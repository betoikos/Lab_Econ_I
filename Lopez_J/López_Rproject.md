# Trabajo final de Laboratorio de Econometría.

En el presente documento, se presenta de forma sintetica la manera en que se replicaron los ejercicios de los laboratorios de Econometría

## Ejercicio 4, Tarea 1.

Para poder desarrollar el ejercicio se capturaron los datos del mismo, los cuales se presentan a continuación.

    Ex1=0
    Ex2=-4
    Ex3=1
    Ey1=-1
    Ey2=4
    Vx1=1
    Vx2=4
    Vx3=2
    Vy1=1
    Vy2=9
    Cx1x2=-1
    Cx1x3=0
    Cx1y1=0
    Cx1y2=1
    Cx2x3=2
    Cx2y1=-1
    Cx2y2=-3
    Cx3y1=0
    Cx3y2=3
    Cy1y2=-2

Donde Exi representa el valor esperado de Xi, Vxi la varianza de Xi y Cxixj la covarianza de xi y xj; de forma similar para y.

i) Para resolver el primer punto se agruparon los datos para obtener el valor esperado y varianza de los vectores X=(x1,x2,x3) y Y=(y1,y2).

    > EX=matrix(c(Ex1,Ex2,Ex3),ncol=1)
    > EX
         [,1]
    [1,]    0
    [2,]   -4
    [3,]    1
    > VX=matrix(c(Vx1,Cx1x2,Cx1x3,Cx1x2,Vx2,Cx2x3,Cx1x3,Cx2x3,Vx3),byrow=T,nrow=3)
    > VX
         [,1] [,2] [,3]
    [1,]    1   -1    0
    [2,]   -1    4    2
    [3,]    0    2    2
    > EY=matrix(c(Ey1,Ey2),ncol=1)
    > EY
         [,1]
    [1,]   -1
    [2,]    4
    > VY=matrix(c(Vy1,Cy1y2,Cy1y2,Vy2),byrow=T,nrow=2)
    > VY
         [,1] [,2]
    [1,]    1   -2
    [2,]   -2    9
    > CXY=matrix(c(Cx1y1,Cx1y2,Cx2y1,Cx2y2,Cx3y1,Cx3y2),byrow=T,nrow=3)
    > CXY
         [,1] [,2]
    [1,]    0    1
    [2,]   -1   -3
    [3,]    0    3
    > CYX=t(CXY)
    > CYX
         [,1] [,2] [,3]
    [1,]    0   -1    0
    [2,]    1   -3    3

ii) Para resolver este punto se identifico al vector como una combinación aX, de forma siguiente:

    > a=matrix(c(-1, 3/2,-4),ncol=1)
    > 
    > EaX=t(a)%*%EX
    > EaX
         [,1]
    [1,]  -10
    > VaX= t(a)%*%VX%*%a
    > VaX
         [,1]
    [1,]   21

iii) Para este punto, se definieron en R la matriz A y el vector b del ejercicio, para posteriormente por proposiciones de clase obtener el valor esperado de AX+b y su varianza.

    > A=matrix(c(-2,0,1,1,4,-2),ncol=3,byrow=T)
    > b=matrix(c(1,1),ncol=1)
    > EAxb=A%*%EX+b
    > EAxb
         [,1]
    [1,]    2
    [2,]  -17
    > VAxb=A%*%VX%*%t(A)
    > VAxb
         [,1] [,2]
    [1,]    6   10
    [2,]   10   33

iv) Para este punto, se definió al vector U=HX+h y al vector V=Ex+f, obteniendo los siguientes resultados:

    > H=matrix(c(1,0,-3,0,1,0,0,2,3),ncol=3,byrow=T)
    > h=matrix(c(2,0,5),ncol=1)
    > E=matrix(c(1,-1,1,-1,4,-3),ncol=3,byrow=T)
    > f=matrix(c(1,0),ncol=1)
    > 
    > EU=H%*%EX+h
    > EU
         [,1]
    [1,]   -1
    [2,]   -4
    [3,]    0
    > EV=E%*%EX+f
    > EV
         [,1]
    [1,]    6
    [2,]  -19
    > VU=H%*%VX%*%t(H)
    > VU
         [,1] [,2] [,3]
    [1,]   19   -7  -32
    [2,]   -7    4   14
    [3,]  -32   14   58
    > VV=E%*%VX%*%t(E)
    > VV
         [,1] [,2]
    [1,]    5  -14
    [2,]  -14   43
    > CUV=H%*%VX%*%t(E)
    > CUV
         [,1] [,2]
    [1,]    2  -11
    [2,]   -3   11
    [3,]   -6   28
    > CVU=t(CUV)
    > CVU
         [,1] [,2] [,3]
    [1,]    2   -3   -6
    [2,]  -11   11   28

v) para este inciso, se procedio a generarel vector c y la constante d en R, y aplicando la teroria de clase se obtuvo la covarianza.

    > C=c(-2,1,5)
    > d=8
    > 
    > #Cov(AX+b,CX+d) se calcula como sigue:
    > A%*%VX%*%C
         [,1]
    [1,]   18
    [2,]   37

vi) Para este punto, apoyandose de las matrices generadas en incisos anteriores y con proposiciones de clase se calculó la COV(AX+b,DY+e) como sigue.

    > D=matrix(c(1,0,2,-2,4,3),ncol=2,byrow=T)
    > e=matrix(c(1,0,-1),ncol=1)
    > 
    > A%*%CXY%*%t(D)
         [,1] [,2] [,3]
    [1,]    0   -2    3
    [2,]   -4   26  -67

vii) Para este punto se definió la matriz presentada como una combinación lineal de las matrices G y g de modo que se calculó la var(GX+g).

    > G=matrix(c(-1,0,-4,1,2,0),ncol=3,byrow=T)
    > g=matrix(c(0,-1),ncol=1)
    > 
    > G%*%VX%*%t(G)
         [,1] [,2]
    [1,]   33  -15
    [2,]  -15   13

viii) Generando a W y V como: W=GX+g y Z=LY y calculando COV(W,Z), se obtuvo lo siguiente:

    > L=matrix(c(1,2,0,1,1,-1),ncol=2,byrow=T)
    > 
    > CWZ=G%*%CXY%*%t(L)
    > CWZ
         [,1] [,2] [,3]
    [1,]  -26  -13   13
    [2,]  -12   -5    3
    > CZW=t(CWZ)
    > CZW
         [,1] [,2]
    [1,]  -26  -12
    [2,]  -13   -5
    [3,]   13    3

## Ejercicio 6, Tarea 1.

Para este ejercicio dato que Z=(y,X), donde X=(x1,x2), entonces en primera instancia se definió en R, la varianza de dicho vector aleatorio y su esperanza; datos dados en el ejercicio.

    > EZ=matrix(c(1,0,2),ncol=1)
    > EZ
         [,1]
    [1,]    1
    [2,]    0
    [3,]    2
    > VZ= matrix(c(0.8,0.4,-0.2,0.4,1,-0.8,-0.2,-0.8,2),ncol=3,byrow=T)
    > VZ
         [,1] [,2] [,3]
    [1,]  0.8  0.4 -0.2
    [2,]  0.4  1.0 -0.8
    [3,] -0.2 -0.8  2.0

i) Para encontrar la varianza de X=(x1,x2) y de Y, se separa EZ y VZ conforme a lo visto en clase:

    > VarY1.6=VZ[1,1]
    > VarY1.6
    [1] 0.8
    > VarX1.6=matrix(c(VZ[2,2],VZ[2,3],VZ[3,2],VZ[3,3]),ncol=2)
    > VarX1.6
         [,1] [,2]
    [1,]  1.0 -0.8
    [2,] -0.8  2.0
    > covYX1.6=matrix(c(VZ[1,2],VZ[1,3]),ncol=2)
    > covYX1.6
         [,1] [,2]
    [1,]  0.4 -0.2
    > covXY1.6=t(covYX1.6)
    > covXY1.6
         [,1]
    [1,]  0.4
    [2,] -0.2

ii) Para calcular, los correspondientes datos del ejercicios, se procedio conforme a las proposiciones de clase, obteniendo:

    > EYcuadrada=VarY1.6+EZ[1,1]^2
    > EYcuadrada
    [1] 1.8
    > EXtX=VarX1.6+c(0,2)%*%t(c(0,2))
    > EXtX
         [,1] [,2]
    [1,]  1.0 -0.8
    [2,] -0.8  6.0
    > EtXX=VarX1.6[1,1]+VarX1.6[2,2]+1
    > EtXX
    [1] 4
    > EytX=covYX1.6+c(0,2)
    > EytX
         [,1] [,2]
    [1,]  0.4  1.8
    > EyX=t(EytX)
    > EyX
         [,1]
    [1,]  0.4
    [2,]  1.8
    
## Ejercicio 5, Tarea 2.

Para este ejercicio se procedió a generar una función para calcular los estimadores de MCO y MCR.

1. Función para obtener estimadores de MCO.

Para el desarrollo de la formula de consideró como insumos:

- x: que se define como una matriz de n observaciones por k columnas de variables explicativas.
- Y: que se define como un vector columna de n observaciones.
-varianza: una variable boleana que en caso de tomar "True" genera además de los estimadores de MCO una estimación de la varianza de U.

En el codigo se generá una matrix X que procede a agregar la columna de 1's a el insumo x.

    X=cbind(rep(1,nrow(x)),x)

Se generá una matriz de etiquetas para cada uno de los estimadores
    
    Cnames=matrix(,1,ncol(x))
      for(i in 1:ncol(x)){
        Cnames[1,i]=(paste("\beta",i))
      }
      c=cbind("Intercepto",Cnames,"Var(U)")

Se genera la condición para ejecutar MCO, además de un condicional sobre la variable boleana para presentarse en los resultados la varianza de U u omitirse:

    if(nrow(x)==nrow(Y)){
        B=solve(t(X)%*%X)%*%t(X)%*%Y
        VU=(1/(nrow(X)-ncol(X)))*(t(Y-X%*%B)%*%(Y-X%*%B))
        Est=matrix(rbind(B,VU),ncol=1,dimnames = list((as.vector(c)),c("Valor estimado")))
        if (varianza==F){matrix(Est[1:ncol(X),1],ncol=1,dimnames = list((cbind("Intercepto",Cnames)),c("Valor estimado")))
        } else {print(Est)} 
      } else {print("El número de observaciones en x es distinto a las de Y")}
  
Siendo el codigo completo el siguiente:

    EstMCO=function(x,Y,varianza){
      X=cbind(rep(1,nrow(x)),x)
      Cnames=matrix(,1,ncol(x))
      for(i in 1:ncol(x)){
        Cnames[1,i]=(paste("??",i))
      }
      c=cbind("Intercepto",Cnames,"Var(U)")
      if(nrow(x)==nrow(Y)){
        B=solve(t(X)%*%X)%*%t(X)%*%Y
        VU=(1/(nrow(X)-ncol(X)))*(t(Y-X%*%B)%*%(Y-X%*%B))
        Est=matrix(rbind(B,VU),ncol=1,dimnames = list((as.vector(c)),c("Valor estimado")))
        if (varianza==F){matrix(Est[1:ncol(X),1],ncol=1,dimnames = list((cbind("Intercepto",Cnames)),c("Valor estimado")))
        } else {print(Est)} 
      } else {print("El número de observaciones en x es distinto a las de Y")}
    }


2. Función para obtener estimadores de MCR.

Para el desarrollo de la formula de consideró como insumos:

- x: que se define como una matriz de n observaciones por k columnas de variables explicativas.
- Y: que se define como un vector columna de n observaciones.
- R: matriz de qx(k+1), donde q es el número de restricciones y k el número de variables explicativas.
- r: es una matriz columna de q hileras.
-varianza: una variable boleana que en caso de tomar "True" genera además de los estimadores de MCO una estimación de la varianza de U.

En el codigo se generá una matrix X que procede a agregar la columna de 1's a el insumo x.
    
    X=cbind(rep(1,nrow(x)),x)

Se generá una matriz de etiquetas para cada uno de los estimadores
    
    Cnames=matrix(,1,ncol(x))
      for(i in 1:ncol(x)){
        Cnames[1,i]=(paste("\beta",i))
      }
      c=cbind("Intercepto",Cnames,"Var(U)")

Se genera la condición para ejecutar MCR, además de un condicional sobre la variable boleana para presentarse en los resultados la varianza de U u omitirse:

    if(nrow(X)==nrow(Y) & ncol(X)==ncol(R)){
        B=solve(t(X)%*%X)%*%t(X)%*%Y
        BR=B-solve(t(X)%*%X)%*%t(R)%*%solve(R%*%solve(t(X)%*%X)%*%t(R))%*%(R%*%B-r)
        VU=(1/(nrow(X)-ncol(X)))*(t(Y-X%*%BR)%*%(Y-X%*%BR))
        Est=matrix(rbind(BR,VU),ncol=1,dimnames = list((as.vector(c)),c("Valor estimado")))
        if (varianza==F){matrix(Est[1:ncol(X),1],ncol=1,dimnames = list((cbind("Intercepto",Cnames)),c("Valor estimado")))
          } else {print(Est)}
      } else {print("El número de observaciones en X es distinto a Y o el número de restricciones supera los párametros")}
  
Siendo el codigo completo:

    EstMCR=function(x,Y,R,r,varianza){
      X=cbind(rep(1,nrow(x)),x)
      Cnames=matrix(,1,ncol(x))
      for(i in 1:ncol(x)){
        Cnames[1,i]=(paste("\beta",i))
      }
      c=cbind("Intercepto",Cnames,"Var(U)")
      if(nrow(X)==nrow(Y) & ncol(X)==ncol(R)){
        B=solve(t(X)%*%X)%*%t(X)%*%Y
        BR=B-solve(t(X)%*%X)%*%t(R)%*%solve(R%*%solve(t(X)%*%X)%*%t(R))%*%(R%*%B-r)
        VU=(1/(nrow(X)-ncol(X)))*(t(Y-X%*%BR)%*%(Y-X%*%BR))
        Est=matrix(rbind(BR,VU),ncol=1,dimnames = list((as.vector(c)),c("Valor estimado")))
        if (varianza==F){matrix(Est[1:ncol(X),1],ncol=1,dimnames = list((cbind("Intercepto",Cnames)),c("Valor estimado")))
          } else {print(Est)}
      } else {print("El número de observaciones en X es distinto a Y o el número de restricciones supera los párametros")}
    }

3. Prueba de funciones.

Se consideraron los datos del ejercicio 1 de la tarea 15 obteniendo:

- Estimadores MCO con y sin varianza:

        > EstMCO(D15.1[1:120,],Y1,varianza=F)
                       Valor estimado
         Intercepto      0.5760072
         \beta 1         0.5079889
         \beta 2        -1.1955320
         \beta 3        -0.7473102

        > EstMCO(D15.1[1:120,],Y1,varianza=T)
                       Valor estimado
        Intercepto      0.5760072
        \beta 1         0.5079889
        \beta 2        -1.1955320
        \beta 3        -0.7473102
        Var(U)          0.3494417

-Estimadores de MCR con y sin varianza.

    > EstMCR(D15.1[1:120,],Y1,diag(4),rep(0,4),varianza=T)
               Valor estimado
    Intercepto  -2.220446e-16
    \beta 1     -2.220446e-16
    \beta 2      6.661338e-16
    \beta 3     -5.551115e-16
    Var(U)       1.429367e+00

    > EstMCR(D15.1[1:120,],Y1,diag(4),rep(0,4),varianza=F)
               Valor estimado
    Intercepto  -2.220446e-16
    \beta 1     -2.220446e-16
    \beta 2      6.661338e-16
    \beta 3     -5.551115e-16

## Ejercicio 5, Tarea 3.

Para este ejercicio se apoyó de la paqueteria *"magic"* en especifico de su función a *diag()* la cual permite obtener matrices diagonales por bloques, además del paquete *MASS* para poder utilizar la función *mvrnorm()* y obtener las muestras aleatorias normales multivariadas.

Con dichos paquetes y con los datos del ejercicio se pasaron a R los vectores de medias y matrices de varianzas procediendo a incorporarlas en las funciones de la forma siguiente:

    m1=c(0,-1)
    Sig1=matrix(c(1,-0.25,-0.25,0.5),ncol=2,byrow=T)
    m2=c(-2,0,-2)
    Sig2=matrix(c(1,1/3,-1/2,1/3,1/4,0,-1/2,0,1),ncol=3,byrow=T)
    S=adiag(Sig1,Sig2)
    mu=c(0,-1,-2,0,-2)
    X=mvrnorm(n=100,mu,S)

                  [,1]        [,2]       [,3]         [,4]        [,5]
      [1,] -0.48493844 -1.21654558 -3.1988697 -0.078985889 -0.19853131
      [2,]  0.94676848 -1.51061228 -0.6558559  0.839545398 -2.82810733
      [3,] -0.06972124 -1.81203526 -2.3387497 -0.016885713 -2.26008705
      [4,]  0.20263252 -1.07705063 -4.7625765 -0.239592777 -0.44218882
      [5,]  0.20269278 -1.06308786 -1.3304138 -0.349732160 -1.86554164
      [6,] -1.22721298 -1.23278736 -2.3040439 -0.247577149 -1.39826846
      [7,] -0.28369683 -1.59348727 -2.1137876  0.229522945 -2.71857104
      [8,] -0.45696204 -1.93196431 -2.9661202 -0.824332718 -2.52667349
      [9,]  0.64207143 -0.73454542 -2.5066978 -0.113419238 -2.08667073
     [10,] -0.11115077 -0.58066805 -3.3497846  0.037555100 -0.92548673
     [11,]  0.34898694 -0.20619767 -1.9230388 -0.077904893 -1.79493096
     [12,]  0.61049066 -0.64768873 -1.7752524 -0.017402378 -3.27773178
     [13,] -0.62009223 -0.43453674 -1.1498573 -0.223335763 -1.87475917
     [14,] -1.02546178 -0.45560123 -2.4537158 -0.214886511 -1.08012481
     [15,] -1.46540639 -1.47584035 -2.4444681 -0.109080042 -1.98490106
     [16,] -1.21580725 -1.01684124 -0.1603751  0.617979944 -3.73256741
     [17,] -0.91350171 -0.93765603 -2.3333918  0.016418462 -0.80256034
     [18,]  0.85460753 -0.26761517 -2.4857668  0.172151455 -1.72496634
     [19,]  0.35849270 -1.54838471 -1.2913570  0.179993304 -2.16722922
     [20,]  0.10526814 -1.72956667 -2.6483232 -0.381466393 -1.25893049
     [21,]  0.90360442 -1.92157126 -1.1109741  0.192129621 -3.67763873
     [22,] -0.11696958 -0.22044114 -1.6911476  0.119771326 -1.58296231
     [23,]  0.29851044 -1.22887396 -2.8901076 -0.748774204 -1.37158386
     [24,]  0.17921058 -2.18607337 -1.7588117  0.543771320 -1.55493611
     [25,] -0.97938468 -1.44791923 -1.0756521  0.342797895 -2.42680681
     [26,] -0.93069698 -0.80816838 -0.9439163  1.075337890 -1.60124424
     [27,] -0.98823186 -0.99446212 -2.7156582 -0.310021053 -2.14275742
     [28,] -0.42094893 -2.48140998 -1.4295725  0.167433451 -2.57161532
     [29,] -0.52688112 -0.95266007 -1.7083518  0.393620807 -0.85931088
     [30,] -1.34460249 -0.29269972 -2.3086374 -0.213802662 -2.53132285
     [31,] -1.61038143 -1.08228717 -0.9550490 -0.069373468 -2.84649988
     [32,] -0.23083618 -1.30610277 -3.1117524 -0.595985641 -2.03192566
     [33,] -1.01263016 -0.15419703 -1.8126880 -0.265093434 -2.00677480
     [34,]  1.03074370 -0.84908875 -2.0219471  0.627864909 -1.76596687
     [35,]  0.54915122 -0.04145404 -1.6789470  0.716563884 -0.45390577
     [36,]  0.01228639 -0.30470586 -2.4052988  0.022012880 -1.28137236
     [37,] -0.20243636  0.30110498 -0.4707881  0.501947837 -2.73423983
     [38,]  1.04587313 -3.44145763 -2.4480046 -0.517262674 -3.22726522
     [39,] -0.52378118 -0.02700590 -2.5967995 -0.319821827 -1.84368501
     [40,] -0.60419255 -0.67510623 -2.6985075 -0.658199259 -3.00722997
     [41,] -0.68227911 -0.77032400 -1.6827124  0.389049034 -1.63067697
     [42,]  0.77660273 -1.48440763 -0.5000075  0.719318288 -0.91026965
     [43,] -0.42893998 -0.84766160 -1.8602952 -0.165999908 -2.74120093
     [44,] -1.13037433 -0.50675016 -2.3021375 -0.034053481 -1.93709567
     [45,] -1.33473450 -0.10548120 -3.0519837 -0.481090738 -1.42232609
     [46,]  0.73754267 -1.12678018 -2.4141618 -0.607376233 -3.07835576
     [47,] -1.62196805 -1.23323650 -2.6675099 -0.537174621 -2.47482829
     [48,] -0.49571374 -1.27090999 -1.4652597 -0.035528591 -3.16510979
     [49,]  1.54706516 -1.11895352 -4.1509275 -0.699264110 -0.38453181
     [50,]  0.28039381 -2.75436719 -1.5350097  0.538668501 -1.10501117
     [51,] -0.07787627 -1.27581575 -3.7103296 -1.242390544 -2.20153634
     [52,] -1.33949387 -1.10721735 -2.0627094 -0.387854302 -4.68977981
     [53,]  2.38232450 -2.08148069 -2.6488499 -0.830781773 -2.71899027
     [54,]  0.14845800 -1.42249199 -1.1023997 -0.101015598 -3.64717359
     [55,]  0.97914151 -0.59928096 -1.4253730  0.238240996 -2.07430067
     [56,] -0.09453575 -0.92066515 -1.1820206  0.175821969 -2.53668307
     [57,]  0.62197603 -1.32442919 -1.8925411  0.272806764 -1.60814358
     [58,]  0.04884988 -2.21052873 -1.4867828  0.004340824 -2.18956038
     [59,]  0.32971694 -1.21160349 -2.2436278  0.070861914 -1.69457048
     [60,] -0.85010038  0.14195341 -1.5141022  0.278095821 -1.46289682
     [61,] -0.95499065  0.03091367 -2.3593523 -0.219074220 -1.67247012
     [62,]  0.40376228 -0.48709265 -1.0426461 -0.029021553 -1.97902755
     [63,] -1.81288149 -1.25020403 -2.3724988 -0.155616116 -1.97953903
     [64,] -0.88361693 -1.93268318 -2.5235513 -0.015412960 -1.44752052
     [65,] -0.78801609 -1.36144941 -0.6045726 -0.219198629 -1.58845394
     [66,] -0.58407685  0.39335154 -2.8834120  0.553887713 -0.81246291
     [67,] -0.47967959 -0.59237664 -0.8510358  0.943487030 -1.03226715
     [68,]  1.40174664 -0.83514282 -1.4959107  0.396538454 -1.81503145
     [69,] -0.18128782 -1.21633544 -0.5573565  0.093383031 -3.48461656
     [70,] -2.09736387 -0.32810161 -2.4188540 -0.103828891 -0.58765212
     [71,] -1.79654814 -1.33001130 -0.6806647 -0.066136999 -3.58339051
     [72,]  1.29304779 -1.83486996 -1.0403693  0.497769024 -2.10005187
     [73,] -0.85573269 -1.32211110 -1.0304362  0.170889759 -2.83219800
     [74,] -1.61641669 -1.18883861 -1.9661749 -0.442911109 -2.44593211
     [75,]  1.74106013 -1.97273967 -1.6076653  0.521897042 -0.76621401
     [76,] -0.85942463 -0.48352363 -2.2912851 -0.673697045 -3.49572130
     [77,] -0.08403541 -0.93321457 -2.3087868  0.404768918  0.08217327
     [78,] -0.29854408 -1.25131149 -2.6872162 -0.424424295 -1.61361543
     [79,]  1.98726936 -0.60150325 -1.7140257  0.622951633 -1.53850809
     [80,] -1.13064776 -0.38796271  0.7504247  1.373940197 -3.15118727
     [81,]  0.82460714 -0.90066714 -2.3321811  0.045869211 -3.24090311
     [82,]  0.36660604 -0.93048190 -0.7780050  0.511171577 -3.14665556
     [83,] -0.04884428 -1.30251767 -2.4498727  0.186580659 -1.09851548
     [84,] -2.96656177 -1.77441335 -2.5151607  0.026689026 -1.40337268
     [85,] -1.11143339 -1.28282878 -2.6467999 -0.902311589 -1.58869928
     [86,] -2.22215480 -1.37434779 -1.4986605 -0.111956306 -4.17174893
     [87,] -0.37486203 -0.09226326 -1.7493988  0.036871973 -2.62097765
     [88,] -0.68719444 -0.71413124 -0.4956806  0.862713522 -2.06999657
     [89,]  0.97368452 -1.87135483 -2.4128066  0.540418726 -0.61991955
     [90,] -2.42956552 -0.01237206 -1.8194260 -0.079551825 -1.22464705
     [91,] -0.48809149  0.41442451 -2.3589127 -0.324169464 -1.71942372
     [92,]  0.74580513 -0.59139751 -2.6225442 -0.560757599 -1.31913635
     [93,] -0.69378657 -1.83946022 -1.5641109 -0.306017185 -3.64090615
     [94,]  1.13624611 -1.84201352 -2.5015646 -0.441659019 -2.12885703
     [95,]  1.27097609 -1.02215580 -2.8280719 -0.382728778 -1.39860132
     [96,] -0.80863520 -2.19108949 -1.1426937  0.058281829 -1.85677223
     [97,] -0.59402175 -1.76855931 -0.7012564  0.225305067 -3.02412112
     [98,] -0.51323039 -0.76212416 -0.5323032  0.998563996 -1.06653220
     [99,]  0.04765467 -2.05733537 -1.1937627  0.046691732 -2.55190461
    [100,]  0.84434895 -1.72506472 -2.1428287  0.697004916 -1.05628263

# Ejercicio 6, Tarea 3.

Para este ejercicio se cargaron en R el vector de medias y matriz de covarianzas presentadas en la distribución aleatoria: así.

    mean=c(0,0,1,1)
    SIGMA=matrix(c(1,0,1,0,0,9,0,1,1,0,4,0,0,1,0,9),ncol=4,byrow=T)
    X.6=mvrnorm(n=200,mean,SIGMA)

                    [,1]        [,2]         [,3]        [,4]
      [1,] -0.1009321085  2.55345424  3.062640406 -2.69384892
      [2,] -0.4817719543 -3.20689447 -0.512307072  5.15141572
      [3,]  2.0595694352 -0.17958230  1.456701699  0.98466697
      [4,]  0.0394662322 -4.18310408 -1.608840065  1.28197213
      [5,] -0.2775170836  1.49478568  2.068661649 -3.28349612
      [6,] -2.3091599038 -0.85532412 -1.669274024 -3.60417363
      [7,] -0.7317712162  8.90448745  1.614170152  2.25776426
      [8,] -2.2562802469  0.78077344 -4.001683897 -2.57924746
      [9,] -0.1050421014 -1.00969132  0.737342524 -0.65306513
     [10,]  1.1022346097  0.90220512  4.400669373  2.99843780
     [11,] -0.7048661135 -2.69768030 -1.510058194  1.41109385
     [12,]  0.5338294821  2.74298856  1.482859796  0.56739601
     [13,]  0.3757180649 -4.00640381  4.394961626 -0.36440985
     [14,] -1.1507890196  3.09396417  1.324427746  1.38770934
     [15,] -1.1349680747  1.15878828 -1.630527689  0.14233896
     [16,]  0.2414532292  0.76367681  2.218504779  2.69077647
     [17,]  0.4524672830  5.33460109  2.049722218  6.76052788
     [18,] -2.4294781537 -7.84704891  0.713742023 -0.92837909
     [19,]  0.3608129985  4.40293942  3.847263069  4.40489500
     [20,]  0.7980364318  1.15042121  0.151563235  5.38311953
     [21,] -0.5649779493  4.70159081  1.161527915  2.63476966
     [22,]  0.5886323458  3.71967367  1.499247046  2.67865902
     [23,] -0.4764571389 -8.21497780 -2.380746175  2.02232403
     [24,] -2.0427609141 -0.43358293 -1.378460522  2.01914231
     [25,] -0.6130069002  0.63487598  2.405027250  3.89120863
     [26,] -1.1406077801 -1.42103512 -1.372636438  2.61472642
     [27,] -0.3077629855  2.30765757 -1.279931680  4.83450173
     [28,]  0.6392831525  2.07388748  2.467132536  0.87266875
     [29,]  0.8968936024  0.25276912  1.534510601  0.06007451
     [30,] -1.0494440882  0.68821474  2.651213085  4.82506200
     [31,]  1.5772583778 -1.01034815  2.278447874  0.34496654
     [32,] -2.1333264873  0.02191065 -0.751480017 -2.96443654
     [33,] -1.2522646436 -0.64226770 -1.982635455  3.38837330
     [34,]  1.6019608389 -2.48826423  4.110069868  6.17393414
     [35,] -2.6814384823  1.84046907  0.181426881  0.31679402
     [36,]  0.1274318014 -3.63186615  0.784278652 -4.29831639
     [37,]  0.8661698175  0.73918507  5.129770292  3.74046785
     [38,] -1.6568666476  0.05054581 -0.942795143 -1.89112553
     [39,] -0.7678146013 -2.69284649 -1.510031726 -2.20033567
     [40,]  0.0073597759  1.28086524  1.711861240 -0.51182750
     [41,] -0.2967606242 -0.80764431  2.441558640  3.27396682
     [42,] -1.4401548498 -3.18658211 -1.810678459  5.01304822
     [43,] -0.1763196514  0.47408608  2.210726487 -0.96491012
     [44,]  0.2727783575  4.15236852 -0.339081357  0.88124468
     [45,]  1.0948484132  0.91940305  2.374903852  3.13797728
     [46,] -1.0284928448 -1.07919677 -0.282999343  3.56408330
     [47,] -1.9413850761  2.32648567  1.893823604  2.25655534
     [48,] -1.8528410014 -4.27288030  0.317815619  3.25116204
     [49,]  1.3285798938 -0.17528186  3.432790820  0.04373975
     [50,] -1.1404798349  1.54296722  1.940711573  2.40390536
     [51,] -0.6328205771  4.58374948  3.891484039  2.98345947
     [52,]  1.9335624459  5.38656826  4.338521592 -1.33923846
     [53,] -0.6281608190 -7.62230374  2.433947123 -4.87486543
     [54,] -0.1552619512 -0.31719303  1.045147313 -7.34157380
     [55,] -1.2727133258 -1.10405605 -0.265099689 -1.30372426
     [56,] -0.2187871501  2.37744565 -1.618698058  4.72774988
     [57,]  0.3072449434 -6.62369555  1.037593683 -4.88037627
     [58,] -1.3970551642  1.30442509 -0.043793284 -0.78259048
     [59,]  0.6542710390 -5.19436528  1.276400985 -0.08499378
     [60,] -0.2477110311 -5.46925666  0.725146715  0.72483649
     [61,]  0.5414015323  0.89359245  3.070964049  4.13445219
     [62,] -0.1895736490 -0.53762144  0.336953249  4.18209746
     [63,]  1.2578626262  1.13534567  0.987061189  3.78716649
     [64,] -0.5662307981  4.24504029 -2.266587804  1.01045758
     [65,]  0.1360897852 -1.93903314  4.581301199  5.51135615
     [66,]  1.7961727999 -0.44746029  8.323689105 -0.11608025
     [67,]  0.5078903115  1.62998588  0.770770062  7.41941129
     [68,]  0.6221686761 -1.58153040  3.700425229 -3.64872790
     [69,]  2.2271359094  4.21832946  3.009729672 -0.98827871
     [70,] -1.0792374867 -7.64989941  0.432432445 -3.69959063
     [71,]  1.7951087151 -1.87182532  1.566539235  0.71118045
     [72,]  0.1261245426 -2.22024254  3.311686760 -4.39129833
     [73,] -1.4093048202 -0.60519308 -1.336670960  0.40460879
     [74,] -0.2225481890  2.91100188  0.035131136 -0.15077952
     [75,]  1.2949096067  3.60825332  2.715057752 -4.86201518
     [76,] -0.1230807713 -8.72774068  1.640847143 -2.03650847
     [77,] -1.7789049807  3.56671515  1.843510456 -0.65277620
     [78,]  0.6718903942 -1.08831435  1.714863222 -1.20895584
     [79,]  0.5637248954  0.59408634  0.878731832  0.80134181
     [80,]  0.9302147971  3.79022509  0.489513662 -0.10996033
     [81,] -0.6133753183  4.07925936  2.693387373  2.83433213
     [82,]  1.9505692095  1.77264099  1.423947824 -0.01560137
     [83,]  0.5567650198  0.04498207  2.678876211  4.87932002
     [84,] -0.4965195528  3.38970442 -1.139869462  5.86854232
     [85,]  0.0096984354 -2.46132000 -0.786829179 -1.10825825
     [86,]  0.8133338904 -4.00594351  1.097278843  2.91084444
     [87,] -0.7972906961 -0.29225521  0.533347090  5.36926026
     [88,]  1.4578426411 -1.73404753 -3.380456359 -1.49483435
     [89,] -1.0096339690 -1.85168936 -0.559619374 -3.25940083
     [90,]  0.8487012480  2.50102203 -0.589011227  5.00867290
     [91,]  0.8947186088 -3.64314386  1.353278828  2.62371872
     [92,]  0.3709011811 -0.61470222  3.040346214  1.12230059
     [93,] -1.3986491640 -0.66170492  1.102082154  2.63514002
     [94,]  1.7472087489 -1.29634041 -0.171327899 -0.32698294
     [95,]  0.8362190679  0.10128716  2.552657452  1.83081683
     [96,] -1.0249771444  2.80813258 -0.929034486  0.65209325
     [97,] -0.4820263365  3.07173651 -0.885485764  2.40285343
     [98,]  0.4067795564 -1.01970218 -0.301161625 -2.63491145
     [99,]  0.8872114655  2.73794909  2.291374981  1.85229019
    [100,] -0.1435072324  3.28577994  3.239922711  1.62447673
    [101,]  1.3752560498  7.32667072  3.684657698 -4.29438693
    [102,] -0.5754920747 -5.48735103 -1.887232694  4.11993461
    [103,] -0.6924560502 -0.04150805  0.156177954 -3.36271281
    [104,] -0.4522576231 -3.18970835 -0.213731931 -2.19949939
    [105,]  1.2546543536 -4.73422292  1.556114404 -1.93520994
    [106,] -0.6238747571 -2.70967772  1.235398221 -0.55584533
    [107,]  0.8640016686 -2.93985114  0.007407362  0.14015846
    [108,] -0.5162484623 -6.70198807  2.274011337 -2.35339663
    [109,]  0.3489962078  3.69292565 -2.943692979 -0.17328367
    [110,] -1.2483108847  1.95077463  0.299550242 -0.47475462
    [111,]  0.4779310263 -3.24595840  0.661919765  0.15001778
    [112,] -2.3422421756 -0.38006654 -3.739101400 -0.30363769
    [113,] -1.5480805958  1.69725091 -1.224940484  2.40005504
    [114,]  1.6613657328 -0.41765593  2.231103958 -1.33095030
    [115,] -0.2991876458 -1.05598232  2.195026239 -6.28685306
    [116,]  0.3997761749  0.61234895  0.501746463 -1.40366220
    [117,]  0.2884445569 -1.99435970  1.604840439 -1.12291366
    [118,]  0.5944654640  2.27293386  1.616745916  0.86359580
    [119,] -1.1290033793 -2.22093303 -0.855987959 -2.40463485
    [120,]  0.6958622355 -0.70574338  0.881678015  2.95811994
    [121,] -0.1073618492  6.74235121  1.975432469  0.30161971
    [122,]  0.0006511343 -2.18601962  1.838290191  0.74197033
    [123,]  0.1909323022 -1.28225110  1.885218399 -0.24956917
    [124,] -0.2518910111 -1.52938104  3.410564309  0.51313272
    [125,]  1.9184223144 -0.08290309  2.334420657 -2.24957968
    [126,]  0.4132714929 -0.71569522  1.249025985  2.48196344
    [127,] -0.1160945767 -5.09948442  2.211772970  5.20667900
    [128,]  0.5078422930  0.75300007  1.742670914 -0.84974046
    [129,]  0.2578229407 -1.24190498  1.804953186  7.93148776
    [130,]  1.6809379588  6.72161970  4.144659907  1.36941600
    [131,] -1.5758836512  1.46240714  1.006257524  1.55949760
    [132,] -0.3235339702  1.55720739  3.080027264  3.18996525
    [133,]  0.5092898435  2.22554676 -0.699400721  5.41483667
    [134,] -0.4146305551  2.16524300  2.867598608 -4.51401528
    [135,] -0.9222185910  2.09393137 -1.664525616  4.32248011
    [136,] -0.3856732524 -3.72906914  2.623497749  7.17454827
    [137,]  0.9155532351 -1.55067231  3.286170921  5.80050985
    [138,] -0.0158307559  4.37596537  0.742247874  7.69504744
    [139,] -0.8498919819 -7.82565808 -0.691869854 -1.33613600
    [140,]  0.0743150144  3.92422843 -0.539580716  2.03296352
    [141,]  0.8025416053 -0.59492622  4.402832047 -1.77113798
    [142,]  0.4408452052  2.79831350 -1.267529981  2.33110114
    [143,] -0.4245959891  0.49671102 -1.554455568  0.80936390
    [144,] -1.1135782742  0.87611508  2.285812293  3.09966498
    [145,]  0.2631176423  5.52713535  0.463647675  8.91397830
    [146,] -0.1154438799  2.74400744 -0.786791710  1.30322717
    [147,]  0.0129177971 -1.87019024  2.109571654  1.97322716
    [148,] -0.6736068709  0.98968445 -0.593400533  2.93352251
    [149,]  1.2774738323  1.23592466  1.364980057 -0.81452785
    [150,]  0.9177914997 -1.34790853  3.306988139 -1.82651385
    [151,]  0.0639006226  0.29420762  0.110146158  0.68054425
    [152,] -0.9124551791  1.74615098 -2.241894682 -0.25094600
    [153,]  0.0958387575  1.34142980 -0.265115016  4.75986523
    [154,]  0.8823815016 -2.11999251  1.303849366  7.32400586
    [155,] -0.8268501793 -0.39195969 -0.484064262  2.19750614
    [156,]  0.6335578000 -1.87809282  0.467704729 -1.30460106
    [157,] -0.1872458663 -1.11836092  2.100387152 -4.30896415
    [158,]  0.5942616025  1.79880682 -0.225471575 -0.86995965
    [159,] -0.9785233784  1.67960501 -1.641657351  3.30289388
    [160,] -0.0117990101 -1.64002064 -1.782785935 -1.44369584
    [161,] -0.0858106576  1.08092872  3.406708209 -0.45244750
    [162,]  0.3823726005 -1.48442335  3.896506362  8.58939475
    [163,]  0.2990911250 -0.61761695  1.807468256 -0.11750503
    [164,]  3.4923261828 -0.29347098  3.916979700 -2.47851057
    [165,] -0.6801015340  0.76205650  2.377091845  2.99425605
    [166,] -1.6432167432 -1.41747230  2.250883094  1.15323817
    [167,] -0.7558981623  2.54678023 -1.547814103  0.09737162
    [168,] -2.8171181861  4.09452357 -2.352587054  3.01810912
    [169,] -0.3874341465 -2.46800417  2.308421714  5.09296807
    [170,]  0.6868107822  2.32264080  2.794213817 -3.99021960
    [171,] -1.0751928495 -1.87814125 -1.995351643  3.23541260
    [172,]  1.2224204258 -2.82951966  2.792010515  3.15900143
    [173,] -0.0504790693  1.48085228 -0.283530773  2.74383648
    [174,]  0.1918661058  5.60011119  1.353936052  1.04568773
    [175,]  0.8588785180  5.65152358  3.340942250 -2.42694151
    [176,]  1.7219364778  1.41694056  1.560510534  0.64091972
    [177,]  1.2289500798  3.93963401  0.925304789  3.25656031
    [178,]  0.4974724374 -4.44177980  1.242032782 -2.98069218
    [179,]  1.3627911148 -0.62747709  0.804228540  1.43460920
    [180,] -1.0122616813  2.89239978  1.936594122  2.82677993
    [181,]  0.9102966955 -0.04617686  3.149589259  4.40603230
    [182,]  0.5509298588 -0.52235818  1.312754022  2.36572571
    [183,]  0.2613864538  1.49374895  2.877523258  0.88467105
    [184,] -0.5808833692  2.31983829  0.683470949 -0.78052264
    [185,]  1.1726028652 -0.07592085  3.691576917  1.06239979
    [186,] -0.7557527169  2.50574545 -3.562043769  0.53867087
    [187,] -0.8062905889 -1.39507055 -1.112349260  0.79181567
    [188,] -1.5885995151 -4.89258597 -0.717896856  2.47264196
    [189,] -0.4088504804 -4.19203455 -2.574623322  3.47945968
    [190,] -0.3959354219 -2.36182403  1.008877783  0.86653379
    [191,] -0.2208491905  3.37570039  2.094826617 -3.80687543
    [192,]  0.8803713678 -5.73394946  2.329096000 -3.64089238
    [193,] -0.7979163498 -5.96599456 -0.732246322 -4.00753283
    [194,]  0.4363464782  3.14186437  3.710934457  3.50366468
    [195,]  1.1217514582  4.01446558  3.865996269  1.71118468
    [196,]  0.9750328320  5.88263235  3.432222738  7.34271650
    [197,] -1.5417952244  2.86673723  1.019175396 -1.60604274
    [198,] -1.6028182069  0.25661396 -1.788607836  4.80320756
    [199,]  0.0005196846 -0.30798088  0.544900364 -0.56824396
    [200,]  0.2706642310 -0.50573304  0.101440029  2.89532697

i) considerando que Z=(X3,X2,X4,X1), y que se puede ver como una transformación lineal de X donde Z=MX entonces se distribuye normal multivariado 4 con las siguiente media y varianza.

    > meanz=M%*%mean
    > sigmaz=M%*%SIGMA%*%t(M)
    > meanz
         [,1]
    [1,]    1
    [2,]    0
    [3,]    1
    [4,]    0
    > sigmaz
         [,1] [,2] [,3] [,4]
    [1,]    4    0    0    1
    [2,]    0    9    1    0
    [3,]    0    1    9    0
    [4,]    1    0    0    1

## Replica y analisis de regresión del articulo *"Does pay inequality within a team affect performance?"* para 2005-2010.

Con el metodó de extrancción de información de los juegos ganados y salarios por equipo en el beisbol norteamericano, así como con los metodos de tratamiento de los datos obtenidos y guiados por la replica del laboratorista (encontrada en el archivo López_Replica.R) se obtuvieron los siguientes resultados de la regresión:

    =============================================================================
                                        Dependent variable:                        
                        ---------------------------------------------------------
                                              pctwin                               
                          (1)                   (2)                    (3)          
    -----------------------------------------------------------------------------
    top20share          0.157**               0.244***               0.232***    
                        (0.071)               (0.077)                (0.076)    

    payroll                                   0.032***                          
                                              (0.012)                        

    log(payroll)                                                      3.662**
                                                                     (1.517)

    Constant            40.176***             30.487***               17.861*
                        (4.377)               (5.662)                (10.203)    

    -----------------------------------------------------------------------------
    Observations          180                   180                    180       
    R2                   0.027                 0.064                  0.058      
    Adjusted R2          0.022                 0.053                  0.047     
    Std. Error     6.392 (df = 178)       6.288 (df = 177)       6.307 (df = 177)
    F Statistic  4.934**(df = 1; 178) 6.019***(df = 2; 177) 5.448***(df = 2; 177)
    =============================================================================
    Note:                                             *p<0.1; **p<0.05; ***p<0.01
    
1. *Primer modelo de regresión*

De esta regresión se puede decir que si bien la proporción de dinero gastado en nomina por el quinto quintil de la muestra explica poco de la variabilidas de juegos ganados, es claro que en este primer modelo  el efecto de este gasto en el top20 es significativo con el 95% de confianza.
    
La interpretación usual de este coeficiente generado sería que con la información obtenida, un aumento unitario en el nivel de la nomina del top20 se asocia a un aumento promedio de 0.157 juegos ganados.

2. *Segundo modelo*

Siendo Payroll, el gasto total por jugadores de cada equipo de beisbol; el segundo modelo (que solo añade dicha variable al modelo de regresión versus el modelo uno) al igual que el anterior solo explica poco de la variabilidad de los juegos ganados (5.3%), pero apesar de ello sus efectos son altamante significativos a más del 99% de confianza.

A modo de interpretación se puede decir que:

* Respecto al modelo 1, el efecto del gasto del ultimo quintil aumenta de modo que ahora un aumento unitario de la nomina del top20 se asocia a un aumento promedio de 0.244 juegos ganados, manteniendo el resto de variables constantes.

* El modelo extrae que para la información obtenida, un aumento unitario en el presupuesto del equipo se asocio a un aumento de 0.032 juegos ganados, manteniendo lo demás constante.


3. *Tercer modelo*

En este tercer modelo a diferencia del segundo, en lugar de considerarse la nomina de cada equipo, se considera al logaritmo de dicha variable, así se extraen las siguientes conclusiones:

* Respecto al modelo 1, el efecto del gasto del ultimo quintil aumenta caso contrario al contrastarlo con el modelo 2; de modo que ahora un aumento unitario de la nomina del top20 se asocia a un aumento promedio de 0.232 juegos ganados, manteniendo el resto de variables constantes.

* En este caso la interpretación del logaritmo (al ser una variable nivel) de la nomina de cada equipo se interpreta como sigue; a un incremento en el uno porciento de la nomina del equipo se aumenta el número promedio de juegos ganados en 0.0366%, manteniendo el resto de variables constante