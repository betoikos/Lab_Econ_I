PH3<-print("True")
} else {
PH3<-print("False")
}
Xi3<-(X1[3,3])^.5
Est3<-(b[3,]-1.2)/(SDU*Xi3)
t3<-1.6607
if (-t3<Est3 & Est3<t3){
PH3<-print("True")
} else {
PH3<-print("False")
}
library(mvtnorm)
set.seed(100)
#----------Pregunta 1----------
Sigma<-matrix(c(0.8,0.4,-0.2,0.4,1,-0.8,-0.2,-0.8,2),3)
Muestra<-rmvnorm(100,mean=c(1,0,2),sigma=Sigma)
Y<-Muestra[,1]
Xj<-Muestra[,2:3]
Constante<-matrix(rep(1,100),100)
X<-cbind(Constante,Xj)
b<-(solve(t(X)%*%X))%*%(t(X)%*%Y)
U<-Y-(X%*%b)
VarU<-t(U)%*%U/97
SDU<-VarU^.5
X1<-solve(t(X)%*%X)
#----------Inciso ii----------
Xi1<-(X1[1,1])^.5
Est1<-(b[1,]-0)/(SDU*Xi1)
t1<-2.6275
if (-t1<Est1 & Est1<t1){
PH1<-print("True")
} else {
PH1<-print("False")
}
#----------Inciso iii----------
Xi2<-(X1[2,2])^.5
Est2<-(b[2,]-0.5)/(SDU*Xi2)
t2<-1.9847
if (-t2<Est2 & Est2<t2){
PH2<-print("True")
} else {
PH2<-print("False")
}
#----------Inciso iv----------
Xi3<-(X1[3,3])^.5
Est3<-(b[3,]-1.2)/(SDU*Xi3)
t3<-1.6607
if (-t3<Est3 & Est3<t3){
PH3<-print("True")
} else {
PH3<-print("False")
}
#----------Inciso v----------
c1<-matrix(c(1,0,1),3)
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c)%*%X1%*%c)^.5
Est4<-((c1%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Es43 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((c1%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Es43 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((c1%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Est4 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((c1%*%b)-1)/(SDU*Xi4)
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((t(c1)%*%b)-1)/(SDU*Xi4)
t4<-1.6607
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((t(c1)%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Est4 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
b
VarU<-(t(U)%*%U)/97
Est5<-((SumU2Cond-SumU2)/SumU2)*(97/(98-97))
bcond<-matrix(c(0,0.5,1),3)
UCond<-Y-(X%*%bcond)
SumU2<-t(U)%*%U
SumU2Cond<-t(UCond)%*%UCond
Est5<-((SumU2Cond-SumU2)/SumU2)*(97/(98-97))
((SumU2Cond-SumU2)/SumU2)
(97/(98-97))
((SumU2Cond-SumU2)/SumU2)
5.253196*97
F1<-2.758
if (Est5<F1){
PH4<-print("True")
} else {
PH4<-print("False")
}
#----------Inciso vii----------
#----------Inciso viii----------
library(mvtnorm)
set.seed(100)
#----------Pregunta 1----------
Sigma<-matrix(c(0.8,0.4,-0.2,0.4,1,-0.8,-0.2,-0.8,2),3)
Muestra<-rmvnorm(100,mean=c(1,0,2),sigma=Sigma)
Y<-Muestra[,1]
Xj<-Muestra[,2:3]
Constante<-matrix(rep(1,100),100)
X<-cbind(Constante,Xj)
b<-(solve(t(X)%*%X))%*%(t(X)%*%Y)
U<-Y-(X%*%b)
VarU<-(t(U)%*%U)/97
SDU<-VarU^.5
X1<-solve(t(X)%*%X)
#----------Inciso ii----------
Xi1<-(X1[1,1])^.5
Est1<-(b[1,]-0)/(SDU*Xi1)
t1<-2.6275
if (-t1<Est1 & Est1<t1){
PH1<-print("True")
} else {
PH1<-print("False")
}
#----------Inciso iii----------
Xi2<-(X1[2,2])^.5
Est2<-(b[2,]-0.5)/(SDU*Xi2)
t2<-1.9847
if (-t2<Est2 & Est2<t2){
PH2<-print("True")
} else {
PH2<-print("False")
}
#----------Inciso iv----------
Xi3<-(X1[3,3])^.5
Est3<-(b[3,]-1.2)/(SDU*Xi3)
t3<-1.6607
if (-t3<Est3 & Est3<t3){
PH3<-print("True")
} else {
PH3<-print("False")
}
#----------Inciso v----------
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((t(c1)%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Est4 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
#----------Inciso vi----------
bcond<-matrix(c(0,0.5,1),3)
UCond<-Y-(X%*%bcond)
SumU2<-t(U)%*%U
SumU2Cond<-t(UCond)%*%UCond
Est5<-((SumU2Cond-SumU2)/SumU2)*(97/(98-97))
F1<-2.758
if (Est5<F1){
PH5<-print("True")
} else {
PH5<-print("False")
}
#----------Inciso vii----------
#----------Inciso viii----------
Sigma<-matrix(c(0.8,0.4,-0.2,0.4,1,-0.8,-0.2,-0.8,2),3)
My<-1
Mx1<-0
Mx2<-2
Muestra<-rmvnorm(100,mean=c(My,Mx1,Mx2),sigma=Sigma)
Y<-Muestra[,1]
Xj<-Muestra[,2:3]
Constante<-matrix(rep(1,100),100)
X<-cbind(Constante,Xj)
b<-(solve(t(X)%*%X))%*%(t(X)%*%Y)
U<-Y-(X%*%b)
VarU<-(t(U)%*%U)/97
SDU<-VarU^.5
X1<-solve(t(X)%*%X)
#----------Inciso ii----------
Xi1<-(X1[1,1])^.5
Est1<-(b[1,]-0)/(SDU*Xi1)
t1<-2.6275
if (-t1<Est1 & Est1<t1){
PH1<-print("True")
} else {
PH1<-print("False")
}
#----------Inciso iii----------
Xi2<-(X1[2,2])^.5
Est2<-(b[2,]-0.5)/(SDU*Xi2)
t2<-1.9847
if (-t2<Est2 & Est2<t2){
PH2<-print("True")
} else {
PH2<-print("False")
}
#----------Inciso iv----------
Xi3<-(X1[3,3])^.5
Est3<-(b[3,]-1.2)/(SDU*Xi3)
t3<-1.6607
if (-t3<Est3 & Est3<t3){
PH3<-print("True")
} else {
PH3<-print("False")
}
#----------Inciso v----------
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((t(c1)%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Est4 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
#----------Inciso vi----------
bcond<-matrix(c(0,0.5,1),3)
UCond<-Y-(X%*%bcond)
SumU2<-t(U)%*%U
SumU2Cond<-t(UCond)%*%UCond
Est5<-((SumU2Cond-SumU2)/SumU2)*(97/(98-97))
F1<-2.758
if (Est5<F1){
PH5<-print("True")
} else {
PH5<-print("False")
}
#----------Inciso vii----------
#Pendiente
#----------Inciso viii----------
Sigma<-matrix(c(0.8,0.4,-0.2,0.4,1,-0.8,-0.2,-0.8,2),3)
Muestra<-rmvnorm(100,mean=c(1,0,2),sigma=Sigma)
Y<-Muestra[,1]
Xj<-Muestra[,2:3]
Constante<-matrix(rep(1,100),100)
X<-cbind(Constante,Xj)
b<-(solve(t(X)%*%X))%*%(t(X)%*%Y)
U<-Y-(X%*%b)
VarU<-(t(U)%*%U)/97
SDU<-VarU^.5
X1<-solve(t(X)%*%X)
#----------Inciso ii----------
Xi1<-(X1[1,1])^.5
Est1<-(b[1,]-0)/(SDU*Xi1)
t1<-2.6275
if (-t1<Est1 & Est1<t1){
PH1<-print("True")
} else {
PH1<-print("False")
}
#----------Inciso iii----------
Xi2<-(X1[2,2])^.5
Est2<-(b[2,]-0.5)/(SDU*Xi2)
t2<-1.9847
if (-t2<Est2 & Est2<t2){
PH2<-print("True")
} else {
PH2<-print("False")
}
#----------Inciso iv----------
Xi3<-(X1[3,3])^.5
Est3<-(b[3,]-1.2)/(SDU*Xi3)
t3<-1.6607
if (-t3<Est3 & Est3<t3){
PH3<-print("True")
} else {
PH3<-print("False")
}
#----------Inciso v----------
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((t(c1)%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Est4 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
#----------Inciso vi----------
bcond<-matrix(c(0,0.5,1),3)
UCond<-Y-(X%*%bcond)
SumU2<-t(U)%*%U
SumU2Cond<-t(UCond)%*%UCond
Est5<-((SumU2Cond-SumU2)/SumU2)*(97/(98-97))
F1<-2.758
if (Est5<F1){
PH5<-print("True")
} else {
PH5<-print("False")
}
#----------Inciso vii----------
#Pendiente
#----------Inciso viii----------
b1<-
b1<-Medias[1,]-(CovYX%*%solve(Sigmax)%*%Medias[2:3,])
Medias<-matrix(c(1,0,2),3)
CovYX<-matrix(c(0.4,-0.2),1)
SigmaX<-matrix(c(1,-0.8,-0.8,2),2)
b1<-Medias[1,]-(CovYX%*%solve(Sigmax)%*%Medias[2:3,])
b1<-Medias[1,]-(CovYX%*%solve(SigmaX)%*%Medias[2:3,])
View(b)
b23<-CovYX%*%solve(SigmaX)
bpob<-rbind(b1,b23)
View(b23)
b23<-t(CovYX%*%solve(SigmaX))
bpob<-rbind(b1,b23)
bpob
Upob<-Y-(X%*%bpob)
VarUpob<-(t(Upob)%*%Upob)/97
VarUpob<-(t(Upob)%*%Upob)/100
Y<-data$lwage
Constante<-matrix(rep(1,526),526)
X<-cbind(Constante,data$educ,data$exper,data$tenure)
b<-(solve(t(X)%*%X))%*%(t(X)%*%Y)
U<-Y-(X%*%b)
VarU<-(t(U)%*%U)/522
SDU<-VarU^.5
X1<-solve(t(X)%*%X)
Xi3<-(X1[3,3])^.5
Est1<-(b[3,]-0)/(SDU*Xi3)
t1<-qt(0.05, 522, lower.tail = F)
t2<-qt(0.01, 522, lower.tail = F)
if (Est1<t1){
PH1<-print("True")
} else {
PH1<-print("False")
}
if (Est1<t1){
PH2<-print("True")
} else {
PH2<-print("False")
}
if (-t1<Est1 & Est1<t1){
PH1<-print("True")
} else {
PH1<-print("False")
}
library(mvtnorm)
set.seed(100)
#----------Pregunta 1----------
Sigma<-matrix(c(0.8,0.4,-0.2,0.4,1,-0.8,-0.2,-0.8,2),3)
Muestra<-rmvnorm(100,mean=c(1,0,2),sigma=Sigma)
Y<-Muestra[,1]
Xj<-Muestra[,2:3]
Constante<-matrix(rep(1,100),100)
X<-cbind(Constante,Xj)
b<-(solve(t(X)%*%X))%*%(t(X)%*%Y)
U<-Y-(X%*%b)
VarU<-(t(U)%*%U)/97
SDU<-VarU^.5
X1<-solve(t(X)%*%X)
#----------Inciso ii----------
Xi1<-(X1[1,1])^.5
Est1<-(b[1,]-0)/(SDU*Xi1)
t1<-2.6275
if (-t1<Est1 & Est1<t1){
PH1<-print("True")
} else {
PH1<-print("False")
}
#----------Inciso iii----------
Xi2<-(X1[2,2])^.5
Est2<-(b[2,]-0.5)/(SDU*Xi2)
t2<-1.9847
if (-t2<Est2 & Est2<t2){
PH2<-print("True")
} else {
PH2<-print("False")
}
#----------Inciso iv----------
Xi3<-(X1[3,3])^.5
Est3<-(b[3,]-1.2)/(SDU*Xi3)
t3<-1.6607
if (-t3<Est3 & Est3<t3){
PH3<-print("True")
} else {
PH3<-print("False")
}
#----------Inciso v----------
c1<-matrix(c(1,0,1),3)
Xi4<-(t(c1)%*%X1%*%c1)^.5
Est4<-((t(c1)%*%b)-1)/(SDU*Xi4)
t4<-1.6607
if (-t4<Est4 & Est4<t4){
PH4<-print("True")
} else {
PH4<-print("False")
}
#----------Inciso vi----------
bcond<-matrix(c(0,0.5,1),3)
UCond<-Y-(X%*%bcond)
SumU2<-t(U)%*%U
SumU2Cond<-t(UCond)%*%UCond
Est5<-((SumU2Cond-SumU2)/SumU2)*(97/(98-97))
F1<-2.758
if (Est5<F1){
PH5<-print("True")
} else {
PH5<-print("False")
}
#----------Inciso vii----------
#Pendiente
#----------Inciso viii----------
Medias<-matrix(c(1,0,2),3)
CovYX<-matrix(c(0.4,-0.2),1)
SigmaX<-matrix(c(1,-0.8,-0.8,2),2)
b1<-Medias[1,]-(CovYX%*%solve(SigmaX)%*%Medias[2:3,])
b23<-t(CovYX%*%solve(SigmaX))
bpob<-rbind(b1,b23)
Upob<-Y-(X%*%bpob)
VarUpob<-(t(Upob)%*%Upob)/100
R<-matrix(c(1,1,0,-1,1,1),2)
r<-matriz(c(1,05),2)
R<-matrix(c(1,1,0,-1,1,1),2)
r<-matrix(c(1,05),2)
R<-matrix(c(1,1,0,-1,1,1),2)
r<-matrix(c(1,0.5),2)
Est6<-(t((R%*%b)-r))
Est6<-(t((R%*%b)-r)%*%(R%*%X1%*%t(R))%*%((R%*%b)-r))/(2*VarU)
R<-matrix(c(1,1,0,-1,1,1),2)
r<-matrix(c(1,0.5),2)
Est6<-(t((R%*%b)-r)%*%(R%*%X1%*%t(R))%*%((R%*%b)-r))/(2*VarU)
F2<-2.358
if (Est6<F2){
PH6<-print("True")
} else {
PH6<-print("False")
}
if(abs(t2) > qt(level1,gl)){sprintf("Se rechaza H0: %s con %s de nivel de significancia", H0b2text, alpha1)} else {
sprintf("Se acepta H0: %s con %s de nivel de significancia", H0b2text, alpha1)
}
if(abs(t2) > qt(level2,gl)){sprintf("Se rechaza H0: %s con %s de nivel de significancia", H0b2text, alpha2)} else {
sprintf("Se acepta H0: %s con %s de nivel de significancia", H0b2text, alpha2)
}
# -------------------------------------------------------------------------------------
# Ejercicio 14.5.1
# by Humberto Martínez García
# hmartinez@colmex.mx
# Licence Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)
getwd()
# Para fijar el directorio de trabajo deben usar el código de abajo.
# Utilicen el directorio de la carpeta con su nombre
setwd("C:/Users/office depot/Documents/GitHub/Lab_Econ_I/Jimenez_MA/HW14")
# Verificar que el directorio se fijó correctamente
getwd()
#install.packages("dplyr")
#install.packages("tidyr")
#install.packages("R")
# -------------------------------------------------------------------------------------
# Ejercicio 14.4
# Usando los datos en wage.xls y la informaciÃ³n en WAGE1_description de Wooldridge, J.M.
# Introductory Econometrics: A Modern Approach. 5th Edition. Se quiere saber si a mÃ¡s aÃ±os de
# experiencia laboral corresponde un mejor salario.
load("wage1.RData")
library("stats")
wage = matrix(data$wage)
educ = matrix(data$educ)
exper = matrix(data$exper)
tenure = matrix(data$tenure)
lwage = log(wage)
n = nrow(wage)
unos = matrix(1, nrow = n, ncol=1) # Vector de unos
X = matrix(c(unos, educ, exper, tenure),n)
k = ncol(X)
gl = n-k
##
require(ggplot2)
require(reshape2)
data2 = melt(data, id.vars='lwage')
ggplot(data2) + geom_jitter(aes(value,lwage, colour=variable),) + geom_smooth(aes(value,lwage, colour=variable), method=lm, se=FALSE) + facet_wrap(~variable, scales="free_x")+labs(x = "Levels", y = "log(average hourly earnings)")
reg0 = lm(lwage ~ educ + exper + tenure)
varu = var(reg0$residuals)
betagorro = matrix(c(reg0$coefficients[1],reg0$coefficients[2],reg0$coefficients[3],reg0$coefficients[4]),4) #Coeficientes estimados
b0 = betagorro[1]
b1 = betagorro[2]
b2 = betagorro[3]
b3 = betagorro[4]
# Hipotesis nulas, para pruebas simples
alpha1 = 0.05;
alpha2 = 0.01;
level1 = 1-(alpha1/2)
level2 = 1-(alpha2/2)
H0b2 = 0;
H0b2text = "b2=0"  # Texto de de la hipÃ³tesis nula
#Estadisticos para pruebas simples
t2 = (b2 - H0b2)/(sqrt(varu)*sqrt(solve(t(X)%*%X)[3,3])) ##OJO [3,3]
# Pruebas de hipÃÂ³tesis simples
if(abs(t2) > qt(level1,gl)){sprintf("Se rechaza H0: %s con %s de nivel de significancia", H0b2text, alpha1)} else {
sprintf("Se acepta H0: %s con %s de nivel de significancia", H0b2text, alpha1)
}
if(abs(t2) > qt(level2,gl)){sprintf("Se rechaza H0: %s con %s de nivel de significancia", H0b2text, alpha2)} else {
sprintf("Se acepta H0: %s con %s de nivel de significancia", H0b2text, alpha2)
}
