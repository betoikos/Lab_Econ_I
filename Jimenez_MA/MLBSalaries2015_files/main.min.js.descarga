var requirejs,require,define;if(function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var i;for(i=0;i<e.length&&(!e[i]||!t(e[i],i,e));i+=1);}}function eachReverse(e,t){if(e){var i;for(i=e.length-1;i>-1&&(!e[i]||!t(e[i],i,e));i-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var i;for(i in e)if(hasProp(e,i)&&t(e[i],i))break}function mixin(e,t,i,s){return t&&eachProp(t,function(t,n){(i||!hasProp(e,n))&&(s&&"string"!=typeof t?(e[n]||(e[n]={}),mixin(e[n],t,i,s)):e[n]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,i,s){var n=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return n.requireType=e,n.requireModules=s,i&&(n.originalError=i),n}function newContext(e){function t(e){var t,i;for(t=0;e[t];t+=1)if(i=e[t],"."===i)e.splice(t,1),t-=1;else if(".."===i){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function i(e,i,s){var n,o,a,r,l,h,d,c,u,p,f,g=i&&i.split("/"),m=g,v=S.map,b=v&&v["*"];if(e&&"."===e.charAt(0)&&(i?(m=getOwn(S.pkgs,i)?g=[i]:g.slice(0,g.length-1),e=m.concat(e.split("/")),t(e),o=getOwn(S.pkgs,n=e[0]),e=e.join("/"),o&&e===n+"/"+o.main&&(e=n)):0===e.indexOf("./")&&(e=e.substring(2))),s&&v&&(g||b)){for(r=e.split("/"),l=r.length;l>0;l-=1){if(d=r.slice(0,l).join("/"),g)for(h=g.length;h>0;h-=1)if(a=getOwn(v,g.slice(0,h).join("/")),a&&(a=getOwn(a,d))){c=a,u=l;break}if(c)break;!p&&b&&getOwn(b,d)&&(p=getOwn(b,d),f=l)}!c&&p&&(c=p,u=f),c&&(r.splice(0,u,c),e=r.join("/"))}return e}function s(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function n(e){var t=getOwn(S.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function a(e,t,s,n){var a,r,l,h,d=null,c=t?t.name:null,u=e,p=!0,f="";return e||(p=!1,e="_@r"+(D+=1)),h=o(e),d=h[0],e=h[1],d&&(d=i(d,c,n),r=getOwn(A,d)),e&&(d?f=r&&r.normalize?r.normalize(e,function(e){return i(e,c,n)}):i(e,c,n):(f=i(e,c,n),h=o(f),d=h[0],f=h[1],s=!0,a=w.nameToUrl(f))),l=!d||r||s?"":"_unnormalized"+(I+=1),{prefix:d,name:f,parentMap:t,unnormalized:!!l,url:a,originalName:u,isDefine:p,id:(d?d+"!"+f:f)+l}}function r(e){var t=e.id,i=getOwn(x,t);return i||(i=x[t]=new w.Module(e)),i}function l(e,t,i){var s=e.id,n=getOwn(x,s);!hasProp(A,s)||n&&!n.defineEmitComplete?(n=r(e),n.error&&"error"===t?i(n.error):n.on(t,i)):"defined"===t&&i(A[s])}function h(e,t){var i=e.requireModules,s=!1;t?t(e):(each(i,function(t){var i=getOwn(x,t);i&&(i.error=e,i.events.error&&(s=!0,i.emit("error",e)))}),s||req.onError(e))}function d(){globalDefQueue.length&&(apsp.apply($,[$.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function c(e){delete x[e],delete k[e]}function u(e,t,i){var s=e.map.id;e.error?e.emit("error",e.error):(t[s]=!0,each(e.depMaps,function(s,n){var o=s.id,a=getOwn(x,o);!a||e.depMatched[n]||i[o]||(getOwn(t,o)?(e.defineDep(n,A[o]),e.check()):u(a,t,i))}),i[s]=!0)}function p(){var e,t,i,o,a=1e3*S.waitSeconds,r=a&&w.startTime+a<(new Date).getTime(),l=[],d=[],c=!1,f=!0;if(!b){if(b=!0,eachProp(k,function(i){if(e=i.map,t=e.id,i.enabled&&(e.isDefine||d.push(i),!i.error))if(!i.inited&&r)n(t)?(o=!0,c=!0):(l.push(t),s(t));else if(!i.inited&&i.fetched&&e.isDefine&&(c=!0,!e.prefix))return f=!1}),r&&l.length)return i=makeError("timeout","Load timeout for modules: "+l,null,l),i.contextName=w.contextName,h(i);f&&each(d,function(e){u(e,{},{})}),r&&!o||!c||!isBrowser&&!isWebWorker||C||(C=setTimeout(function(){C=0,p()},50)),b=!1}}function f(e){hasProp(A,e[0])||r(a(e[0],null,!0)).init(e[1],e[2])}function g(e,t,i,s){e.detachEvent&&!isOpera?s&&e.detachEvent(s,t):e.removeEventListener(i,t,!1)}function m(e){var t=e.currentTarget||e.srcElement;return g(t,w.onScriptLoad,"load","onreadystatechange"),g(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(d();$.length;){if(e=$.shift(),null===e[0])return h(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}}var b,y,w,_,C,S={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},x={},k={},T={},$=[],A={},P={},D=1,I=1;return _={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=A[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,i=getOwn(S.pkgs,e.map.id);return t=i?getOwn(S.config,e.map.id+"/"+i.main):getOwn(S.config,e.map.id),t||{}},exports:A[e.map.id]}}},y=function(e){this.events=getOwn(T,e.id)||{},this.map=e,this.shim=getOwn(S.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},y.prototype={init:function(e,t,i,s){s=s||{},this.inited||(this.factory=t,i?this.on("error",i):this.events.error&&(i=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=i,this.inited=!0,this.ignore=s.ignore,s.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;P[e]||(P[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,i=this.map.id,s=this.depExports,n=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{n=w.execCb(i,o,s,n)}catch(a){e=a}else n=w.execCb(i,o,s,n);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?n=t.exports:void 0===n&&this.usingExports&&(n=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",h(this.error=e)}else n=o;this.exports=n,this.map.isDefine&&!this.ignore&&(A[i]=n,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),c(i),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,s=a(e.prefix);this.depMaps.push(s),l(s,"defined",bind(this,function(s){var n,o,d,u=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,f=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(s.normalize&&(u=s.normalize(u,function(e){return i(e,p,!0)})||""),o=a(e.prefix+"!"+u,this.map.parentMap),l(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),d=getOwn(x,o.id),void(d&&(this.depMaps.push(o),this.events.error&&d.on("error",bind(this,function(e){this.emit("error",e)})),d.enable()))):(n=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),n.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(x,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&c(e.map.id)}),h(e)}),n.fromText=bind(this,function(i,s){var o=e.name,l=a(o),d=useInteractive;s&&(i=s),d&&(useInteractive=!1),r(l),hasProp(S.config,t)&&(S.config[o]=S.config[t]);try{req.exec(i)}catch(c){return h(makeError("fromtexteval","fromText eval for "+t+" failed: "+c,c,[t]))}d&&(useInteractive=!0),this.depMaps.push(l),w.completeLoad(o),f([o],n)}),void s.load(e.name,f,n,S))})),w.enable(s,this),this.pluginMaps[s.id]=s},enable:function(){k[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var i,s,n;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,n=getOwn(_,e.id))return void(this.depExports[t]=n(this));this.depCount+=1,l(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&l(e,"error",bind(this,this.errback))}i=e.id,s=x[i],hasProp(_,i)||!s||s.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(x,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var i=this.events[e];i||(i=this.events[e]=[]),i.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:S,contextName:e,registry:x,defined:A,urlFetched:P,defQueue:$,Module:y,makeModuleMap:a,nextTick:req.nextTick,onError:h,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=S.pkgs,i=S.shim,s={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){s[t]?"map"===t?(S.map||(S.map={}),mixin(S[t],e,!0,!0)):mixin(S[t],e,!0):S[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),i[t]=e}),S.shim=i),e.packages&&(each(e.packages,function(e){var i;e="string"==typeof e?{name:e}:e,i=e.location,t[e.name]={name:e.name,location:i||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),S.pkgs=t),eachProp(x,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function o(i,s,l){var d,c,u;return n.enableBuildCallback&&s&&isFunction(s)&&(s.__requireJsBuild=!0),"string"==typeof i?isFunction(s)?h(makeError("requireargs","Invalid require call"),l):t&&hasProp(_,i)?_[i](x[t.id]):req.get?req.get(w,i,t,o):(c=a(i,t,!1,!0),d=c.id,hasProp(A,d)?A[d]:h(makeError("notloaded",'Module name "'+d+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),w.nextTick(function(){v(),u=r(a(null,t)),u.skipMap=n.skipMap,u.init(i,s,l,{enabled:!0}),p()}),o)}return n=n||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var s,n=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==n&&(!a||n>1)&&(s=e.substring(n,e.length),e=e.substring(0,n)),w.nameToUrl(i(e,t&&t.id,!0),s,!0)},defined:function(e){return hasProp(A,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(A,e)||hasProp(x,e)}}),t||(o.undef=function(e){d();var i=a(e,t,!0),n=getOwn(x,e);s(e),delete A[e],delete P[i.url],delete T[e],n&&(n.events.defined&&(T[e]=n.events),c(e))}),o},enable:function(e){var t=getOwn(x,e.id);t&&r(e).enable()},completeLoad:function(e){var t,i,s,o=getOwn(S.shim,e)||{},a=o.exports;for(d();$.length;){if(i=$.shift(),null===i[0]){if(i[0]=e,t)break;t=!0}else i[0]===e&&(t=!0);f(i)}if(s=getOwn(x,e),!t&&!hasProp(A,e)&&s&&!s.inited){if(!(!S.enforceDefine||a&&getGlobal(a)))return n(e)?void 0:h(makeError("nodefine","No define call for "+e,null,[e]));f([e,o.deps||[],o.exportsFn])}p()},nameToUrl:function(e,t,i){var s,n,o,a,r,l,h,d,c;if(req.jsExtRegExp.test(e))d=e+(t||"");else{for(s=S.paths,n=S.pkgs,r=e.split("/"),l=r.length;l>0;l-=1){if(h=r.slice(0,l).join("/"),o=getOwn(n,h),c=getOwn(s,h)){isArray(c)&&(c=c[0]),r.splice(0,l,c);break}if(o){a=e===o.name?o.location+"/"+o.main:o.location,r.splice(0,l,a);break}}d=r.join("/"),d+=t||(/^data\:|\?/.test(d)||i?"":".js"),d=("/"===d.charAt(0)||d.match(/^[\w\+\.\-]+:/)?"":S.baseUrl)+d}return S.urlArgs?d+((-1===d.indexOf("?")?"?":"&")+S.urlArgs):d},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,i,s){return t.apply(s,i)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=m(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=m(e);return n(t.id)?void 0:h(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,i,s){var n,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=i,i=s):e=[]),o&&o.context&&(a=o.context),n=getOwn(contexts,a),n||(n=contexts[a]=req.s.newContext(a)),o&&n.configure(o),n.require(e,t,i)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,i){var s=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return s.type=e.scriptType||"text/javascript",s.charset="utf-8",s.async=!0,s},req.load=function(e,t,i){var s,n=e&&e.config||{};if(isBrowser)return s=req.createNode(n,t,i),s.setAttribute("data-requirecontext",e.contextName),s.setAttribute("data-requiremodule",t),!s.attachEvent||s.attachEvent.toString&&s.attachEvent.toString().indexOf("[native code")<0||isOpera?(s.addEventListener("load",e.onScriptLoad,!1),s.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,s.attachEvent("onreadystatechange",e.onScriptLoad)),s.src=i,currentlyAddingScript=s,baseElement?head.insertBefore(s,baseElement):head.appendChild(s),currentlyAddingScript=null,s;if(isWebWorker)try{importScripts(i),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+i,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,i){var s,n;"string"!=typeof e&&(i=t,t=e,e=null),isArray(t)||(i=t,t=null),!t&&isFunction(i)&&(t=[],i.length&&(i.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,i){t.push(i)}),t=(1===i.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(s=currentlyAddingScript||getInteractiveScript(),s&&(e||(e=s.getAttribute("data-requiremodule")),n=contexts[s.getAttribute("data-requirecontext")])),(n?n.defQueue:globalDefQueue).push([e,t,i])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("libs/require/require",function(){}),define("main.min",function(){}),!window.console||!window.console.log){var console={};console.log=console.error=console.info=console.debug=console.warn=console.trace=console.dir=console.dirxml=console.time=console.timeEnd=console.assert=console.profile=function(){},window.console=console}window.console.group&&window.console.groupCollapsed&&window.console.groupEnd||(window.console.groupCollapsed=window.console.group=function(e){window.console.log(e)},window.console.groupEnd=function(){}),define("console.setup",function(){}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t="length"in e&&e.length,i=Q.type(e);return"function"===i||Q.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e}function s(e,t,i){if(Q.isFunction(t))return Q.grep(e,function(e,s){return!!t.call(e,s,e)!==i});if(t.nodeType)return Q.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(re.test(t))return Q.filter(t,e,i);t=Q.filter(t,e)}return Q.grep(e,function(e){return q.call(t,e)>=0!==i})}function n(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t=fe[e]={};return Q.each(e.match(pe)||[],function(e,i){t[i]=!0}),t}function a(){J.removeEventListener("DOMContentLoaded",a,!1),e.removeEventListener("load",a,!1),Q.ready()}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+r.uid++}function l(e,t,i){var s;if(void 0===i&&1===e.nodeType)if(s="data-"+t.replace(we,"-$1").toLowerCase(),i=e.getAttribute(s),"string"==typeof i){try{i="true"===i?!0:"false"===i?!1:"null"===i?null:+i+""===i?+i:ye.test(i)?Q.parseJSON(i):i}catch(n){}be.set(e,t,i)}else i=void 0;return i}function h(){return!0}function d(){return!1}function c(){try{return J.activeElement}catch(e){}}function u(e,t){return Q.nodeName(e,"table")&&Q.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Fe.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var i=0,s=e.length;s>i;i++)ve.set(e[i],"globalEval",!t||ve.get(t[i],"globalEval"))}function m(e,t){var i,s,n,o,a,r,l,h;if(1===t.nodeType){if(ve.hasData(e)&&(o=ve.access(e),a=ve.set(t,o),h=o.events)){delete a.handle,a.events={};for(n in h)for(i=0,s=h[n].length;s>i;i++)Q.event.add(t,n,h[n][i])}be.hasData(e)&&(r=be.access(e),l=Q.extend({},r),be.set(t,l))}}function v(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Q.nodeName(e,t)?Q.merge([e],i):i}function b(e,t){var i=t.nodeName.toLowerCase();"input"===i&&xe.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function y(t,i){var s,n=Q(i.createElement(t)).appendTo(i.body),o=e.getDefaultComputedStyle&&(s=e.getDefaultComputedStyle(n[0]))?s.display:Q.css(n[0],"display");return n.detach(),o}function w(e){var t=J,i=je[e];return i||(i=y(e,t),"none"!==i&&i||(Be=(Be||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Be[0].contentDocument,t.write(),t.close(),i=y(e,t),Be.detach()),je[e]=i),i}function _(e,t,i){var s,n,o,a,r=e.style;return i=i||Ve(e),i&&(a=i.getPropertyValue(t)||i[t]),i&&(""!==a||Q.contains(e.ownerDocument,e)||(a=Q.style(e,t)),He.test(a)&&ze.test(t)&&(s=r.width,n=r.minWidth,o=r.maxWidth,r.minWidth=r.maxWidth=r.width=a,a=i.width,r.width=s,r.minWidth=n,r.maxWidth=o)),void 0!==a?a+"":a}function C(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function S(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),s=t,n=Xe.length;n--;)if(t=Xe[n]+i,t in e)return t;return s}function x(e,t,i){var s=We.exec(t);return s?Math.max(0,s[1]-(i||0))+(s[2]||"px"):t}function k(e,t,i,s,n){for(var o=i===(s?"border":"content")?4:"width"===t?1:0,a=0;4>o;o+=2)"margin"===i&&(a+=Q.css(e,i+Ce[o],!0,n)),s?("content"===i&&(a-=Q.css(e,"padding"+Ce[o],!0,n)),"margin"!==i&&(a-=Q.css(e,"border"+Ce[o]+"Width",!0,n))):(a+=Q.css(e,"padding"+Ce[o],!0,n),"padding"!==i&&(a+=Q.css(e,"border"+Ce[o]+"Width",!0,n)));return a}function T(e,t,i){var s=!0,n="width"===t?e.offsetWidth:e.offsetHeight,o=Ve(e),a="border-box"===Q.css(e,"boxSizing",!1,o);if(0>=n||null==n){if(n=_(e,t,o),(0>n||null==n)&&(n=e.style[t]),He.test(n))return n;s=a&&(Z.boxSizingReliable()||n===e.style[t]),n=parseFloat(n)||0}return n+k(e,t,i||(a?"border":"content"),s,o)+"px"}function $(e,t){for(var i,s,n,o=[],a=0,r=e.length;r>a;a++)s=e[a],s.style&&(o[a]=ve.get(s,"olddisplay"),i=s.style.display,t?(o[a]||"none"!==i||(s.style.display=""),""===s.style.display&&Se(s)&&(o[a]=ve.access(s,"olddisplay",w(s.nodeName)))):(n=Se(s),"none"===i&&n||ve.set(s,"olddisplay",n?i:Q.css(s,"display"))));for(a=0;r>a;a++)s=e[a],s.style&&(t&&"none"!==s.style.display&&""!==s.style.display||(s.style.display=t?o[a]||"":"none"));return e}function A(e,t,i,s,n){return new A.prototype.init(e,t,i,s,n)}function P(){return setTimeout(function(){Ze=void 0}),Ze=Q.now()}function D(e,t){var i,s=0,n={height:e};for(t=t?1:0;4>s;s+=2-t)i=Ce[s],n["margin"+i]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function I(e,t,i){for(var s,n=(it[t]||[]).concat(it["*"]),o=0,a=n.length;a>o;o++)if(s=n[o].call(i,t,e))return s}function M(e,t,i){var s,n,o,a,r,l,h,d,c=this,u={},p=e.style,f=e.nodeType&&Se(e),g=ve.get(e,"fxshow");i.queue||(r=Q._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,c.always(function(){c.always(function(){r.unqueued--,Q.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],h=Q.css(e,"display"),d="none"===h?ve.get(e,"olddisplay")||w(e.nodeName):h,"inline"===d&&"none"===Q.css(e,"float")&&(p.display="inline-block")),i.overflow&&(p.overflow="hidden",c.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(s in t)if(n=t[s],Ke.exec(n)){if(delete t[s],o=o||"toggle"===n,n===(f?"hide":"show")){if("show"!==n||!g||void 0===g[s])continue;f=!0}u[s]=g&&g[s]||Q.style(e,s)}else h=void 0;if(Q.isEmptyObject(u))"inline"===("none"===h?w(e.nodeName):h)&&(p.display=h);else{g?"hidden"in g&&(f=g.hidden):g=ve.access(e,"fxshow",{}),o&&(g.hidden=!f),f?Q(e).show():c.done(function(){Q(e).hide()}),c.done(function(){var t;ve.remove(e,"fxshow");for(t in u)Q.style(e,t,u[t])});for(s in u)a=I(f?g[s]:0,s,c),s in g||(g[s]=a.start,f&&(a.end=a.start,a.start="width"===s||"height"===s?1:0))}}function E(e,t){var i,s,n,o,a;for(i in e)if(s=Q.camelCase(i),n=t[s],o=e[i],Q.isArray(o)&&(n=o[1],o=e[i]=o[0]),i!==s&&(e[s]=o,delete e[i]),a=Q.cssHooks[s],a&&"expand"in a){o=a.expand(o),delete e[s];for(i in o)i in e||(e[i]=o[i],t[i]=n)}else t[s]=n}function L(e,t,i){var s,n,o=0,a=tt.length,r=Q.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var t=Ze||P(),i=Math.max(0,h.startTime+h.duration-t),s=i/h.duration||0,o=1-s,a=0,l=h.tweens.length;l>a;a++)h.tweens[a].run(o);return r.notifyWith(e,[h,o,i]),1>o&&l?i:(r.resolveWith(e,[h]),!1)},h=r.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Ze||P(),duration:i.duration,tweens:[],createTween:function(t,i){var s=Q.Tween(e,h.opts,t,i,h.opts.specialEasing[t]||h.opts.easing);return h.tweens.push(s),s},stop:function(t){var i=0,s=t?h.tweens.length:0;if(n)return this;for(n=!0;s>i;i++)h.tweens[i].run(1);return t?r.resolveWith(e,[h,t]):r.rejectWith(e,[h,t]),this}}),d=h.props;for(E(d,h.opts.specialEasing);a>o;o++)if(s=tt[o].call(h,e,d,h.opts))return s;return Q.map(d,I,h),Q.isFunction(h.opts.start)&&h.opts.start.call(e,h),Q.fx.timer(Q.extend(l,{elem:e,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function N(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var s,n=0,o=t.toLowerCase().match(pe)||[];if(Q.isFunction(i))for(;s=o[n++];)"+"===s[0]?(s=s.slice(1)||"*",(e[s]=e[s]||[]).unshift(i)):(e[s]=e[s]||[]).push(i)}}function F(e,t,i,s){function n(r){var l;return o[r]=!0,Q.each(e[r]||[],function(e,r){var h=r(t,i,s);return"string"!=typeof h||a||o[h]?a?!(l=h):void 0:(t.dataTypes.unshift(h),n(h),!1)}),l}var o={},a=e===yt;return n(t.dataTypes[0])||!o["*"]&&n("*")}function O(e,t){var i,s,n=Q.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((n[i]?e:s||(s={}))[i]=t[i]);return s&&Q.extend(!0,e,s),e}function R(e,t,i){for(var s,n,o,a,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===s&&(s=e.mimeType||t.getResponseHeader("Content-Type"));if(s)for(n in r)if(r[n]&&r[n].test(s)){l.unshift(n);break}if(l[0]in i)o=l[0];else{for(n in i){if(!l[0]||e.converters[n+" "+l[0]]){o=n;break}a||(a=n)}o=o||a}return o?(o!==l[0]&&l.unshift(o),i[o]):void 0}function B(e,t,i,s){var n,o,a,r,l,h={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)h[a.toLowerCase()]=e.converters[a];for(o=d.shift();o;)if(e.responseFields[o]&&(i[e.responseFields[o]]=t),!l&&s&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=d.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(a=h[l+" "+o]||h["* "+o],!a)for(n in h)if(r=n.split(" "),r[1]===o&&(a=h[l+" "+r[0]]||h["* "+r[0]])){a===!0?a=h[n]:h[n]!==!0&&(o=r[0],d.unshift(r[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(c){return{state:"parsererror",error:a?c:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function j(e,t,i,s){var n;if(Q.isArray(t))Q.each(t,function(t,n){i||xt.test(e)?s(e,n):j(e+"["+("object"==typeof n?t:"")+"]",n,i,s)});else if(i||"object"!==Q.type(t))s(e,t);else for(n in t)j(e+"["+n+"]",t[n],i,s)}function z(e){return Q.isWindow(e)?e:9===e.nodeType&&e.defaultView}var H=[],V=H.slice,U=H.concat,W=H.push,q=H.indexOf,G={},Y=G.toString,X=G.hasOwnProperty,Z={},J=e.document,K="2.1.4",Q=function(e,t){return new Q.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ie=/-([\da-z])/gi,se=function(e,t){return t.toUpperCase()};Q.fn=Q.prototype={jquery:K,constructor:Q,selector:"",length:0,toArray:function(){return V.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:V.call(this)},pushStack:function(e){var t=Q.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Q.each(this,e,t)},map:function(e){return this.pushStack(Q.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(V.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:W,sort:H.sort,splice:H.splice},Q.extend=Q.fn.extend=function(){var e,t,i,s,n,o,a=arguments[0]||{},r=1,l=arguments.length,h=!1;for("boolean"==typeof a&&(h=a,a=arguments[r]||{},r++),"object"==typeof a||Q.isFunction(a)||(a={}),r===l&&(a=this,r--);l>r;r++)if(null!=(e=arguments[r]))for(t in e)i=a[t],s=e[t],a!==s&&(h&&s&&(Q.isPlainObject(s)||(n=Q.isArray(s)))?(n?(n=!1,o=i&&Q.isArray(i)?i:[]):o=i&&Q.isPlainObject(i)?i:{},a[t]=Q.extend(h,o,s)):void 0!==s&&(a[t]=s));return a},Q.extend({expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Q.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Q.type(e)||e.nodeType||Q.isWindow(e)?!1:e.constructor&&!X.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?G[Y.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=Q.trim(e),e&&(1===e.indexOf("use strict")?(t=J.createElement("script"),t.text=e,J.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ie,se)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,s){var n,o=0,a=e.length,r=i(e);if(s){if(r)for(;a>o&&(n=t.apply(e[o],s),n!==!1);o++);else for(o in e)if(n=t.apply(e[o],s),n===!1)break}else if(r)for(;a>o&&(n=t.call(e[o],o,e[o]),n!==!1);o++);else for(o in e)if(n=t.call(e[o],o,e[o]),n===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var s=t||[];return null!=e&&(i(Object(e))?Q.merge(s,"string"==typeof e?[e]:e):W.call(s,e)),s},inArray:function(e,t,i){return null==t?-1:q.call(t,e,i)},merge:function(e,t){for(var i=+t.length,s=0,n=e.length;i>s;s++)e[n++]=t[s];return e.length=n,e},grep:function(e,t,i){for(var s,n=[],o=0,a=e.length,r=!i;a>o;o++)s=!t(e[o],o),s!==r&&n.push(e[o]);return n},map:function(e,t,s){var n,o=0,a=e.length,r=i(e),l=[];if(r)for(;a>o;o++)n=t(e[o],o,s),null!=n&&l.push(n);else for(o in e)n=t(e[o],o,s),null!=n&&l.push(n);return U.apply([],l)},guid:1,proxy:function(e,t){var i,s,n;return"string"==typeof t&&(i=e[t],t=e,e=i),Q.isFunction(e)?(s=V.call(arguments,2),n=function(){return e.apply(t||this,s.concat(V.call(arguments)))},n.guid=e.guid=e.guid||Q.guid++,n):void 0},now:Date.now,support:Z}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()});var ne=function(e){function t(e,t,i,s){var n,o,a,r,l,h,c,p,f,g;if((t?t.ownerDocument||t:j)!==M&&I(t),t=t||M,i=i||[],r=t.nodeType,"string"!=typeof e||!e||1!==r&&9!==r&&11!==r)return i;if(!s&&L){if(11!==r&&(n=be.exec(e)))if(a=n[1]){if(9===r){if(o=t.getElementById(a),!o||!o.parentNode)return i;if(o.id===a)return i.push(o),i}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(a))&&R(t,o)&&o.id===a)return i.push(o),i}else{if(n[2])return K.apply(i,t.getElementsByTagName(e)),i;if((a=n[3])&&_.getElementsByClassName)return K.apply(i,t.getElementsByClassName(a)),i}if(_.qsa&&(!N||!N.test(e))){if(p=c=B,f=t,g=1!==r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(h=k(e),(c=t.getAttribute("id"))?p=c.replace(we,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=h.length;l--;)h[l]=p+u(h[l]);f=ye.test(e)&&d(t.parentNode)||t,g=h.join(",")}if(g)try{return K.apply(i,f.querySelectorAll(g)),i}catch(m){}finally{c||t.removeAttribute("id")}}}return $(e.replace(le,"$1"),t,i,s)}function i(){function e(i,s){return t.push(i+" ")>C.cacheLength&&delete e[t.shift()],e[i+" "]=s}var t=[];return e}function s(e){return e[B]=!0,e}function n(e){var t=M.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var i=e.split("|"),s=e.length;s--;)C.attrHandle[i[s]]=t}function a(e,t){var i=t&&e,s=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(s)return s;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function r(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e;
}}function l(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function h(e){return s(function(t){return t=+t,s(function(i,s){for(var n,o=e([],i.length,t),a=o.length;a--;)i[n=o[a]]&&(i[n]=!(s[n]=i[n]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function c(){}function u(e){for(var t=0,i=e.length,s="";i>t;t++)s+=e[t].value;return s}function p(e,t,i){var s=t.dir,n=i&&"parentNode"===s,o=H++;return t.first?function(t,i,o){for(;t=t[s];)if(1===t.nodeType||n)return e(t,i,o)}:function(t,i,a){var r,l,h=[z,o];if(a){for(;t=t[s];)if((1===t.nodeType||n)&&e(t,i,a))return!0}else for(;t=t[s];)if(1===t.nodeType||n){if(l=t[B]||(t[B]={}),(r=l[s])&&r[0]===z&&r[1]===o)return h[2]=r[2];if(l[s]=h,h[2]=e(t,i,a))return!0}}}function f(e){return e.length>1?function(t,i,s){for(var n=e.length;n--;)if(!e[n](t,i,s))return!1;return!0}:e[0]}function g(e,i,s){for(var n=0,o=i.length;o>n;n++)t(e,i[n],s);return s}function m(e,t,i,s,n){for(var o,a=[],r=0,l=e.length,h=null!=t;l>r;r++)(o=e[r])&&(!i||i(o,s,n))&&(a.push(o),h&&t.push(r));return a}function v(e,t,i,n,o,a){return n&&!n[B]&&(n=v(n)),o&&!o[B]&&(o=v(o,a)),s(function(s,a,r,l){var h,d,c,u=[],p=[],f=a.length,v=s||g(t||"*",r.nodeType?[r]:r,[]),b=!e||!s&&t?v:m(v,u,e,r,l),y=i?o||(s?e:f||n)?[]:a:b;if(i&&i(b,y,r,l),n)for(h=m(y,p),n(h,[],r,l),d=h.length;d--;)(c=h[d])&&(y[p[d]]=!(b[p[d]]=c));if(s){if(o||e){if(o){for(h=[],d=y.length;d--;)(c=y[d])&&h.push(b[d]=c);o(null,y=[],h,l)}for(d=y.length;d--;)(c=y[d])&&(h=o?ee(s,c):u[d])>-1&&(s[h]=!(a[h]=c))}}else y=m(y===a?y.splice(f,y.length):y),o?o(null,a,y,l):K.apply(a,y)})}function b(e){for(var t,i,s,n=e.length,o=C.relative[e[0].type],a=o||C.relative[" "],r=o?1:0,l=p(function(e){return e===t},a,!0),h=p(function(e){return ee(t,e)>-1},a,!0),d=[function(e,i,s){var n=!o&&(s||i!==A)||((t=i).nodeType?l(e,i,s):h(e,i,s));return t=null,n}];n>r;r++)if(i=C.relative[e[r].type])d=[p(f(d),i)];else{if(i=C.filter[e[r].type].apply(null,e[r].matches),i[B]){for(s=++r;n>s&&!C.relative[e[s].type];s++);return v(r>1&&f(d),r>1&&u(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(le,"$1"),i,s>r&&b(e.slice(r,s)),n>s&&b(e=e.slice(s)),n>s&&u(e))}d.push(i)}return f(d)}function y(e,i){var n=i.length>0,o=e.length>0,a=function(s,a,r,l,h){var d,c,u,p=0,f="0",g=s&&[],v=[],b=A,y=s||o&&C.find.TAG("*",h),w=z+=null==b?1:Math.random()||.1,_=y.length;for(h&&(A=a!==M&&a);f!==_&&null!=(d=y[f]);f++){if(o&&d){for(c=0;u=e[c++];)if(u(d,a,r)){l.push(d);break}h&&(z=w)}n&&((d=!u&&d)&&p--,s&&g.push(d))}if(p+=f,n&&f!==p){for(c=0;u=i[c++];)u(g,v,a,r);if(s){if(p>0)for(;f--;)g[f]||v[f]||(v[f]=Z.call(l));v=m(v)}K.apply(l,v),h&&!s&&v.length>0&&p+i.length>1&&t.uniqueSort(l)}return h&&(z=w,A=b),g};return n?s(a):a}var w,_,C,S,x,k,T,$,A,P,D,I,M,E,L,N,F,O,R,B="sizzle"+1*new Date,j=e.document,z=0,H=0,V=i(),U=i(),W=i(),q=function(e,t){return e===t&&(D=!0),0},G=1<<31,Y={}.hasOwnProperty,X=[],Z=X.pop,J=X.push,K=X.push,Q=X.slice,ee=function(e,t){for(var i=0,s=e.length;s>i;i++)if(e[i]===t)return i;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",se="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ne=se.replace("w","w#"),oe="\\["+ie+"*("+se+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ne+"))|)"+ie+"*\\]",ae=":("+se+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+oe+")*)|.*)\\)|)",re=new RegExp(ie+"+","g"),le=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),he=new RegExp("^"+ie+"*,"+ie+"*"),de=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ce=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),ue=new RegExp(ae),pe=new RegExp("^"+ne+"$"),fe={ID:new RegExp("^#("+se+")"),CLASS:new RegExp("^\\.("+se+")"),TAG:new RegExp("^("+se.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},ge=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,be=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,we=/'|\\/g,_e=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),Ce=function(e,t,i){var s="0x"+t-65536;return s!==s||i?t:0>s?String.fromCharCode(s+65536):String.fromCharCode(s>>10|55296,1023&s|56320)},Se=function(){I()};try{K.apply(X=Q.call(j.childNodes),j.childNodes),X[j.childNodes.length].nodeType}catch(xe){K={apply:X.length?function(e,t){J.apply(e,Q.call(t))}:function(e,t){for(var i=e.length,s=0;e[i++]=t[s++];);e.length=i-1}}}_=t.support={},x=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},I=t.setDocument=function(e){var t,i,s=e?e.ownerDocument||e:j;return s!==M&&9===s.nodeType&&s.documentElement?(M=s,E=s.documentElement,i=s.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",Se,!1):i.attachEvent&&i.attachEvent("onunload",Se)),L=!x(s),_.attributes=n(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=n(function(e){return e.appendChild(s.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=ve.test(s.getElementsByClassName),_.getById=n(function(e){return E.appendChild(e).id=B,!s.getElementsByName||!s.getElementsByName(B).length}),_.getById?(C.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&L){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},C.filter.ID=function(e){var t=e.replace(_e,Ce);return function(e){return e.getAttribute("id")===t}}):(delete C.find.ID,C.filter.ID=function(e){var t=e.replace(_e,Ce);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),C.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,s=[],n=0,o=t.getElementsByTagName(e);if("*"===e){for(;i=o[n++];)1===i.nodeType&&s.push(i);return s}return o},C.find.CLASS=_.getElementsByClassName&&function(e,t){return L?t.getElementsByClassName(e):void 0},F=[],N=[],(_.qsa=ve.test(s.querySelectorAll))&&(n(function(e){E.appendChild(e).innerHTML="<a id='"+B+"'></a><select id='"+B+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&N.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||N.push("\\["+ie+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+B+"-]").length||N.push("~="),e.querySelectorAll(":checked").length||N.push(":checked"),e.querySelectorAll("a#"+B+"+*").length||N.push(".#.+[+~]")}),n(function(e){var t=s.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&N.push("name"+ie+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||N.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),N.push(",.*:")})),(_.matchesSelector=ve.test(O=E.matches||E.webkitMatchesSelector||E.mozMatchesSelector||E.oMatchesSelector||E.msMatchesSelector))&&n(function(e){_.disconnectedMatch=O.call(e,"div"),O.call(e,"[s!='']:x"),F.push("!=",ae)}),N=N.length&&new RegExp(N.join("|")),F=F.length&&new RegExp(F.join("|")),t=ve.test(E.compareDocumentPosition),R=t||ve.test(E.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,s=t&&t.parentNode;return e===s||!(!s||1!==s.nodeType||!(i.contains?i.contains(s):e.compareDocumentPosition&&16&e.compareDocumentPosition(s)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},q=t?function(e,t){if(e===t)return D=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!_.sortDetached&&t.compareDocumentPosition(e)===i?e===s||e.ownerDocument===j&&R(j,e)?-1:t===s||t.ownerDocument===j&&R(j,t)?1:P?ee(P,e)-ee(P,t):0:4&i?-1:1)}:function(e,t){if(e===t)return D=!0,0;var i,n=0,o=e.parentNode,r=t.parentNode,l=[e],h=[t];if(!o||!r)return e===s?-1:t===s?1:o?-1:r?1:P?ee(P,e)-ee(P,t):0;if(o===r)return a(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)h.unshift(i);for(;l[n]===h[n];)n++;return n?a(l[n],h[n]):l[n]===j?-1:h[n]===j?1:0},s):M},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==M&&I(e),i=i.replace(ce,"='$1']"),!(!_.matchesSelector||!L||F&&F.test(i)||N&&N.test(i)))try{var s=O.call(e,i);if(s||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return s}catch(n){}return t(i,M,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==M&&I(e),R(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==M&&I(e);var i=C.attrHandle[t.toLowerCase()],s=i&&Y.call(C.attrHandle,t.toLowerCase())?i(e,t,!L):void 0;return void 0!==s?s:_.attributes||!L?e.getAttribute(t):(s=e.getAttributeNode(t))&&s.specified?s.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],s=0,n=0;if(D=!_.detectDuplicates,P=!_.sortStable&&e.slice(0),e.sort(q),D){for(;t=e[n++];)t===e[n]&&(s=i.push(n));for(;s--;)e.splice(i[s],1)}return P=null,e},S=t.getText=function(e){var t,i="",s=0,n=e.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=S(e)}else if(3===n||4===n)return e.nodeValue}else for(;t=e[s++];)i+=S(t);return i},C=t.selectors={cacheLength:50,createPseudo:s,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_e,Ce),e[3]=(e[3]||e[4]||e[5]||"").replace(_e,Ce),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&ue.test(i)&&(t=k(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_e,Ce).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=V[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&V(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,s){return function(n){var o=t.attr(n,e);return null==o?"!="===i:i?(o+="","="===i?o===s:"!="===i?o!==s:"^="===i?s&&0===o.indexOf(s):"*="===i?s&&o.indexOf(s)>-1:"$="===i?s&&o.slice(-s.length)===s:"~="===i?(" "+o.replace(re," ")+" ").indexOf(s)>-1:"|="===i?o===s||o.slice(0,s.length+1)===s+"-":!1):!0}},CHILD:function(e,t,i,s,n){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),r="of-type"===t;return 1===s&&0===n?function(e){return!!e.parentNode}:function(t,i,l){var h,d,c,u,p,f,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,v=r&&t.nodeName.toLowerCase(),b=!l&&!r;if(m){if(o){for(;g;){for(c=t;c=c[g];)if(r?c.nodeName.toLowerCase()===v:1===c.nodeType)return!1;f=g="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?m.firstChild:m.lastChild],a&&b){for(d=m[B]||(m[B]={}),h=d[e]||[],p=h[0]===z&&h[1],u=h[0]===z&&h[2],c=p&&m.childNodes[p];c=++p&&c&&c[g]||(u=p=0)||f.pop();)if(1===c.nodeType&&++u&&c===t){d[e]=[z,p,u];break}}else if(b&&(h=(t[B]||(t[B]={}))[e])&&h[0]===z)u=h[1];else for(;(c=++p&&c&&c[g]||(u=p=0)||f.pop())&&((r?c.nodeName.toLowerCase()!==v:1!==c.nodeType)||!++u||(b&&((c[B]||(c[B]={}))[e]=[z,u]),c!==t)););return u-=n,u===s||u%s===0&&u/s>=0}}},PSEUDO:function(e,i){var n,o=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[B]?o(i):o.length>1?(n=[e,e,"",i],C.setFilters.hasOwnProperty(e.toLowerCase())?s(function(e,t){for(var s,n=o(e,i),a=n.length;a--;)s=ee(e,n[a]),e[s]=!(t[s]=n[a])}):function(e){return o(e,0,n)}):o}},pseudos:{not:s(function(e){var t=[],i=[],n=T(e.replace(le,"$1"));return n[B]?s(function(e,t,i,s){for(var o,a=n(e,null,s,[]),r=e.length;r--;)(o=a[r])&&(e[r]=!(t[r]=o))}):function(e,s,o){return t[0]=e,n(t,null,o,i),t[0]=null,!i.pop()}}),has:s(function(e){return function(i){return t(e,i).length>0}}),contains:s(function(e){return e=e.replace(_e,Ce),function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:s(function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_e,Ce).toLowerCase(),function(t){var i;do if(i=L?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===E},focus:function(e){return e===M.activeElement&&(!M.hasFocus||M.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return ge.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:h(function(){return[0]}),last:h(function(e,t){return[t-1]}),eq:h(function(e,t,i){return[0>i?i+t:i]}),even:h(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:h(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:h(function(e,t,i){for(var s=0>i?i+t:i;--s>=0;)e.push(s);return e}),gt:h(function(e,t,i){for(var s=0>i?i+t:i;++s<t;)e.push(s);return e})}},C.pseudos.nth=C.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[w]=r(w);for(w in{submit:!0,reset:!0})C.pseudos[w]=l(w);return c.prototype=C.filters=C.pseudos,C.setFilters=new c,k=t.tokenize=function(e,i){var s,n,o,a,r,l,h,d=U[e+" "];if(d)return i?0:d.slice(0);for(r=e,l=[],h=C.preFilter;r;){(!s||(n=he.exec(r)))&&(n&&(r=r.slice(n[0].length)||r),l.push(o=[])),s=!1,(n=de.exec(r))&&(s=n.shift(),o.push({value:s,type:n[0].replace(le," ")}),r=r.slice(s.length));for(a in C.filter)!(n=fe[a].exec(r))||h[a]&&!(n=h[a](n))||(s=n.shift(),o.push({value:s,type:a,matches:n}),r=r.slice(s.length));if(!s)break}return i?r.length:r?t.error(e):U(e,l).slice(0)},T=t.compile=function(e,t){var i,s=[],n=[],o=W[e+" "];if(!o){for(t||(t=k(e)),i=t.length;i--;)o=b(t[i]),o[B]?s.push(o):n.push(o);o=W(e,y(n,s)),o.selector=e}return o},$=t.select=function(e,t,i,s){var n,o,a,r,l,h="function"==typeof e&&e,c=!s&&k(e=h.selector||e);if(i=i||[],1===c.length){if(o=c[0]=c[0].slice(0),o.length>2&&"ID"===(a=o[0]).type&&_.getById&&9===t.nodeType&&L&&C.relative[o[1].type]){if(t=(C.find.ID(a.matches[0].replace(_e,Ce),t)||[])[0],!t)return i;h&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(n=fe.needsContext.test(e)?0:o.length;n--&&(a=o[n],!C.relative[r=a.type]);)if((l=C.find[r])&&(s=l(a.matches[0].replace(_e,Ce),ye.test(o[0].type)&&d(t.parentNode)||t))){if(o.splice(n,1),e=s.length&&u(o),!e)return K.apply(i,s),i;break}}return(h||T(e,c))(s,t,!L,i,ye.test(e)&&d(t.parentNode)||t),i},_.sortStable=B.split("").sort(q).join("")===B,_.detectDuplicates=!!D,I(),_.sortDetached=n(function(e){return 1&e.compareDocumentPosition(M.createElement("div"))}),n(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&n(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),n(function(e){return null==e.getAttribute("disabled")})||o(te,function(e,t,i){var s;return i?void 0:e[t]===!0?t.toLowerCase():(s=e.getAttributeNode(t))&&s.specified?s.value:null}),t}(e);Q.find=ne,Q.expr=ne.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=ne.uniqueSort,Q.text=ne.getText,Q.isXMLDoc=ne.isXML,Q.contains=ne.contains;var oe=Q.expr.match.needsContext,ae=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,re=/^.[^:#\[\.,]*$/;Q.filter=function(e,t,i){var s=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===s.nodeType?Q.find.matchesSelector(s,e)?[s]:[]:Q.find.matches(e,Q.grep(t,function(e){return 1===e.nodeType}))},Q.fn.extend({find:function(e){var t,i=this.length,s=[],n=this;if("string"!=typeof e)return this.pushStack(Q(e).filter(function(){for(t=0;i>t;t++)if(Q.contains(n[t],this))return!0}));for(t=0;i>t;t++)Q.find(e,n[t],s);return s=this.pushStack(i>1?Q.unique(s):s),s.selector=this.selector?this.selector+" "+e:e,s},filter:function(e){return this.pushStack(s(this,e||[],!1))},not:function(e){return this.pushStack(s(this,e||[],!0))},is:function(e){return!!s(this,"string"==typeof e&&oe.test(e)?Q(e):e||[],!1).length}});var le,he=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,de=Q.fn.init=function(e,t){var i,s;if(!e)return this;if("string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:he.exec(e),!i||!i[1]&&t)return!t||t.jquery?(t||le).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof Q?t[0]:t,Q.merge(this,Q.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:J,!0)),ae.test(i[1])&&Q.isPlainObject(t))for(i in t)Q.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return s=J.getElementById(i[2]),s&&s.parentNode&&(this.length=1,this[0]=s),this.context=J,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Q.isFunction(e)?"undefined"!=typeof le.ready?le.ready(e):e(Q):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))};de.prototype=Q.fn,le=Q(J);var ce=/^(?:parents|prev(?:Until|All))/,ue={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(e,t,i){for(var s=[],n=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(n&&Q(e).is(i))break;s.push(e)}return s},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),Q.fn.extend({has:function(e){var t=Q(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(Q.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,s=0,n=this.length,o=[],a=oe.test(e)||"string"!=typeof e?Q(e,t||this.context):0;n>s;s++)for(i=this[s];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(a?a.index(i)>-1:1===i.nodeType&&Q.find.matchesSelector(i,e))){o.push(i);break}return this.pushStack(o.length>1?Q.unique(o):o)},index:function(e){return e?"string"==typeof e?q.call(Q(e),this[0]):q.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Q.unique(Q.merge(this.get(),Q(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,i){return Q.dir(e,"parentNode",i)},next:function(e){return n(e,"nextSibling")},prev:function(e){return n(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,i){return Q.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return Q.dir(e,"previousSibling",i)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(i,s){var n=Q.map(this,t,i);return"Until"!==e.slice(-5)&&(s=i),s&&"string"==typeof s&&(n=Q.filter(s,n)),this.length>1&&(ue[e]||Q.unique(n),ce.test(e)&&n.reverse()),this.pushStack(n)}});var pe=/\S+/g,fe={};Q.Callbacks=function(e){e="string"==typeof e?fe[e]||o(e):Q.extend({},e);var t,i,s,n,a,r,l=[],h=!e.once&&[],d=function(o){for(t=e.memory&&o,i=!0,r=n||0,n=0,a=l.length,s=!0;l&&a>r;r++)if(l[r].apply(o[0],o[1])===!1&&e.stopOnFalse){t=!1;break}s=!1,l&&(h?h.length&&d(h.shift()):t?l=[]:c.disable())},c={add:function(){if(l){var i=l.length;!function o(t){Q.each(t,function(t,i){var s=Q.type(i);"function"===s?e.unique&&c.has(i)||l.push(i):i&&i.length&&"string"!==s&&o(i)})}(arguments),s?a=l.length:t&&(n=i,d(t))}return this},remove:function(){return l&&Q.each(arguments,function(e,t){for(var i;(i=Q.inArray(t,l,i))>-1;)l.splice(i,1),s&&(a>=i&&a--,r>=i&&r--)}),this},has:function(e){return e?Q.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=h=t=void 0,this},disabled:function(){return!l},lock:function(){return h=void 0,t||c.disable(),this},locked:function(){return!h},fireWith:function(e,t){return!l||i&&!h||(t=t||[],t=[e,t.slice?t.slice():t],s?h.push(t):d(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],i="pending",s={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(i){Q.each(t,function(t,o){var a=Q.isFunction(e[t])&&e[t];n[o[1]](function(){var e=a&&a.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o[0]+"With"](this===s?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,s):s}},n={};return s.pipe=s.then,Q.each(t,function(e,o){var a=o[2],r=o[3];s[o[1]]=a.add,r&&a.add(function(){i=r},t[1^e][2].disable,t[2][2].lock),n[o[0]]=function(){return n[o[0]+"With"](this===n?s:this,arguments),this},n[o[0]+"With"]=a.fireWith}),s.promise(n),e&&e.call(n,n),n},when:function(e){var t,i,s,n=0,o=V.call(arguments),a=o.length,r=1!==a||e&&Q.isFunction(e.promise)?a:0,l=1===r?e:Q.Deferred(),h=function(e,i,s){return function(n){i[e]=this,s[e]=arguments.length>1?V.call(arguments):n,s===t?l.notifyWith(i,s):--r||l.resolveWith(i,s)}};if(a>1)for(t=new Array(a),i=new Array(a),s=new Array(a);a>n;n++)o[n]&&Q.isFunction(o[n].promise)?o[n].promise().done(h(n,s,o)).fail(l.reject).progress(h(n,i,t)):--r;return r||l.resolveWith(s,o),l.promise()}});var ge;Q.fn.ready=function(e){return Q.ready.promise().done(e),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){(e===!0?--Q.readyWait:Q.isReady)||(Q.isReady=!0,e!==!0&&--Q.readyWait>0||(ge.resolveWith(J,[Q]),Q.fn.triggerHandler&&(Q(J).triggerHandler("ready"),Q(J).off("ready"))))}}),Q.ready.promise=function(t){return ge||(ge=Q.Deferred(),"complete"===J.readyState?setTimeout(Q.ready):(J.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1))),ge.promise(t)},Q.ready.promise();var me=Q.access=function(e,t,i,s,n,o,a){var r=0,l=e.length,h=null==i;if("object"===Q.type(i)){n=!0;for(r in i)Q.access(e,t,r,i[r],!0,o,a)}else if(void 0!==s&&(n=!0,Q.isFunction(s)||(a=!0),h&&(a?(t.call(e,s),t=null):(h=t,t=function(e,t,i){return h.call(Q(e),i)})),t))for(;l>r;r++)t(e[r],i,a?s:s.call(e[r],r,t(e[r],i)));return n?e:h?t.call(e):l?t(e[0],i):o};Q.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},r.uid=1,r.accepts=Q.acceptData,r.prototype={key:function(e){if(!r.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=r.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(s){t[this.expando]=i,Q.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var s,n=this.key(e),o=this.cache[n];if("string"==typeof t)o[t]=i;else if(Q.isEmptyObject(o))Q.extend(this.cache[n],t);else for(s in t)o[s]=t[s];return o},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var s;return void 0===t||t&&"string"==typeof t&&void 0===i?(s=this.get(e,t),void 0!==s?s:this.get(e,Q.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,s,n,o=this.key(e),a=this.cache[o];if(void 0===t)this.cache[o]={};else{Q.isArray(t)?s=t.concat(t.map(Q.camelCase)):(n=Q.camelCase(t),t in a?s=[t,n]:(s=n,s=s in a?[s]:s.match(pe)||[])),i=s.length;for(;i--;)delete a[s[i]]}},hasData:function(e){return!Q.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var ve=new r,be=new r,ye=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,we=/([A-Z])/g;Q.extend({hasData:function(e){return be.hasData(e)||ve.hasData(e)},data:function(e,t,i){return be.access(e,t,i)},removeData:function(e,t){be.remove(e,t)},_data:function(e,t,i){return ve.access(e,t,i)},_removeData:function(e,t){ve.remove(e,t)}}),Q.fn.extend({data:function(e,t){var i,s,n,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(n=be.get(o),1===o.nodeType&&!ve.get(o,"hasDataAttrs"))){for(i=a.length;i--;)a[i]&&(s=a[i].name,0===s.indexOf("data-")&&(s=Q.camelCase(s.slice(5)),l(o,s,n[s])));ve.set(o,"hasDataAttrs",!0)}return n}return"object"==typeof e?this.each(function(){be.set(this,e)}):me(this,function(t){var i,s=Q.camelCase(e);if(o&&void 0===t){if(i=be.get(o,e),void 0!==i)return i;if(i=be.get(o,s),void 0!==i)return i;if(i=l(o,s,void 0),void 0!==i)return i}else this.each(function(){var i=be.get(this,s);be.set(this,s,t),-1!==e.indexOf("-")&&void 0!==i&&be.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){be.remove(this,e)})}}),Q.extend({queue:function(e,t,i){var s;return e?(t=(t||"fx")+"queue",s=ve.get(e,t),i&&(!s||Q.isArray(i)?s=ve.access(e,t,Q.makeArray(i)):s.push(i)),s||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=Q.queue(e,t),s=i.length,n=i.shift(),o=Q._queueHooks(e,t),a=function(){Q.dequeue(e,t)};"inprogress"===n&&(n=i.shift(),s--),n&&("fx"===t&&i.unshift("inprogress"),delete o.stop,n.call(e,a,o)),!s&&o&&o.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ve.get(e,i)||ve.access(e,i,{empty:Q.Callbacks("once memory").add(function(){ve.remove(e,[t+"queue",i])})})}}),Q.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Q.queue(this[0],e):void 0===t?this:this.each(function(){var i=Q.queue(this,e,t);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,s=1,n=Q.Deferred(),o=this,a=this.length,r=function(){--s||n.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)i=ve.get(o[a],e+"queueHooks"),i&&i.empty&&(s++,i.empty.add(r));return r(),n.promise(t)}});var _e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Ce=["Top","Right","Bottom","Left"],Se=function(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)},xe=/^(?:checkbox|radio)$/i;!function(){var e=J.createDocumentFragment(),t=e.appendChild(J.createElement("div")),i=J.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),Z.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var ke="undefined";Z.focusinBubbles="onfocusin"in e;var Te=/^key/,$e=/^(?:mouse|pointer|contextmenu)|click/,Ae=/^(?:focusinfocus|focusoutblur)$/,Pe=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(e,t,i,s,n){var o,a,r,l,h,d,c,u,p,f,g,m=ve.get(e);if(m)for(i.handler&&(o=i,i=o.handler,n=o.selector),i.guid||(i.guid=Q.guid++),(l=m.events)||(l=m.events={}),(a=m.handle)||(a=m.handle=function(t){return typeof Q!==ke&&Q.event.triggered!==t.type?Q.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(pe)||[""],h=t.length;h--;)r=Pe.exec(t[h])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p&&(c=Q.event.special[p]||{},p=(n?c.delegateType:c.bindType)||p,c=Q.event.special[p]||{},d=Q.extend({type:p,origType:g,data:s,handler:i,guid:i.guid,selector:n,needsContext:n&&Q.expr.match.needsContext.test(n),namespace:f.join(".")},o),(u=l[p])||(u=l[p]=[],u.delegateCount=0,c.setup&&c.setup.call(e,s,f,a)!==!1||e.addEventListener&&e.addEventListener(p,a,!1)),c.add&&(c.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),n?u.splice(u.delegateCount++,0,d):u.push(d),Q.event.global[p]=!0)},remove:function(e,t,i,s,n){var o,a,r,l,h,d,c,u,p,f,g,m=ve.hasData(e)&&ve.get(e);if(m&&(l=m.events)){for(t=(t||"").match(pe)||[""],h=t.length;h--;)if(r=Pe.exec(t[h])||[],p=g=r[1],f=(r[2]||"").split(".").sort(),p){for(c=Q.event.special[p]||{},p=(s?c.delegateType:c.bindType)||p,u=l[p]||[],r=r[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=u.length;o--;)d=u[o],!n&&g!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||s&&s!==d.selector&&("**"!==s||!d.selector)||(u.splice(o,1),d.selector&&u.delegateCount--,c.remove&&c.remove.call(e,d));a&&!u.length&&(c.teardown&&c.teardown.call(e,f,m.handle)!==!1||Q.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)Q.event.remove(e,p+t[h],i,s,!0);Q.isEmptyObject(l)&&(delete m.handle,ve.remove(e,"events"))}},trigger:function(t,i,s,n){var o,a,r,l,h,d,c,u=[s||J],p=X.call(t,"type")?t.type:t,f=X.call(t,"namespace")?t.namespace.split("."):[];if(a=r=s=s||J,3!==s.nodeType&&8!==s.nodeType&&!Ae.test(p+Q.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),h=p.indexOf(":")<0&&"on"+p,t=t[Q.expando]?t:new Q.Event(p,"object"==typeof t&&t),t.isTrigger=n?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=s),i=null==i?[t]:Q.makeArray(i,[t]),c=Q.event.special[p]||{},n||!c.trigger||c.trigger.apply(s,i)!==!1)){if(!n&&!c.noBubble&&!Q.isWindow(s)){for(l=c.delegateType||p,Ae.test(l+p)||(a=a.parentNode);a;a=a.parentNode)u.push(a),r=a;r===(s.ownerDocument||J)&&u.push(r.defaultView||r.parentWindow||e)}for(o=0;(a=u[o++])&&!t.isPropagationStopped();)t.type=o>1?l:c.bindType||p,d=(ve.get(a,"events")||{})[t.type]&&ve.get(a,"handle"),d&&d.apply(a,i),d=h&&a[h],d&&d.apply&&Q.acceptData(a)&&(t.result=d.apply(a,i),t.result===!1&&t.preventDefault());return t.type=p,n||t.isDefaultPrevented()||c._default&&c._default.apply(u.pop(),i)!==!1||!Q.acceptData(s)||h&&Q.isFunction(s[p])&&!Q.isWindow(s)&&(r=s[h],r&&(s[h]=null),Q.event.triggered=p,s[p](),Q.event.triggered=void 0,r&&(s[h]=r)),t.result}},dispatch:function(e){e=Q.event.fix(e);var t,i,s,n,o,a=[],r=V.call(arguments),l=(ve.get(this,"events")||{})[e.type]||[],h=Q.event.special[e.type]||{};if(r[0]=e,e.delegateTarget=this,!h.preDispatch||h.preDispatch.call(this,e)!==!1){for(a=Q.event.handlers.call(this,e,l),t=0;(n=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=n.elem,i=0;(o=n.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,s=((Q.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,r),void 0!==s&&(e.result=s)===!1&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,s,n,o,a=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){
for(s=[],i=0;r>i;i++)o=t[i],n=o.selector+" ",void 0===s[n]&&(s[n]=o.needsContext?Q(n,this).index(l)>=0:Q.find(n,this,null,[l]).length),s[n]&&s.push(o);s.length&&a.push({elem:l,handlers:s})}return r<t.length&&a.push({elem:this,handlers:t.slice(r)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,s,n,o=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||J,s=i.documentElement,n=i.body,e.pageX=t.clientX+(s&&s.scrollLeft||n&&n.scrollLeft||0)-(s&&s.clientLeft||n&&n.clientLeft||0),e.pageY=t.clientY+(s&&s.scrollTop||n&&n.scrollTop||0)-(s&&s.clientTop||n&&n.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,i,s,n=e.type,o=e,a=this.fixHooks[n];for(a||(this.fixHooks[n]=a=$e.test(n)?this.mouseHooks:Te.test(n)?this.keyHooks:{}),s=a.props?this.props.concat(a.props):this.props,e=new Q.Event(o),t=s.length;t--;)i=s[t],e[i]=o[i];return e.target||(e.target=J),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==c()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===c()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Q.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Q.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,s){var n=Q.extend(new Q.Event,i,{type:e,isSimulated:!0,originalEvent:{}});s?Q.event.trigger(n,null,t):Q.event.dispatch.call(t,n),n.isDefaultPrevented()&&i.preventDefault()}},Q.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},Q.Event=function(e,t){return this instanceof Q.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?h:d):this.type=e,t&&Q.extend(this,t),this.timeStamp=e&&e.timeStamp||Q.now(),void(this[Q.expando]=!0)):new Q.Event(e,t)},Q.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=h,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=h,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=h,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,s=this,n=e.relatedTarget,o=e.handleObj;return(!n||n!==s&&!Q.contains(s,n))&&(e.type=o.origType,i=o.handler.apply(this,arguments),e.type=t),i}}}),Z.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){var s=this.ownerDocument||this,n=ve.access(s,t);n||s.addEventListener(e,i,!0),ve.access(s,t,(n||0)+1)},teardown:function(){var s=this.ownerDocument||this,n=ve.access(s,t)-1;n?ve.access(s,t,n):(s.removeEventListener(e,i,!0),ve.remove(s,t))}}}),Q.fn.extend({on:function(e,t,i,s,n){var o,a;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(a in e)this.on(a,t,i,e[a],n);return this}if(null==i&&null==s?(s=t,i=t=void 0):null==s&&("string"==typeof t?(s=i,i=void 0):(s=i,i=t,t=void 0)),s===!1)s=d;else if(!s)return this;return 1===n&&(o=s,s=function(e){return Q().off(e),o.apply(this,arguments)},s.guid=o.guid||(o.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,s,i,t)})},one:function(e,t,i,s){return this.on(e,t,i,s,1)},off:function(e,t,i){var s,n;if(e&&e.preventDefault&&e.handleObj)return s=e.handleObj,Q(e.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof e){for(n in e)this.off(n,t,e[n]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=d),this.each(function(){Q.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?Q.event.trigger(e,t,i,!0):void 0}});var De=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ie=/<([\w:]+)/,Me=/<|&#?\w+;/,Ee=/<(?:script|style|link)/i,Le=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^$|\/(?:java|ecma)script/i,Fe=/^true\/(.*)/,Oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Re={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Re.optgroup=Re.option,Re.tbody=Re.tfoot=Re.colgroup=Re.caption=Re.thead,Re.th=Re.td,Q.extend({clone:function(e,t,i){var s,n,o,a,r=e.cloneNode(!0),l=Q.contains(e.ownerDocument,e);if(!(Z.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e)))for(a=v(r),o=v(e),s=0,n=o.length;n>s;s++)b(o[s],a[s]);if(t)if(i)for(o=o||v(e),a=a||v(r),s=0,n=o.length;n>s;s++)m(o[s],a[s]);else m(e,r);return a=v(r,"script"),a.length>0&&g(a,!l&&v(e,"script")),r},buildFragment:function(e,t,i,s){for(var n,o,a,r,l,h,d=t.createDocumentFragment(),c=[],u=0,p=e.length;p>u;u++)if(n=e[u],n||0===n)if("object"===Q.type(n))Q.merge(c,n.nodeType?[n]:n);else if(Me.test(n)){for(o=o||d.appendChild(t.createElement("div")),a=(Ie.exec(n)||["",""])[1].toLowerCase(),r=Re[a]||Re._default,o.innerHTML=r[1]+n.replace(De,"<$1></$2>")+r[2],h=r[0];h--;)o=o.lastChild;Q.merge(c,o.childNodes),o=d.firstChild,o.textContent=""}else c.push(t.createTextNode(n));for(d.textContent="",u=0;n=c[u++];)if((!s||-1===Q.inArray(n,s))&&(l=Q.contains(n.ownerDocument,n),o=v(d.appendChild(n),"script"),l&&g(o),i))for(h=0;n=o[h++];)Ne.test(n.type||"")&&i.push(n);return d},cleanData:function(e){for(var t,i,s,n,o=Q.event.special,a=0;void 0!==(i=e[a]);a++){if(Q.acceptData(i)&&(n=i[ve.expando],n&&(t=ve.cache[n]))){if(t.events)for(s in t.events)o[s]?Q.event.remove(i,s):Q.removeEvent(i,s,t.handle);ve.cache[n]&&delete ve.cache[n]}delete be.cache[i[be.expando]]}}}),Q.fn.extend({text:function(e){return me(this,function(e){return void 0===e?Q.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,s=e?Q.filter(e,this):this,n=0;null!=(i=s[n]);n++)t||1!==i.nodeType||Q.cleanData(v(i)),i.parentNode&&(t&&Q.contains(i.ownerDocument,i)&&g(v(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Q.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return me(this,function(e){var t=this[0]||{},i=0,s=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ee.test(e)&&!Re[(Ie.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(De,"<$1></$2>");try{for(;s>i;i++)t=this[i]||{},1===t.nodeType&&(Q.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(n){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Q.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=U.apply([],e);var i,s,n,o,a,r,l=0,h=this.length,d=this,c=h-1,u=e[0],g=Q.isFunction(u);if(g||h>1&&"string"==typeof u&&!Z.checkClone&&Le.test(u))return this.each(function(i){var s=d.eq(i);g&&(e[0]=u.call(this,i,s.html())),s.domManip(e,t)});if(h&&(i=Q.buildFragment(e,this[0].ownerDocument,!1,this),s=i.firstChild,1===i.childNodes.length&&(i=s),s)){for(n=Q.map(v(i,"script"),p),o=n.length;h>l;l++)a=i,l!==c&&(a=Q.clone(a,!0,!0),o&&Q.merge(n,v(a,"script"))),t.call(this[l],a,l);if(o)for(r=n[n.length-1].ownerDocument,Q.map(n,f),l=0;o>l;l++)a=n[l],Ne.test(a.type||"")&&!ve.access(a,"globalEval")&&Q.contains(r,a)&&(a.src?Q._evalUrl&&Q._evalUrl(a.src):Q.globalEval(a.textContent.replace(Oe,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(e){for(var i,s=[],n=Q(e),o=n.length-1,a=0;o>=a;a++)i=a===o?this:this.clone(!0),Q(n[a])[t](i),W.apply(s,i.get());return this.pushStack(s)}});var Be,je={},ze=/^margin/,He=new RegExp("^("+_e+")(?!px)[a-z%]+$","i"),Ve=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",n.appendChild(o);var t=e.getComputedStyle(a,null);i="1%"!==t.top,s="4px"===t.width,n.removeChild(o)}var i,s,n=J.documentElement,o=J.createElement("div"),a=J.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===a.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(a),e.getComputedStyle&&Q.extend(Z,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==s&&t(),s},reliableMarginRight:function(){var t,i=a.appendChild(J.createElement("div"));return i.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",a.style.width="1px",n.appendChild(o),t=!parseFloat(e.getComputedStyle(i,null).marginRight),n.removeChild(o),a.removeChild(i),t}}))}(),Q.swap=function(e,t,i,s){var n,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];n=i.apply(e,s||[]);for(o in t)e.style[o]=a[o];return n};var Ue=/^(none|table(?!-c[ea]).+)/,We=new RegExp("^("+_e+")(.*)$","i"),qe=new RegExp("^([+-])=("+_e+")","i"),Ge={position:"absolute",visibility:"hidden",display:"block"},Ye={letterSpacing:"0",fontWeight:"400"},Xe=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=_(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,s){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var n,o,a,r=Q.camelCase(t),l=e.style;return t=Q.cssProps[r]||(Q.cssProps[r]=S(l,r)),a=Q.cssHooks[t]||Q.cssHooks[r],void 0===i?a&&"get"in a&&void 0!==(n=a.get(e,!1,s))?n:l[t]:(o=typeof i,"string"===o&&(n=qe.exec(i))&&(i=(n[1]+1)*n[2]+parseFloat(Q.css(e,t)),o="number"),null!=i&&i===i&&("number"!==o||Q.cssNumber[r]||(i+="px"),Z.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(i=a.set(e,i,s))||(l[t]=i)),void 0)}},css:function(e,t,i,s){var n,o,a,r=Q.camelCase(t);return t=Q.cssProps[r]||(Q.cssProps[r]=S(e.style,r)),a=Q.cssHooks[t]||Q.cssHooks[r],a&&"get"in a&&(n=a.get(e,!0,i)),void 0===n&&(n=_(e,t,s)),"normal"===n&&t in Ye&&(n=Ye[t]),""===i||i?(o=parseFloat(n),i===!0||Q.isNumeric(o)?o||0:n):n}}),Q.each(["height","width"],function(e,t){Q.cssHooks[t]={get:function(e,i,s){return i?Ue.test(Q.css(e,"display"))&&0===e.offsetWidth?Q.swap(e,Ge,function(){return T(e,t,s)}):T(e,t,s):void 0},set:function(e,i,s){var n=s&&Ve(e);return x(e,i,s?k(e,t,s,"border-box"===Q.css(e,"boxSizing",!1,n),n):0)}}}),Q.cssHooks.marginRight=C(Z.reliableMarginRight,function(e,t){return t?Q.swap(e,{display:"inline-block"},_,[e,"marginRight"]):void 0}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(i){for(var s=0,n={},o="string"==typeof i?i.split(" "):[i];4>s;s++)n[e+Ce[s]+t]=o[s]||o[s-2]||o[0];return n}},ze.test(e)||(Q.cssHooks[e+t].set=x)}),Q.fn.extend({css:function(e,t){return me(this,function(e,t,i){var s,n,o={},a=0;if(Q.isArray(t)){for(s=Ve(e),n=t.length;n>a;a++)o[t[a]]=Q.css(e,t[a],!1,s);return o}return void 0!==i?Q.style(e,t,i):Q.css(e,t)},e,t,arguments.length>1)},show:function(){return $(this,!0)},hide:function(){return $(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Se(this)?Q(this).show():Q(this).hide()})}}),Q.Tween=A,A.prototype={constructor:A,init:function(e,t,i,s,n,o){this.elem=e,this.prop=i,this.easing=n||"swing",this.options=t,this.start=this.now=this.cur(),this.end=s,this.unit=o||(Q.cssNumber[i]?"":"px")},cur:function(){var e=A.propHooks[this.prop];return e&&e.get?e.get(this):A.propHooks._default.get(this)},run:function(e){var t,i=A.propHooks[this.prop];return this.options.duration?this.pos=t=Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.fx=A.prototype.init,Q.fx.step={};var Ze,Je,Ke=/^(?:toggle|show|hide)$/,Qe=new RegExp("^(?:([+-])=|)("+_e+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[M],it={"*":[function(e,t){var i=this.createTween(e,t),s=i.cur(),n=Qe.exec(t),o=n&&n[3]||(Q.cssNumber[e]?"":"px"),a=(Q.cssNumber[e]||"px"!==o&&+s)&&Qe.exec(Q.css(i.elem,e)),r=1,l=20;if(a&&a[3]!==o){o=o||a[3],n=n||[],a=+s||1;do r=r||".5",a/=r,Q.style(i.elem,e,a+o);while(r!==(r=i.cur()/s)&&1!==r&&--l)}return n&&(a=i.start=+a||+s||0,i.unit=o,i.end=n[1]?a+(n[1]+1)*n[2]:+n[2]),i}]};Q.Animation=Q.extend(L,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,s=0,n=e.length;n>s;s++)i=e[s],it[i]=it[i]||[],it[i].unshift(t)},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}}),Q.speed=function(e,t,i){var s=e&&"object"==typeof e?Q.extend({},e):{complete:i||!i&&t||Q.isFunction(e)&&e,duration:e,easing:i&&t||t&&!Q.isFunction(t)&&t};return s.duration=Q.fx.off?0:"number"==typeof s.duration?s.duration:s.duration in Q.fx.speeds?Q.fx.speeds[s.duration]:Q.fx.speeds._default,(null==s.queue||s.queue===!0)&&(s.queue="fx"),s.old=s.complete,s.complete=function(){Q.isFunction(s.old)&&s.old.call(this),s.queue&&Q.dequeue(this,s.queue)},s},Q.fn.extend({fadeTo:function(e,t,i,s){return this.filter(Se).css("opacity",0).show().end().animate({opacity:t},e,i,s)},animate:function(e,t,i,s){var n=Q.isEmptyObject(e),o=Q.speed(t,i,s),a=function(){var t=L(this,Q.extend({},e),o);(n||ve.get(this,"finish"))&&t.stop(!0)};return a.finish=a,n||o.queue===!1?this.each(a):this.queue(o.queue,a)},stop:function(e,t,i){var s=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=Q.timers,a=ve.get(this);if(n)a[n]&&a[n].stop&&s(a[n]);else for(n in a)a[n]&&a[n].stop&&et.test(n)&&s(a[n]);for(n=o.length;n--;)o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(i),t=!1,o.splice(n,1));(t||!i)&&Q.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=ve.get(this),s=i[e+"queue"],n=i[e+"queueHooks"],o=Q.timers,a=s?s.length:0;for(i.finish=!0,Q.queue(this,e,[]),n&&n.stop&&n.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;a>t;t++)s[t]&&s[t].finish&&s[t].finish.call(this);delete i.finish})}}),Q.each(["toggle","show","hide"],function(e,t){var i=Q.fn[t];Q.fn[t]=function(e,s,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(D(t,!0),e,s,n)}}),Q.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,i,s){return this.animate(t,e,i,s)}}),Q.timers=[],Q.fx.tick=function(){var e,t=0,i=Q.timers;for(Ze=Q.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||Q.fx.stop(),Ze=void 0},Q.fx.timer=function(e){Q.timers.push(e),e()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){Je||(Je=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(Je),Je=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var s=setTimeout(t,e);i.stop=function(){clearTimeout(s)}})},function(){var e=J.createElement("input"),t=J.createElement("select"),i=t.appendChild(J.createElement("option"));e.type="checkbox",Z.checkOn=""!==e.value,Z.optSelected=i.selected,t.disabled=!0,Z.optDisabled=!i.disabled,e=J.createElement("input"),e.value="t",e.type="radio",Z.radioValue="t"===e.value}();var st,nt,ot=Q.expr.attrHandle;Q.fn.extend({attr:function(e,t){return me(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})}}),Q.extend({attr:function(e,t,i){var s,n,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===ke?Q.prop(e,t,i):(1===o&&Q.isXMLDoc(e)||(t=t.toLowerCase(),s=Q.attrHooks[t]||(Q.expr.match.bool.test(t)?nt:st)),void 0===i?s&&"get"in s&&null!==(n=s.get(e,t))?n:(n=Q.find.attr(e,t),null==n?void 0:n):null!==i?s&&"set"in s&&void 0!==(n=s.set(e,i,t))?n:(e.setAttribute(t,i+""),i):void Q.removeAttr(e,t))},removeAttr:function(e,t){var i,s,n=0,o=t&&t.match(pe);if(o&&1===e.nodeType)for(;i=o[n++];)s=Q.propFix[i]||i,Q.expr.match.bool.test(i)&&(e[s]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!Z.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),nt={set:function(e,t,i){return t===!1?Q.removeAttr(e,i):e.setAttribute(i,i),i}},Q.each(Q.expr.match.bool.source.match(/\w+/g),function(e,t){var i=ot[t]||Q.find.attr;ot[t]=function(e,t,s){var n,o;return s||(o=ot[t],ot[t]=n,n=null!=i(e,t,s)?t.toLowerCase():null,ot[t]=o),n}});var at=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(e,t){return me(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Q.propFix[e]||e]})}}),Q.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var s,n,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return o=1!==a||!Q.isXMLDoc(e),o&&(t=Q.propFix[t]||t,n=Q.propHooks[t]),void 0!==i?n&&"set"in n&&void 0!==(s=n.set(e,i,t))?s:e[t]=i:n&&"get"in n&&null!==(s=n.get(e,t))?s:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||at.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Z.optSelected||(Q.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var rt=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(e){var t,i,s,n,o,a,r="string"==typeof e&&e,l=0,h=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(pe)||[];h>l;l++)if(i=this[l],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(rt," "):" ")){for(o=0;n=t[o++];)s.indexOf(" "+n+" ")<0&&(s+=n+" ");a=Q.trim(s),i.className!==a&&(i.className=a)}return this},removeClass:function(e){var t,i,s,n,o,a,r=0===arguments.length||"string"==typeof e&&e,l=0,h=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(pe)||[];h>l;l++)if(i=this[l],s=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(rt," "):"")){for(o=0;n=t[o++];)for(;s.indexOf(" "+n+" ")>=0;)s=s.replace(" "+n+" "," ");a=e?Q.trim(s):"",i.className!==a&&(i.className=a)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):Q.isFunction(e)?this.each(function(i){Q(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var t,s=0,n=Q(this),o=e.match(pe)||[];t=o[s++];)n.hasClass(t)?n.removeClass(t):n.addClass(t);else(i===ke||"boolean"===i)&&(this.className&&ve.set(this,"__className__",this.className),this.className=this.className||e===!1?"":ve.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,s=this.length;s>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rt," ").indexOf(t)>=0)return!0;return!1}});var lt=/\r/g;Q.fn.extend({val:function(e){var t,i,s,n=this[0];{if(arguments.length)return s=Q.isFunction(e),this.each(function(i){var n;1===this.nodeType&&(n=s?e.call(this,i,Q(this).val()):e,null==n?n="":"number"==typeof n?n+="":Q.isArray(n)&&(n=Q.map(n,function(e){return null==e?"":e+""})),t=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,n,"value")||(this.value=n))});if(n)return t=Q.valHooks[n.type]||Q.valHooks[n.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(n,"value"))?i:(i=n.value,"string"==typeof i?i.replace(lt,""):null==i?"":i)}}}),Q.extend({valHooks:{option:{get:function(e){var t=Q.find.attr(e,"value");return null!=t?t:Q.trim(Q.text(e))}},select:{get:function(e){for(var t,i,s=e.options,n=e.selectedIndex,o="select-one"===e.type||0>n,a=o?null:[],r=o?n+1:s.length,l=0>n?r:o?n:0;r>l;l++)if(i=s[l],!(!i.selected&&l!==n||(Z.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&Q.nodeName(i.parentNode,"optgroup"))){if(t=Q(i).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var i,s,n=e.options,o=Q.makeArray(t),a=n.length;a--;)s=n[a],(s.selected=Q.inArray(s.value,o)>=0)&&(i=!0);return i||(e.selectedIndex=-1),o}}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(e,t){return Q.isArray(t)?e.checked=Q.inArray(Q(e).val(),t)>=0:void 0}},Z.checkOn||(Q.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),Q.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,s){return this.on(t,e,i,s)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var ht=Q.now(),dt=/\?/;Q.parseJSON=function(e){return JSON.parse(e+"")},Q.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,t=i.parseFromString(e,"text/xml")}catch(s){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Q.error("Invalid XML: "+e),t};var ct=/#.*$/,ut=/([?&])_=[^&]*/,pt=/^(.*?):[ \t]*([^\r\n]*)$/gm,ft=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,gt=/^(?:GET|HEAD)$/,mt=/^\/\//,vt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,bt={},yt={},wt="*/".concat("*"),_t=e.location.href,Ct=vt.exec(_t.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_t,type:"GET",isLocal:ft.test(Ct[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?O(O(e,Q.ajaxSettings),t):O(Q.ajaxSettings,e)},ajaxPrefilter:N(bt),ajaxTransport:N(yt),ajax:function(e,t){function i(e,t,i,a){var l,d,v,b,w,C=t;2!==y&&(y=2,r&&clearTimeout(r),s=void 0,o=a||"",_.readyState=e>0?4:0,l=e>=200&&300>e||304===e,i&&(b=R(c,_,i)),b=B(c,b,_,l),l?(c.ifModified&&(w=_.getResponseHeader("Last-Modified"),w&&(Q.lastModified[n]=w),w=_.getResponseHeader("etag"),w&&(Q.etag[n]=w)),204===e||"HEAD"===c.type?C="nocontent":304===e?C="notmodified":(C=b.state,d=b.data,v=b.error,l=!v)):(v=C,(e||!C)&&(C="error",0>e&&(e=0))),_.status=e,_.statusText=(t||C)+"",l?f.resolveWith(u,[d,C,_]):f.rejectWith(u,[_,C,v]),_.statusCode(m),m=void 0,h&&p.trigger(l?"ajaxSuccess":"ajaxError",[_,c,l?d:v]),g.fireWith(u,[_,C]),h&&(p.trigger("ajaxComplete",[_,c]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var s,n,o,a,r,l,h,d,c=Q.ajaxSetup({},t),u=c.context||c,p=c.context&&(u.nodeType||u.jquery)?Q(u):Q.event,f=Q.Deferred(),g=Q.Callbacks("once memory"),m=c.statusCode||{},v={},b={},y=0,w="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!a)for(a={};t=pt.exec(o);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?o:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return y||(e=b[i]=b[i]||e,v[e]=t),this},overrideMimeType:function(e){return y||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)m[t]=[m[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||w;return s&&s.abort(t),i(0,t),this}};if(f.promise(_).complete=g.add,_.success=_.done,_.error=_.fail,c.url=((e||c.url||_t)+"").replace(ct,"").replace(mt,Ct[1]+"//"),c.type=t.method||t.type||c.method||c.type,c.dataTypes=Q.trim(c.dataType||"*").toLowerCase().match(pe)||[""],null==c.crossDomain&&(l=vt.exec(c.url.toLowerCase()),c.crossDomain=!(!l||l[1]===Ct[1]&&l[2]===Ct[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(Ct[3]||("http:"===Ct[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=Q.param(c.data,c.traditional)),F(bt,c,t,_),2===y)return _;h=Q.event&&c.global,h&&0===Q.active++&&Q.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!gt.test(c.type),n=c.url,c.hasContent||(c.data&&(n=c.url+=(dt.test(n)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=ut.test(n)?n.replace(ut,"$1_="+ht++):n+(dt.test(n)?"&":"?")+"_="+ht++)),c.ifModified&&(Q.lastModified[n]&&_.setRequestHeader("If-Modified-Since",Q.lastModified[n]),Q.etag[n]&&_.setRequestHeader("If-None-Match",Q.etag[n])),(c.data&&c.hasContent&&c.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",c.contentType),_.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+wt+"; q=0.01":""):c.accepts["*"]);for(d in c.headers)_.setRequestHeader(d,c.headers[d]);if(c.beforeSend&&(c.beforeSend.call(u,_,c)===!1||2===y))return _.abort();w="abort";for(d in{success:1,error:1,complete:1})_[d](c[d]);if(s=F(yt,c,t,_)){_.readyState=1,h&&p.trigger("ajaxSend",[_,c]),c.async&&c.timeout>0&&(r=setTimeout(function(){_.abort("timeout")},c.timeout));try{y=1,s.send(v,i)}catch(C){if(!(2>y))throw C;i(-1,C)}}else i(-1,"No Transport");return _},getJSON:function(e,t,i){return Q.get(e,t,i,"json")},getScript:function(e,t){return Q.get(e,void 0,t,"script")}}),Q.each(["get","post"],function(e,t){Q[t]=function(e,i,s,n){return Q.isFunction(i)&&(n=n||s,s=i,i=void 0),Q.ajax({url:e,type:t,dataType:n,data:i,success:s})}}),Q._evalUrl=function(e){return Q.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Q.fn.extend({wrapAll:function(e){var t;return Q.isFunction(e)?this.each(function(t){Q(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Q(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return Q.isFunction(e)?this.each(function(t){Q(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Q(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(i){Q(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}}),Q.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)};var St=/%20/g,xt=/\[\]$/,kt=/\r?\n/g,Tt=/^(?:submit|button|image|reset|file)$/i,$t=/^(?:input|select|textarea|keygen)/i;Q.param=function(e,t){var i,s=[],n=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){n(this.name,this.value)});else for(i in e)j(i,e[i],t,n);return s.join("&").replace(St,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Q.prop(this,"elements");return e?Q.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Q(this).is(":disabled")&&$t.test(this.nodeName)&&!Tt.test(e)&&(this.checked||!xe.test(e))}).map(function(e,t){var i=Q(this).val();return null==i?null:Q.isArray(i)?Q.map(i,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:i.replace(kt,"\r\n")}}).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var At=0,Pt={},Dt={0:200,1223:204},It=Q.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Pt)Pt[e]()}),Z.cors=!!It&&"withCredentials"in It,Z.ajax=It=!!It,Q.ajaxTransport(function(e){var t;return Z.cors||It&&!e.crossDomain?{send:function(i,s){var n,o=e.xhr(),a=++At;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(n in e.xhrFields)o[n]=e.xhrFields[n];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(n in i)o.setRequestHeader(n,i[n]);t=function(e){return function(){t&&(delete Pt[a],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?s(o.status,o.statusText):s(Dt[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{
text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=Pt[a]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(r){if(t)throw r}},abort:function(){t&&t()}}:void 0}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(s,n){t=Q("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&n("error"===e.type?404:200,e.type)}),J.head.appendChild(t[0])},abort:function(){i&&i()}}}});var Mt=[],Et=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mt.pop()||Q.expando+"_"+ht++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(t,i,s){var n,o,a,r=t.jsonp!==!1&&(Et.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Et.test(t.data)&&"data");return r||"jsonp"===t.dataTypes[0]?(n=t.jsonpCallback=Q.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(Et,"$1"+n):t.jsonp!==!1&&(t.url+=(dt.test(t.url)?"&":"?")+t.jsonp+"="+n),t.converters["script json"]=function(){return a||Q.error(n+" was not called"),a[0]},t.dataTypes[0]="json",o=e[n],e[n]=function(){a=arguments},s.always(function(){e[n]=o,t[n]&&(t.jsonpCallback=i.jsonpCallback,Mt.push(n)),a&&Q.isFunction(o)&&o(a[0]),a=o=void 0}),"script"):void 0}),Q.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||J;var s=ae.exec(e),n=!i&&[];return s?[t.createElement(s[1])]:(s=Q.buildFragment([e],t,n),n&&n.length&&Q(n).remove(),Q.merge([],s.childNodes))};var Lt=Q.fn.load;Q.fn.load=function(e,t,i){if("string"!=typeof e&&Lt)return Lt.apply(this,arguments);var s,n,o,a=this,r=e.indexOf(" ");return r>=0&&(s=Q.trim(e.slice(r)),e=e.slice(0,r)),Q.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(n="POST"),a.length>0&&Q.ajax({url:e,type:n,dataType:"html",data:t}).done(function(e){o=arguments,a.html(s?Q("<div>").append(Q.parseHTML(e)).find(s):e)}).complete(i&&function(e,t){a.each(i,o||[e.responseText,t,e])}),this},Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length};var Nt=e.document.documentElement;Q.offset={setOffset:function(e,t,i){var s,n,o,a,r,l,h,d=Q.css(e,"position"),c=Q(e),u={};"static"===d&&(e.style.position="relative"),r=c.offset(),o=Q.css(e,"top"),l=Q.css(e,"left"),h=("absolute"===d||"fixed"===d)&&(o+l).indexOf("auto")>-1,h?(s=c.position(),a=s.top,n=s.left):(a=parseFloat(o)||0,n=parseFloat(l)||0),Q.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(u.top=t.top-r.top+a),null!=t.left&&(u.left=t.left-r.left+n),"using"in t?t.using.call(e,u):c.css(u)}},Q.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var t,i,s=this[0],n={top:0,left:0},o=s&&s.ownerDocument;if(o)return t=o.documentElement,Q.contains(t,s)?(typeof s.getBoundingClientRect!==ke&&(n=s.getBoundingClientRect()),i=z(o),{top:n.top+i.pageYOffset-t.clientTop,left:n.left+i.pageXOffset-t.clientLeft}):n},position:function(){if(this[0]){var e,t,i=this[0],s={top:0,left:0};return"fixed"===Q.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Q.nodeName(e[0],"html")||(s=e.offset()),s.top+=Q.css(e[0],"borderTopWidth",!0),s.left+=Q.css(e[0],"borderLeftWidth",!0)),{top:t.top-s.top-Q.css(i,"marginTop",!0),left:t.left-s.left-Q.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Nt;e&&!Q.nodeName(e,"html")&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||Nt})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var s="pageYOffset"===i;Q.fn[t]=function(n){return me(this,function(t,n,o){var a=z(t);return void 0===o?a?a[i]:t[n]:void(a?a.scrollTo(s?e.pageXOffset:o,s?o:e.pageYOffset):t[n]=o)},t,n,arguments.length,null)}}),Q.each(["top","left"],function(e,t){Q.cssHooks[t]=C(Z.pixelPosition,function(e,i){return i?(i=_(e,t),He.test(i)?Q(e).position()[t]+"px":i):void 0})}),Q.each({Height:"height",Width:"width"},function(e,t){Q.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,s){Q.fn[s]=function(s,n){var o=arguments.length&&(i||"boolean"!=typeof s),a=i||(s===!0||n===!0?"margin":"border");return me(this,function(t,i,s){var n;return Q.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(n=t.documentElement,Math.max(t.body["scroll"+e],n["scroll"+e],t.body["offset"+e],n["offset"+e],n["client"+e])):void 0===s?Q.css(t,i,a):Q.style(t,i,s,a)},t,o?s:void 0,o,null)}})}),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Q});var Ft=e.jQuery,Ot=e.$;return Q.noConflict=function(t){return e.$===Q&&(e.$=Ot),t&&e.jQuery===Q&&(e.jQuery=Ft),Q},typeof t===ke&&(e.jQuery=e.$=Q),Q}),define("jquery_modern",function(){}),function(){var e=this,t=e._,i={},s=Array.prototype,n=Object.prototype,o=Function.prototype,a=s.push,r=s.slice,l=s.concat,h=n.toString,d=n.hasOwnProperty,c=s.forEach,u=s.map,p=s.reduce,f=s.reduceRight,g=s.filter,m=s.every,v=s.some,b=s.indexOf,y=s.lastIndexOf,w=Array.isArray,_=Object.keys,C=o.bind,S=function(e){return e instanceof S?e:this instanceof S?void(this._wrapped=e):new S(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=S),exports._=S):e._=S,S.VERSION="1.4.4";var x=S.each=S.forEach=function(e,t,s){if(null!=e)if(c&&e.forEach===c)e.forEach(t,s);else if(e.length===+e.length){for(var n=0,o=e.length;o>n;n++)if(t.call(s,e[n],n,e)===i)return}else for(var a in e)if(S.has(e,a)&&t.call(s,e[a],a,e)===i)return};S.map=S.collect=function(e,t,i){var s=[];return null==e?s:u&&e.map===u?e.map(t,i):(x(e,function(e,n,o){s[s.length]=t.call(i,e,n,o)}),s)};var k="Reduce of empty array with no initial value";S.reduce=S.foldl=S.inject=function(e,t,i,s){var n=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return s&&(t=S.bind(t,s)),n?e.reduce(t,i):e.reduce(t);if(x(e,function(e,o,a){n?i=t.call(s,i,e,o,a):(i=e,n=!0)}),!n)throw new TypeError(k);return i},S.reduceRight=S.foldr=function(e,t,i,s){var n=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return s&&(t=S.bind(t,s)),n?e.reduceRight(t,i):e.reduceRight(t);var o=e.length;if(o!==+o){var a=S.keys(e);o=a.length}if(x(e,function(r,l,h){l=a?a[--o]:--o,n?i=t.call(s,i,e[l],l,h):(i=e[l],n=!0)}),!n)throw new TypeError(k);return i},S.find=S.detect=function(e,t,i){var s;return T(e,function(e,n,o){return t.call(i,e,n,o)?(s=e,!0):void 0}),s},S.filter=S.select=function(e,t,i){var s=[];return null==e?s:g&&e.filter===g?e.filter(t,i):(x(e,function(e,n,o){t.call(i,e,n,o)&&(s[s.length]=e)}),s)},S.reject=function(e,t,i){return S.filter(e,function(e,s,n){return!t.call(i,e,s,n)},i)},S.every=S.all=function(e,t,s){t||(t=S.identity);var n=!0;return null==e?n:m&&e.every===m?e.every(t,s):(x(e,function(e,o,a){return(n=n&&t.call(s,e,o,a))?void 0:i}),!!n)};var T=S.some=S.any=function(e,t,s){t||(t=S.identity);var n=!1;return null==e?n:v&&e.some===v?e.some(t,s):(x(e,function(e,o,a){return n||(n=t.call(s,e,o,a))?i:void 0}),!!n)};S.contains=S.include=function(e,t){return null==e?!1:b&&e.indexOf===b?-1!=e.indexOf(t):T(e,function(e){return e===t})},S.invoke=function(e,t){var i=r.call(arguments,2),s=S.isFunction(t);return S.map(e,function(e){return(s?t:e[t]).apply(e,i)})},S.pluck=function(e,t){return S.map(e,function(e){return e[t]})},S.where=function(e,t,i){return S.isEmpty(t)?i?null:[]:S[i?"find":"filter"](e,function(e){for(var i in t)if(t[i]!==e[i])return!1;return!0})},S.findWhere=function(e,t){return S.where(e,t,!0)},S.max=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&S.isEmpty(e))return-(1/0);var s={computed:-(1/0),value:-(1/0)};return x(e,function(e,n,o){var a=t?t.call(i,e,n,o):e;a>=s.computed&&(s={value:e,computed:a})}),s.value},S.min=function(e,t,i){if(!t&&S.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&S.isEmpty(e))return 1/0;var s={computed:1/0,value:1/0};return x(e,function(e,n,o){var a=t?t.call(i,e,n,o):e;a<s.computed&&(s={value:e,computed:a})}),s.value},S.shuffle=function(e){var t,i=0,s=[];return x(e,function(e){t=S.random(i++),s[i-1]=s[t],s[t]=e}),s};var $=function(e){return S.isFunction(e)?e:function(t){return t[e]}};S.sortBy=function(e,t,i){var s=$(t);return S.pluck(S.map(e,function(e,t,n){return{value:e,index:t,criteria:s.call(i,e,t,n)}}).sort(function(e,t){var i=e.criteria,s=t.criteria;if(i!==s){if(i>s||void 0===i)return 1;if(s>i||void 0===s)return-1}return e.index<t.index?-1:1}),"value")};var A=function(e,t,i,s){var n={},o=$(t||S.identity);return x(e,function(t,a){var r=o.call(i,t,a,e);s(n,r,t)}),n};S.groupBy=function(e,t,i){return A(e,t,i,function(e,t,i){(S.has(e,t)?e[t]:e[t]=[]).push(i)})},S.countBy=function(e,t,i){return A(e,t,i,function(e,t){S.has(e,t)||(e[t]=0),e[t]++})},S.sortedIndex=function(e,t,i,s){i=null==i?S.identity:$(i);for(var n=i.call(s,t),o=0,a=e.length;a>o;){var r=o+a>>>1;i.call(s,e[r])<n?o=r+1:a=r}return o},S.toArray=function(e){return e?S.isArray(e)?r.call(e):e.length===+e.length?S.map(e,S.identity):S.values(e):[]},S.size=function(e){return null==e?0:e.length===+e.length?e.length:S.keys(e).length},S.first=S.head=S.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:r.call(e,0,t)},S.initial=function(e,t,i){return r.call(e,0,e.length-(null==t||i?1:t))},S.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:r.call(e,Math.max(e.length-t,0))},S.rest=S.tail=S.drop=function(e,t,i){return r.call(e,null==t||i?1:t)},S.compact=function(e){return S.filter(e,S.identity)};var P=function(e,t,i){return x(e,function(e){S.isArray(e)?t?a.apply(i,e):P(e,t,i):i.push(e)}),i};S.flatten=function(e,t){return P(e,t,[])},S.without=function(e){return S.difference(e,r.call(arguments,1))},S.uniq=S.unique=function(e,t,i,s){S.isFunction(t)&&(s=i,i=t,t=!1);var n=i?S.map(e,i,s):e,o=[],a=[];return x(n,function(i,s){(t?s&&a[a.length-1]===i:S.contains(a,i))||(a.push(i),o.push(e[s]))}),o},S.union=function(){return S.uniq(l.apply(s,arguments))},S.intersection=function(e){var t=r.call(arguments,1);return S.filter(S.uniq(e),function(e){return S.every(t,function(t){return S.indexOf(t,e)>=0})})},S.difference=function(e){var t=l.apply(s,r.call(arguments,1));return S.filter(e,function(e){return!S.contains(t,e)})},S.zip=function(){for(var e=r.call(arguments),t=S.max(S.pluck(e,"length")),i=new Array(t),s=0;t>s;s++)i[s]=S.pluck(e,""+s);return i},S.object=function(e,t){if(null==e)return{};for(var i={},s=0,n=e.length;n>s;s++)t?i[e[s]]=t[s]:i[e[s][0]]=e[s][1];return i},S.indexOf=function(e,t,i){if(null==e)return-1;var s=0,n=e.length;if(i){if("number"!=typeof i)return s=S.sortedIndex(e,t),e[s]===t?s:-1;s=0>i?Math.max(0,n+i):i}if(b&&e.indexOf===b)return e.indexOf(t,i);for(;n>s;s++)if(e[s]===t)return s;return-1},S.lastIndexOf=function(e,t,i){if(null==e)return-1;var s=null!=i;if(y&&e.lastIndexOf===y)return s?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var n=s?i:e.length;n--;)if(e[n]===t)return n;return-1},S.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var s=Math.max(Math.ceil((t-e)/i),0),n=0,o=new Array(s);s>n;)o[n++]=e,e+=i;return o},S.bind=function(e,t){if(e.bind===C&&C)return C.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}},S.partial=function(e){var t=r.call(arguments,1);return function(){return e.apply(this,t.concat(r.call(arguments)))}},S.bindAll=function(e){var t=r.call(arguments,1);return 0===t.length&&(t=S.functions(e)),x(t,function(t){e[t]=S.bind(e[t],e)}),e},S.memoize=function(e,t){var i={};return t||(t=S.identity),function(){var s=t.apply(this,arguments);return S.has(i,s)?i[s]:i[s]=e.apply(this,arguments)}},S.delay=function(e,t){var i=r.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},S.defer=function(e){return S.delay.apply(S,[e,1].concat(r.call(arguments,1)))},S.throttle=function(e,t){var i,s,n,o,a=0,r=function(){a=new Date,n=null,o=e.apply(i,s)};return function(){var l=new Date,h=t-(l-a);return i=this,s=arguments,0>=h?(clearTimeout(n),n=null,a=l,o=e.apply(i,s)):n||(n=setTimeout(r,h)),o}},S.debounce=function(e,t,i){var s,n;return function(){var o=this,a=arguments,r=function(){s=null,i||(n=e.apply(o,a))},l=i&&!s;return clearTimeout(s),s=setTimeout(r,t),l&&(n=e.apply(o,a)),n}},S.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},S.wrap=function(e,t){return function(){var i=[e];return a.apply(i,arguments),t.apply(this,i)}},S.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},S.after=function(e,t){return 0>=e?t():function(){return--e<1?t.apply(this,arguments):void 0}},S.keys=_||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)S.has(e,i)&&(t[t.length]=i);return t},S.values=function(e){var t=[];for(var i in e)S.has(e,i)&&t.push(e[i]);return t},S.pairs=function(e){var t=[];for(var i in e)S.has(e,i)&&t.push([i,e[i]]);return t},S.invert=function(e){var t={};for(var i in e)S.has(e,i)&&(t[e[i]]=i);return t},S.functions=S.methods=function(e){var t=[];for(var i in e)S.isFunction(e[i])&&t.push(i);return t.sort()},S.extend=function(e){return x(r.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]}),e},S.pick=function(e){var t={},i=l.apply(s,r.call(arguments,1));return x(i,function(i){i in e&&(t[i]=e[i])}),t},S.omit=function(e){var t={},i=l.apply(s,r.call(arguments,1));for(var n in e)S.contains(i,n)||(t[n]=e[n]);return t},S.defaults=function(e){return x(r.call(arguments,1),function(t){if(t)for(var i in t)null==e[i]&&(e[i]=t[i])}),e},S.clone=function(e){return S.isObject(e)?S.isArray(e)?e.slice():S.extend({},e):e},S.tap=function(e,t){return t(e),e};var D=function(e,t,i,s){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof S&&(e=e._wrapped),t instanceof S&&(t=t._wrapped);var n=h.call(e);if(n!=h.call(t))return!1;switch(n){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=i.length;o--;)if(i[o]==e)return s[o]==t;i.push(e),s.push(t);var a=0,r=!0;if("[object Array]"==n){if(a=e.length,r=a==t.length)for(;a--&&(r=D(e[a],t[a],i,s)););}else{var l=e.constructor,d=t.constructor;if(l!==d&&!(S.isFunction(l)&&l instanceof l&&S.isFunction(d)&&d instanceof d))return!1;for(var c in e)if(S.has(e,c)&&(a++,!(r=S.has(t,c)&&D(e[c],t[c],i,s))))break;if(r){for(c in t)if(S.has(t,c)&&!a--)break;r=!a}}return i.pop(),s.pop(),r};S.isEqual=function(e,t){return D(e,t,[],[])},S.isEmpty=function(e){if(null==e)return!0;if(S.isArray(e)||S.isString(e))return 0===e.length;for(var t in e)if(S.has(e,t))return!1;return!0},S.isElement=function(e){return!(!e||1!==e.nodeType)},S.isArray=w||function(e){return"[object Array]"==h.call(e)},S.isObject=function(e){return e===Object(e)},x(["Arguments","Function","String","Number","Date","RegExp"],function(e){S["is"+e]=function(t){return h.call(t)=="[object "+e+"]"}}),S.isArguments(arguments)||(S.isArguments=function(e){return!(!e||!S.has(e,"callee"))}),"function"!=typeof/./&&(S.isFunction=function(e){return"function"==typeof e}),S.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},S.isNaN=function(e){return S.isNumber(e)&&e!=+e},S.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==h.call(e)},S.isNull=function(e){return null===e},S.isUndefined=function(e){return void 0===e},S.has=function(e,t){return d.call(e,t)},S.noConflict=function(){return e._=t,this},S.identity=function(e){return e},S.times=function(e,t,i){for(var s=Array(e),n=0;e>n;n++)s[n]=t.call(i,n);return s},S.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=S.invert(I.escape);var M={escape:new RegExp("["+S.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+S.keys(I.unescape).join("|")+")","g")};S.each(["escape","unescape"],function(e){S[e]=function(t){return null==t?"":(""+t).replace(M[e],function(t){return I[e][t]})}}),S.result=function(e,t){if(null==e)return null;var i=e[t];return S.isFunction(i)?i.call(e):i},S.mixin=function(e){x(S.functions(e),function(t){var i=S[t]=e[t];S.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),O.call(this,i.apply(S,e))}})};var E=0;S.uniqueId=function(e){var t=++E+"";return e?e+t:t},S.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var L=/(.)^/,N={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},F=/\\|'|\r|\n|\t|\u2028|\u2029/g;S.template=function(e,t,i){var s;i=S.defaults({},i,S.templateSettings);var n=new RegExp([(i.escape||L).source,(i.interpolate||L).source,(i.evaluate||L).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(n,function(t,i,s,n,r){return a+=e.slice(o,r).replace(F,function(e){return"\\"+N[e]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),s&&(a+="'+\n((__t=("+s+"))==null?'':__t)+\n'"),n&&(a+="';\n"+n+"\n__p+='"),o=r+t.length,t}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{s=new Function(i.variable||"obj","_",a)}catch(r){throw r.source=a,r}if(t)return s(t,S);var l=function(e){return s.call(this,e,S)};return l.source="function("+(i.variable||"obj")+"){\n"+a+"}",l},S.chain=function(e){return S(e).chain()};var O=function(e){return this._chain?S(e).chain():e};S.mixin(S),x(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];S.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],O.call(this,i)}}),x(["concat","join","slice"],function(e){var t=s[e];S.prototype[e]=function(){return O.call(this,t.apply(this._wrapped,arguments))}}),S.extend(S.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return S})}.call(this),function(e,t){"undefined"!=typeof exports?t(e,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(i,s,n){e.Backbone=t(e,n,i,s)}):e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender)}(this,function(e,t,i,s){var n=e.Backbone,o=[],a=o.push,r=o.slice,l=o.splice;t.VERSION="1.0.0",t.$=s,t.noConflict=function(){return e.Backbone=n,this},t.emulateHTTP=!1,t.emulateJSON=!1;var h=t.Events={on:function(e,t,i){if(!c(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var s=this._events[e]||(this._events[e]=[]);return s.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,s){if(!c(this,"once",e,[t,s])||!t)return this;var n=this,o=i.once(function(){n.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,s)},off:function(e,t,s){var n,o,a,r,l,h,d,u;if(!this._events||!c(this,"off",e,[t,s]))return this;if(!e&&!t&&!s)return this._events={},this;for(r=e?[e]:i.keys(this._events),l=0,h=r.length;h>l;l++)if(e=r[l],a=this._events[e]){if(this._events[e]=n=[],t||s)for(d=0,u=a.length;u>d;d++)o=a[d],(t&&t!==o.callback&&t!==o.callback._callback||s&&s!==o.context)&&n.push(o);n.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=r.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],s=this._events.all;return i&&u(i,t),s&&u(s,arguments),this},stopListening:function(e,t,i){var s=this._listeners;if(!s)return this;var n=!t&&!i;"object"==typeof t&&(i=this),e&&((s={})[e._listenerId]=e);for(var o in s)s[o].off(t,i,this),n&&delete this._listeners[o];return this}},d=/\s+/,c=function(e,t,i,s){if(!i)return!0;if("object"==typeof i){for(var n in i)e[t].apply(e,[n,i[n]].concat(s));return!1}if(d.test(i)){for(var o=i.split(d),a=0,r=o.length;r>a;a++)e[t].apply(e,[o[a]].concat(s));return!1}return!0},u=function(e,t){var i,s=-1,n=e.length,o=t[0],a=t[1],r=t[2];switch(t.length){case 0:for(;++s<n;)(i=e[s]).callback.call(i.ctx);return;case 1:for(;++s<n;)(i=e[s]).callback.call(i.ctx,o);return;case 2:for(;++s<n;)(i=e[s]).callback.call(i.ctx,o,a);return;case 3:for(;++s<n;)(i=e[s]).callback.call(i.ctx,o,a,r);return;default:for(;++s<n;)(i=e[s]).callback.apply(i.ctx,t)}},p={listenTo:"on",listenToOnce:"once"};i.each(p,function(e,t){h[t]=function(t,s,n){var o=this._listeners||(this._listeners={}),a=t._listenerId||(t._listenerId=i.uniqueId("l"));return o[a]=t,"object"==typeof s&&(n=this),t[e](s,n,this),this}}),h.bind=h.on,h.unbind=h.off,i.extend(t,h);var f=t.Model=function(e,t){var s,n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),(s=i.result(this,"defaults"))&&(n=i.defaults({},n,s)),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(f.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,s){var n,o,a,r,l,h,d,c;if(null==e)return this;if("object"==typeof e?(o=e,s=t):(o={})[e]=t,s||(s={}),!this._validate(o,s))return!1;a=s.unset,l=s.silent,r=[],h=this._changing,this._changing=!0,h||(this._previousAttributes=i.clone(this.attributes),this.changed={}),c=this.attributes,d=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(n in o)t=o[n],i.isEqual(c[n],t)||r.push(n),i.isEqual(d[n],t)?delete this.changed[n]:this.changed[n]=t,a?delete c[n]:c[n]=t;if(!l){r.length&&(this._pending=!0);for(var u=0,p=r.length;p>u;u++)this.trigger("change:"+r[u],this,c[r[u]],s)}if(h)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,s);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var s in this.attributes)t[s]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,s=!1,n=this._changing?this._previousAttributes:this.attributes;for(var o in e)i.isEqual(n[o],t=e[o])||((s||(s={}))[o]=t);return s},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,s=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(s&&s(t,i,e),void t.trigger("sync",t,i,e)):!1},$(this,e),this.sync("read",this,e)},save:function(e,t,s){var n,o,a,r=this.attributes;if(null==e||"object"==typeof e?(n=e,s=t):(n={})[e]=t,s=i.extend({validate:!0},s),n&&!s.wait){if(!this.set(n,s))return!1}else if(!this._validate(n,s))return!1;n&&s.wait&&(this.attributes=i.extend({},r,n)),void 0===s.parse&&(s.parse=!0);var l=this,h=s.success;return s.success=function(e){l.attributes=r;var t=l.parse(e,s);return s.wait&&(t=i.extend(n||{},t)),i.isObject(t)&&!l.set(t,s)?!1:(h&&h(l,e,s),void l.trigger("sync",l,e,s))},$(this,s),o=this.isNew()?"create":s.patch?"patch":"update","patch"===o&&(s.attrs=n),a=this.sync(o,this,s),n&&s.wait&&(this.attributes=r),a},destroy:function(e){e=e?i.clone(e):{};var t=this,s=e.success,n=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&n(),s&&s(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;$(this,e);var o=this.sync("delete",this,e);return e.wait||n(),o},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||T();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var s=this.validationError=this.validate(e,t)||null;return s?(this.trigger("invalid",this,s,i.extend(t||{},{validationError:s})),!1):!0}});var g=["keys","values","pairs","invert","pick","omit"];i.each(g,function(e){f.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},v={add:!0,remove:!0,merge:!0},b={add:!0,merge:!1,remove:!1};i.extend(m.prototype,h,{model:f,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.defaults(t||{},b))},remove:function(e,t){e=i.isArray(e)?e.slice():[e],t||(t={});var s,n,o,a;for(s=0,n=e.length;n>s;s++)a=this.get(e[s]),a&&(delete this._byId[a.id],delete this._byId[a.cid],o=this.indexOf(a),this.models.splice(o,1),this.length--,t.silent||(t.index=o,a.trigger("remove",a,this,t)),this._removeReference(a));return this},set:function(e,t){t=i.defaults(t||{},v),t.parse&&(e=this.parse(e,t)),i.isArray(e)||(e=e?[e]:[]);var s,n,o,r,h,d=t.at,c=this.comparator&&null==d&&t.sort!==!1,u=i.isString(this.comparator)?this.comparator:null,p=[],f=[],g={};for(s=0,n=e.length;n>s;s++)(o=this._prepareModel(e[s],t))&&((r=this.get(o))?(t.remove&&(g[r.cid]=!0),t.merge&&(r.set(o.attributes,t),c&&!h&&r.hasChanged(u)&&(h=!0))):t.add&&(p.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,null!=o.id&&(this._byId[o.id]=o)));if(t.remove){for(s=0,n=this.length;n>s;++s)g[(o=this.models[s]).cid]||f.push(o);f.length&&this.remove(f,t)}if(p.length&&(c&&(h=!0),this.length+=p.length,null!=d?l.apply(this.models,[d,0].concat(p)):a.apply(this.models,p)),h&&this.sort({silent:!0}),t.silent)return this;for(s=0,n=p.length;n>s;s++)(o=p[s]).trigger("add",o,this,t);return h&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var s=0,n=this.models.length;n>s;s++)this._removeReference(this.models[s]);return t.previousModels=this.models,this._reset(),this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,i.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return r.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[null!=e.id?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,s){t||(t=this.comparator);var n=i.isFunction(t)?t:function(e){return e.get(t)};return i.sortedIndex(this.models,e,n,s)},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,s=this;return e.success=function(i){var n=e.reset?"reset":"set";s[n](i,e),t&&t(s,i,e),s.trigger("sync",s,i,e)},$(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var s=this,n=t.success;return t.success=function(i){t.wait&&s.add(e,t),n&&n(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof f)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var i=new this.model(e,t);return i._validate(e,t)?i:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,s){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,s),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];i.each(y,function(e){m.prototype[e]=function(){var t=r.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var w=["groupBy","countBy","sortBy"];i.each(w,function(e){m.prototype[e]=function(t,s){var n=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,n,s)}});var _=t.View=function(e){this.cid=i.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},C=/^(\S+)\s*(.*)$/,S=["model","collection","el","id","attributes","className","tagName","events"];i.extend(_.prototype,h,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var s=e[t];if(i.isFunction(s)||(s=this[e[t]]),s){var n=t.match(C),o=n[1],a=n[2];s=i.bind(s,this),o+=".delegateEvents"+this.cid,""===a?this.$el.on(o,s):this.$el.on(o,a,s)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=i.extend({},i.result(this,"options"),e)),i.extend(this,i.pick(e,S)),this.options=e},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var s=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(s,!1)}}}),t.sync=function(e,s,n){var o=x[e];i.defaults(n||(n={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:o,dataType:"json"};if(n.url||(a.url=i.result(s,"url")||T()),null!=n.data||!s||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",
a.data=JSON.stringify(n.attrs||s.toJSON(n))),n.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),n.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){a.type="POST",n.emulateJSON&&(a.data._method=o);var r=n.beforeSend;n.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),r?r.apply(this,arguments):void 0}}"GET"===a.type||n.emulateJSON||(a.processData=!1),"PATCH"!==a.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=n.xhr=t.ajax(i.extend(a,n));return s.trigger("request",s,l,n),l};var x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=function(e,t){var s,n=this;s=e&&i.has(e,"constructor")?e.constructor:function(){return n.apply(this,arguments)},i.extend(s,n,t);var o=function(){this.constructor=s};return o.prototype=n.prototype,s.prototype=new o,e&&i.extend(s.prototype,e),s.__super__=n.prototype,s};f.extend=m.extend=_.extend=k;var T=function(){throw new Error('A "url" property or function must be specified')},$=function(e,t){var i=t.error;t.error=function(s){i&&i(e,s,t),e.trigger("error",e,s,t)}};return t}),define("pubsub",["underscore","backbone"],function(e,t){"use strict";var i=e.extend({},t.Events);i.attach=function(t,i){e.each(t,e.bind(function(e,t){this.on(t,e,i)},this))},i.unattach=function(t,i){e.each(t,e.bind(function(e,t){this.off(t,e,i)},this))};var s=i.trigger;return i.trigger=function(e){try{s.apply(i,arguments)}catch(t){console.error('PubSub trigger "'+e+'" threw exception: ',t.stack||t.stacktrace||t.message)}return i},i}),define("managers/trafficcop",["jquery","underscore"],function(e,t){var i=function(){this.DEBUG=!0,this.defaultTimeout=2e3,this.minTimeout=500,this.activeRequests=[],this.activeAnimations=[],this.animationCompletion=null};return i.prototype={addRequest:function(i){var s={ajaxPromise:i,gate:e.Deferred(),result:null};this.activeRequests.push(s),i.always(t.bind(function(e){this.activeAnimations.length?s.result=e:("resolved"===i.state()?s.gate.resolve(e):s.gate.reject(e),this._cleanup())},this));var n=s.gate.promise();return n.original=i,n.abort=i.abort,n},addAnimation:function(i,s,n,o,a){if(!i||"pending"!==i.state())return i;this.animationCompletion||(this.animationCompletion=e.Deferred());var r=Math.max(2*a,this.minTimeout)||this.defaultTimeout,l=setTimeout(t.bind(function(){console.warn("ANIMATION did NOT resolve within "+r+" ms, releasing barrier "+this._getAnimationPropertyDescription(n,o),s),this._resolveAnimation(i)},this),r);return this.activeAnimations.push(i),i.always(t.bind(function(){clearTimeout(l),this._resolveAnimation(i)||console.warn("animation finished after being released "+this._getAnimationPropertyDescription(n,o),s)},this)),this.animationCompletion.promise()},getAnimationCompletion:function(){return this.animationCompletion?this.animationCompletion.promise():e.Deferred().resolve()},_getAnimationPropertyDescription:function(e,t){return e?"on property "+e+":"+t:"on unregistered element"},_resolveAnimation:function(t){var i=e.inArray(t,this.activeAnimations);return-1!==i?(this.activeAnimations.splice(i,1),0===this.activeAnimations.length&&this._openGate(),!0):!1},_openGate:function(){var e=this.animationCompletion;this.animationCompletion=null,t.each(this.activeRequests,function(e){var t=e.ajaxPromise.state();"resolved"===t?e.gate.resolve(e.result):"rejected"===t&&e.gate.reject(e.result)}),this._cleanup(),e.resolve()},_cleanup:function(){this.activeRequests=t.reject(this.activeRequests,function(e){return"pending"!==e.gate.state()})}},new i}),function(e){"use strict";"function"==typeof define&&define.amd?define("libs/css-transition-lib/css-transition-lib",["jquery"],function(t){return window.CSSAnimate=e(t),window.CSSAnimate}):window.CSSAnimate=e(window.jQuery||window.Zepto||window.$)}(function(e){"use strict";function t(e){var t,i=document.createElement("p").style,s=["ms","O","Moz","Webkit"];if(""===i[e])return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),t=s.length;t--;)if(""===i[s[t]+e])return s[t]+e}function i(e){var t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};return t[e]}var s=function(e){this.transitionCssName=e,this.transitionEndName=i(e)};return s.prototype={animate:function(t,i,s,n,o,a){var r=this;return t=e(t),0===t.length?(console.error("tried animating null or empty jquery object"),e.Deferred().reject()):e.when.apply(e,e.map(t,function(t){return r.transitionCssName?r.cssTransition(e(t),i,s,n,o,a):r.jQuery(e(t),i,s,n,o,a)}))},cssTransition:function(t,i,s,n,o,a){var r;return"opacity"===i&&"none"===t.css("display")&&(n=0),this._isDocumentHidden()?(t.css(i,s),e.Deferred().resolve()):(0!==n&&40>n&&(n=40),o=this._normalizeEasing(o,this._easingMap),r=e.camelCase(i),s=this._getCssNumber(r,s),a=a?" "+a+"ms":"",this._transition(t,i,r,s,n,o,a))},jQuery:function(t,i,s,n,o,a){if(this._isDocumentHidden())return t.css(i,s),e.Deferred().resolve();var r={};return o=this._normalizeEasing(o,this._invert(this._easingMap)),r[i]=s,e.Deferred(function(e){var l="proganimate"+i;t.stop(l,!0),0===n?(t.css(i,s),setTimeout(function(){e.resolve()},1)):t.delay(a||0,l).animate(r,{duration:n,easing:o,queue:l,done:function(){t.css(i,s),e.resolve()},fail:function(){e.reject()}}).dequeue(l)}).promise()},stop:function(t,i){var s=e.camelCase(i),n=window.getComputedStyle(t[0]).getPropertyValue(i);return t.stop("proganimate"+i,!0),this._failPreviousTransition(t,s)&&(t[0].style[s]=n),n},_easingMap:{easeInQuad:"ease-in",easeInSine:"ease-in",easeInCubic:"ease-in",easeInQuart:"ease-in",easeInQuint:"ease-in",easeInExpo:"ease-in",easeInCirc:"ease-in",easeInBack:"ease-in",easeInElastic:"ease-in",easeInBounce:"ease-in",easeOutQuad:"ease-out",easeOutSine:"ease-out",easeOutCubic:"ease-out",easeOutQuart:"ease-out",easeOutQuint:"ease-out",easeOutExpo:"ease-out",easeOutCirc:"ease-out",easeOutBack:"ease-out",easeOutElastic:"ease-out",easeOutBounce:"ease-out",easeInOutQuad:"ease-in-out",easeInOutSine:"ease-in-out",easeInOutCubic:"ease-in-out",easeInOutQuart:"ease-in-out",easeInOutQuint:"ease-in-out",easeInOutExpo:"ease-in-out",easeInOutCirc:"ease-in-out",easeInOutBack:"ease-in-out",easeInOutElastic:"ease-in-out",easeInOutBounce:"ease-in-out",swing:"ease-in-out"},_normalizeEasing:function(e,t){var i;return e=e||"linear",i=t[e],i?e=i:-1===e.indexOf("cubic-bezier")||t.swing?this._invert(t)[e]||(e="linear"):e="swing",e},_transition:function(t,i,s,n,o,a,r){var l,h=e.Deferred(),d=this._getCurrentValue(t,s,i);return this._shouldDoTransition(t,s,i,d,n,o)?(l=i+" "+o+"ms "+a+" "+r,h=this._doTransition(t,s,i,n,l)):setTimeout(function(){h.resolve()},1),h.promise()},_doTransition:function(t,i,s,n,o){var a=t[0].style,r=this;return this._getAnimationDeferred(t,i,s,"2d",function(e){r._triggerTransition(e,t,i,s,n,o)}).then(function(){return n.replace(/[ ]+/g,"")===a[i].replace(/[ ]+/g,"")?e.Deferred().resolve():e.Deferred().reject()})},_getAnimationDeferred:function(t,i,s,n,o){var a=this;return e.Deferred(function(e){var r=a._failPreviousTransition(t,i,!0);setTimeout(function(){r&&r.cleanup(),"pending"===e.state()&&o(e)},20),t.data("transition-animate-"+i+"-defer",{promise:e,animationType:n,cleanup:function(){a._removeTransition(t[0].style,s)}})}).always(function(e){t.removeData("transition-animate-"+i+"-defer"),e||a._removeTransition(t[0].style,s)})},_removeTransition:function(t,i){var s=t[this.transitionCssName];s=s||"",s=s.replace(new RegExp(i+" \\w+ [\\w-]+(\\s*\\([^\\)]*\\))?"),""),t[this.transitionCssName]=e.trim(s.replace(/^[ ,]+/,"").replace(/[ ,]+$/,"").replace(/,[ ]+,/,""))},_triggerTransition:function(e,t,i,s,n,o){var a=t[0].style;this._registerTransitionEndListener(t,e,s),this._setupTransition(a,s,o),a[i]=n},_failPreviousTransition:function(e,t,i){var s=e.data("transition-animate-"+t+"-defer");return s?(s.promise.reject(i),s):void 0},_setupTransition:function(e,t,i){var s=e[this.transitionCssName];s?s+=","+i:s=i,e[this.transitionCssName]=s},_getCurrentValue:function(e,t,i){var s=e[0].style,n=s[t]||e.css(i);return"auto"!==n&&n||(s[t]=this._getCssNumber(t,0),n="0"),n},_shouldDoTransition:function(e,t,i,s,n,o){var a=e[0].style;return 0===o?(this._failPreviousTransition(e,t),a[t]=n,!1):this._canAnimate(s,n)?s:(this._failPreviousTransition(e,t),!1)},_canAnimate:function(e,t){return"0"===e.replace(/[ a-z%]+/g,"")&&"0"===t.replace(/[ a-z%]+/g,"")?!1:e.replace(/[ ]/g,"")!==t.replace(/[ ]/g,"")},_getCssNumber:function(t,i){return e.cssNumber[t]||!this._isNumber(i)&&i.match(/[a-z%]/)?i+"":i+"px"},_registerTransitionEndListener:function(t,i,s){if(this.transitionEndName){var n=t[0],o=this.transitionEndName,a=function(e){e.target!==n||s&&e.propertyName!==s||(this.removeEventListener(o,a),i.resolve(),a=null)};return n.addEventListener(o,a),i.promise()}return e.Deferred.reject()},_invert:function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t},_isNumber:function(e){return"[object Number]"===Object.prototype.toString.call(e)},_isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden}},new s(t("transition"))}),define("easing",["jquery"],function(e){e.easing.jswing=e.easing.swing,e.extend(e.easing,{def:"easeOutQuad",swing:function(t,i,s,n,o){return e.easing[e.easing.def](t,i,s,n,o)},easeInQuad:function(e,t,i,s,n){return s*(t/=n)*t+i},easeOutQuad:function(e,t,i,s,n){return-s*(t/=n)*(t-2)+i},easeInOutQuad:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t+i:-s/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,s,n){return s*(t/=n)*t*t+i},easeOutCubic:function(e,t,i,s,n){return s*((t=t/n-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t*t+i:s/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,s,n){return s*(t/=n)*t*t*t+i},easeOutQuart:function(e,t,i,s,n){return-s*((t=t/n-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t*t*t+i:-s/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,s,n){return s*(t/=n)*t*t*t*t+i},easeOutQuint:function(e,t,i,s,n){return s*((t=t/n-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,s,n){return(t/=n/2)<1?s/2*t*t*t*t*t+i:s/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,s,n){return-s*Math.cos(t/n*(Math.PI/2))+s+i},easeOutSine:function(e,t,i,s,n){return s*Math.sin(t/n*(Math.PI/2))+i},easeInOutSine:function(e,t,i,s,n){return-s/2*(Math.cos(Math.PI*t/n)-1)+i},easeInExpo:function(e,t,i,s,n){return 0==t?i:s*Math.pow(2,10*(t/n-1))+i},easeOutExpo:function(e,t,i,s,n){return t==n?i+s:s*(-Math.pow(2,-10*t/n)+1)+i},easeInOutExpo:function(e,t,i,s,n){return 0==t?i:t==n?i+s:(t/=n/2)<1?s/2*Math.pow(2,10*(t-1))+i:s/2*(-Math.pow(2,-10*--t)+2)+i},easeInCirc:function(e,t,i,s,n){return-s*(Math.sqrt(1-(t/=n)*t)-1)+i},easeOutCirc:function(e,t,i,s,n){return s*Math.sqrt(1-(t=t/n-1)*t)+i},easeInOutCirc:function(e,t,i,s,n){return(t/=n/2)<1?-s/2*(Math.sqrt(1-t*t)-1)+i:s/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,s,n){var o=1.70158,a=0,r=s;if(0==t)return i;if(1==(t/=n))return i+s;if(a||(a=.3*n),r<Math.abs(s)){r=s;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(s/r);return-(r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/a))+i},easeOutElastic:function(e,t,i,s,n){var o=1.70158,a=0,r=s;if(0==t)return i;if(1==(t/=n))return i+s;if(a||(a=.3*n),r<Math.abs(s)){r=s;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(s/r);return r*Math.pow(2,-10*t)*Math.sin(2*(t*n-o)*Math.PI/a)+s+i},easeInOutElastic:function(e,t,i,s,n){var o=1.70158,a=0,r=s;if(0==t)return i;if(2==(t/=n/2))return i+s;if(a||(a=.3*n*1.5),r<Math.abs(s)){r=s;var o=a/4}else var o=a/(2*Math.PI)*Math.asin(s/r);return 1>t?-.5*r*Math.pow(2,10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/a)+i:r*Math.pow(2,-10*(t-=1))*Math.sin(2*(t*n-o)*Math.PI/a)*.5+s+i},easeInBack:function(e,t,i,s,n,o){return void 0==o&&(o=1.70158),s*(t/=n)*t*((o+1)*t-o)+i},easeOutBack:function(e,t,i,s,n,o){return void 0==o&&(o=1.70158),s*((t=t/n-1)*t*((o+1)*t+o)+1)+i},easeInOutBack:function(e,t,i,s,n,o){return void 0==o&&(o=1.70158),(t/=n/2)<1?s/2*t*t*(((o*=1.525)+1)*t-o)+i:s/2*((t-=2)*t*(((o*=1.525)+1)*t+o)+2)+i},easeInBounce:function(t,i,s,n,o){return n-e.easing.easeOutBounce(t,o-i,0,n,o)+s},easeOutBounce:function(e,t,i,s,n){return(t/=n)<1/2.75?7.5625*s*t*t+i:2/2.75>t?s*(7.5625*(t-=1.5/2.75)*t+.75)+i:2.5/2.75>t?s*(7.5625*(t-=2.25/2.75)*t+.9375)+i:s*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(t,i,s,n,o){return o/2>i?.5*e.easing.easeInBounce(t,2*i,0,n,o)+s:.5*e.easing.easeOutBounce(t,2*i-o,0,n,o)+.5*n+s}})}),define("transformSupport",["jquery"],function(e){e.support.css=e.support.css||{},Modernizr.csstransitions&&(e.support.css.transition={cssName:Modernizr.prefixed("transition"),endEventNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}},e.support.css.transition.endName=e.support.css.transition.endEventNames[e.support.css.transition.cssName],e.support.css.transition.registerTransitionEndListener=function(t,i,s){i||(i=e.Deferred());var n=e.support.css.transition.endName,o=function(e){e.target!=t||s&&e.propertyName!==s||(this.removeEventListener(n,o),i.resolve(),o=null)};return t.addEventListener(n,o),i.promise()}),!Modernizr.csstransforms3d||navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/5")||(e.support.css.transform={cssName:Modernizr.prefixed("transform"),originCssName:Modernizr.prefixed("transformOrigin"),styleCssName:Modernizr.prefixed("transformStyle"),backfaceVisibilityCssName:Modernizr.prefixed("backfaceVisibility"),perspectiveCssName:Modernizr.prefixed("perspective"),perspectiveOriginCssName:Modernizr.prefixed("perspectiveOrigin")},e.support.css.transform.cssHyphenName=e.support.css.transform.cssName.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-"))}),define("baseview",["jquery","underscore","backbone","pubsub","managers/trafficcop","libs/css-transition-lib/css-transition-lib","easing","transformSupport"],function(e,t,i,s,n,o){"use strict";var a=i.View.extend({useCSSTransitions:!!e.support.css.transition,transitionCssName:e.support.css.transition&&e.support.css.transition.cssName,isSafari6:navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")&&-1!==navigator.userAgent.indexOf("Version/6"),isApple:navigator.userAgent.indexOf("iPhone")>-1||navigator.userAgent.indexOf("iPad")>-1,pubSub:null,options:{animations:{fadeIn:{duration:200,easing:"easeInQuad"},fadeOut:{duration:200,easing:"easeOutSine"},useCSSTransitions:!0}},initialize:function(t){this.options=e.extend(!0,{},a.prototype.options,t),this.useCSSTransitions=this.options.animations.useCSSTransitions&&this.useCSSTransitions,this.seenModules={},this.subviews=this.subviews||{},this.clear$$(),this.pubSub&&s.attach(this.pubSub,this)},$$:function(e){var t=this.cachedSelectors[e];return t||(t=this.$(e),this.cachedSelectors[e]=t),t},clear$$:function(e){e?delete this.cachedSelectors[e]:this.cachedSelectors={}},setElement:function(){this.clear$$(),i.View.prototype.setElement.apply(this,arguments)},destroy:function(e,t){this.destroyed=!0,this.destroyModules(e,t),this.clear$$(),this.pubSub&&s.unattach(this.pubSub,this),e&&this.$el.remove()},destroyModules:function(e,t){this._callCollection(this.subviews,"destroy",[e,t]),this.undelegateEvents(),this.subviews={}},triggerEvent:function(e,t){t=Array.prototype.slice.call(arguments,1),this._callCollection(this.subviews,e,t)},_callCollection:function(i,s,n){t.each(i,function(i){try{e.isArray(i)?t.each(i,function(t){e.isFunction(t[s])&&t[s].apply(t,n)}):i&&e.isFunction(i[s])&&i[s].apply(i,n)}catch(o){console.error("subview threw exception on destruction: ",o.stack||o.stacktrace||o.message)}})},registerAnimation:function(e,t,i,s,o){return n.addAnimation(e,t,i,s,o)},animate:function(i,s,a,r,l,h){return i&&0!==i.length?(this.isSafari6&&"opacity"===s&&(r=0),e.when.apply(e,t.map(i,t.bind(function(t){var i;return i=this.useCSSTransitions?o.cssTransition(e(t),s,a,r,l,h):o.jQuery(e(t),s,a,r,l,h),n.addAnimation(i,t,a,r),i},this)))):(console.error("tried animating null or empty jquery object"),e.Deferred().reject())},stopAnimate:function(i,s){t.each(i,function(t){o.stop(e(t),s)})},show:function(i,s){var n,o=this.options.animations.fadeIn;return i&&!this.isSafari6?(n=this.$el.fadeTo(o.duration,1,o.easing).promise(),this.registerAnimation(n,this.$el,"opacity",1)):(n=e.Deferred(),t.defer(function(){n.resolve()}),this.$el.css({display:"block",opacity:1})),n.done(function(){s&&s()}),n},hide:function(i,s){var n,o=this.options.animations.fadeOut;return i&&!this.isSafari6?(n=this.$el.fadeTo(o.duration,0,o.easing).promise(),n.done(t.bind(function(){this.$el.css({display:"none"})},this)),this.registerAnimation(n,this.$el,"opacity",0,o.duration)):(n=e.Deferred().resolve(),this.$el.css({display:"none",opacity:0})),n.done(function(){s&&s()}),n},setupSub:function(e,t,i,s){s=s||{};var n=this.subviews[e];n||(this.subviews[e]=n=[]),this.$(t).each(function(e,t){s.el=t,n.push(new i(s))})}});return a}),define("utils",["jquery","underscore"],function(e,t){"use strict";var i=function(){this.storage={},this.set("DEBUG",!0),this.set("document",e(document)),this.set("win",e(window)),this.set("body",e("body")),this.set("scrollEl",e("html,body")),this.set("doc",e(document))};return i.prototype={set:function(e,t){this.storage[e]=t},get:function(e){return this.storage[e]},getPageUrl:function(){return this.getOrigin()+window.location.pathname},getOrigin:function(){return window.location.protocol+"//"+window.location.host},getPathname:function(){return window.location.pathname},getScrollPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},parsePageInfo:function(e){return JSON.parse(e.find(".pageinfo").eq(0).html()||"{}")},_loadedScripts:{},loadScript:function(e,t,i){return this._loadedScripts[t]=this._loadedScripts[t]||this._requireScript(e,t),this._loadedScripts[t].done(i)},_requireScript:function(t,i){return e.Deferred(function(e){require([t],function(){var s=window[i];s?e.resolve(s):e.reject("Missing symbol: "+i+" from script: "+t)},e.reject)}).fail(function(e){console.error(e)})},openPopup:function(e,t,i){t=t||600,i=i||400;var s=this.popupCoords(t,i);window.open(e,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height="+i+",width="+t+",top="+s.top+",left="+s.left)},isValidUrl:function(e){if(!e)return!1;if(-1!==e.indexOf("mailto:"))return!0;if(-1!==e.indexOf("javascript:"))return!1;if("#"===e[0]){if(1===e.length)return!1}else if(-1!==e.indexOf("../")||"/"!==e[0]&&-1===e.indexOf("://"))return console.error("Attempting to load a relative url, bad code monkey! ("+e+")"),!1;return!0},getNested:function(e,i){return e?(i=Array.prototype.slice.call(arguments,1),t.reduce(i,function(e,t){return e&&e[t]},e)):void 0},flag:function(e){return this.getNested(window.site_vars,"flags",e)},getSiteSections:function(){var e=this.getNested(window.site_vars,"sections")||"";return e?e.split("|"):[]},popupCoords:function(e,t){var i=window.screenLeft?window.screenLeft:window.screenX,s=window.screenTop?window.screenTop:window.screenY,n=window.outerWidth?window.outerWidth:document.documentElement.clientWidth,o=window.outerHeight?window.outerHeight:document.documentElement.clientHeight;return{left:i+n/2-e/2,top:s+o/2-t/2-25}},addCommas:function(e){e+="";for(var t=e.split("."),i=t[0],s=t.length>1?"."+t[1]:"",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");return i+s},passiveSupported:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(i){}return e},lazyLoadImage:function(i,s,n,o,a){var r=!1,l="data-srcset";return s=s||"data-src",i.each(t.bind(function(t,i){var h=e(i),d=h.attr(s),c=h.attr("src"),u=h.attr(l),p=h.attr("srcset");d&&c!==d&&(this._attachHandler("error",h,o),this._attachHandler("load",h,a),h.attr("src",d),u&&p!==u&&h.attr("srcset",u),n||(h.removeAttr(s),u&&h.removeAttr(l)),r=!0)},this)),r},_attachHandler:function(e,t,i){var s=function(){t.off(e,s),"error"===e&&t.hide(),i&&i(t)};t.on(e,s)},getSectionPath:function(e){if(e&&(e=this._stripQueryParams(e)),e&&"/"!==e){"/"===e[0]&&(e=e.substring(1));var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}return"home"},getSubSection:function(e){if(e){e=this._stripQueryParams(e),"/"!==e[e.length-1]&&(e+="/");var t=e.indexOf("/",1),i=e.indexOf("/",t+1);if(-1!==t&&-1!==i)return e.substring(t+1,i)}return""},_stripQueryParams:function(e){var t=e.indexOf("?");return-1!==t&&(e=e.substring(0,t)),e},lazyLoadError:function(t){e(this).hide(),t&&t(e(this))},requireSingleUseScript:function(i){return e.Deferred(function(e){require([i],function(t){e.resolveWith(this,[t])},function(t){console.error("failed loading scripts",t),e.reject(t)})}).always(t.bind(function(){this.removeRequireModule(i)},this)).promise()},removeRequireModule:function(t){require.undef(t),e('script[data-requiremodule="'+t+'"]').remove()},getUrlParam:function(e){var t=decodeURI((new RegExp(e+"=(.+?)(&|$)").exec(window.location.search)||[0,!1])[1]);return"false"===t?!1:"true"===t?!0:t},getSessionData:function(e,t){var i=sessionStorage[e];return i&&JSON.parse(i)||t},setSessionData:function(e,i){t.isString(i)||(i=JSON.stringify(i)),sessionStorage.setItem(e,i)},clearSessionData:function(e){sessionStorage.removeItem(e)},isDocumentHidden:function(){return document.hidden||document.webkitHidden||document.mozHidden||document.msHidden||document.oHidden},appendHashParams:function(e,i,s){if(i&&"string"==typeof e){var n=e.split("#"),o="",a=0;t.each(i,function(e,t){o+=(a>0?"&":"")+(s?s+"_":"")+t+"="+e,a++}),e=n[0]+"#"+o+(n[1]?"&"+n[1]:"")}return e},removeHashParamsByPrefix:function(e,t){if("string"==typeof e&&"string"==typeof t){for(var i=("#"===e[0]?e.substr(1):e).split("&"),s=i.length;s--;)i[s].substring(0,t.length)===t&&i.splice(s,1);return"#"+i.join("&")}return e},removeHashParamsFromCurrentUrl:function(e){if(window.location.hash.indexOf(e)){var t=this.removeHashParamsByPrefix(window.location.hash,e);t.length>1?window.location.hash=t:window.history&&window.history.replaceState&&history.replaceState("",document.title,window.location.pathname+window.location.search)}},isElementInViewport:function(t){t instanceof e&&(t=t[0]);var i=t.getBoundingClientRect(),s=window.innerHeight||document.documentElement.clientHeight,n=window.innerWidth||document.documentElement.clientWidth,o=i.top<=s&&i.top+i.height>=0&&i.left<=n&&i.left+i.width>=0;return i.left>=0&&i.top>=0&&i.left+i.width<=n&&i.top+i.height<=s?"full":o?"partial":"outside"},hasAutoplayVideo:function(e){return"video"===e.priority_asset||"video-asset"===e.basePageType||"SmallPlayerForPriorityVideo"===e["web-template"]||t.where(e.js_modules,{oembedprovider:"Inform, Inc."}).length},scrubEmail:function(e){var t=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/gi;return String(e).replace(t,"")},checkForEmail:function(e){var t=/@/gi;return e.match(t)?!0:!1},logAction:function(e,t){try{window.newrelic.addPageAction(e,t)}catch(i){}}},new i}),function(e){"function"==typeof define&&define.amd?define("cookie",["jquery"],e):e("object"==typeof exports?require("jquery"):jQuery)}(function(e){function t(e){return r.raw?e:encodeURIComponent(e)}function i(e){return r.raw?e:decodeURIComponent(e)}function s(e){return t(r.json?JSON.stringify(e):String(e))}function n(e){0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return e=decodeURIComponent(e.replace(a," ")),r.json?JSON.parse(e):e}catch(t){}}function o(t,i){var s=r.raw?t:n(t);return e.isFunction(i)?i(s):s}var a=/\+/g,r=e.cookie=function(n,a,l){if(arguments.length>1&&!e.isFunction(a)){if(l=e.extend({},r.defaults,l),"number"==typeof l.expires){var h=l.expires,d=l.expires=new Date;d.setTime(+d+864e5*h)}return document.cookie=[t(n),"=",s(a),l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}for(var c=n?void 0:{},u=document.cookie?document.cookie.split("; "):[],p=0,f=u.length;f>p;p++){var g=u[p].split("="),m=i(g.shift()),v=g.join("=");if(n&&n===m){c=o(v,a);break}n||void 0===(v=o(v))||(c[m]=v)}return c};r.defaults={},e.removeCookie=function(t,i){return void 0===e.cookie(t)?!1:(e.cookie(t,"",e.extend({},i,{expires:-1})),!e.cookie(t))}}),define("abtest-manager",["jquery","underscore","utils","pubsub","cookie"],function(e,t,i,s){"use strict";var n=function(){this.userTestSlot=0,this.slotKey="ab_test_slot"};return n.prototype={start:function(e){this.pubSub={"activePageInfo:set":this._onActivePageInfoSet},s.attach(this.pubSub,this),this.userTestSlot=this._getUserTestSlot(),this.initialPath=window.location.pathname,this.processPageInfo(e)},stop:function(){s.unattach(this.pubSub,this),this._clearUserTestSlot(),this.userTestSlot=0,this.tests=[]},processPageInfo:function(e){e=e||{},this._processTests(e),e.user=e.user||{},e.user.abTestSlot=this.userTestSlot,e.user.abTest=this.getUserTest()},_onActivePageInfoSet:function(e){i.getNested(e,"routePath")!=this.initialPath?this.processPageInfo(e):this.initialPath=null},getTests:function(){return this.tests},getCurrentTests:function(){return this.currentTests},getTestById:function(e){return t.find(this.getTests(),function(t){return t.id===e})},getTestByVariant:function(e){return t.find(this.getTests(),function(i){return t.find(i.variants,function(t){return t.id===e})})},getUserTests:function(){return this.userTests},getUserTest:function(){return this.userTest},getUserTestByTargetAndPath:function(e,i){return t.find(this.userTests,function(t){return t.testTarget===e?new RegExp(t.urlRegex).test(i):void 0})},getUserTestByTarget:function(e){return i.getNested(this.userTest,"testTarget")===e?this.userTest:void 0},_isUserInVariantRange:function(e){return e.trafficRange&&this.userTestSlot>=e.trafficRange.start&&this.userTestSlot<=e.trafficRange.end},_processTests:function(s){this.tests=s.abtests||[],this.currentTests=[],this.userTests=[],this.userTest=null,t.each(this.tests,function(n){var o=this._isTestCurrent(n);if(t.each(n.variants,function(t){var a;t.id===s.headerAbVariant&&(a=n.isHeaderVariantTest=!0);var r=a||o&&this._isUserInVariantRange(t);r&&(n.userVariant=t,n.userVariant.options=e.extend(!0,i.getNested(n,"defaultVariantOptions"),i.getNested(t,"options"))),t.control===!0&&(n.controlVariant=t)},this),n.userVariant){this.userTests.push(n);try{(n.isHeaderVariantTest||new RegExp(n.urlRegex).test(window.location.pathname))&&(this.userTest=n)}catch(a){return!1}}o&&this.currentTests.push(n)},this)},_getUserTestSlot:function(){return this._readUserTestSlot()||this._setUserTestSlot()},_readUserTestSlot:function(){return JSON.parse(window.localStorage.getItem(this.slotKey))},_setUserTestSlot:function(){var e=Math.floor(100*Math.random())+1;try{window.localStorage.setItem(this.slotKey,JSON.stringify(e))}catch(t){console.error("Failed saving userTestSlot",t.stack||t.stacktrace||t.message)}return e},_clearUserTestSlot:function(){window.localStorage.removeItem(this.slotKey)},_isTestCurrent:function(e){var t=new Date;return new Date(e.endTime)>t&&new Date(e.startTime)<t}},window.abTestManager=new n,window.abTestManager}),define("modules/global/alert",["jquery","underscore","pubsub"],function(e,t,i){var s=function(){};return s.prototype={render:function(){this.$alert||(this.$alert=e('<div class="ui-alert"><span class="text"></span><span class="close-btn">Close</span></div>').appendTo(e("body")),this.$alertText=this.$alert.find(".text"),this.$alert.on("click",".close-btn",t.bind(function(){this.hide()},this)))},show:function(e){this.render(),i.trigger("show:alert"),this.$alertText.html(e),this.$alert.addClass("active").removeClass("error")},hide:function(){i.trigger("hide:alert"),this.$alert.removeClass("active error")},showError:function(e){this.render(),i.trigger("show:error:alert"),this.$alertText.html(e),this.$alert.addClass("active error")}},new s}),define("managers/requestmanager",["jquery","underscore","managers/trafficcop","utils"],function(e,t,i,s){var n=function(){this.DEBUG=!0,this.xhrList=[],this.intervalList=[]};return e(document).ajaxSend(function(t,i,s){"post"===s.method&&i.setRequestHeader("X-CSRFToken",e.cookie("csrftoken"))}),n.prototype={timeout:3e4,fetchHtml:function(e,t,i,s){return this.fetchData(e,t,i,s,!0)},persistentFetchHtml:function(e,t,i,s){return this.fetchData(e,t,i,s,!0,!0)},recurringFetchHtml:function(e,t,i,s,n){return this.recurringFetchData(e,t,i,s,n,!0)},recurringFetchData:function(e,i,s,n,o,a){var r=t.bind(function(){this.fetchData(e,i,!1,o,a).done(function(e){n(e)})},this);r();var l=setInterval(r,s);return this.intervalList.push(l),l},fetchData:function(i,s,n,o,a,r){s=this._setupRequest(i,s,o);var l=e.Deferred();this._startRequest(l,s,n,a,void 0,r);var h=l.promise();return h.abort=t.bind(function(){l.reject()},this),h},persistentFetchData:function(e,t,i,s,n){return this.fetchData(e,t,i,s,n,!0)},_setupRequest:function(t,i,s){var n={};return s&&(n["X-PJAX"]="true",n["X-PJAX-Container"]="#overlay"),t?0!==t.indexOf("/")&&0!==t.indexOf("http")&&(t="/"+t):t="/",i=e.extend({url:t,data:{ajax:!0},beforeSend:function(t){e.each(n,function(e,i){t.setRequestHeader(e,i)})},timeout:this.timeout},i)},_startRequest:function(t,s,n,o,a,r){var l=this._initializeFetchData(s.url,n,r);if(!l)return void t.reject();var h=t.promise().ajaxPromise=e.ajax(s);this.DEBUG&&h.fail(function(e){e.statusText&&"abort"!==e.statusText&&console.log("fetchData Error: ",e.statusText,s)}),t.fail(function(){"pending"===h.state()&&h.abort()}),h=i.addRequest(h),this._registerNavRequests(h,t,s.url,n,r),n?this._resolveNavAjax(h,t,s,n,o,a):this._resolveAjax(h,t,o)},_refreshPage:function(){window.location=window.location},_resolveNavAjax:function(e,i,s,o,a,r){e.done(t.bind(function(){var t=e.original.getResponseHeader("X-Firefly-Session-Needed"),n=e.original.getResponseHeader("X-Gannett-Site-Version");t?this._handleFireflyAuth(t,i,s,o,a,r):n&&window.site_static_version!==n&&!s.ignoreVersionCheck?this._refreshPage():this._resolveAjax(e,i,a)},this)).fail(function(){n.prototype._resolveAjax(e,i,a)})},_handleFireflyAuth:function(e,i,s,n,o,a){if(a)console.error("Auth failed, X-Firefly-Session-Needed appeared on refetch"),i.reject("NOT AUTHORIZED");else{console.log("Requesting FIREFLY Auth");var r=this._getFireflyAuth(e).done(t.bind(function(){console.log("FIREFLY Auth Successful, requesting original asset"),this._startRequest(i,s,n,o,!0)},this)).fail(function(e,t){i.reject(e,t)});i.fail(function(){r.reject()})}},_resolveAjax:function(e,t,i){e.done(function(s){i&&(s=n.prototype._toHtml(s)),t.resolveWith(e,[s])}).fail(function(i){t.rejectWith(e,[i])})},_toHtml:function(t){var i=document.createDocumentFragment(),s=document.createElement("div");return s.innerHTML=t,i.appendChild(s),e(i).children().children()},_getFireflyAuth:function(i){var n,o=Math.floor(1e3*Math.random()),a=this._createFireflyiFrame(i);return e.Deferred(t.bind(function(t){n=setTimeout(function(){console.error("Auth timeout occurred"),t.reject("NOT AUTHORIZED","Request Timed Out")},this.timeout),e(window).on("message.rqman"+o,function(e){if(e=e.originalEvent,e.origin===s.getOrigin())try{var i=JSON.parse(e.data);if("firefly-auth"!==i.type)return;if("success"===i.auth)return void t.resolve(i);t.reject("NOT AUTHORIZED",i)}catch(n){}})},this)).always(function(){clearTimeout(n),e(window).off(".rqman"+o),document.body.removeChild(a)})},_createFireflyiFrame:function(e){var i=document.createElement("iframe");return i.id=i.name=t.uniqueId("firefly_auth_"),i.className="hidden",i.src=e,document.body.appendChild(i),i},_registerNavRequests:function(e,i,s,n,o){var a={ajaxPromise:e,resultDeferred:i,url:s,isNav:n,isPersistent:o};this.xhrList.push(a),
e.always(t.bind(function(){this.xhrList=t.without(this.xhrList,a)},this))},_initializeFetchData:function(e,t,i){var s=1==this.xhrList.length&&this.xhrList[0],n=s&&s.isNav;if(i)return!0;if(t){if(n&&s.url===e)return!1;this.abortAllRequests()}else if(n)return!1;return!0},abortAllRequests:function(){t.each(this.xhrList,function(e){e.isPersistent||(e.ajaxPromise.abort(),e.resultDeferred.reject())}),t.each(this.intervalList,function(e){clearInterval(e)}),this.xhrList=t.where(this.xhrList,{isPersistent:!0}),this.intervalList=[]},done:function(){return e.when(this.xhrList)}},new n}),define("mergedSiteConfig",[],function(){return{require:{paths:{chosen:"libs/jquery/plugins/chosen.jquery.min",bxslider:"libs/jquery/plugins/jquery.bxslider.min",touchswipe:"libs/jquery/plugins/jquery.touchSwipe"},shim:{"libs/flot/jquery.flot.usat.pie":["libs/flot/jquery.flot"],"libs/flot/jquery.flot.multibars":["libs/flot/jquery.flot"],touchswipe:["jquery"],chosen:["jquery"],"libs/flot/jquery.flot.orderBars":["libs/flot/jquery.flot"],bxslider:["jquery"],"libs/flot/jquery.flot.usat.style":["libs/flot/jquery.flot"],"libs/flot/jquery.flot":["jquery","libs/flot/excanvas"]}},global:{modules:["modules/global/header","analytics/settealium","user-accounts/facebook-user-account","user-accounts/googleplus-user-account","abtest-manager","template-manager"],pubSub:{openFullScreenCarousel:["modules/carousel/carousel-fullscreen"]}},apps:{"contact-us-staff":{path:"apps/contact-us-staff",css:"apps/contact-us-staff"},Interactives:{path:"apps/interactives",selector:"#interactive"},Overlay:{path:"apps/simple-overlay",css:["story-article","story-grid","story-navbar","blog-story-article","stories/sponsored-series","stories/story-right-rail"],overlay:!0},"Overlay-with-footer":{path:"apps/simple-overlay",init_modules:[{name:"footer"}],overlay:!0},Blog:{path:"blog/blog-front",init_modules:[{name:"footer"}],css:["blog","blog/blog-default"]},"member-guide-apps":{path:"apps/member-guide-apps",css:"apps/member-guide"},Users:{path:"base-app",selector:".something"},"member-guide-social":{path:"apps/member-guide-social",css:"apps/member-guide"},MediaView:{path:"apps/media",css:"media-view",header:{fixed:!0,open:!1}},Search:{path:"apps/search",css:"modules/search",header:{fixed:!0,open:!0}},StaffCMS:{path:"base-app",init_modules:[{name:"staff-listing"}],css:["pages/staff-listing"]},BigPage:{path:"apps/bigpage",css:"bigpage",header:{fixed:!0,open:!1}},BaseApp:{path:"base-app"},Error:{path:"apps/404",css:"404",overlay:!0},Cards:{path:"apps/cards/cards",init_modules:[{name:"footer"},{name:"sidebar"},{name:"taboola-recommendations"}],css:["cards","sidebar","no-sidebar"]},"Overlay-with-arrows":{path:"apps/overlay/overlay",init_modules:[{name:"utility-bar"},{name:"recommended-flyout"}],overlay:!0},StaffBio:{path:"apps/stag-front",init_modules:[{name:"footer"},{name:"headline-grid"}],css:["pages/staff"]},"Interactive-Overlay":{path:"apps/overlay/overlay",selector:"#interactive",overlay:!0},Topics:{path:"apps/topics",init_modules:[{name:"footer"}],css:["stag","apps/topics/topics-page-automated"]},longform:{path:"base-app",css:"longform/longform-article",header:{fixed:!0,open:!1}},"featured-newsletter":{path:"apps/featured-newsletter",css:["apps/featured-newsletter"],header:{fixed:!0,open:!1}},"member-guide":{path:"apps/member-guide",css:"apps/member-guide"},"Overlay-with-utility-bar":{path:"apps/simple-overlay",init_modules:[{name:"utility-bar"}],css:["utility-bar"],overlay:!0}},version:2,pages:[{path:"apps/overlay/pages/contact-us-overlay",init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"ContactUs",urls:["^(contactus.*)$"],appName:"Overlay"},{path:"apps/overlay/pages/interactive-overlay",name:"Web to Watch",urls:["^(tv/web-to-watch.*|interactives/tv-on-the-web.*)$"],appName:"Overlay"},{init_modules:[{name:"static-story-expand-faq"},{name:"footer"}],name:"StaticContent",urls:["^(social-player.*|shop.*|about.*|rss.*|mobile-apps.*|mediakit.*|press-bios.*|reporters.*|legal.*|editorial-policy.*|conversation-guidelines.*|interactives/tv-on-the-web.*)$"],appName:"Overlay"},{urls:["^(life/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Life",css:["life"],appName:"Cards"},{hosturls:{"puzzles.usatoday.com":["^(|crossword|dont-quote-me|minisudoku|quickcross|sudoku|upanddown|wordroundup)/*$"]},name:"Puzzles Flash legacy",appName:"Overlay",urls:["^((puzzles/legacy)(|/.*))$"],path:"apps/overlay/pages/puzzles-overlay",preloadedUrl:"http://www.usatoday.com/life/",css:["puzzles"]},{init_modules:[{name:"snapshots"}],name:"Home",urls:["^()$","^(index.html)$","^(home/flex.*)$"],appName:"Cards"},{init_modules:[{name:"taboola-recommendations"}],name:"Photo Asset",urls:["^((photos|picture-gallery)/.*/)$"],appName:"Overlay-with-arrows"},{init_modules:[{name:"taboola-recommendations"},{name:"piano-video"}],name:"Video Asset",urls:["^videos/.*/$"],appName:"Overlay-with-arrows"},{name:"Sports Player",appName:"Overlay-with-utility-bar",urls:["^(sports/[a-zA-Z]+/player/.*)$"],path:"apps/overlay/pages/player-overlay",preloadedUrl:"/sports/",init_modules:[{name:"gallery"},{name:"sports-datatables"},{name:"sports-more-teams-college"}],css:["sports","sports-logos"]},{name:"Sports Olympics Widgets",appName:"Cards",urls:["^(sports/olympics/[a-zA-Z0-9]+/(medals|schedule)/)$","^(sports/olympics/[a-zA-Z0-9]+/(medals|schedule)/[0-9\\-]+/[a-zA-Z0-9]+/[a-zA-Z0-9]+/)$","^(sports/services/rightrail/olympics/[a-zA-Z0-9]+/[a-zA-Z0-9]+/)$"],path:"apps/cards/pages/sports-card",preloadedUrl:"/sports/",init_modules:[{name:"sports-olympics-schedule-results"},{name:"sports-filters"},{name:"sports-nav"},{name:"sports-jumptotop"}],css:["sports","sports-logos"]},{name:"Sports Olympics Profile Overlay",appName:"Overlay-with-utility-bar",urls:["^(sports/olympics/[a-zA-Z0-9]+/(athletes|countries)/[a-zA-Z0-9-]+/.*)$"],path:"apps/cards/pages/sports-card",preloadedUrl:"/sports/",init_modules:[{name:"gallery"},{name:"sports-olympics-profile-overlay"}],css:["sports","sports-logos"]},{name:"Sports BoxScores",appName:"Overlay",urls:["^(sports/[a-zA-Z]+/game/.*)$","^(sports/[a-zA-Z]+/event/.*)$","^(sports/soccer/[a-zA-Z]+/event/.*)$"],path:"apps/overlay/pages/boxscore-overlay",preloadedUrl:"/sports/",init_modules:[{name:"gallery"}],css:["sports","sports-logos"]},{name:"Sports Story Overlay",appName:"Overlay-with-arrows",urls:["^(story/sports/.*)"],path:"apps/overlay/pages/sports-story-overlay",preloadedUrl:"/sports/",init_modules:[{name:"iframe-auto-height"},{name:"taboola-recommendations"},{name:"nfl-unitedway"}],css:["sports","sports-logos"]},{name:"Sports",appName:"Cards",urls:["^(sports/[a-zA-Z0-9%\\-/\\.#]*)$"],path:"apps/cards/pages/sports-card",init_modules:[{name:"sports-filters"},{name:"scores-page"},{name:"sports-leagues"},{name:"sports-nav"},{name:"sports-player-news"},{name:"sports-popup"},{name:"sports-jumptotop"},{name:"sports-datatables"},{name:"sports-leader-rotate"},{name:"gallery"},{name:"utility-bar"},{name:"sports-event-tool"},{name:"sports-ballots"},{name:"sports-brackets"},{name:"sports-data-video"}],css:["sports","sports-logos"]},{urls:["^(topic/.*/video-big-board/)$"],init_modules:[{name:"sports-video"},{name:"sports-featured-content"},{name:"utility-bar"}],name:"Video Big Board",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/fantasy-football-week-in-america/)$"],init_modules:[{name:"sports-video"}],name:"Fantasy Football Week In America",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/fantasy-football-draft-kit/)$","^(topic/.*/spanning-the-sec/)$"],name:"Sports Topic Pages Without Init Modules",css:["sports","sports-logos"],appName:"Topics"},{urls:["^(topic/.*/2014-olympic-(.+)s/)$"],init_modules:[{name:"sports-popup-media-view"}],name:"Sports Topic Pages With Popup Media View",css:["sports","sports-logos"],appName:"Topics"},{init_modules:[{name:"video"}],name:"Default",urls:["^(media/.*)$"],appName:"MediaView"},{name:"Default",urls:["^(topic/.*)$"],appName:"Topics"},{name:"Default",urls:["^(blog/.*)$"],appName:"Blog"},{urls:["^(blogs/)$"],name:"BlogsIndex",css:["blogs-index"],appName:"Cards"},{name:"Default",urls:["^(blog/.*)$"],appName:"Blog"},{urls:["^(life/books/best-selling/.*)$"],name:"Best Selling Book List",css:["book-reviews"],appName:"Cards"},{name:"Book Review Detail Page",appName:"Overlay-with-arrows",urls:["^(story/life/books/.*)$"],path:"apps/overlay/pages/story-overlay",preloadedUrl:"/life/books/",init_modules:[{name:"booksAssetView"},{name:"taboola-recommendations"},{name:"form-dropdown"}],css:["book-reviews"]},{path:"apps/overlay/pages/story-overlay",init_modules:[{name:"iframe-auto-height"},{name:"taboola-recommendations"},{name:"myCapture"}],name:"Story",urls:["^((story|article)/.*/)$"],appName:"Overlay-with-arrows"},{path:"modules/longform/longform",init_modules:[{name:"longform-navigation"},{name:"longform-share"},{name:"longform-nav-rail-bucket"},{name:"longform-arrow"},{name:"longform-poster-ad-bottom"},{name:"longform-fullsize-gallery"}],name:"Longform",urls:["^(wide-story/.*)$","^(longform/.*)$"],appName:"longform"},{path:"apps/overlay/pages/interactive-overlay",name:"Interactive Overlay",urls:["^interactive/.+/\\d{4}/\\d{2}/\\d{2}/([^/]*/)?(\\d{1,32})/$"],appName:"Interactive-Overlay"},{path:"apps/overlay/pages/interactive-overlay",name:"Interactive",urls:["^interactive/\\d{1,32}/(embed/)?$"],appName:"Interactives"},{name:"Flight Tracker",appName:"Overlay-with-utility-bar",urls:["^(travel/flight-tracker/.*)$"],path:"apps/overlay/pages/flight-tracker-overlay",preloadedUrl:"travel/",css:["map"]},{init_modules:[{name:"footer"}],name:"Travel",urls:["^(travel/[a-zA-Z0-9%\\-/\\.#]*)$"],appName:"Cards"},{path:"modules/polldaddy-poll",urls:["^(polls/.*)$"],name:"Poll",css:["polldaddy"],appName:"Overlay-with-utility-bar"},{name:"Default",urls:["^(search/.*)$"],appName:"Search"},{name:"Default",urls:["^(big-page/.*)$"],appName:"BigPage"},{name:"Money Overlay",appName:"Overlay",urls:["^(money/(economic-calendar|etfs|funds|markets|stocks|lookup|watchlist)/.*/)$","^(money/watchlist/)$"],preloadedUrl:"/money/",init_modules:[{name:"form-dropdown"}],css:["money"]},{urls:["^(money/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Money",css:["money"],appName:"Cards"},{name:"Sports Employee Directory",urls:["^(staff/listing/.*)$","^(staff/record/.*)$"],appName:"StaffCMS"},{name:"Default",urls:["^(staff/.*)$"],appName:"StaffBio"},{header:{fixed:!0,open:!1},urls:["^(memberguide/social/?)$"],name:"Member Guide Social",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide-social"},{header:{fixed:!0,open:!1},urls:["^(memberguide/apps/?)$"],name:"Member Guide Apps",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide-apps"},{header:{fixed:!0,open:!1},urls:["^(memberguide/.*)$"],name:"Member Guide",viewport:"width=device-width, initial-scale=1.0",appName:"member-guide"},{urls:["^(contact/staff/?)$"],name:"Contact Us Staff",viewport:"width=device-width, initial-scale=1.0",appName:"contact-us-staff"},{name:"Default",urls:["^(featured-newsletter/.*)$"],appName:"featured-newsletter"},{name:"CatchAll",urls:["^(errors/.*)$","^(404.html)$"],appName:"Error"},{name:"Puzzles Html5 Legacy Overlay",appName:"Overlay",urls:["^(puzzles/(crossword|sudoku|roundup|upanddown).*)$"],path:"apps/overlay/pages/puzzles-oldhtml5-overlay",preloadedUrl:"/life/",css:["life","puzzles"]},{path:"apps/cards/pages/weather-card",urls:["^(weather/[a-zA-Z0-9%\\-/\\.]*)$"],name:"Weather",css:["weather"],appName:"Cards"},{css:["users"],name:"Profile Page",urls:["^(profile/[0-9]+/)$"],appName:"Users"},{css:["firefly"],name:"Not Authorized",urls:["^get-access/","^restricted/"],appName:"Overlay"},{name:"Generic Section",urls:["^({{sections}})$","^({{sections}})/.*$","^$","^index.html$","^section/[a-zA-Z0-9%_\\-/\\.]*$"],appName:"Cards"},{name:"Static Page",appName:"Overlay-with-utility-bar",header:{fixed:!0,open:!1},ajax:!1,urls:["^pages/.*$"],path:"pages/static_page"}],siteModules:{"scores-page":{path:"modules/sports/scorespage",selector:"#scorespage"},"sports-more-teams":{path:"modules/sports/sports-more-teams"},"sponsor-story-topbar":{},"story-headline":{},"interactive-poll":{path:"modules/interactive-poll",selector:".interactive-poll"},sigfig:{},"site-nav-firefly-module":{path:"modules/users/site-nav-firefly-module",selector:".site-nav-firefly-module"},"travel-featured-content":{path:"modules/travel/travel-featured-content"},"sports-data-video":{path:"modules/sports/sports-data-video",selector:".sp-data-video"},"utility-bar-module-firefly":{path:"modules/stories/utility-bar-module-firefly",selector:".util-bar-module-firefly"},"sports-popup":{path:"modules/sports/popup-details",selector:"#section_sports"},"ggm-jobs-latest":{},quicklinks:{},"shermans-deals":{path:"modules/travel/shermans"},"video-playlist":{path:"modules/videos/video-playlist-init",selector:".video-gallery"},"rentals-listing-row":{path:"modules/rentals-listing-row"},"topics-videos":{path:"modules/topics/topics-videos"},"popular-on-social":{},sidebar:{path:"modules/sidebar",selector:"#card_full_width_main"},"sidebar-poster-ad":{path:"modules/fronts/sidebar-poster-ad",selector:".partner-sidebar-ad"},"travel-guides":{path:"modules/travel/travel-guides"},"blog-promo":{path:"modules/fronts/blog-promo"},essentials:{},"360video":{path:"modules/videos/pluto/pluto-wrapper",selector:".js-ui-video-init"},"2016-election-results-map":{path:"modules/fronts/election-results-map"},"sports-olympics-countdown":{path:"modules/sports/sports-countdown"},"expandable-photo":{path:"modules/stories/expandable-photo"},"bounce-exchange":{path:"modules/stories/bounce-exchange"},"top-stories":{},"sports-pulse":{path:"modules/partner/sponsor-logo-ad",selector:".sponsor-logo"},"travel-dest-nav":{path:"modules/travel/travel-dest-nav"},"home-finder-featured":{path:"modules/home-finder/home-carousel"},"dynamic-video-playlist":{path:"modules/videos/video-playlist-init",selector:".video-gallery"},"headline-list":{},"longform-inline-share":{path:"modules/longform/longform-inline-share"},piano:{path:"modules/stories/piano"},"social-media-facebook-cta":{},"home-finder-search":{path:"modules/home-finder/home-search"},usanow:{},"more-blogs":{},interactive_beforeandafter:{path:"modules/interactives/before-after",selector:".interactive.before-after"},"assigned-content-nav":{path:"modules/fronts/assigned-content-nav"},"sports-more-teams-college":{path:"modules/sports/sports-more-teams-college",selector:"#sp-more-teams-slider"},"sports-scores-suspender-des":{path:"modules/sports/sports-scores-suspender",selector:"#scores"},"section-header-blog":{},"sports-syndication-hero":{},puzzles:{},"longform-footer-copyright":{},"featured-content-with-advertising":{path:"modules/fronts/sidebar-poster-ad",selector:".poster-ad-primary"},"sports-datatables":{path:"modules/sports/sports-datatables",selector:"#section_sports"},"blogs-index-latest-hero":{},"feedback-opinionlabs":{path:"modules/feedback-opinionlabs/feedback-opinionlabs"},"leaderboard-ad":{path:"modules/partner/leaderboard-ad",selector:".leaderboard-ad"},"travel-trends":{},"ggm-mil-mall-promo":{},"assigned-content":{path:"modules/stories/assigned-content"},"rentalslite-search":{path:"modules/rentalslite-search"},"sports-leader-rotate":{path:"modules/sports/sports-leader-rotate",selector:".sp-leader-rotate"},"taboola-poster-asset":{path:"modules/partner/taboola-poster-asset"},"ggm-jobs-search":{path:"modules/ggm-jobs-search/ggm-jobs-search"},"static-story-expand-faq":{path:"modules/stories/expand-faq",selector:".static-page-faq"},"ggm-earlybird-signup":{},"sports-olympics-medals":{path:"apps/overlay/pages/olympics-widgets"},"flight-tracker":{path:"modules/travel/flight-search"},"front-list":{path:"modules/fronts/front-list"},"sponsored-series-topbar":{path:"modules/stories/sponsored-series-topbar",selector:".sponsored-series-bar"},map:{path:"modules/map/map",selector:".mapboxWrap"},"headline-list-blog":{path:"modules/fronts/headline-list-blog"},booksthreeup:{path:"modules/book-reviews/books-three-up",selector:".module-books-three-up"},twitter:{path:"modules/twitter"},"car-search":{path:"modules/car-search",selector:".car-search-module-wrap"},"market-symbol-search":{path:"modules/money/market-symbol-search"},interactive_piechart:{path:"modules/interactives/pie-chart",selector:".interactive.pie-chart"},"sports-nav":{path:"modules/sports/sports-nav",selector:".sp-nav-wrap"},video:{path:"modules/videos/video-init",selector:".js-ui-video-init"},"feed-stories":{path:"modules/feed-stories/feed-stories"},"sports-news":{path:"modules/sports/sports-news"},"featured-content":{path:"modules/fronts/featured-content"},"elections-primaries-2016":{},"sports-video":{path:"modules/sports/sports-video",selector:".hero-3up"},"rentals-local-rentals":{path:"modules/rentals-local-rentals"},"rentalslite-ads":{path:"modules/rentalslite-ads"},"related-topics-embed-stories":{},"longform-byline":{},"rentals-header":{},"sports-olympics-schedule-results":{path:"apps/overlay/pages/olympics-schedule-results",selector:".olympics-schedule"},"longform-series-bottom":{path:"modules/longform/longform-series-bottom",selector:".series-bucket-wrapper"},"section-header-elections-2016":{},"market-tool-links":{},"featured-events":{path:"modules/featured-events/featured-events"},"utility-bar-module-share":{path:"modules/stories/utility-bar-module-share",selector:".util-bar-module-share"},"front-galleries":{path:"modules/fronts/front-galleries"},taboola:{path:"modules/stories/taboola-recommendations"},hotelme:{path:"modules/travel/hotelme",selector:".hotelme-wrapper"},"site-nav-social-module":{path:"modules/header/site-nav-social-module",selector:".site-nav-social-module"},"headline-text-grid":{},"longform-headline":{},"recommended-flyout":{path:"modules/stories/recommended-flyout",selector:".recommended-flyout-container"},"iframe-auto-height":{path:"modules/global/iframe-auto-height",selector:".iframe-auto"},"sports-team-leaders":{path:"modules/sports/sports-team-leaders"},"home-finder-ads":{path:"modules/home-finder/home-ads"},hero:{path:"modules/fronts/hero",selector:".hero"},"sports-brackets":{path:"modules/sports/sports-brackets",selector:".card-full-width.brackets"},"sports-twitter":{path:"modules/sports/sports-twitter"},"poster-ad-asset2":{path:"modules/partner/poster-ad-asset2",selector:".partner-asset-right-ad-2"},"web-twitter":{},"sports-front-galleries":{path:"modules/sports/sports-front-galleries"},"about-this-blog":{},"blog-list":{path:"blog/blog-list"},"sports-olympics-widgets":{path:"apps/overlay/pages/olympics-widgets",selector:".sports-olympics-widgets"},"topics-photo-gallery":{path:"modules/topics/topics-photo-gallery"},"longform-series-top":{path:"modules/longform/longform-featured-series",selector:".longform-top-series-bucket"},"headline-grid":{path:"modules/fronts/headline-grid"},"section-header-nation-now":{},"longform-nav-rail-bucket":{path:"modules/longform/longform-nav-rail-bucket",selector:".longform-series-flyout-bucket-wrapper"},"countdown-clock":{path:"modules/fronts/countdown-clock"},"sports-follow-usat-overlay":{path:"modules/sports/sports-follow-usat"},"topics-interactives":{},"topics-share-tools":{path:"modules/topics/topics-share-tools"},"newsletter-signup-condensed":{path:"modules/newsletter-signup-condensed/newsletter-signup-condensed",selector:".nscm-container"},"site-nav-weather-module":{path:"modules/weather/site-nav-weather-module",selector:".site-nav-weather-module"},"section-header":{},"rentals-apartments-ad":{path:"modules/rentals-apartments-ad"},"sports-video-ooyala":{path:"modules/sports/sports-video-ooyala",selector:".sports-ooyala"},"holiday-puzzles":{},"live-newscasts":{path:"modules/live-newscasts/live-newscasts"},"piano-video":{path:"modules/stories/piano",selector:".asset"},interactive_overview:{path:"modules/interactives/overview",selector:".interactive.overview"},"asset-nav-bar":{},"sports-olympics-results":{path:"apps/overlay/pages/olympics-widgets"},"trending-map":{path:"modules/trending-map/trending-map"},"topics-overview":{},oembed:{path:"modules/stories/oembed",selector:".js-oembed"},"travel-poll":{path:"modules/travel/travel-poll"},livefeed:{path:"modules/fronts/live-feed",selector:".livefeed-news-list"},"top-stories-asset":{},"sub-section-navigation":{},"sports-team-statistics":{path:"modules/sports/sports-team-leaders"},"sports-gallery":{},"travel-your-take":{},"brightcove-video":{path:"modules/videos/brightcove-video",selector:".ui-video:not('.gallery-video')"},"ggm-va-loan":{path:"modules/ggm-va-loan/ggm-va-loan"},interactive_barchart:{path:"modules/interactives/bar-chart",selector:".interactive.bar-chart"},"google-survey":{path:"modules/stories/google-survey"},header:{path:"modules/global/header",selector:".site-header"},"rentalslite-header":{},"video-carousel":{path:"modules/videos/video-playlist-init"},"ggm-classifieds-search":{},"suspender-ad":{path:"modules/fronts/suspender-ad",selector:".suspender-ad"},myCapture:{path:"modules/myCapture/myCapture",selector:".mycapture-btn-wrap"},"topics-related-tags":{},"longform-share":{path:"modules/longform/longform-share",selector:".longform-share-wrapper"},"sports-scores-suspender":{path:"modules/sports/sports-scores-suspender",selector:"#scores"},gallery:{path:"modules/carousel/carousel",selector:".galleries"},"longform-navigation":{path:"modules/longform/longform-navigation",selector:".longform-navigation-wrapper"},"newsletter-story":{path:"modules/newsletter-story/newsletter-story",selector:".newsletter-embed"},"top-stories-subsection":{path:"modules/fronts/most-popular"},"rentalslite-classified":{path:"modules/rentalslite-classified"},"travel-tools":{path:"modules/travel/travel-tools"},"vrstories-app-promo":{},"sports-syndication-headline-grid":{path:"modules/sports/sports-headline-grid"},"polldaddy-poll":{path:"modules/polldaddy-poll"},"generic-oembed":{},"hero-4-up":{path:"modules/fronts/hero",selector:".hero"},"longform-footer-logo":{},"sports-team-matchup":{path:"modules/sports/sports-team-matchup"},"sports-ballots":{path:"modules/sports/sports-ballots",selector:"#section_sports"},"travel-email":{path:"modules/travel/travel-email"},"story-byline":{},booksAssetView:{path:"apps/overlay/pages/book-reviews-overlay",selector:".books-meta-comp"},"site-nav-user-module":{path:"modules/users/site-nav-user-module",selector:".site-nav-user-module"},snapshots:{path:"modules/fronts/snapshots",selector:".front-galleries-module"},"sponsor-story-more-stories":{},"job-search":{path:"modules/money/job-search",selector:".job-search-module-wrap"},"sports-story-video":{path:"modules/sports/sports-story-video"},"sports-multipurpose-promo":{path:"modules/sports/sports-multipurpose-promo"},subscription:{},"longform-sponsor-attribution":{},"kayak-widget":{path:"modules/travel/kayak-module"},"site-nav-search-trending-module":{path:"modules/header/site-nav-search-trending-module",selector:".site-nav-search-module"},"hero-4-up-flex":{path:"modules/fronts/hero",selector:".hp4fm-primary-wrap"},"travel-experience":{path:"modules/travel/travel-experience"},"longform-poster-ad-bottom":{path:"modules/longform/longform-poster-ad-bottom",selector:".longform-poster-ad-bottom"},footer:{path:"modules/global/footer",selector:".footer"},"inline-share-tools":{path:"modules/stories/inline-share-tools",selector:".inline-share-tools"},"most-popular":{path:"modules/fronts/most-popular"},"sports-countdown":{path:"modules/sports/sports-countdown"},"sports-event-tool":{path:"modules/sports/sports-event-tool",selector:"#section_sports"},"taboola-exchange":{path:"modules/partner/taboola-exchange"},"utility-bar-module-comments":{path:"modules/stories/utility-bar-module-comments",selector:".util-bar-module-comments"},"sports-popup-media-view":{path:"modules/sports/sports-popup-media-view",selector:".content-wrap"},blogs:{path:"modules/fronts/blogs"},"story-transition-ad":{path:"modules/partner/story-transition-ad",selector:".partner-overlay"},"form-dropdown":{path:"ui/dropdown",selector:".ui-dropdown"},"social-media":{},"gannett-properties":{selector:".gannett-properties-wrapper"},"sports-latest-player-news":{path:"modules/sports/sports-latest-player-news"},"sports-jumptotop":{path:"modules/sports/sports-jumptotop",selector:"#section_sports"},"blogs-index-grid":{},"taboola-recommendations":{path:"modules/stories/taboola-recommendations",selector:"#js-taboola-wrapper"},"topics-timeline":{path:"modules/topics/topics-timeline"},"newsletter-signup":{path:"modules/newsletter-signup/newsletter-signup"},"share-facebook":{path:"modules/stories/share-facebook",selector:".util-bar-flyout-share"},"asset-sponsorship":{},"sports-featured-content":{path:"modules/fronts/featured-content"},"search-module":{path:"modules/search-module"},"longform-arrow":{path:"modules/longform/cover-photo-arrow",selector:".longform-arrow-container"},"gravy-events":{},"market-summary-search":{path:"modules/money/market-summary-search"},"slider-ad":{path:"modules/partner/slider-ad",selector:".slider-ad"},"site-nav-search-module":{path:"modules/header/site-nav-search-module",selector:".site-nav-search-module"},"big-headline":{},"sports-player-news":{path:"modules/sports/sports-player-news",selector:"#player-news-page"},"site-nav-more-module":{path:"modules/header/site-nav-more-module",selector:".site-nav-more-module"},"share-email":{path:"modules/stories/share-email",selector:".util-bar-flyout-share"},interactive_sequencer:{path:"modules/interactives/sequencer",selector:".interactive.sequencer"},"staff-listing":{path:"modules/tools/staff-listing",selector:"#section_staff"},"live-video-sidebar":{path:"modules/live-video-sidebar/live-video-sidebar"},"generic-front-header":{path:"modules/fronts/pr-front"},"sports-stn-promo":{path:"modules/sports-stn-promo/sports-stn-promo"},"more-section-stories":{},livevideo:{path:"modules/videos/brightcove-video",selector:".ui-video"},"branded-content":{},"overlay-ad":{},"hero-5-up":{path:"modules/fronts/hero",selector:".hero"},"sidebar-feed":{},"sports-tickets":{path:"modules/sports/sports-tickets"},"travel-experience-promo":{path:"modules/travel/travel-experience-promo"},"related-topics-photo-gallery-embed-stories":{},interactive_linechart:{path:"modules/interactives/line-chart",selector:".interactive.line-chart"},interactive_timeline:{path:"modules/interactives/timeline",selector:".interactive.timeline"},"poster-ad-asset":{path:"modules/partner/poster-ad-asset",selector:".partner-asset-right-ad"},"renvy-lite-search":{path:"modules/renvy-lite-search"},"series-ribbon":{path:"modules/series-ribbon/series-ribbon"},"jobs-search":{path:"modules/jobs-search/jobs-search",selector:".jobs-search-form"},"utility-bar-module-print":{path:"modules/stories/utility-bar-module-print",selector:".util-bar-module-print"},"sports-olympics-profile-overlay":{path:"apps/overlay/pages/olympics-profile-overlay",selector:".olympics-profile"},"sports-follow-usat":{},"national-news-desk":{},"generic-iframe":{},"utility-bar":{path:"modules/stories/utility-bar",selector:".utility-bar-wrap"},"section-highlights":{path:"modules/section-highlights/section-highlights"},"longform-subheadline":{},"sports-filters":{path:"modules/sports/sports-filters",selector:".sp-filter-bar-wrap"},"super-hero":{path:"modules/fronts/super-hero"},"travel-experience-featured":{path:"modules/travel/travel-experience-featured"},"vegas-experience":{},"sports-olympics-schedule":{path:"apps/overlay/pages/olympics-widgets"},"topics-scroller-ad":{},"sports-leagues":{path:"modules/sports/leagues",selector:"#section_sports"},booklist:{path:"modules/book-reviews/booklist",selector:".front-booklist-page-container"},"longform-fullsize-gallery":{path:"modules/longform/longform-fullsize-gallery",selector:".js-lfa-full-gallery"},"sports-galleries":{path:"modules/fronts/front-galleries"},"hero-6-pack":{path:"modules/fronts/hero",selector:".hero"},"nfl-unitedway":{path:"modules/sports/nfl-unitedway",selector:"#nfl-unitedway-subscribe"}}}}),define("managers/siteconfig",["jquery","underscore","mergedSiteConfig"],function(e,t,i){"use strict";var s={getSiteConfig:function(){return this.inited||(this.inited=!0,this.setupSiteConfig(i)),i},setupSiteConfig:function(e){!e.require||t.isEmpty(e.require.paths)&&t.isEmpty(e.require.shim)||require.config(e.require),s._replaceEnvVariables(e)},loadRoutes:function(){return e.Deferred(t.bind(function(e){var i=this.getSiteConfig(),s=t.pluck(i.apps,"path");require(s,t.bind(function(){var s=arguments,n=0;t.each(i.apps,function(e){e.AppClass=s[n++]}),this.urls=this._buildRoutes(i.pages,i.apps),e.resolve(this.urls)},this))},this))},_buildRoutes:function(e,i){return t.reduce(e,function(e,s){var n=i[s.appName],o=s.hosturls&&s.hosturls[location.hostname]||s.urls;return n||(s.appName&&(console.error("Invalid appName "+s.appName+" for Page "+s.name),s.appName="BaseApp"),n=i.BaseApp),s.modules=(s.init_modules||[]).concat(n.init_modules||[]),e.concat(t.map(o,function(e){var t=void 0===s.ajax&&void 0===n.ajax||void 0===s.ajax&&n.ajax===!0||s.ajax===!0;return{url:new RegExp(e),app:n,page:s,ajax:t}},this))},[])},getRouteInfo:function(i){return i&&(i=i.split("?")[0].split("#")[0],"/"===i[0]&&(i=i.substring(1)),i=e.trim(i)),null!==i&&t.find(this.urls,function(e){return e.url.test(i)})},_replaceEnvVariables:function(e){var i=t.templateSettings.interpolate;t.templateSettings.interpolate=/{{(.+?)}}/g,t.each(e.pages,function(e){if(e.urls){var i=[];t.each(e.urls,function(e){if(-1!=e.indexOf("{{")&&-1!=e.indexOf("}}"))try{e=t.template(e,window.site_vars||{})}catch(s){console.error("invalid url template: "+e),e=void 0}void 0!==e&&i.push(e)}),e.urls=i}}),t.templateSettings.interpolate=i}};return s}),define("managers/resourcemanager",["jquery","underscore","managers/siteconfig"],function(e,t,i){"use strict";var s=function(){this.initialize()};return s.prototype={initialize:function(s){s=e.extend({siteModules:i.getSiteConfig().siteModules},s),this.siteModules=s.siteModules||{},this.$stylesheets=e([]),this.stylesheets=[],this.staticUrl=window.site_static_url||"/static/",this.staticVersion=window.site_static_version||"off",e("link[data-identifier]").each(t.bind(function(t,i){var s=e(i).data("identifier");"main"!=s&&(this.stylesheets.push(e(i).data("identifier")),this.$stylesheets.push(i))},this))},fetchStyles:function(i,s,n){var o=t.difference(i,this.stylesheets),a=t.difference(this.stylesheets,i);n&&a.length&&console.log("removing styles from dom: ",a),n&&o.length&&console.log("adding styles to dom: ",o);var r=this._findStyleTags(a);this.stylesheets=i,this.$stylesheets=e(t.filter(this.$stylesheets,function(e){return!t.include(r,e)})),this._addStylesToHead(o),r.length&&s.done(function(){r.remove()})},fetchJavascript:function(i,s){return e.Deferred(t.bind(function(e){i?require([i],t.bind(function(t){this._resolveFetchJavascript(e,t,s)},this)):this._resolveFetchJavascript(e,null,s)},this)).promise()},_resolveFetchJavascript:function(e,t,i){this.fetchPageModules(i).done(function(i){e.resolve(t,i)})},fetchPageModules:function(i){return i=i||[],e.Deferred(t.bind(function(e){var s=i.length,n=[];return s?void t.each(i,function(i){n.push(i),this.getSiteModuleByName(i.name).done(function(e){i.selector=e.selector||"."+e.name+"-module",i.ModuleClass=e.ModuleClass}).fail(function(){n=t.reject(n,function(e){return e.name===i.name})}).always(function(){s--,0===s&&e.resolve(n)})},this):void e.resolve(n)},this)).promise()},getSiteModuleByName:function(i){return e.Deferred(t.bind(function(e){var t=this.siteModules[i];t?t.ModuleClass?e.resolve(t):t.path?require([t.path],function(s){t.ModuleClass=s,t.name=i,e.resolve(t)},function(i){console.error("Failed loading "+t.path+": "+i.message,i),e.reject(i)}):e.reject():e.reject("No Such Module Found")},this)).promise()},_findStyleTags:function(i){return e(t.filter(this.$stylesheets,function(s){var n=e(s).data("identifier");return t.find(i,function(e){return n===e})}))},_addStylesToHead:function(i){if(i&&i.length>0){var s=e([]);t.each(i,function(t){var i=e('<link rel="stylesheet" data-identifier="'+t+'" href="'+this.staticUrl+"css/bundles/"+t+(window.use_minified_css?".min":"")+".css?v="+this.staticVersion+'">')[0];
s.push(i),this.$stylesheets.push(i)},this),e("head").append(s)}}},new s}),define("intersection-observer",["underscore"],function(e){"use strict";function t(e){this.time=e.time,this.target=e.target,this.rootBounds=e.rootBounds,this.boundingClientRect=e.boundingClientRect,this.intersectionRect=e.intersectionRect||l(),this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,i=t.width*t.height,s=this.intersectionRect,n=s.width*s.height;i?this.intersectionRatio=n/i:this.intersectionRatio=this.isIntersecting?1:0}function i(t,i){var s=i||{};if("function"!=typeof t)throw new Error("callback must be a function");if(s.root&&1!=s.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=e.throttle(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(s.rootMargin),this.thresholds=this._initThresholds(s.threshold),this.root=s.root||null,this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ")}function s(){return window.performance&&performance.now&&performance.now()}function n(e,t,i,s){"function"==typeof e.addEventListener?e.addEventListener(t,i,s||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,i)}function o(e,t,i,s){"function"==typeof e.removeEventListener?e.removeEventListener(t,i,s||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,i)}function a(e,t){var i=Math.max(e.top,t.top),s=Math.min(e.bottom,t.bottom),n=Math.max(e.left,t.left),o=Math.min(e.right,t.right),a=o-n,r=s-i;return a>=0&&r>=0&&{top:i,bottom:s,left:n,right:o,width:a,height:r}}function r(e){var t;try{t=e.getBoundingClientRect()}catch(i){}return t?(t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top}),t):l()}function l(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function h(e,t){for(var i=t;i;){if(i==e)return!0;i=d(i)}return!1}function d(e){var t=e.parentNode;return t&&11==t.nodeType&&t.host?t.host:t}if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)return"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}}),window.IntersectionObserver;var c=[];return i.prototype.THROTTLE_TIMEOUT=300,i.prototype.POLL_INTERVAL=null,i.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:e,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},i.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e}),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},i.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},i.prototype.takeRecords=function(){var e=this._queuedEntries.slice();return this._queuedEntries=[],e},i.prototype._initThresholds=function(e){var t=e||[0];return Array.isArray(t)||(t=[t]),t.sort().filter(function(e,t,i){if("number"!=typeof e||isNaN(e)||0>e||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==i[t-1]})},i.prototype._parseRootMargin=function(e){var t=e||"0px",i=t.split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});return i[1]=i[1]||i[0],i[2]=i[2]||i[0],i[3]=i[3]||i[1],i},i.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(n(window,"resize",this._checkForIntersections,!0),n(document,"scroll",this._checkForIntersections,!0)))},i.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,o(window,"resize",this._checkForIntersections,!0),o(document,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},i.prototype._checkForIntersections=function(){var e=this._rootIsInDom(),i=e?this._getRootRect():l();this._observationTargets.forEach(function(n){var o=n.element,a=r(o),l=this._rootContainsTarget(o),h=n.entry,d=e&&l&&this._computeTargetAndRootIntersection(o,i),c=n.entry=new t({time:s(),target:o,boundingClientRect:a,rootBounds:i,intersectionRect:d});h?e&&l?this._hasCrossedThreshold(h,c)&&this._queuedEntries.push(c):h&&h.isIntersecting&&this._queuedEntries.push(c):this._queuedEntries.push(c)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},i.prototype._computeTargetAndRootIntersection=function(e,t){if("none"!=window.getComputedStyle(e).display){for(var i=r(e),s=i,n=d(e),o=!1;!o;){var l=null,h=1==n.nodeType?window.getComputedStyle(n):{};if("none"==h.display)return;if(n==this.root||n==document?(o=!0,l=t):n!=document.body&&n!=document.documentElement&&"visible"!=h.overflow&&(l=r(n)),l&&(s=a(l,s),!s))break;n=d(n)}return s}},i.prototype._getRootRect=function(){var e;if(this.root)e=r(this.root);else{var t=document.documentElement,i=document.body;e={top:0,left:0,right:t.clientWidth||i.clientWidth,width:t.clientWidth||i.clientWidth,bottom:t.clientHeight||i.clientHeight,height:t.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(e)},i.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,i){return"px"==t.unit?t.value:t.value*(i%2?e.width:e.height)/100}),i={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3]};return i.width=i.right-i.left,i.height=i.bottom-i.top,i},i.prototype._hasCrossedThreshold=function(e,t){var i=e&&e.isIntersecting?e.intersectionRatio||0:-1,s=t.isIntersecting?t.intersectionRatio||0:-1;if(i!==s)for(var n=0;n<this.thresholds.length;n++){var o=this.thresholds[n];if(o==i||o==s||i>o!=s>o)return!0}},i.prototype._rootIsInDom=function(){return!this.root||h(document,this.root)},i.prototype._rootContainsTarget=function(e){return h(this.root||document,e)},i.prototype._registerInstance=function(){c.indexOf(this)<0&&c.push(this)},i.prototype._unregisterInstance=function(){var e=c.indexOf(this);-1!=e&&c.splice(e,1)},i}),define("state",["jquery","underscore","pubsub","utils","abtest-manager","modules/global/alert","managers/trafficcop","managers/requestmanager","managers/resourcemanager","managers/siteconfig","intersection-observer"],function(e,t,i,s,n,o,a,r,l,h,d){"use strict";Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.constructor.prototype});var c=function(){this.scrollEl=s.get("scrollEl"),this.body=s.get("body"),this.$win=s.get("win"),this.initialize()};return c.prototype={DEBUG:!0,LAYER_OVERLAY:"overlay",LAYER_PRELOAD:"preload",LAYER_BASE:"base",REFRESH_FREQUENCY:60*(s.getNested(window.site_vars,"REFRESH_RATE")||0)*1e3,start:function(e){var t=h.getSiteConfig();this.started=!0,this.header=e,this.pubSub={"page:unload":this.updateActivityTimestamp,"page:load":this.onPageLoad,"video:load":this.updateActivityTimestamp,"slide:change":this.updateActivityTimestamp,heattrack:this.updateActivityTimestamp,vitrack:this.updateActivityTimestamp,uotrack:this.updateActivityTimestamp,"dom:update":this.onDomUpdate},i.attach(this.pubSub,this),this._setupGlobalPubSub(s.getNested(t,"global","pubSub")),this.startRefreshTimer()},initIntersectionObservers:function(){var i=e(this.getActiveApp().el),s=i.find(".js-llc");if(s.length){if(!this.observer){var n={rootMargin:"300px 50px"};this.observer=new d(t.bind(this.onIntersection,this),n)}s.each(t.bind(function(e,t){this.observer.observe(t)},this))}},clearIntersectionObservers:function(){this.observer&&e(".js-llc,.js-lli").each(t.bind(function(e,t){this.observer.unobserve(t),t.gannett&&(t.gannett={})},this))},resetIntersectionObservers:function(){this.clearIntersectionObservers(),this.initIntersectionObservers()},onIntersection:function(n){t.each(n,function(n){var o=e(n.target),a=o.attr("data-name")||"el",r=n.target.gannett=n.target.gannett||{};if(n.isIntersecting)if(o.hasClass("js-llp")||this.observer.unobserve(n.target),o.hasClass("js-lli"))o.removeClass("js-lli"),s.lazyLoadImage(o);else{r.isIntersecting=!0,r.hasIntersected=!0,r.intersectionCount?r.intersectionCount++:r.intersectionCount=1,o.find(".js-lli").each(t.bind(function(e,t){this.observer.observe(t)},this));var l=o.find(".js-llbi");s.lazyLoadImage(l),l.removeClass("js-llbi"),i.trigger("entered:view:"+a,n.target)}else r.hasIntersected&&(r.isIntersecting=!1,i.trigger("exited:view:"+a,n.target))},this)},_checkForIntersections:function(){this.observer&&this.observer._checkForIntersections&&this.observer._checkForIntersections()},addGlobalScrollListener:function(){var e=t.throttle(this._onScroll,100).bind(this);this.$win.on("scroll."+this.cid,e)},removeGlobalScrollListener:function(){this.$win.off("scroll."+this.cid)},removeScrollListeners:function(){t.each(this.globalScrollListeners,function(e,t){this.$win.off("scroll."+e.name)},this),this.removeGlobalScrollListener(),this.globalScrollListeners=[]},_onScroll:function(e){t.each(this.globalScrollListeners,function(e){try{e.fn()}catch(t){console.error("Failed to execute global scroll handler "+e.name)}})},registerScrollListener:function(e,i,s){if(t.isFunction(i)){s=s||500;var n=t.throttle(i,s);0===this.globalScrollListeners.length&&this.addGlobalScrollListener(),this.globalScrollListeners.push({fn:n,name:e})}},unRegisterScrollListener:function(e){t.each(this.globalScrollListeners,function(t,i){t.name===e&&this.globalScrollListeners.splice(i,1)},this),0===this.globalScrollListeners.length&&this.removeGlobalScrollListener()},stop:function(){this.started=!1,this._currentViewport="width=1070",i.unattach(this.pubSub,this),t.each(s.getNested(this.siteConfig,"global","pubSub"),function(e,t){i.off(t)}),this.removeScrollListeners(),n.stop()},_setupGlobalPubSub:function(e){t.each(e,function(e,s){e instanceof Array||(e=[e]),require(e,t.bind(function(){var e=arguments;this.started&&i.on(s,function(i){t.each(e,function(e){new e(i)})})},this))},this)},initialize:function(){this.$overlayFilm=e("#overlay-film"),this.activeAppInfo={url:null,css:[],layer:null,scrollTop:0,appConfig:null,pageConfig:null,app:null},this.lastUrl=null,this.getActivePageInfo(),this._clearPreloadedAppInfo(),this.fullscreenView=null,this.globalScrollListeners=[],n.start(this.getActivePageInfo())},_clearPreloadedAppInfo:function(){this.preloadedAppInfo={url:null,css:[],scrollTop:0,appConfig:null,pageConfig:null,layer:this.LAYER_PRELOAD,app:null}},onRouteChange:function(e,t){return console.log("App: "+e.page.appName+"/"+e.page.name),this.activeAppInfo.app&&i.trigger("page:unload"),this._loadRoute(e,t)},_loadRoute:function(e,t,i){var s={preloadedUrl:e.page.preloadedUrl||e.app.preloadedUrl};return this._loadApp(e.app.AppClass,s,t,e.app,e.page,i)},_preloadRoute:function(e,t,i){return this._preloadApp(e.app.AppClass,{},t,e.app,e.page,i)},preloadPath:function(t){this.DEBUG&&console.log("Router: Preloading: ",t);var i=h.getRouteInfo(t);return!i||window.chromeless||this.activeAppInfo.layer&&this.activeAppInfo.layer!==this.LAYER_OVERLAY?e.Deferred().reject():this._preloadRoute(i,t)},_loadPath:function(t){var i=h.getRouteInfo(t);return i?this.onRouteChange(i,t):(console.error("StateManager: tried navigating to path, but no match found: "+t),e.Deferred().reject())},refreshActiveApp:function(){var e=this.activeAppInfo.url,t=h.getRouteInfo(e).page,s=l.fetchJavascript(t.path,t.modules),n=this._fetchPathHtml(e);return i.trigger("page:unload"),this._changePage(this.activeAppInfo,e,e,n,s)},setIntentUrl:function(e){this.activeAppInfo.intentUrl=e,this.activeAppInfo.app&&this.activeAppInfo.app.destroyModules()},getIntentUrl:function(){return this.activeAppInfo.intentUrl},getPreloadedUrl:function(){return this.preloadedAppInfo.url},registerFullScreenView:function(e){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView=e,this.activeAppInfo.app.pause()},setActiveAppFixed:function(e){this._setFixedPosition(this.activeAppInfo,this.activeAppInfo.app,e)},clearFullScreenView:function(){return this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,!0),this.fullscreenView?(this.fullscreenView=null,this._loadPath(this.activeAppInfo.url)):void 0},clearActiveAppFixed:function(e){this._clearFixedPosition(this.activeAppInfo,this.activeAppInfo.app,e)},_loadApp:function(e,i,s,n,o,a){var r,h=n.overlay?this.LAYER_OVERLAY:this.LAYER_BASE,d=l.fetchJavascript(o.path,o.modules);return this._closeFullscreenView(),this.lastUrl=this.activeAppInfo.url,this.activeAppInfo.app&&(this.activeAppInfo.intentUrl&&this.activeAppInfo.intentUrl!==s&&(this.activeAppInfo.url=this.activeAppInfo.intentUrl),this.activeAppInfo.intentUrl=null),r=this._handleTransition(s,this.activeAppInfo,e,i,h,a,d),this.activeAppInfo.css=o.css||[],this.activeAppInfo.url=s,this.activeAppInfo.layer=h,this.activeAppInfo.pageConfig=o,this.activeAppInfo.appConfig=n,l.fetchStyles(t.union(this.preloadedAppInfo.css,this.activeAppInfo.css),r),r},_preloadApp:function(e,i,s,n,o,a){var r=this._handleTransition(s,this.preloadedAppInfo,e,i,this.LAYER_PRELOAD,a);return this.preloadedAppInfo.css=o.css||[],this.preloadedAppInfo.url=s,this.preloadedAppInfo.pageConfig=o,this.preloadedAppInfo.appConfig=n,l.fetchStyles(t.union(this.preloadedAppInfo.css,this.activeAppInfo.css),r),r},_closeFullscreenView:function(){if(this.fullscreenView){var e=this.fullscreenView;this.fullscreenView=null,e.close()}},_handleTransition:function(e,t,i,s,n,o,a){var r,l=t.url;return this._needsNewApp(i,t)?(r=new i(s),o=o||this._requestPageHtml(l,e,t===this.preloadedAppInfo),t.app?this._changeApps(t,n,r,l,e,o,a):this._revealApp(t,r,l,e,o,a)):t.layer===n?(o=this._requestPageHtml(l,e,t===this.preloadedAppInfo),this._changePage(t,l,e,o,a)):this._transitionFromOverlayToPreloadedApp(l,e,a)},_changeApps:function(i,s,n,o,a,r,l){return i.layer===s?i.app.removeApp(o,a).then(t.bind(function(){return this._revealApp(i,n,o,a,r,l)},this)):s===this.LAYER_OVERLAY?this._revealOverlay(n,o,a,r,l):e.when(this._removePreloadedApp(o,a),this._removeOverlay(i.app,o,a)).then(t.bind(function(){return this._revealApp(i,n,o,a,r,l)},this))},updateState:function(){var t=this.activeAppInfo;if(t.appConfig&&t.pageConfig){this.header&&this._setHeader(this.header,e.extend({},t.appConfig.header,t.pageConfig.header));var i=t.appConfig.viewport||t.pageConfig.viewport||"width=1070";this._currentViewport!==i&&(this._currentViewport=i,e("meta[name=viewport]").attr("content",i))}},_setHeader:function(e,i){t.isEmpty(i)?e.restoreDefaultState():i.fixed?i.open?e.setOpenFixed():e.setClosedFixed():e.setFixingScroller(!0)},_changePage:function(e,i,s,n,o){return e.app.changePage(i,s,n,o,e===this.preloadedAppInfo).then(null,t.bind(function(t,o){return"InvalidApp"===t&&o?this._invalidateApp(e,o,i,s,n):void 0},this))},_rerouteInitialPageLoad:function(i,s,n){return e.Deferred(function(e){t.defer(function(){i.app=null,i.url=null,e.resolve()})}).then(t.bind(function(){return this._loadRoute(n,s)},this))},_removePreloadedApp:function(e,t){var i=this.preloadedAppInfo.app;return i?(this._clearPreloadedAppInfo(),i.beforeOverlayRemove(t),i.removeApp(e,t)):void 0},_revealApp:function(e,i,s,n,o,a){return e.app=i,i.revealApp(s,n,o,a,e===this.preloadedAppInfo).then(null,t.bind(function(t,i){return"InvalidApp"===t&&i?this._invalidateApp(e,i,s,n,o):void 0},this))},_invalidateApp:function(e,t,i,s,n){try{e.app.destroy()}catch(o){console.error("View threw an exception on destroy: ",o.stack||o.stacktrace||o.message)}return console.log("Rerouting: "+t.page.appName+"/"+t.page.name),n?(e.url=i,e===this.activeAppInfo?this._loadRoute(t,s,n):this._preloadRoute(t,s,n)):this._rerouteInitialPageLoad(e,s,t)},_needsNewApp:function(e,t){return!(t.app&&t.app.isRevealed()&&(Object.getPrototypeOf(t.app)===e.prototype||this.preloadedAppInfo.app&&Object.getPrototypeOf(this.preloadedAppInfo.app)===e.prototype&&this.preloadedAppInfo.app.isRevealed()))},_requestPageHtml:function(i,o,a){var l=n.getUserTestByTargetAndPath("full-page",o),h=s.getNested(l,"userVariant","options")||{},d=h.altUrl,c=t.omit(h,"altUrl");if(d&&!t.isEmpty(c)&&(d+="?"+e.param(c)),null!==i||a||d){if(i!==o)return d?this._fetchPathHtml(d,!1,{ignoreVersionCheck:!0}):this._fetchPathHtml(o,a);a||r.abortAllRequests()}return null},_transitionFromOverlayToPreloadedApp:function(e,i,s){var n=this.preloadedAppInfo,o=this._requestPageHtml(n.url,i,!1),a=this.activeAppInfo.app;return this._movePreloadAppToActiveApp(this.LAYER_BASE),n.app.beforeOverlayRemove(i),this._removeOverlay(a,e,i).then(t.bind(function(){return this.updateState(),this._transitionFromOverlayScroll(n),this._changePage(n,e,i,o,s)},this))},_removeOverlay:function(t,i,s){return e.when(t.removeApp(i,s),this._fadeOutOverlayFilm(t))},_movePreloadAppToActiveApp:function(t){e.extend(this.activeAppInfo,this.preloadedAppInfo),i.trigger("activePageInfo:set",this.activeAppInfo.app.pageInfo),this.activeAppInfo.layer=t,this._clearPreloadedAppInfo()},_deactivateActiveApp:function(){this.activeAppInfo.app.pause(),e.extend(this.preloadedAppInfo,this.activeAppInfo)},_revealOverlay:function(s,n,o,a,r){var l=this.activeAppInfo.app;l.isRevealed()?this._deactivateActiveApp():(l.removeApp(n,o),l=null),this.body.css("overflow-y","scroll"),this._transitionToOverlayScroll(this.preloadedAppInfo);var h=e.when(this._fadeInOverlayFilm(s),this._revealApp(this.activeAppInfo,s,n,o,a,r));return i.trigger("scrollTop",0),h.done(t.bind(function(){this.body.css("overflow-y",""),l&&!l.destroyed&&l.afterOverlayReveal(this.preloadedAppInfo.scrollTop)},this)),h},_fadeInOverlayFilm:function(t){var i=t.options.animations.fadeIn;return this.$overlayFilm.length||(this.$overlayFilm=e('<div class="ui-film"></div>'),this.body.append(this.$overlayFilm)),t.animate(this.$overlayFilm,"opacity",.7,i.duration,"ease-in")},_fadeOutOverlayFilm:function(t){var i=this.$overlayFilm,s=t.options.animations.fadeOut;return this.$overlayFilm=e([]),t.animate(i,"opacity",0,s.duration,"ease-out").done(function(){i.remove()})},_fetchPathHtml:function(e,i,n){var a=this.fetchHtml(e,n||null,!i);return i||a.fail(t.bind(function(e){if(e)if("NOT AUTHORIZED"===e)window.location.assign(s.getNested(window,"firefly_urls","samSubscribeURL")||"");else{var t=this.generateRequestError(e);t&&o.showError(t),(200!==e.status&&e.status||"timeout"===e.statusText)&&window.history.back()}},this)),a},generateRequestError:function(e){if(e){if(500===e.status)return"Connection Error... (INTERNAL SERVER ERROR)";if(404===e.status)return"Connection Error... (FILE NOT FOUND)";if(200!==e.status&&e.status)return"Connection Error... ("+(e.statusText||"Unknown Error")+")"}return null},_transitionFromOverlayScroll:function(e){var t=e.app;t&&(t.isApple?t.show():this._clearFixedPosition(e,t),t.$el.css("z-index",""))},_transitionToOverlayScroll:function(e){var t=e.app;t&&(t.isApple?t.hide():this._setFixedPosition(e,t),t.$el.css("z-index","0"))},_clearFixedPosition:function(e,t,s){t.clearFixedPosition(s),i.trigger("scrollTop",e.scrollTop||0)},_setFixedPosition:function(e,t,n){var o=t.getWindowOffset().top;e.scrollTop=s.getScrollPosition(),i.trigger("scrollTop",0),t.setFixedPosition(o,n)},onPageLoad:function(){s.flag("lazy_load")&&this.resetIntersectionObservers(),this.updateActivityTimestamp()},onDomUpdate:function(){this._checkForIntersections()},updateActivityTimestamp:function(){this.lastActivityTimestamp=(new Date).getTime()},getActivePageInfo:function(){var e=s.getNested(this.activeAppInfo,"app","pageInfo");return e?e:(this.initialPageInfo||(this.initialPageInfo=s.parsePageInfo(this.body),this.initialPageInfo.headerAbVariant=this.body.attr("data-ab-variant")),this.initialPageInfo)},getActiveAppClientInfo:function(){return this.activeAppInfo.app&&this.activeAppInfo.app.getClientInfo()||{}},getPreloadedPageInfo:function(){return this.preloadedAppInfo.app&&this.preloadedAppInfo.app.pageInfo||{}},getActiveApp:function(){return this.activeAppInfo.app},getPreloadedApp:function(){return this.preloadedAppInfo.app},getReferrer:function(){return null===this.lastUrl?document.referrer:s.getOrigin()+this.lastUrl},getCurrentUrl:function(){return this.activeAppInfo.url?s.getOrigin()+this.activeAppInfo.url:window.location.href},startRefreshTimer:function(){!this.refreshTimer&&this.REFRESH_FREQUENCY&&(this.lastActivityTimestamp=0,this.refreshTimer=setInterval(t.bind(function(){if(!this.fullscreenView&&this.activeAppInfo.layer!==this.LAYER_OVERLAY){var e=(new Date).getTime(),t=e-this.lastActivityTimestamp;t>this.REFRESH_FREQUENCY&&(i.trigger("site:refresh","refresh:"+(this.getActivePageInfo().ssts||"").replace(/[\/:].*/,"")),window.location=window.location)}},this),6e4))},stopRefreshTimer:function(){this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null)},registerAnimation:function(e,t,i,s,n){return a.addAnimation(e,t,i,s,n)},fetchHtml:function(e,t,i,s){return r.fetchHtml(e,t,i,s,!0)},persistentFetchHtml:function(e,t,i,s){return r.persistentFetchHtml(e,t,i,s,!0)},fetchData:function(e,t,i,s,n){return r.fetchData(e,t,i,s,n)},persistentFetchData:function(e,t,i,s,n){return r.persistentFetchData(e,t,i,s,n)},recurringFetchHtml:function(e,t,i,s,n){return r.recurringFetchHtml(e,t,i,s,n,!0)},recurringFetchData:function(e,t,i,s,n,o){return r.recurringFetchData(e,t,i,s,n,o)}},window.stateManager=new c,window.stateManager}),define("fwinfo",["jquery","underscore","cookie"],function(e,t){"use strict";var i=function(){this.initialize()};return i.prototype={initialize:function(){this.useLocalStorage=navigator.cookieEnabled&&window.localStorage,this.useLocalStorage&&!e.cookie("hasFwInfo")&&(window.localStorage.removeItem("fwInfo"),e.cookie("hasFwInfo","true",{path:"/"}))},setPersistentSessionValue:function(e,t){var i=this._getFwInfo();i[e]=t,this._setFwInfo(i)},getPersistentSessionValue:function(e,t){var i=this._getFwInfo();return i[e]||t},getAndClearPersistentSessionValue:function(e){var i=this._getFwInfo(),s=i[e];return this._setFwInfo(t.omit(i,e)),s},_setFwInfo:function(e){if(t.isObject(e))try{e=JSON.stringify(e),this.useLocalStorage?window.localStorage.setItem("fwInfo",e):window.sessionStorage.setItem("fwInfo",e)}catch(i){console.error("Unable to set fwInfo in localStorage",i.stack||i.stacktrace||i.message)}},_getFwInfo:function(){var e;try{e=JSON.parse(this.useLocalStorage?window.localStorage.getItem("fwInfo"):window.sessionStorage.getItem("fwInfo"))}catch(t){console.error("Unable to fetch fwInfo from localStorage",t.stack||t.stacktrace||t.message)}return e||{}},setsessionvalue:function(e,t){this.setPersistentSessionValue(e,t)},getsessionvalue:function(e){return this.getPersistentSessionValue(e)},getandclearsessionvalue:function(e){return this.getAndClearPersistentSessionValue(e)}},new i}),define("managers/routemanager",["jquery","underscore","state","managers/siteconfig","pubsub","utils","fwinfo"],function(e,t,i,s,n,o,a){"use strict";var r=function(){};return r.prototype={baseUrl:window.location.protocol+"//"+window.location.host,usatBetaDomain:"http://beta.usatoday.com",$canonical:e('link[rel="canonical"]'),start:function(e){this.started=!0,s.loadRoutes().done(t.bind(function(i){this.started&&(e&&o.get("win").on("popstate",t.bind(this._onStateChange,this)),this._onStateChange(),console.log("Site Loaded"))},this))},getLocalPath:function(e){if(!e||"#"===e)return null;if(e.indexOf(this.baseUrl))if(e.indexOf(this.usatBetaDomain)){if(-1!==e.indexOf("://"))return null}else e=e.substring(this.usatBetaDomain.length);else e=e.substring(this.baseUrl.length);return e},stop:function(){this.started=!1,o.get("win").off("popstate")},getInfo:function(t){var i=this.getLocalPath(t);return null!==i?s.getRouteInfo(e.trim(i)):null},isAjax:function(e){var t=this.getInfo(e);return t&&t.ajax},goTo:function(t,s,a){if(!o.isValidUrl(t)||!this._canNavigate())return!1;if(!i.getIntentUrl()&&this.isCurrentUrl(t))return console.warn("Tried navigating to the current url, skipping"),!1;n.trigger("track",{label:s,url:t,event:a}),e.ajax({url:"/comscorepvcandidate.xml",headers:{"Cache-Control":"no-cache, no-store, must-revalidate, private","Surrogate-Control":"max-age=0",Pragma:"no-cache",Expires:"0"},cache:!1});var r=this._goHashTag(t)||this._goInternal(t);return this.$canonical.attr("href",this.baseUrl+t),r||this._setLocation(this.attachChromeless(t)),delete window.simpleExclusion,delete window.simpleTarget,!0},goToInterstitual:function(e){return e=this.getLocalPath(e),Modernizr.history&&o.isValidUrl(e)&&this._canNavigate()&&this.getInfo(e)?(i.setIntentUrl(e),this._pushState(this.attachChromeless(e)),!0):!1},isCurrentUrl:function(e){var t=this.getLocalPath(e);return t&&(t=t.split("#")[0]),t===this._getCurrentPath()},_getCurrentPath:function(){return window.location.pathname+location.search},_setLocation:function(e){window.location.assign(e)},_canNavigate:function(){var e=i.getActivePageInfo().navigationWarning;return e&&!window.confirm(e)?!1:!0},_goHashTag:function(t){if("#"===t[0]){t=t.substring(1);var i=e("a[name="+t+"]").offset();return i&&i.top&&n.trigger("scrollTop",i.top-40),window.location.hash=t,!0}},attachChromeless:function(e){return window.chromeless?e+(-1===e.indexOf("?")?"?":"&")+"chromeless=true":e},_goInternal:function(e){return Modernizr.history&&this.isAjax(e)&&this.isAjax(o.getPageUrl())?(this._pushState(this.attachChromeless(this.getLocalPath(e))),this._onStateChange(),!0):!1},_pushState:function(e){window.history.pushState({},document.title,e)},_onStateChange:function(e){var t,s=window.location;s.pathname!==this._currentPathName&&("object"==typeof e&&(this.$canonical.attr("href",this.baseUrl+s.pathname),this._currentPathName&&a.setsessionvalue("clickPage",this.baseUrl+this._currentPathName)),this._currentPathName=s.pathname+s.search,t=this.getInfo(s.pathname),t?i.onRouteChange(t,s.pathname+s.search+s.hash):console.error("Could not find any site-config matching "+s.pathname))}},new r}),define("managers/cachemanager",["jquery","underscore"],function(e,t){"use strict";var i=function(){t.bindAll(this,"_updateCache"),window.addEventListener?window.addEventListener("storage",this._updateCache,!1):window.attachEvent("onstorage",this._updateCache),this.reset(),this.getValue("cmgc",this.gc,10080)};return i.prototype={keyPrefix:"wf_",reset:function(){this._cache={}},gc:function(){var e=i.prototype;t.each(t.keys(window.localStorage),function(t){0===t.indexOf(e.keyPrefix)&&(e._getBrowserCache(window.localStorage,t)||window.localStorage.removeItem(t))})},_updateCache:function(i){var s;i||(i=window.event),i.key&&0===i.key.indexOf(this.keyPrefix)&&(i.newValue?(s=JSON.parse(i.newValue),t.isObject(s)&&"raw"!==s.type&&(s.data=e.Deferred().resolve(s.data)),this._setMemoryCache(i.key,s)):delete this._cache[i.key])},getValue:function(e,i,s){var n,o,a,r=this._getStorage(s);return e=this.keyPrefix+e,n=this._getMemoryCache(e),n||(n=this._getBrowserCache(r,e),n||(o=this._getValue(i),a=this._isPromise(o),n=this._buildCacheEntry(o,a,s),a?o.done(t.bind(function(t){var i=this._buildCacheEntry(t,!0,s);this._setBrowserCache(e,i,r)},this)):this._setBrowserCache(e,n,r)),this._setMemoryCache(e,n)),n.data},setValue:function(e,i,s){var n=this._isPromise(i),o=this._buildCacheEntry(i,n,s);e=this.keyPrefix+e,n?i.done(t.bind(function(t){var i=this._buildCacheEntry(t,!0,s);this._setBrowserCache(e,i,this._getStorage(s))},this)):this._setBrowserCache(e,o,this._getStorage(s)),this._setMemoryCache(e,o)},_isPromise:function(t){return e.isPlainObject(t)&&e.isFunction(t.promise)},_getStorage:function(e){var t=e?"localStorage":"sessionStorage";return window[t]},_setMemoryCache:function(e,t){this._cache[e]=t},_setBrowserCache:function(e,t,i){try{i.setItem(e,JSON.stringify(t))}catch(s){console.log("Storage Set Failed for key: "+e)}},_buildCacheEntry:function(e,t,i){var s,n={data:e,type:t?0:"raw"};return i&&(s=new Date,n.expires=s.setTime(s.getTime()+1e3*i*60)),n},clearValue:function(e){e=this.keyPrefix+e,sessionStorage.removeItem(e),localStorage.removeItem(e),delete this._cache[e]},_getMemoryCache:function(e){var t=this._cache[e];if(t){if("raw"!==t.type){if("pending"===t.data.state())return t;if("rejected"===t.data.state())return null}if(!t.expires)return t;if(new Date<new Date(t.expires))return t}},_getBrowserCache:function(i,s){var n=i.getItem(s);return n&&(n=JSON.parse(n),t.isObject(n)&&(!n.expires||new Date<new Date(n.expires)))?("raw"!==n.type&&(n.data=e.Deferred().resolve(n.data)),n):void 0},_getValue:function(t){return e.isFunction(t)?t():t}},new i}),define("user-manager",["jquery","underscore","pubsub","managers/cachemanager"],function(e,t,i,s){"use strict";var n=function(){this.initialize()};return n.prototype={PREFERRED_ACCOUNT_KEY:"userPreferredAccount",PREFERRED_ACCOUNT_TIMEOUT:525600,initialize:function(){this.resetManager(),this.preferredAccount&&(this.state="loggingIn",i.on("page:load",this.autoLogin,this)),i.on("user:statuschange",this._userStatusChange,this)},destroy:function(){this.resetManager(),i.off("user:statuschange",this._userStatusChange,this),i.off("page:load",this.autoLogin,this)},autoLogin:function(){this.state=null,this.loginUser(this.preferredAccount,!0).fail(t.bind(function(){this.logoutUser()},this)),i.off("page:load",this.autoLogin,this)},registerAccount:function(e){var t=e.getName();return this.accounts[t]?void console.error("duplicate account name given to registerAccount"):void(this.accounts[t]=e)},unRegisterAccount:function(e){var t=e.getName();this.accounts[t]?this.accounts[t]=null:console.error("unRegisterAccount called on name that isn't registered!"),e.logout(),this.preferredAccount===t&&this.setPreferredAccount(null)},loginUser:function(e,t){return this._askAccount("login",e,t)},_userStatusChange:function(e,t,i){"loggedIn"===t?this._onLoginSuccess(e,i):"loggedOut"===t&&this._onLogoutSuccess(e)},_onLoginSuccess:function(e,t){this.setPreferredAccount(e),i.trigger("user:login",t,e)},setPreferredAccount:function(e){var t=this.getPreferredAccountLookupKey();e?s.setValue(t,e,this.PREFERRED_ACCOUNT_TIMEOUT):s.clearValue(t),this.preferredAccount=e},getPreferredAccountLookupKey:function(){return this.PREFERRED_ACCOUNT_KEY},getPreferredAccount:function(){return this.preferredAccount||s.getValue(this.getPreferredAccountLookupKey(),null,this.PREFERRED_ACCOUNT_TIMEOUT)},getLoginStatus:function(e){var t,i=this.getAccount(e);return t=i?i.getLoginStatus():"loggedOut",this.state||t},logoutUser:function(e){return this._askAccount("logout",e)},logoutAll:function(){return e.when.apply(e,t.map(this.accounts,function(e){return e.logout()}))},_onLogoutSuccess:function(e){i.trigger("user:logout",e),e===this.getPreferredAccount()&&this.setPreferredAccount(null)},getAccount:function(e){return this.accounts[e||this.preferredAccount]},getUserInfo:function(e){return this._askAccount("getUserInfo",e)},getUserAttributes:function(e){return this._askAccount("getUserAttributes",e)},getCoreUserInfo:function(e){return this._askAccount("getCoreUserInfo",e)},resetManager:function(){this.accounts={},this.preferredAccount=this.getPreferredAccount()},_askAccount:function(t,i,s){var n=this.getAccount(i);return n?n[t]?n[t].apply(n,Array.prototype.slice.call(arguments,2)):e.Deferred().reject("Account "+(i||this.preferredAccount)+" does not support method "+t):e.Deferred().reject("Invalid Account")}},new n}),define("modules/global/barrier",["jquery"],function(e){var t=function(t,i,s){e.extend(this,e.Deferred()),s&&(this.reject=this.resolve);var n=setTimeout(e.proxy(function(){this.reject()},this),i);t.then(e.proxy(function(){this.resolve.apply(this,arguments)},this),e.proxy(function(){
this.reject.apply(this,arguments)},this)).always(function(){clearTimeout(n)})},i=function(){this.init()};return i.prototype={init:function(){this._processes=[],this._waiting=[]},add:function(e,i,s){return i?void this._addToQueue(this._processes,new t(e,i,s)):void console.error("Invalid Barrier, timeoutMS required")},cancel:function(t){e.each(this._waiting,function(e,t){t.reject()}),this._waiting=[],t&&(e.each(this._processes.slice(0),function(e,t){t.reject()}),this._processes=[])},wait:function(){var t=this._processes;return t.length?this._addToQueue(this._waiting,e.Deferred(function(i){e.when.apply(e,t).then(function(){i.resolve.apply(i,arguments)},function(){i.reject.apply(i,arguments)})})):e.Deferred().resolve()},_addToQueue:function(t,i){return t.push(i),i.always(e.proxy(function(){return this._removeFromQueue(t,i)},this))},_removeFromQueue:function(t,i){var s=e.inArray(i,t);return-1!==s?(t.splice(s,1),!0):!1}},i}),define("modules/global/memobarrier",["jquery","modules/global/barrier"],function(e,t){var i=function(){this.init()};return i.prototype=new t,i.prototype.constructor=i,i.prototype._addToQueue=function(e,t){return e.push(t),t},i}),define("adLogger",["underscore"],function(e){"use strict";var t=function(){this.initialize()};return t.prototype={initialize:function(){this.debug=window.isAdDebug,Function.prototype.bind&&window.console&&"object"==typeof window.console.log&&e.each(["log","info","warn","error"],function(e){window.console[e]=Function.prototype.call.bind(window.console[e],window.console)})},logGroup:function(e){this.debug&&window.console.groupCollapsed(e)},logGroupEnd:function(){this.debug&&window.console.groupEnd()},_log:function(e,t,i){var s="Ad "+t+": "+e;if(window.console&&window.console[t])if(i.length){window.console.groupCollapsed(s);for(var n=0,o=i.length;o>n;n++)window.console[t](i[n]);window.console.groupEnd()}else window.console[t](s)},logDebug:function(e,t){this.debug&&this._log(e,"log",Array.prototype.slice.call(arguments,1))},logError:function(e,t){this._log(e,"error",Array.prototype.slice.call(arguments,1))},logInfo:function(e,t){this.debug&&this._log(e,"info",Array.prototype.slice.call(arguments,1))},logWarn:function(e,t){this._log(e,"warn",Array.prototype.slice.call(arguments,1))}},new t}),define("partner/ad-slot",["jquery","underscore","baseview","state","utils","modules/global/memobarrier","pubsub","adLogger"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({className:"ad-slot",id:function(){return t.uniqueId("ad-slot-"+this.options.adUnit.replace(/\//g,"-")+"-")},events:{partnersetup:"onHighImpactAdLoad",partnerloading:"onPartnerLoading"},pageLoaded:!1,initialized:!1,queue:[],pageUnLoad:function(){l.prototype.pageLoaded=!1},pageLoad:function(){l.prototype.queue.length&&l.prototype._requestSlots(l.prototype.queue),l.prototype.queue=[],l.prototype.pageLoaded=!0},initialize:function(s){if(s=e.extend({adUnit:null,exclusion:[],targeting:{},sizes:[],type:"in",onSlotSetup:null,onSlotRequest:null,onSlotRender:null,onSlotEmpty:null,position:null,adPosition:null},s),t.bindAll(this,"_prebidBidBack","_apsBidBack"),!l.prototype.initialized&&window.googletag&&(l.prototype.initialized=!0,googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",l.prototype._renderEnded)})),!(this.$el.length&&s.position&&s.position.length&&s.position.parents("body").length))return void r.logInfo("AdSlot("+this.options.adUnit+"): Unable to request ad because no valid dom element provided");this.apsScriptLoad=e.Deferred(),this.apsBarrier=new o;var h=n.getNested(window.site_vars,"ADS","aps","timeout")||1e3;this.apsBarrier.add(this.apsScriptLoad,h,!0),window.apstag?this.apsScriptLoad.resolve():a.on("ads:apsLoaded",this.onApsLoaded,this),s.position.append(this.$el),this.targetBarrier=new o,this.gptSlot=null,this.slotId=this.$el.prop("id"),this.adDeliveryData=null,this.pbDebug=n.getUrlParam("pb_debug"),this.pbSlotLog=n.getUrlParam("pb_slot_log"),this.pbLog=n.getUrlParam("pb_console"),this.iasDebug=n.getUrlParam("ias_debug"),this.apsDebug=n.getUrlParam("aps_debug"),i.prototype.initialize.call(this,s),this._buildGptSlot()},_buildGptSlot:function(){return s.getActivePageInfo().noadvertising?void r.logInfo("AdSlot("+this.options.adUnit+"): blocked because of noadvertising flag in pageinfo"):void("in"===this.options.type?this._registerSlotWithGoogle(this.options.adUnit,this.options.sizes,this.slotId):this._registerOutOfPageSlotWithGoogle(this.options.adUnit,this.slotId))},destroy:function(){a.off("ads:apsLoaded",this.onApsLoaded,this),this.gptSlot&&(this.gptSlot.__gannettSlot=null),window.pbjs&&window.pbjs.removeAdUnit(this.slotId),this.destroyed=!0,this.gptSlot=null,i.prototype.destroy.call(this,!0),delete window.gannettAolConfigs},refresh:function(){this.destroyed||(this.adLoading=!1,this.adData=null,this.$el.closest("body").length||this.options.position.append(this.$el),this.delegateEvents(),this.gptSlot?window.googletag&&!s.getActivePageInfo().noadvertising&&(this._refreshSlot(this.gptSlot),r.logInfo("AdSlot("+this.options.adUnit+"): Ad refreshed for slot",this.gptSlot)):this._buildGptSlot())},onApsLoaded:function(){this.apsScriptLoad.resolve(),a.off("ads:apsLoaded",this.onApsLoaded,this)},onPartnerLoading:function(){this.adLoading=!0},onHighImpactAdLoad:function(e,t){var i=null;if(t&&t.data)i=t.data;else{if(!e.originalEvent||!e.originalEvent.data)return void r.logError("AdSlot("+this.options.adUnit+"): Found a high impact ad, can't find the data object from the iFrame",arguments);i=e.originalEvent.data}if(!i||!i.adType)return void r.logError("AdSlot("+this.options.adUnit+"): high impact event received, but invalid data object was given",i);this.adData=i;var s=this._normalizeAdType(i.adType);this.options.onSlotRender(i,s)},_normalizeAdType:function(e){return e?e.toLowerCase().replace(/[^a-z]/,""):null},_registerOutOfPageSlotWithGoogle:function(e,i){window.googletag&&googletag.cmd.push(t.bind(function(){r.logInfo("AdSlot("+this.options.adUnit+"): registering out of page slot with google "+e),this.gptSlot=googletag.defineOutOfPageSlot(e,i).addService(googletag.pubads()),this.gptSlot.__gannettSlot=this,googletag.display(i),this._refreshSlot(this.gptSlot)},this))},_refreshSlot:function(e){this.setTargeting(),n.getNested(this.options,"skipTargetBarrier")?this._requestSlots([e]):this.targetBarrier.wait().done(t.bind(function(){r.logInfo("Ready to request slot",this.options.adUnit),this.pageLoaded?this._requestSlots([e]):this.queue.push(e)},this))},_requestSlots:function(e){var i=googletag.pubads();return n.checkForEmail(document.location.href)?void(window.noAds=!0):(window.noAds=!1,this.pbLog&&console.log("AD-SLOT: Request slot(s) ---------",Date.now(),e),i.clearTargeting("credit"),i.clearTargeting("videotag"),t.each(e,function(e){"function"==typeof e.clearTargeting&&(e.clearTargeting("credit"),e.clearTargeting("videotag")),e&&e.__gannettSlot&&e.__gannettSlot.options&&e.__gannettSlot.options.onSlotRequest()}),i.refresh(e),void 0)},_registerSlotWithGoogle:function(e,i,s){window.googletag&&(e=this._sanitizeAdUnit(e),googletag.cmd.push(t.bind(function(){var o=n.getNested(this.options,"onSlotSetup"),a=n.getNested(this.options,"deferred");r.logGroup("AdSlot "+this.options.adUnit),r.logInfo("registering slot with google "+e+" sizes",i),this.gptSlot=googletag.defineSlot(e,i,s).addService(googletag.pubads()),o&&"function"==typeof o&&this.options.onSlotSetup(this.options.adPosition,s),this.gptSlot.__gannettSlot=this,googletag.display(s),t.forEach(arguments,function(t){r.logInfo("AdSlot("+e+"): "+t)}),a?a.done(t.bind(function(){this._refreshSlot(this.gptSlot)},this)):this._refreshSlot(this.gptSlot),r.logGroupEnd(),(n.getNested(window.site_vars,"ADS","ias","enabled")||this.iasDebug)&&(window.iasSlots=window.iasSlots||[],window.iasSlots.push({adSlotId:s,size:i[0],adUnitPath:e}))},this)))},_sanitizeAdUnit:function(e){return"string"==typeof e?e.replace(/[^\w-*!<>:().\\\/]/g,""):""},_renderEnded:function(e){e.slot.__gannettSlot&&t.defer(t.bind(function(){!this.gptSlot||this.adData||this.adLoading||(e.isEmpty?(r.logInfo("AdSlot("+this.options.adUnit+"): No Ad Delivered"),this.options.onSlotEmpty&&this.options.onSlotEmpty()):this.options.onSlotRender(null,null,e.size),a.trigger("ads:renderSuccess",{empty:e.isEmpty,adUnit:this.options.adUnit}))},e.slot.__gannettSlot))},setTargeting:function(e){var t=e||this.options.targeting;this.gptSlot&&(this._setTargeting(this.gptSlot,t),this._setExclusionTargeting(this.gptSlot,this.options.exclusion))},_getMaxSize:function(e){var i;return e.length>1?t.reduce(e,function(e,t){var s=t[0]+t[1];return s>e?(i=t,s):e},0):i=e[0],i},_getPrebid:function(e,i,o){if(!n.getUrlParam("pb_video_id")){var a,r,l,h=[],d=window.pbjs||{},c=n.getNested(window.site_vars,"ADS","prebid")||{},u=-1!==e.indexOf("_btf")?"btf":"atf",p=n.getNested(c,"aol")||{},f=n.getNested(c,"appNexus")||{},g=n.getNested(c,"criteo")||{},m=n.getNested(c,"index")||{},v=n.getNested(c,"openX")||{},b=n.getNested(c,"rubicon")||{},y=n.getNested(c,"pubMatic")||{},w=n.getNested(c,"sonobi")||{},_=n.getNested(c,"triplelift")||{},C=n.getNested(c,"yieldbot")||{},S=n.getNested(c,"trustx")||{},x=n.getNested(c,"aardvark")||{},k=n.getNested(c,"sizes"),T=s.getActivePageInfo(),$=T.section_name,A=T.ssts.split("/");if(d.adUnits&&t.where(d.adUnits,{code:o}).length)return this._fetchPrebid(o);if(!k)return!1;if(k=t.map(k,function(e){return[e.width,e.height]}),i=t.filter(i,function(e){return t.findWhere(k,e)}),t.isEmpty(i))return!1;if(r=this._getMaxSize(i),!r)return this.preBidDeferred.resolve("No header bidding needed for ad slot");if(l=r[0]+"x"+r[1],("sonobi"===this.pbDebug||!this.pbDebug&&w.enabled)&&h.push({bidder:"sonobi",params:{ad_unit:e}}),("criteo"===this.pbDebug||!this.pbDebug&&g.enabled)&&t.isArray(g.placements)&&this._setupCriteo(g,i,h),"rubicon"===this.pbDebug||!this.pbDebug&&b.enabled){var P=n.getNested(b,"zones",u,$)||b.zoneId;h.push({bidder:"rubicon",params:{accountId:b.account,siteId:b.siteId,zoneId:P,inventory:{domain:window.site_vars.base_url,section:$,subsection:A[1]||"",topic:A[2]||""}}})}if(("appnexus"===this.pbDebug||!this.pbDebug&&f.enabled)&&t.isArray(f.placements)&&this._setupAppNexus(f,i,$,e,h),("openx"===this.pbDebug||!this.pbDebug&&v.enabled)&&t.isArray(v.placements)&&this._setupOpenX(v,i,$,h),("index"===this.pbDebug||!this.pbDebug&&m.enabled)&&this._setupIndex(m,e,h),("triplelift"===this.pbDebug||!this.pbDebug&&_.enabled)&&t.isArray(_.placements)&&this._setupTripleLift(_,i,h),("yieldbot"===this.pbDebug||!this.pbDebug&&C.enabled)&&this._setupYieldbox(C,e,i,h),("trustx"===this.pbDebug||!this.pbDebug&&S.enabled)&&this._setupTrustx(S,i,h),("aardvark"===this.pbDebug||!this.pbDebug&&x.enabled)&&this._setupAardvark(x,i,$,h),("pubmatic"===this.pbDebug||!this.pbDebug&&y.enabled)&&t.isArray(y.slots)){var D=u.toUpperCase()+"@"+l,I="ROS@"+l,M=y.slots.indexOf(D)>-1?D:y.slots.indexOf(I)>-1?I:null;M&&h.push({bidder:"pubmatic",params:{publisherId:y.account,adSlot:M}})}("aol"===this.pbDebug||!this.pbDebug&&p.enabled)&&t.isArray(p.placements)&&this._setupAol(p,e,i,h),a={code:o,sizes:i,bids:h},d.que.push(function(){d.addAdUnits(a)}),d.firstLoad?this._fetchPrebid(o):this.preBidDeferred.resolve(),this.pbSlotLog&&console.info("PREBID SLOT CONFIG",JSON.stringify(a,null,4)),this.pbLog&&console.log("AD-SLOT: Prebid configured -------",Date.now(),a)}},_fetchPrebid:function(e){pbjs.que.push(t.bind(function(){pbjs.requestBids({timeout:n.getNested(window.site_vars,"ADS","prebid","timeout")||800,adUnitCodes:[e],bidsBackHandler:this._prebidBidBack}),this.pbLog&&console.log("AD-SLOT: Fetching slot prebid ----",Date.now(),e)},this))},_prebidBidBack:function(e){pbjs.setTargetingForGPTAsync(),this.preBidDeferred.resolve(),this.pbLog&&console.log("AD-SLOT: Setting prebid targeting ",Date.now(),pbjs.getAdserverTargeting())},_getAps:function(e,t,i){var s=window.apstag||{fetchBids:function(){}},o=s.gannettSlots||[],a=n.getNested(window.site_vars,"ADS","aps","sizes"),r=this._getApsSizes(t,a);if(r.length){var l={slotID:i,sizes:r};this.pbSlotLog&&console.info("AMAZON APS SLOT CONFIG",JSON.stringify(l,null,4)),s.firstLoad?s.fetchBids({slots:[l]},this._apsBidBack):(o.push(l),this.apsBidDeferred.resolve())}},_getApsSizes:function(e,t){var i,s,n,o,a;for(a=[],i=0;i<e.length;i++)for(n=JSON.stringify(e[i]),s=0;s<t.length;s++)o=JSON.stringify([t[s].width,t[s].height]),n===o&&a.push(e[i]);return a},_apsBidBack:function(e){var i=n.getNested(window,"googletag","cmd")||[];i.push(t.bind(function(){var e=window.apstag||{};e.setDisplayBids(),this.apsBidDeferred.resolve()},this)),this.pbLog&&console.log("Setting APS targeting",e)},_setupAol:function(e,i,s,n){var o,a=this._getPlacementSizes(e.placements,s,e.multisize);t.forEach(a,function(s){o=t.where(e.placements,{size:s})[0],o&&n.push({bidder:"aol",params:{placement:o.id,network:e.network,alias:i,server:e.server,sizeId:o.size,bidFloor:e.bidfloor}})})},_setupAppNexus:function(e,i,s,n,o){var a,r,l=this._getPlacementSizes(e.placements,i,e.multisize);t.forEach(l,function(i){a=t.where(e.placements,{size:i})[0],a&&(r=a[s]||a.ros,r&&o.push({bidder:"appnexusAst",params:{placementId:r,keywords:{position:n.split("/")[2]}}}))})},_setupCriteo:function(e,i,s){var n,o=this._getPlacementSizes(e.placements,i,e.multisize);t.forEach(o,function(i){n=t.where(e.placements,{size:i})[0],n&&s.push({bidder:"criteo",params:{zoneId:n.id}})})},_setupTrustx:function(e,i,s){var n,o=this._getPlacementSizes(e.placements,i,e.multisize);t.forEach(o,function(i){n=t.where(e.placements,{size:i})[0],n&&n.uid&&s.push({bidder:"trustx",params:{uid:n.uid}})})},_setupAardvark:function(e,i,s,n){var o,a=this._getPlacementSizes(e.placements,i,e.multisize);t.forEach(a,function(i){o=t.where(e.placements,{size:i})[0],o&&o.ai&&o.sc&&n.push({bidder:"aardvark",params:{ai:o.ai,sc:o.sc,categories:[s]}})})},_setupIndex:function(e,t,i){var s,n=t.split("/")[2];n&&(s=e.placements[n],s&&i.push({bidder:"indexExchange",params:{id:s.id,siteID:s.siteid}}))},_setupOpenX:function(e,i,s,o){var a,r,l=this._getPlacementSizes(e.placements,i,e.multisize);t.forEach(l,function(i){a=t.where(e.placements,{size:i})[0],a&&(r=a[s]||a.ros,r&&o.push({bidder:"openx",params:{unit:r,delDomain:n.getNested(e,"domain")}}))})},_setupTripleLift:function(e,i,s){var n,o=this._getPlacementSizes(e.placements,i,e.multisize);t.forEach(o,function(i){n=t.where(e.placements,{size:i})[0],n&&s.push({bidder:"triplelift",params:{inventoryCode:n.id}})})},_setupYieldbox:function(e,i,s,n){var o,a=this._getPlacementSizes(e.placements,s,e.multisize);t.forEach(a,function(i){o=t.where(e.placements,{size:i})[0],o&&n.push({bidder:"yieldbot",params:{psn:o.id,slot:o.slot}})})},_getPlacementSizes:function(e,i,s){var n,o=[],a=[];return t.forEach(e,function(e){var s=e.size.split("x");s=t.map(s,function(e){return parseInt(e,10)});var n=t.findWhere(i,s);n&&a.push(n)}),t.isEmpty(a)?void 0:(t.reduce(a,function(e,t){var i=t[0]+t[1];return o.push(t[0]+"x"+t[1]),i>e?(n=t[0]+"x"+t[1],i):e},0),s?o:[n])},_setTargeting:function(i,s){var o,a=n.getNested(this.options,"adUnit")||"",l=n.getNested(this.options,"sizes")||[];i.clearTargeting(),(n.getNested(window.site_vars,"ADS","prebid","enabled")||this.pbDebug)&&(o=n.getNested(window.site_vars,"ADS","prebid","timeout")+100||900,this.preBidDeferred=e.Deferred(),this.targetBarrier.add(this.preBidDeferred,o,!0),this._getPrebid(a,l,this.slotId)),(n.getNested(window.site_vars,"ADS","aps","enabled")||this.apsDebug)&&(o=n.getNested(window.site_vars,"ADS","aps","timeout")||1e3,this.apsBidDeferred=e.Deferred(),this.targetBarrier.add(this.apsBidDeferred,o,!0),this.apsBarrier.wait().then(t.bind(function(){this._getAps(a,l,this.slotId)},this))),i.setTargeting("position",a.split("/")[2]||"NA"),t.each(s,function(e,t){(e||0===e||e===!1)&&(e=n.scrubEmail(e),i.setTargeting(t,e),r.logInfo("set targetting - key:"+t+" value:"+e))},this)},_setExclusionTargeting:function(e,i){t.each(i,function(i){i&&!t.isEmpty(i)&&(e.setCategoryExclusion(i),r.logInfo("set exclusion targetting -  value:"+i))},this)}});return l}),define("admanager",["jquery","underscore","pubsub","state","utils","user-manager","partner/ad-slot","modules/global/memobarrier","adLogger","cookie"],function(e,t,i,s,n,o,a,r,l){"use strict";var h=function(){this.initialize()};return h.prototype={adSizes:{pushdown:[1200,615],gravity:[2560,1440],elastic:[1080,810],cinematicvideoskin:[2600,1400],heroflip:[720,524],fluid:"fluid",mediumrectangle:[300,250],halfpage:[300,600],portrait:[300,1050],leaderboard:[728,90],generic:[1,2],billboard:[970,250],sponsor_logo:[100,30],sponsor_logo_medium:[100,50]},adLiteSizes:[[300,250],[300,600],[300,1050],[970,90],[970,66],[970,250],[728,90]],adLite:!1,flexibleAds:["pushdown","gravity","elastic","cinematicvideoskin","heroflip","generic"],activeAdPlacements:{},globalTargetingKeys:[],getSharedAdSlot:function(e,i,s,n){var o=this._buildAdSizesFromPlacements(i),a=this.buildAdUnit(e),r=s&&s.$el||this.globalStaging;return n=n||s&&s.getSlotType()||"in",this._createAdSlot(a,{},[],o,n,s,r,function(e,t,n){if(!t&&s)s.render(null,null,n);else{var o=i[t];if(!o)return void l.logError("AdSlot("+a+"): ad delivered to unknown ad position/type: "+t);o.render(e,t,n)}},function(){t.each(i,function(e){e.noAd()})})},getAdSlot:function(e,i,s,n,o,a){var r=this.buildAdUnit(e),l=this._mapAdSizeNamesToActualSizes(n);return this._createAdSlot(r,i,s,l,a,o,o.$el,t.bind(function(e,t,i){o.render(e,t,i)},this),function(){o.noAd()})},buildAdUnit:function(e){var t=n.getNested(window.site_vars,"ADS")||{},i=this.usatai||n.getNested(t,"DFP","ACCOUNTID"),s=this.usatan||n.getNested(t,"DFP","ACCOUNTNAME");return i+"/"+s+"/"+e},getSize:function(t){var i=this.adSizes[e.trim(t)];return i?i:(l.logWarn("Size not found for "+t),null)},isFlexibleAdSize:function(e){return-1!==t.indexOf(this.flexibleAds,e)},getVCESize:function(e){var t=this.getSize(e);return t?t.join("x"):"1x1"},initialize:function(){var s=n.getNested(window.site_vars,"ADS","adlite","cookie");return n.getNested(window.site_vars,"ADS","adlite","enabled")&&s&&(this.adLite=e.cookie(s)||!1),this._resetSlots(),window.googletag&&window.googletag.pubads?(t.bindAll(this,"_prebidBidBack","_fetchPrebid","_fetchIAS","_fetchAps","_apsBidBack","_setupAps"),this.targetBarrier=new r,this.apsBarrier=new r,this.pbDebug=n.getUrlParam("pb_debug"),this.pbLog=n.getUrlParam("pb_console"),this.iasDebug=n.getUrlParam("ias_debug"),(n.getNested(window.site_vars,"ADS","prebid","enabled")||this.pbDebug)&&this._setupPrebid(),this.apsDebug=n.getUrlParam("aps_debug"),this.apsEnabled=n.getNested(window.site_vars,"ADS","aps","enabled")===!0||this.apsDebug,this.apsEnabled&&this._setupAps(),l.logGroup("AdManager initialize"),this.pubSub={"page:load":this.onPageLoad,"page:unload":this.onPageUnload,"user:statuschange":this.onUserStatusChange,"simpletarget:update":this._setSimpleTargeting,nextVideoPlay:this._refreshBid,"activePageInfo:set":this._onActivePageInfoSet},i.attach(this.pubSub,this),this.usatai=n.getUrlParam("usatai"),this.usatan=n.getUrlParam("usatan"),this.usatl=n.getUrlParam("usatl"),this.globalStaging=e("#ad-staging"),this._initializeGoogletag(),window.adManager=this,this._initializeBaseTargeting(),e(window).on("fetchPrebid",this._fetchPrebid),e(window).on("fetchPrebid",this._fetchAps),l.logDebug("AdManager initialized"),void l.logGroupEnd()):(this.adLoadBarrier.resolve(),void(this.pageLoaded=!0))},_onActivePageInfoSet:function(e){this._setGlobalTargeting(e,{})},stop:function(){i.unattach(this.pubSub,this),e(window).off("fetchPrebid")},_setupPrebid:function(){var e=window.pbjs||{},t={buckets:[{precision:2,min:0,max:5,increment:.01},{precision:2,min:5,max:10,increment:.05},{precision:2,min:10,max:20,increment:.1},{precision:2,min:20,max:50,increment:.25},{precision:2,min:50,max:100,increment:1}]};e.que=e.que||[],e.firstLoad=!1,e.que.push(function(){e.aliasBidder("appnexusAst","appnexus"),e.setConfig({priceGranularity:t,enableSendAllBids:!0,userSync:{iframeEnabled:!0,enabledBidders:["openx"]}})})},_setupAps:function(){this.apsScriptLoad=e.Deferred();var s=n.getNested(window.site_vars,"ADS","aps","timeout")||1e3;this.apsBarrier.add(this.apsScriptLoad,s,!0),n.loadScript("https://c.amazon-adsystem.com/aax2/apstag.js","apstag").then(t.bind(function(){var e=window.apstag||{},t=n.getNested(window.site_vars,"ADS","aps","pubID"),s=n.getNested(window.site_vars,"ADS","aps","timeout"),o={pubID:t,adServer:"googletag",bidTimeout:s,videoAdServer:"DFP"};e.firstLoad=!1,e.gannettSlots=e.gannettSlots||[],e.init(o),n.getUrlParam("pb_slot_log")&&console.info("AMAZON APS INIT CONFIG",JSON.stringify(o,null,4)),i.trigger("ads:apsLoaded"),this.apsScriptLoad.resolve()},this))},_fetchTargeting:function(){var t=1200;if(n.getNested(window.site_vars,"ADS","prebid","enabled")||this.pbDebug){var i=t+200+n.getNested(window.site_vars,"ADS","prebid","timeout")||800;this.fetchedPrebid=e.Deferred(),this.fetchedIAS=e.Deferred(),this.targetBarrier.add(this.fetchedPrebid,i,!0),this.targetBarrier.add(this.fetchedIAS,i,!0),setTimeout(this._fetchPrebid,t),setTimeout(this._fetchIAS,t)}if(this.apsEnabled){var s=t+200+n.getNested(window.site_vars,"ADS","aps","timeout")||1e3;this.fetchedAps=e.Deferred(),this.targetBarrier.add(this.fetchedAps,s,!0),setTimeout(this._fetchAps,t)}},_fetchPrebid:function(){var e=window.pbjs||{};e.que=e.que||[],this.requestedBids||!n.getNested(window.site_vars,"ADS","prebid","enabled")&&!this.pbDebug||((n.getNested(window.site_vars,"html5video","prebid","enabled")||n.getUrlParam("pb_video_id"))&&this._setVideoSlots("prebid"),this.pbLog&&console.log("ADMANAGER: Fetch Prebid ----------",Date.now()),this.requestedBids=!0,e.que.push(t.bind(function(){e.firstLoad=!0,e.requestBids({timeout:n.getNested(window.site_vars,"ADS","prebid","timeout")||800,bidsBackHandler:this._prebidBidBack})},this)))},_fetchIAS:function(){(n.getNested(window.site_vars,"ADS","ias","enabled")||this.iasDebug)&&(window.__iasPET=window.__iasPET||{},window.__iasPET.queue=window.__iasPET.queue||[],window.__iasPET.pubId=n.getNested(window.site_vars,"ADS","ias","pubid"),window.__iasPET.queue.push({adSlots:window.iasSlots,dataHandler:t.bind(function(){__iasPET.setTargetingForGPT(),this.fetchedIAS.resolve()},this)}),n.loadScript("https://cdn.adsafeprotected.com/iasPET.1.js","__iasPET"))},_fetchAps:function(){this.apsBarrier.wait().then(t.bind(function(){var e=window.apstag||{fetchBids:function(){}};!e.firstLoad&&this.apsEnabled&&(e.firstLoad=!0,e.gannettSlots=e.gannettSlots||[],this._setVideoSlots("aps"),e.fetchBids({slots:e.gannettSlots},this._apsBidBack))},this))},_refreshBid:function(e){if(e){var t=window.apstag||{};t.fetchBids({slots:e},this._apsBidBack)}},_setVideoSlots:function(t){var i=e(".js-video-aps:not(.js-uw-iframe-video)");if(i.length>0)switch(t){case"aps":this._setupVideoAps(i);break;case"prebid":this._setupVideoPrebid(i)}},_setupVideoAps:function(e){for(var t=0;t<e.length;t++){var i="videoSlot"+(t+1);window.videoA9Slots||(window.videoA9Slots=[]),window.videoA9Slots.push({videoID:e[t].dataset.videoId,slotID:i}),window.apstag.gannettSlots.push({slotID:i,mediaType:"video"})}},_setupVideoPrebid:function(e){var t=n.getNested(window.site_vars,"html5video","prebid","size")||[920,508],i=n.getUrlParam("pb_video_id")||n.getNested(window.site_vars,"ADS","prebid","appNexus","videoPlacementId");if(i)for(var s=0;s<e.length;s++)pbjs.que.push(this._addVideoPrebidUnit(e[s],t,i))},_addVideoPrebidUnit:function(e,t,i){pbjs.addAdUnits([{code:"video-"+e.dataset.videoId.toString(),sizes:t,mediaType:"video",bids:[{bidder:"appnexusAst",params:{placementId:i}}]}])},_setVideoBids:function(e){window.videoPrebidBids=window.videoPrebidBids||{},Object.keys(e).forEach(t.bind(function(t){t.indexOf("video")>-1&&(window.videoPrebidBids[t]=e[t])},this))},_prebidBidBack:function(e){e&&this._setVideoBids(e);var t=pbjs.getAdserverTargeting();this.pbLog&&console.log("ADMANAGER: Bids back -------------",Date.now(),t),pbjs.setTargetingForGPTAsync(),this.fetchedPrebid.resolve()},_apsBidBack:function(e){var s=n.getNested(window,"googletag","cmd")||[];s.push(t.bind(function(){var e=window.apstag||{};e.setDisplayBids(),this.fetchedAps.resolve()},this)),e&&i.trigger("apsBidsBack",e),this.pbLog&&console.log("Setting APS targeting",e)},_createAdSlot:function(i,s,o,r,l,h,d,c,u){if(this.adLite&&(r=t.reduce(this.adLiteSizes,function(e,i){var s=t.findWhere(r,i);return s&&e.push(s),e},[])),!t.isEmpty(r)){var p=e.Deferred();return p.done(t.bind(function(){this.activeSlotStatistics.unknown--},this)),this.activeSlotStatistics.unknown++,new a({adLite:this.adLite,adUnit:i,deferred:n.getNested(h,"options","deferred"),skipTargetBarrier:n.getNested(h,"options","skipTargetBarrier"),exclusion:o,targeting:s,sizes:r,type:l||"out",position:d,adPosition:h,onSlotSetup:t.bind(function(e,t){var i=n.getNested(e,"options","onSetup");i&&"function"==typeof i&&i(e,t)},this),onSlotRequest:t.bind(function(){this.slotsBarrier.add(p,2e3,!0)},this),onSlotEmpty:t.bind(function(){this.activeSlotStatistics.noad++,p.resolve(),u()},this),onSlotRender:t.bind(function(e,t,i){if(t){this.activeSlotStatistics.high_impact++;var s=n.getNested(e,"dfp","ecid");this.activeSlotStatistics.high_impact_info.push({adType:t,cap:e.maxDisplayed,capExp:parseInt(e.leaveBehindExp,10),ecid:s,state:"loading"})}else this.activeSlotStatistics.iab++;p.resolve(),c(e,t,i)},this)})}},_resetSlots:function(){this.slotsBarrier?this.slotsBarrier.cancel(!0):this.slotsBarrier=new r,this.adLoadBarrier&&this.adLoadBarrier.reject(),this.adLoadBarrier=e.Deferred(),this.activeSlotStatistics={adLite:this.adLite,high_impact:0,high_impact_info:[],iab:0,noad:0,unknown:0}},getActiveSlotStatistics:function(){return this.adLoadBarrier.then(t.bind(function(){return this.slotsBarrier.wait()},this)).then(t.bind(function(){var i=this.activeSlotStatistics;return e.Deferred(function(e){t.defer(function(){e.resolve(i)})})},this))},updateActiveSlotStatistics:function(e,i){var s=t.findWhere(this.activeSlotStatistics.high_impact_info,{adType:e});s&&(s.state=i)},_initializeGoogletag:function(){googletag.cmd.push(function(){var e=googletag.pubads();l.logInfo("Collapses the empty divs. Used for the asset pages where the slot and placement are the same"),e.collapseEmptyDivs(),e.enableSingleRequest(),l.logInfo("Disabling initial load of slots"),e.disableInitialLoad(),n.checkForEmail(document.location.href)?(l.logInfo("Ad calls not enabled, email detected in URL"),window.noAds=!0):(l.logInfo("Enabled the ad calls"),googletag.enableServices(),window.noAds=!1)})},_initializeBaseTargeting:function(){var i=googletag.pubads(),s=n.getNested(window.site_vars,"ADS","adblock_cookie");googletag.cmd.push(t.bind(function(){var t=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join();i.setTargeting("aam",t),i.setTargeting("u",e.cookie("aam_uuid")||""),i.setTargeting("userguid",e.cookie("gup_anonid")||""),i.setTargeting("ksg",(localStorage.getItem("kxgannett_segs")||"").split(",")),i.setTargeting("kuid",localStorage.getItem("kxgannett_user")||""),"true"===e.cookie(s)&&i.setTargeting("adblock","disabled"),this.usatl&&i.setTargeting("adlabel",this.usatl);var o=n.getNested(window.site_vars,"ADS","DFP","ENV");l.logInfo("using env targeting: "+o),i.setTargeting("env",o)},this))},onPageLoad:function(i){this._buildSharedAdSlots(i.cst),this.pageLoaded=!0,this._fetchTargeting(),this.targetBarrier?this.targetBarrier.wait().done(t.bind(function(){this.pbLog&&console.log("ADMANAGER: Target barrier released",Date.now());var t=[{},{ss:this.ssInfo}].concat([].slice.call(arguments)),s=e.extend.apply(e,t);l.logInfo("AdManager: requestAds()",i,s),this._setGlobalTargeting(i,s),this._setGlobalExclusionTargeting(i),this._setSimpleTargeting(),a.prototype.pageLoad(),this.adLoadBarrier.resolve()},this)):this.adLoadBarrier.resolve()},_buildSharedAdSlots:function(e){t.each(this.activeAdPlacements,function(t,i){t&&!t.built&&(t.slotInfo=this.getSharedAdSlot(t.name+"/"+e,t.positionMap,t.defaultPosition),this.activeAdPlacements[i].built=!0)},this)},onPageUnload:function(){this.pageLoaded=!1,this._resetSlots(),a.prototype.pageUnLoad(),this._resetTargeting(),this.requestedBids=!1,window.pbjs&&(pbjs.firstLoad=!1),window.apstag&&(window.apstag.firstLoad=!1,window.apstag.gannettSlots=[])},_resetTargeting:function(){this.targetBarrier&&this.targetBarrier.cancel(!0),this.targetBarrier=new r,this._clearGlobalTargeting()},isPageLoaded:function(){return this.pageLoaded},_clearGlobalTargeting:function(){googletag.cmd.push(t.bind(function(){var e=googletag.pubads(),i=this.globalTargetingKeys;l.logInfo("clear pubads() targetting",i),t.each(i,function(t){e.clearTargeting(t)}),this.globalTargetingKeys=[]},this))},_setGlobalTargeting:function(i,o){var a=this,r=s.getActiveApp(),h=e.extend({},this.getPageAdTargeting(i),o,r&&r.getClientAdInfo());this.globalTargetingKeys=[],googletag.cmd.push(t.bind(function(){var e=googletag.pubads();t.each(h,function(t,i){(t||0===t||t===!1)&&(t=n.scrubEmail(t),a.globalTargetingKeys.push(i),e.setTargeting(i,t),l.logInfo("set pubads() targetting - key:"+i+" value:"+t))}),this.adLite&&e.setTargeting("adlite","true")},this))},_setGlobalExclusionTargeting:function(e){var i,s=e.seokeywords||"",o=e.taxonomykeywords||"",a=n.getNested(window,"site_vars","ADS","exclusion_categories")||[];s=t.isArray(s)?s:s.split(","),o=t.isArray(o)?o:o.split(","),i=t.map(t.compact(t.union(s,o)),function(e){return e.toLowerCase().trim()}),googletag.cmd.push(t.bind(function(){var e=googletag.pubads();e.clearCategoryExclusions(),t.each(a,function(s){var n=t.map(s.tags,function(e){return e.toLowerCase()}),o=t.intersection(i,n);t.isEmpty(o)||e.setCategoryExclusion(s.name)}),this.adLite&&e.setCategoryExclusion("Ad Lite")},this))},_setSimpleTargeting:function(){var e=t.uniq(window.simpleExclusion||[]),i=t.uniq(window.simpleTarget||[]),s=i.concat(e);googletag.cmd.push(function(){var i=googletag.pubads();t.each(e,function(e){i.setCategoryExclusion(e)}),i.setTargeting("categoryvalue",s)})},_getTargetingReferrer:function(){var e=s.getReferrer().match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i),t=e&&e[1];return t=t?t.split(".").slice(-2).join("."):"NA"},_getNavigationType:function(e){var t="external";return e?t="autorefresh":s.lastUrl||-1!==document.referrer.indexOf(n.getNested(window,"site_vars","base_url"))?t="internal":document.referrer||(t="direct"),t},_readUserInsights:function(){var e={};try{e=JSON.parse(window.localStorage.getItem("user_insights"))||{}}catch(t){}return e},getPageAdTargeting:function(e){var t=n.getNested(window,"site_vars","aws_site_name")||"usat",i=n.getNested(e,"cst")||"",s=n.getNested(e,"ssts")||"",o=i.split("/"),a=s.split("/"),r=e.prevPvParams||{},l=e.prevPageInfo||{},h=e.user||{},d=h.abTest||{},c=(n.getNested(window,"site_vars","version")||"0.0").split("."),u=n.getUrlParam("navigationtype")||this._getNavigationType(e.refreshed),p=n.getNested(e,"breaking"),f=p?"breaking":p===!1?"none":"NA",g=this._readUserInsights(),m=void 0!==g.doLookALike?g.doLookALike.toString():"NA",v="front-list-sidebar-page"==n.getNested(e,"layout_type")?"dfr":"legacy desktop";return{build:v,dolookalike:m,version_major:c[0],version_minor:c[1],version_patch:"0",property:t,pageType:e.basePageType,referrer:this._getTargetingReferrer(),series:e.series,sitepage:t+"/"+s,contentid:e.assetid,topic:e.topic,cst_section:o[0]||"NA",cst_subsection:o[1]||"NA",cst_topic:o[2]||"NA",ssts_section:a[0]||"NA",ssts_subsection:a[1]||"NA",ssts_topic:a[2]||"NA",ssts_subtopic:a[3]||"NA",abTestId:d.id||"NA",abTestVariant:n.getNested(d,"userVariant","id")||"NA",clickAbTestId:r.abTestId||"NA",clickAbTestVariant:r.abTestVariant||"NA",prevAbTestId:n.getNested(l,"user","abTest","id")||"NA",prevAbTestVariant:n.getNested(l,"user","abTest","userVariant","id")||"NA",navigationtype:u,alerttype:f,origin:(e.origin||"NA").replace(/[\/\-_]/g,""),utm_props:this.getUtm(),aam_props:"reimagine|desktop|"+e.contenttype}},getUtm:function(){var e=n.getUrlParam,t=e("utm_source")||"",i=e("utm_medium")||"",s=e("utm_campaign")||"";return t+"|"+i+"|"+s},onUserStatusChange:function(e,i){if("firefly"===e)if("loggedIn"==i||"loggingIn"==i){
var s=o.getCoreUserInfo();s=s.then(t.bind(function(e){e.UserLicenseType?this.ssInfo=t.map(e.UserLicenseType.split("_"),function(e){return e.substring(0,3)}).join("_"):this.ssInfo=null},this),t.bind(function(){this.ssInfo=null},this)),this.targetBarrier.add(s,2e3,!0)}else this.ssInfo=null},getAdActualSizes:function(e){return this._mapAdSizeNamesToActualSizes(e)},_mapAdSizeNamesToActualSizes:function(e){if(t.isString(e)){var i=e.split(",");return i.length>1?this._processAdSizeData(i):this._processAdSizeData([e])}return t.isArray(e)?this._isAdSizeArray(e)?this._processAdSizeData([e]):this._processAdSizeData(e):[]},_processAdSizeData:function(e){return t.reduce(e,function(e,i){var s;return t.isString(i)?s=this._getAdSizeFromString(i):t.isArray(i)&&this._isAdSizeArray(i)&&(s=i),s&&e.push(s),e},[],this)},_isAdSizeArray:function(t){return 2===t.length&&e.isNumeric(t[0])&&e.isNumeric(t[1])},_getAdSizeFromString:function(e){var t=this.getSize(e);if(!t){var i=e.toLowerCase().split("x");2===i.length&&(i=[parseInt(i[0],10),parseInt(i[1],10)],this._isAdSizeArray(i)&&(t=i))}return t},_buildAdSizesFromPlacements:function(i){var s=[];return t.each(i,function(t){var i=this._mapAdSizeNamesToActualSizes(t.getAdSizes());e.merge(s,i)},this),t.uniq(s)},refreshSharedAdPosition:function(e){var i=this.activeAdPlacements[e];return i?i.slotInfo?(t.each(i.positionMap,function(e){e.destroyAdPlacement()},this),void i.slotInfo.refresh()):void l.logError("AdManager: tried refreshing shared ad position that hasn't been requested yet"):void l.logError("AdManager: tried refreshing shared ad position that no longer exists")},registerSharedAdPosition:function(e){var i=e.getAdPlacement(),s=e.getAdType();if(this._checkPageChange(),s&&!t.isArray(s)&&(s=[s]),!i||!s||!s.length)return void l.logError("AdManager: invalid ad unit registered, adUnit and adType are required",e);var n=this._getAdPlacementInfo(i);this._addAdToPlacementInfo(n,e,s)},_getAdPlacementInfo:function(e){var t=this.activeAdPlacements[e];return t||(this.activeAdPlacements[e]=t={name:e,positionMap:{},defaultPosition:null,slotInfo:null,numPositions:0,built:!1}),t},_addAdToPlacementInfo:function(e,i,s){t.each(s,function(t){return e.positionMap[t]?void l.logError("AdManager: invalid ad unit registered, duplicate adType registered",i):(l.logInfo("AdManager: registerSharedAdPosition for adPlacement: "+e.name+" and adType:"+t),void(e.positionMap[t]=i))}),e.numPositions++,i.isDefaultPosition()&&(e.defaultPosition?l.logWarn("AdManager: multiple ad placements declared themselves default for adUnit: "+e.name,i):e.defaultPosition=i)},_checkPageChange:function(){var e=window.location.pathname;e!==this.siteUrl&&(this.siteUrl=e,t.each(this.activeAdPlacements,function(e){e&&l.logError("Site Url changed, but ad placements were not released: ",e)}),this.activeAdPlacements={})},destroySharedAdPosition:function(e){var i=e.getAdPlacement(),s=e.getAdType(),n=this.activeAdPlacements[i];return n?(s&&!t.isArray(s)&&(s=[s]),t.each(s,function(t){var s=n.positionMap[t];return s?(l.logInfo("AdManager: destroySharedAdPosition for adPlacement: "+i+" and adType:"+t),void(n.positionMap[t]=null)):void l.logError("AdManager: destruction of unknown ad type",e)}),e.isDefaultPosition()&&(n.defaultPosition=null),n.numPositions--,void(n.numPositions||(n.slotInfo&&n.slotInfo.destroy(),this.activeAdPlacements[i]=null))):void l.logError("AdManager: destruction of unknown ad unit",e)},_createScript:function(e,t,i){l.logDebug("Creating script",e,t,i[0]);var s=document.createElement("script");s.id=e,s.src=t,s.type="text/javascript",s.defer=!1,i[0].appendChild(s)},logDebug:function(){l.logDebug.apply(l,arguments)},logError:function(){l.logError.apply(l,arguments)},logInfo:function(){l.logInfo.apply(l,arguments)},logWarn:function(){l.logWarn.apply(l,arguments)}},new h}),define("api/ads",["jquery","admanager"],function(e,t){"use strict";return{registerAd:function(i,s,n,o){var a=e("string"==typeof i?"#"+i:i),r={$el:a,render:function(e,t){},noAd:function(){}};t.getAdSlot(s,o,[],n,r,"in")}}}),define("managers/autoplay",["jquery","underscore","pubsub","admanager","utils"],function(e,t,i,s,n){"use strict";var o=function(){this.pubSub={"page:load":this._onPageLoad,"page:unload":this._onPageUnload}};return o.prototype={start:function(){this._pageIndex=0,this._currentModules=this._currentModules||{},this._playedModules=[],this._autoPlayOrder=n.getNested(window.site_vars,"autoplay","default")||[],i.attach(this.pubSub,this)},reset:function(){this._currentModules={},this._playedModules=[]},stop:function(){i.unattach(this.pubSub,this)},register:function(e,i){this._currentModules=this._currentModules||{},t.isFunction(i)&&(this._currentModules[e]=i)},_onPageLoad:function(){s.getActiveSlotStatistics().done(t.bind(function(e){e&&e.adLite||this._go(0,this._pageIndex)},this))},_onPageUnload:function(){this._pageIndex++,this.reset()},_go:function(e,i){i===this._pageIndex&&this._triggerAutoPlay(e||0).then(t.bind(function(){this._go(e+1,i)},this))},_triggerAutoPlay:function(i){var s=this._getAutoPlayResult(i);return s&&t.isFunction(s.then)?s:e.Deferred(t.bind(function(e){s===!1?e.reject():s===!0?e.resolve():(console.error("AutoPlayManager: Invalid return value from "+this._autoPlayOrder[i]+".startAutoPlay()"),e.resolve())},this))},_getAutoPlayResult:function(e){var t=this._autoPlayOrder[e],i=this._playedModules,s=this._currentModules[t];return s?(this._playedModules=this._playedModules.concat(t),s(i)):e<this._autoPlayOrder.length}},new o}),define("site-manager",["jquery","underscore","backbone","utils","pubsub","state","abtest-manager","managers/routemanager","managers/autoplay"],function(e,t,i,s,n,o,a,r,l){var h=i.View.extend({el:"body",initialize:function(){window.appViewEventProxy=n,window.Utils=s,window.siteManager=this,this.DEBUG=s.get("DEBUG"),this.$win=s.get("win"),this.$top=s.get("scrollEl"),this.pubSub={scrollTop:this.scrollTop},n.attach(this.pubSub,this)},start:function(e,i){this.$win.on("resize."+this.cid,t.throttle(function(e){n.trigger("resize:app")},500)).trigger("resize"),this.$el.on("click."+this.cid,"a,area",t.bind(this.triggerRoute,this)),this.$el.on("submit."+this.cid,"form.ui-ajax-form",t.bind(this.triggerForm,this)),e&&(window.header=this.header=new e),r.start(i||void 0===i),o.start(this.header),l.start()},getHeader:function(){return this.header},scrollTop:function(e,t){return this.header?this.header.scrollTop(e,t):0},stop:function(){this.$el.off("."+this.cid),this.$win.off("."+this.cid),l.stop(),o.stop(),r.stop()},destroy:function(){this.undelegateEvents(),window.header&&delete window.header,delete window.appViewEventProxy,delete window.Utils,n.unattach(this.pubSub,this)},triggerRoute:function(t){var i=e(t.currentTarget),s=e.trim(i.attr("href"));t.isDefaultPrevented()||this._isMetaKey(t)?n.trigger("track",{event:t,url:s}):i.attr("target")?(n.trigger("track",{event:t,url:s}),this._goPopup(i,s)&&t.preventDefault()):s?(t.preventDefault(),r.goTo(s,i.data("trackLabel")||i.data("uotrack")||i.data("ht"),t)):(n.trigger("track",{event:t}),t.preventDefault())},_isMetaKey:function(e){return e.metaKey||e.ctrlKey||e.altKey||2==e.which},_goPopup:function(e,t){var i=e.attr("target");return"_popup"===i||"_blank"===i&&void 0!==e.data("popup")?(s.openPopup(t,e.data("popup-width"),e.data("popup-height")),!0):void 0},triggerForm:function(i){var s=e(i.currentTarget),n=s.data("mapping"),o={},a=s.attr("action");i.isDefaultPrevented()||(n&&(e.each(s.serializeArray(),function(e,t){o[t.name]=t.value}),a+=t.template(n,o)),i.preventDefault(),r.goTo(a,s.data("trackLabel")||s.data("uotrack")||s.data("ht"),i))}});return new h}),define("third_party_integrations/sourcepoint/sourcepoint-utils",["jquery","underscore","utils","managers/autoplay","cookie"],function(e,t,i,s){"use strict";if(window._sp_){var n=function(){t.bindAll(this,"autoplay","spCallback","spChoiceCallback","buildProp41"),this.autoplayPromise=e.Deferred(),this.whitelist="n/a",this.recovery="n/a",this.msg_id="n/a",this.cmpgn_id="n/a",window._sp_.config=window._sp_.config||{},window._sp_.config.mms_client_data_callback=this.spCallback,window._sp_.config.mms_choice_selected_callback=this.spChoiceCallback,window._sp_.config.sp_script_blocked||s.register("sourcepoint",this.autoplay)};return n.prototype={autoplay:function(){return this.autoplayPromise},spCallback:function(t){if(t.msgID){var s=t.info||{},n=t.o||{},o=i.getNested(window.site_vars,"ADS","adblock_cookie");this.whitelist=n.wl?"whitelist-y":"whitelist-n",this.recovery=n.oir?"recovery-y":"recovery-n",this.msg_id=s.msg_id,this.cmpgn_id=s.cmpgn_id;var a=this.buildProp41()+"|impression";window.utag.link({clickName:a,clickPage:location.href,linkTrackVars:"prop41,prop64"}),window._sp_.displayed_message=!0,o&&e.cookie(o,!0,{expires:365})}else console.info("no message"),this.autoplayPromise.resolve()},spChoiceCallback:function(e){var t={1:"whitelist",2:"opt-in-recovery",3:"alt-ad"},i=t[e]||e;"whitelist"===i?this.whitelist="whitelist-y":"opt-in-recovery"===i&&(this.recovery="recovery-y");var s=this.buildProp41()+"|choice-"+i;window.utag.link({clickName:s,clickPage:location.href,linkTrackVars:"prop41,prop64"})},buildProp41:function(){return"adblockmessage|sp-"+this.cmpgn_id+"-"+this.msg_id+"|"+this.whitelist+"|"+this.recovery}},new n}}),define("base-app",["jquery","underscore","baseview","state","managers/trafficcop","site-manager","utils","pubsub","managers/resourcemanager","managers/routemanager","abtest-manager","third_party_integrations/sourcepoint/sourcepoint-utils"],function(e,t,i,s,n,o,a,r,l,h,d){"use strict";var c=i.extend({currentPath:"",initialize:function(t){this._animId=0,this._fixedOffset=null,this.$top=a.get("scrollEl"),this.appRevealed=!1,this.pubSub=e.extend({"header:fixed":this._onHeaderFixed,"header:unfixed":this._onHeaderUnfixed},this.pubSub),i.prototype.initialize.call(this,t)},isRevealed:function(){return this.appRevealed},revealApp:function(e,t,i,s,n){var o=this._buildRequestInfo(e,t,i,s,n);return i?"rejected"===i.state()?i:this._handleAsyncReveal(i,o):this._handleInitialReveal(o)},_buildRequestInfo:function(t,i,s,n,o){return{fromUrl:t,toUrl:i,animId:++this._animId,resourcePromise:n||e.Deferred().resolve(),requestPromise:s||e.Deferred().resolve(),modulePromise:e.Deferred(),paused:o}},_handleInitialReveal:function(i){var s=e(".site-header").next();s.length||(s=a.get("body")),this.setElement(s);var n=this._setPageInfo(s,i);return this._isCorrectApp(n.jsUrl).then(t.bind(function(){return this.$el.hasClass("js-ab-app-el")&&(this.$el.removeClass("js-ab-app-el"),this.$(".js-ab-content-el").removeClass("js-ab-content-el"),this.$(".js-ab-loader").remove()),this._triggerAfterPageReveal(i)},this))},_handleAsyncReveal:function(i,s){var n;return"resolved"===i.state()?i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,s).then(t.bind(function(){return this._updateState(s),this._revealAppMarkup(e,s).then(t.bind(function(){return this._finishReveal(e,s)},this))},this))},this)):(n=this.getRevealAppLoader(s.toUrl),n instanceof e||(n=e(n)),this._revealAppMarkup(n,s).then(t.bind(function(){return this.afterLoaderReveal(),i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,s).then(t.bind(function(){return this._updateState(s),this._handleRevealLoaderContentSwap(e,s).then(t.bind(function(){return this.setElement(e,!1),this._finishReveal(e,s)},this))},this))},this))},this)))},_updateState:function(e){e.paused||s.updateState()},_revealAppMarkup:function(t,i){this._insertAppMarkup(t,i.paused);var s=this._safeCall("animateRevealApp",i.fromUrl,i.toUrl,i.paused);return s?n.addAnimation(s):e.Deferred().resolve()},_handleRevealLoaderContentSwap:function(t,i){return i.animId!==this._animId?e.Deferred().reject():(this.beforeLoaderRemove(),this.swapContent(this.$el,t,i.paused,this.getHash(i.toUrl)))},_finishReveal:function(t,i){return i.animId!==this._animId?e.Deferred().reject():(i.paused&&this.setFixedPosition(this.$el.offset().top),this._triggerAfterPageReveal(i))},_fetchPageModules:function(e,t){t.paused?t.modulePromise.resolve():t.resourcePromise.done(function(){l.fetchPageModules(e.js_modules).done(t.modulePromise.resolve)})},_insertAppMarkup:function(t,i){var s=e(".site-header");this.setElement(t,!1),t.hasClass("js-ab-app-el")||(t.hide(),this.$el.insertAfter(s)),i&&this.setFixedPosition(s.outerHeight())},changePage:function(e,t,i,s,n){var o=this._buildRequestInfo(e,t,i,s,n);return this.destroyModules(),i?this._handleChangePageRequest(i,o):this._handleChangePageNoRequest(o)},_handleChangePageNoRequest:function(e){return this._fetchPageModules(this.pageInfo,e),this._triggerAfterPageReveal(e)},_handleChangePageRequest:function(i,n){var o=this.animateChangePagePreData(n.fromUrl,n.toUrl);return o||this._triggerGenericLoader(i),i=i.then(t.bind(function(e){return this._triggerBeforePageReveal(e,n).then(function(){return e})},this)),e.when(i,o).then(t.bind(function(e){return n.paused||s.updateState(),this._finishChangePage(e,n)},this))},_triggerGenericLoader:function(e){"pending"===e.state()&&(this.activateLoader(),e.always(t.bind(function(){this.deactivateLoader()},this)))},_finishChangePage:function(i,s){if(s.animId!==this._animId)return e.Deferred().reject();var n=this.animateChangePagePostData(s.fromUrl,s.toUrl,i,s.paused)||e.Deferred().resolve();return s.paused&&this.setFixedPosition(this.$el.offset().top),n.then(t.bind(function(){return this._triggerAfterPageReveal(s)},this))},updateLayoutFlag:function(){if(!s.getPreloadedApp()){var e=a.get("body"),t=e.attr("data-layout")||"",i=this.pageInfo.layout_type||"";t!==i&&(t&&e.removeClass(t+"-layout"),i&&e.addClass(i+"-layout"),e.attr("data-layout",i))}},swapContent:function(t,i,s,n){return a.getNested(window.site_vars,"flags","disable_swap_fade")||this.isSafari5||this.isApple||s?(i.insertAfter(t),t.remove(),e.Deferred().resolve()):this._crossFade(t,i,n)},_crossFade:function(e,t,i){var s=parseInt(e.css("top"),10)||e.offset().top||0;return s-=a.getScrollPosition(),t.css({"z-index":100,overflow:"hidden"}),e.css({position:"absolute","z-index":101,opacity:1,top:s}),t.insertAfter(e),i&&this._scrollToHashTag(t,i)||o.scrollTop(0),this.animate(e,"opacity",0,this.options.animations.fadeIn.duration).always(function(){t.css({"z-index":"",overflow:""}),e.remove()})},_scrollToHashTag:function(e,t){var i=this._getOffset(e,t);return i.top?(this.$top.scrollTop(i.top-this.$el.offset().top),!0):void 0},_getOffset:function(e,t){try{return e.find("a[name="+t+"]").offset()||{}}catch(i){console.warn("Invalid hashtag",t)}return{}},pause:function(){this.destroyModules(!1,!0)},getHash:function(e){var t=e.indexOf("#");return-1!==t?e.substring(t+1):null},_triggerAfterPageReveal:function(i){return e.when(i.resourcePromise,i.modulePromise).done(t.bind(function(e,t){i.animId===this._animId&&(i.paused||(r.trigger("page:beforeLoad",this.pageInfo),this._initPage(null!==i.fromUrl,e,t)),this._safeCall("afterPageReveal",i.fromUrl,i.toUrl,i.paused,e&&e[0]),this.appRevealed=!0,this.currentPath=i.toUrl,i.paused||this.trackPageLoad(this.pageInfo),window.GidgitsJS&&window.GidgitsJS.refresh&&window.GidgitsJS.refresh())},this))},_safeCall:function(e){try{return this[e].apply(this,Array.prototype.slice.call(arguments,1))}catch(t){console.error("View threw an exception on "+e,t.stack||t.stacktrace||t.message)}},_initPage:function(e,t,i){e&&(this.delegateEvents(),this._updatePageTitle(),this.updateLayoutFlag()),t&&t.length>1?this._initModules(t[1].concat(i||[])):this._initModules(i)},_triggerBeforePageReveal:function(e,t){this._safeCall("beforePageReveal",t.fromUrl,t.toUrl,e,t.paused);var i=this._setPageInfo(e,t);return this._isCorrectApp(i.jsUrl)},_isCorrectApp:function(t){var i=this;return e.Deferred(function(e){if(t){var s=h.getInfo(t);if(s&&s.app.AppClass.prototype!==Object.getPrototypeOf(i))return void e.reject("InvalidApp",s)}e.resolve()})},_setPageInfo:function(e,t){var i;return i=t.fromUrl||t.paused?a.parsePageInfo(e):s.getActivePageInfo(),this.verifyPageInfo(i,t),this._fetchPageModules(i,t),t.requestPromise.ajaxPromise&&(i.headerAbVariant=t.requestPromise.ajaxPromise.getResponseHeader("X-AbVariant")),t.paused||r.trigger("activePageInfo:set",i),r.trigger("pageInfo:set",i),this.pageInfo=i,i},verifyPageInfo:function(e,t){return e.templatetype=e.templatetype||"",e.ssts=e.ssts||"bugpages",e.cst=e.aws||e.cst||"undefined",e.routePath=e.routePath||t.toUrl,e},_updatePageTitle:function(){if("None"===(this.pageInfo.seotitle||"None")){var e=a.getNested(window.site_vars,"display_name");e&&(document.title=e)}else document.title=this.pageInfo.seotitle},removeApp:function(e,i){return this._animId++,this._safeCall("beforeAppRemove",e,i),this.destroyModules(!1),this._triggerAnimateRemoveApp(e,i).always(t.bind(function(){this._safeCall("afterAppRemove",e,i),this._safeDestroy()},this))},_triggerAnimateRemoveApp:function(t,i){var s=this._safeCall("animateRemoveApp",t,i);return s?n.addAnimation(s):e.Deferred().resolve()},_safeDestroy:function(){try{this.destroy(!0)}catch(e){console.error("View threw an exception on destroy: ",e.stack||e.stacktrace||e.message),this.$el.remove()}},getWindowOffset:function(){return this.el?this.el.getBoundingClientRect():{top:0,left:0}},animateRevealApp:function(t,i,s){return this.isApple&&s?e.Deferred().resolve():this.show(!0)},animateRemoveApp:function(e,t){return this.hide(!0)},animateChangePagePreData:function(e,t){return null},animateChangePagePostData:function(e,t,i,s){var n=this.swapContent(this.$el,i,s,this.getHash(t));return this.setElement(i,!1),n},setFixedPosition:function(e,t){t||!this.isSafari5&&!this.isApple?(this._header=o.getHeader(),this._header?this._header.isFixed()?(this._header.isOpen()?this._fixedOffset=e-this._header.getFixedThreshold():this._fixedOffset=e,this.$el.css({position:"fixed",top:e})):(this._fixedOffset=e=this.$el.offset().top,this.$el.css({position:"absolute",top:e})):this._fixedOffset=e):this.$el.hide()},clearFixedPosition:function(e){this._fixedOffset=null,e||!this.isSafari5&&!this.isApple?this.$el.css({position:"",top:""}):this.$el.show()},_onHeaderFixed:function(){this._header&&null!==this._fixedOffset&&(this._fixedOffset-=this._header.getFixedThreshold(),this.$el.css({position:"fixed",top:this._fixedOffset}))},_onHeaderUnfixed:function(){this._header&&null!==this._fixedOffset&&(this._fixedOffset+=this._header.getFixedThreshold(),this.$el.css({position:"absolute",top:this._fixedOffset}))},activateLoader:function(){},deactivateLoader:function(){},beforeAppRemove:function(e,t){},afterAppRemove:function(e,t){},beforePageReveal:function(e,t,i,s){},afterPageReveal:function(e,t,i,s){s&&(this.subviews.page=new s({el:this.$el}))},getRevealAppLoader:function(e){return'<section class="ui-loading dark-medium ui-app-loader"></section>'},beforeOverlayRemove:function(e){},afterOverlayReveal:function(e){},afterLoaderReveal:function(){},beforeLoaderRemove:function(){},getClientAdInfo:function(){return{}},parsePageInfo:function(e){return s.parsePageInfo(e)},getClientInfo:function(){return{}},trackPageLoad:function(e){var i=a.getNested(window.site_vars,"flags","traffic_cop_defer");i?r.trigger("page:load",e):t.defer(function(){n.getAnimationCompletion().done(function(){r.trigger("page:load",e)})})},buildModules:function(e){return l.fetchPageModules(e).done(t.bind(this._initModules,this))},_initModules:function(e){this.destroyed||t.each(e,this._initModule,this)},_initModule:function(e){var i=e.selector,s=this.seenModules[e.name]||0;e.position&&(i="#module-position-"+e.position+i+",#module-position-"+e.position+" "+i),this.$(i).each(t.bind(function(t,i){if(-1!==i.className.indexOf("companion-galleries"))return!1;try{this.subviews[e.name+s]=new e.ModuleClass(this._getModuleOptions(i,e))}catch(n){console.error("failed loading module "+e.name,n.stack||n.stacktrace||n.message)}s+=1},this)),this.seenModules[e.name]=s},_getModuleOptions:function(i,s){var n=e(i).attr("data-options-id")||"default",o=t.findWhere(a.getNested(window.site_vars,"moduleOptions"),{moduleName:s.name}),r=t.find(a.getNested(o,"optionSets"),function(e){return e.id===n})||{},l=d.getUserTestByTarget(s.name),h=a.getNested(l,"userVariant","options")||{},c=t.extend({},r,s.options,h);return l&&(c.abTest=l),c.el=i,c.layoutType=s.layoutType,c}});return c}),define("apps/contact-us-staff",["jquery","underscore","base-app","utils"],function(e,t,i,s){var n=i.extend({events:{"click .js-cufwa-jumper":"jumpToGroup"},beforePageReveal:function(){var e=s.get("body");e.hasClass("cufwa-body")||e.addClass("cufwa-body")},beforeAppRemove:function(){e("body").removeClass("cufwa-body")},jumpToGroup:function(t){t.preventDefault();var i=e(t.currentTarget).data("anchor"),s=this.$(".js-cufwa-jump[data-anchor='"+i+"']");e("html, body").animate({scrollTop:s.offset().top-60},500)}});return n}),define("apps/interactives",["jquery","underscore","base-app"],function(e,t,i){var s=i.extend({trackPageLoad:function(e){window.top===window&&i.prototype.trackPageLoad(e)}});return s}),define("apps/simple-overlay",["jquery","underscore","backbone","base-app","state","utils","site-manager","managers/routemanager","pubsub","user-manager"],function(e,t,i,s,n,o,a,r,l,h){"use strict";var d=s.extend({el:"#overlay",events:{"click .transition-wrap":"close","click .close-overlay":"close"},initialize:function(i){var n=o.getNested(window,"site_vars","flags","disable_overlay_animations");i=e.extend(!0,{template:'<div id="overlay" class="no-transition"><div class="transition-wrap"><article class="asset clearfix story overlay-loader-wrap"><div class="overlay-loader-init"></div></article></div></div>',animations:{fadeIn:{duration:n?0:200},fadeOut:{duration:n?0:200}},disableAnimations:n},i),t.bindAll(this,"resizeHandler","scrollHandler","onBreakingOpen","onBreakingClose","onVideoBarExpand","onVideoBarCollapse"),this.win=o.get("win"),this.scrollEl=o.get("scrollEl"),this.$body=o.get("body"),this.header=a.getHeader(),this.pubSub={"video:after:expandBar":this.onVideoBarExpand,"video:collapseBar":this.onVideoBarCollapse,"breakingbar:after:open":this.onBreakingOpen,"breakingbar:after:close":this.onBreakingClose,"newsreel:open":this.onNewsreelOpen,"newsreel:unfixed":this.onNewsreelUnfixed},this.resizeHandler(),s.prototype.initialize.call(this,i)},destroy:function(e){this._removeOverlayCardPlaceholder(),this.win.off("."+this.cid),s.prototype.destroy.call(this,e)},onBreakingClose:function(){this.breakingbar=!1,this.bnmHeight=0},onBreakingOpen:function(){this.breakingbar=o.getNested(this.header,"subviews","breakingbar")||!1,this.bnmHeight=e(".bnm-bar").outerHeight()},onNewsreelOpen:function(){this.newsreelOffset=this.$(".nrrm-stb").outerHeight(),this.closeWrapOffset=this.closeWrap.offset().top},onNewsreelUnfixed:function(){this.closeWrap.css({position:"absolute",top:""})},scrollHandler:function(){var t,i=this.closeWrap[0].getBoundingClientRect(),s=this.closeWrap.offset().top,n=this.bnmHeight||0,o=this.videoOffset||0,a=this.newsreelOffset||0,r=this.closeWrapOffset||0,l=n+o+a;this.transitionWrap||(this.transitionWrap=this.$(".transition-wrap:first")),t=this.transitionWrap.offset().top,0>s-t+l||a>0&&e(document).scrollTop()<r?this.closeWrap.css({position:"absolute",top:""}):i.top<=40+l&&this.closeWrap.css({position:"fixed",top:40+l})},resizeHandler:function(){this.winSize={width:this.win.width(),height:this.win.height()},this.header&&(this.winSize.height-=this.header.getCollapsedHeight()),this.setArticleMinHeight(this.$(".transition-wrap:first .asset"))},setArticleMinHeight:function(e){e.length&&e.outerHeight()<this.winSize.height&&e.css("min-height",this.winSize.height)},_onHeaderFixed:function(){this.overlayOffsetPlaceholder&&this._fixPlaceholder(),s.prototype._onHeaderFixed.apply(this,arguments)},_onHeaderUnfixed:function(){this.overlayOffsetPlaceholder&&this._unfixPlaceholder(),s.prototype._onHeaderUnfixed.apply(this,arguments)},_fixPlaceholder:function(){this.overlayOffsetPlaceholder.css({position:"fixed",top:-1*this.header.getFixedThreshold()})},_unfixPlaceholder:function(){this.overlayOffsetPlaceholder.css({position:"absolute",top:0})},_removeOverlayCardPlaceholder:function(){this.overlayCardPlaceholder&&(this.overlayOffsetPlaceholder.remove(),this.overlayOffsetPlaceholder=null,this.overlayCardPlaceholder.remove(),this.overlayCardPlaceholder=null)},onVideoBarExpand:function(){this.videoOffset=this.$(".js-pvb").outerHeight(),this.scrollHandler()},onVideoBarCollapse:function(){this.videoOffset=0,this.closeWrap.css({top:40}),this._onHeaderFixed()},beforeAppRemove:function(e,t){this.win.off("."+this.cid),this.positionCloseButton("absolute",o.getScrollPosition())},animateRemoveApp:function(e,t){return this.isSafari5||this.options.disableAnimations?this.hide():(this.header&&this.header.updateNavigation(t),this.$el.css({position:"relative",opacity:1}),this.animate(this.$el,"opacity",0,250))},beforePageReveal:function(e,t,i,s){i.find(".asset").css("min-height",this.winSize.height)},animateRevealApp:function(i,s,n){var o=this.$(".transition-wrap"),a=this.winSize.height;if(this.transitionWrap=o,this.isSafari5||!e.support.css.transform||this.options.disableAnimations)return o.css("height",a),this.show();o.css({height:a,overflow:"hidden",opacity:0}),o[0].style[e.support.css.transform.cssName]="scale(0.4)",o[0].style[e.support.css.transform.originCssName]="50% "+.25*a+"px",o[0].style[this.transitionCssName]=e.support.css.transform.cssHyphenName+" 300ms linear, opacity 300ms linear",this.$el.show().css({opacity:1,display:"block"}),t.delay(t.bind(function(){o[0].style[e.support.css.transform.cssName]="scale(1.0)",o[0].style.opacity=1},this));var r=e.support.css.transition.registerTransitionEndListener(o[0]);return r.done(t.bind(function(){o[0].style[e.support.css.transform.cssName]="",o[0].style[this.transitionCssName]="",o[0].style[e.support.css.transform.originCssName]=""},this)),r.promise()},getRevealAppLoader:function(e){return this.options.template},afterLoaderReveal:function(){this.loaderTimeout=setTimeout(t.bind(function(){var e=this.$(".overlay-loader-init");e.length>0&&e.removeClass("overlay-loader-init").addClass("ui-circle-loader overlay-circle-loader")},this),200)},beforeLoaderRemove:function(){clearTimeout(this.loaderTimeout)},animateChangePagePreData:function(t,i){var s=this.winSize.height,n=o.getScrollPosition(),r=this.$(".transition-wrap:first");this.prepareContentForTransition(r,n,s);var l=e(this.options.template),h=l.find(".transition-wrap");return this.prepareContentForTransition(h,0,s),this.$el.prepend(h),a.scrollTop(0),this.positionCloseButton("absolute",n,r),this.swapContent(r,h)},prepareContentForTransition:function(e,t,i){e.css({height:i}),e.children().css({top:-1*t})},animateChangePagePostData:function(e,i,s,n){var o=s.find(".transition-wrap");return o.css("height",this.winSize.height),this.setArticleMinHeight(o.find(".asset")),this.beforeLoaderRemove(),this.swapContent(this.$(".transition-wrap:first"),o,this.getHash(i)).done(t.bind(function(){o.css("height","")},this))},afterPageReveal:function(i,s,n,a){var r=this.$(".transition-wrap:first");r.css({height:"",overflow:"visible"}),this.currentSection=this.getSectionName(),this.transitionWrap=r,this.closeWrap=this.$(".close-wrap"),this.preloadedUrl=this.options.preloadedUrl||this.currentSection||"/",this.header&&this.header.updateNavigation((this.pageInfo||{}).ssts),null===i&&(o.flag("disable_overlay_preload")?(this.overlayOffsetPlaceholder=e('<div id="cards-offset-placeholder" style="height:'+(this.header.getExpandedHeight()+50)+'px;"></div>'),this.overlayCardPlaceholder=e('<div class="card-wrap card-wrap-behind-overlay card-wrap-placeholder"></div>'),this.header.isFixed()?this._fixPlaceholder():this._unfixPlaceholder(),this.$body.append(this.overlayOffsetPlaceholder,this.overlayCardPlaceholder)):this.preloadPath()),a&&(this.subviews.view=new a({el:r,path:s})),this.win.on("resize."+this.cid,t.throttle(this.resizeHandler,50)).on("scroll."+this.cid,t.throttle(this.scrollHandler,50)),this._referrerCheck()},verifyPageInfo:function(e,t){var i=h.getAccount("firefly"),n="nothitpaywall";if(e=s.prototype.verifyPageInfo.apply(this,arguments),i){var o=i.getViewsCookie().viewsRemaining;o>=0&&(n=0===o?"nofreearticlesremaining":o)}return e.numPageViewsLeft=n,e},preloadPath:function(){n.preloadPath(this.preloadedUrl)},positionCloseButton:function(e,t,i){var s=i?i.find(".close-wrap"):this.closeWrap;"absolute"===e?s.css({position:e,"margin-top":"",top:t||0}):s.css({position:e,"margin-top":-80,top:""})},getSectionName:function(){var e=this.pageInfo||{},i=(e.ss||e.ssts||"").split("/")[0];return"home"===i?"/":t.contains(o.getSiteSections(),i)?"/"+i+"/":void 0},close:function(t){if(!(t&&t.target!==t.currentTarget||e(t.currentTarget).hasClass("transition-wrap")&&window.pluto360Asset)){e(t.currentTarget).hasClass("transition-wrap")&&l.trigger("uotrack","transition-wrap-click");var i=e(t.currentTarget).attr("data-ht")||"modalclose";if(l.trigger("heattrack",i),!this.notUW){var s=this.uwCounter,o=2;if(s>=1&&o>=s)return void this._UWRedirect()}return this._removeOverlayCardPlaceholder(),r.goTo(n.getPreloadedUrl()||this.currentSection||"/"),t?!1:void 0}},_UWRedirect:function(){this.uwref?window.history.go(-this.uwCounter):window.location.href=this.referrerUrl},_referrerCheck:function(){this.uwCounter||this.notUW?this.uwCounter>=1&&(this.uwCounter+=1):"1"===this._getQueryVariable("uwref")?(this.uwref=!0,this.uwCounter=1):this.notUW=!0},_getQueryVariable:function(e){for(var t=window.location.search.substring(1),i=t.split("&"),s=0;s<i.length;s++){var n=i[s].split("=");if(n[0]===e)return n[1]}return!1}});return d}),define("third-party-apis/base-third-party-api",["jquery","underscore","backbone","pubsub","utils"],function(e,t,i,s,n){"use strict";var o=i.View.extend({SITE_CONFIG:n.getNested(window.site_vars,"THIRDPARTYAPI"),initialize:function(){s.on("page:load",t.bind(this.loadScript,this))},loadScript:function(){return this.loadScriptPromise||(this.loadScriptPromise=this._handleLoadScript()),this.loadScriptPromise},_handleLoadScript:function(){return e.Deferred().resolve()},setupOnLoadCallbacks:function(e,i){window[e]||(window[e]=t.bind(function(){i()},this))},getApiSiteConfig:function(e){var t=this.SITE_CONFIG;return t?t[e]:(console.error("No siteconfig set up for "+e+" api!"),{})}});return o}),define("third-party-apis/opinionlabs",["jquery","underscore","utils","user-manager","third-party-apis/base-third-party-api"],function(e,t,i,s,n){"use strict";var o=n.extend({initialize:function(){var e=this.getApiSiteConfig("OPINIONLAB");e.ENABLED&&n.prototype.initialize.call(this)},_handleLoadScript:function(){if(!this._loadScriptPromise){this._loadScriptPromise=e.Deferred();var n=i.getNested(window.site_vars,"THIRDPARTYAPI","OPINIONLAB","SOURCE"),o=e.ajax(n[0],{cache:!0,dataType:"script"}),a=e.ajax(n[1],{cache:!0,dataType:"script"});e.when(o,a).done(t.bind(function(){OOo.oo_feedback=new OOo.Ocode({onPageCard:{closeWithOverlay:!0},customVariables:{authenticationStatus:"No",subscriptionStatus:"No",platform:"legacy"}}),OOo.oo_launch=function(e,t){OOo.oo_feedback.options.customVariables.cta=e.target.dataset.cta;var i=e||window.event;OOo[t].show(i)};var e=i.getNested(window.utag_data,"gup_anonid");""!==e&&"undefined"!==e&&null!==e&&(OOo.oo_feedback.options.customVariables.GUID=e),OOo.oo_feedback.options.customVariables.siteId=i.getNested(window.site_vars,"siteid");var n=s.getAccount("firefly");n&&n.getUserInfo().always(t.bind(function(e){e&&"Not logged in."!==e&&(OOo.oo_feedback.options.customVariables.authenticationStatus="Yes",e.hasMarketAccess===!0&&(OOo.oo_feedback.options.customVariables.subscriptionStatus="Yes")),OOo.oo_feedback.options.customVariables.GUID=i.getNested(window.utag_data,"gup_anonid")})),this._loadScriptPromise.resolve()},this))}return this._loadScriptPromise.promise()},launchModal:function(e){OOo.oo_launch(e,"oo_feedback")}});return new o}),define("modules/global/footer",["jquery","underscore","baseview","easing","pubsub","utils","third-party-apis/opinionlabs"],function(e,t,i,s,n,o,a){var r=i.extend({events:{"click .site-index":"toggle",
"click .footer-more-trigger":"showMore","click .site-footer-list-item .feedback-ol-link":"feedbackModal"},initialize:function(e){this.$scrollEl=o.get("scrollEl"),this.$nav=this.$("nav"),this.$toggle=this.$(".site-index"),i.prototype.initialize.call(this,e)},showMore:function(t){t.preventDefault();var i=e(t.currentTarget);i.hide().siblings(".footer-more-item").show()},toggle:function(e){e&&e.preventDefault();var t=this.$el.offset().top-(o.get("headerHeight")||0);this.$toggle.toggleClass("open"),this.$scrollEl.animate({scrollTop:t},500,"easeInOutCubic"),this.$nav.slideToggle(500,"easeInOutCubic")},feedbackModal:function(e){n.trigger("track",{label:"survey_click_footer"}),a.launchModal(e)}});return r}),define("partner/ad-position",["jquery","underscore","baseview","utils","admanager","managers/cachemanager","pubsub","adLogger"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({$head:e("head"),initialize:function(s){s=e.extend({adSizes:[],adPlacement:null,subSection:null,slotType:"in",adWidth:null,adHeight:null,onSetup:null,onAdReady:null,onNoAd:null,beforeAdRender:null},s),this._debounceAdReady=t.debounce(this._adReady,30),this.$el.prop("id")||this.$el.prop("id",t.uniqueId("ad-position-")),i.prototype.initialize.call(this,s),this.tracked=!1,this.adState="pending",this.$el.css({width:"",height:"",display:""});var n=this.$el.closest(".partner-placement"),o=this.options.adSizes;o=t.isArray(o)?o.join(","):o,n.attr("data-monetization-id",this.options.adPlacement.replace(/\/.*/,"")),n.attr("data-monetization-sizes",o)},render:function(e,t,i){this.options.beforeAdRender&&this.options.beforeAdRender(e,t),t||e?this._renderHighImpact(e,t):this._adReady(e,t,i)},_renderHighImpact:function(e,t){this.adType=t,this.adData=e,r.logDebug("AdPosition HighImpact Ad recieved with type: "+t,e),this._renderCustomAd(e)},noAd:function(){this.adState="noad",this.options.onNoAd&&this.options.onNoAd()},getAdState:function(){return this.adState},_renderCustomAd:function(i){return i.dfp&&i.dfp.ecid?(i.html&&(this.$adEl=e(e.parseHTML(i.html,document,!0)),this.$el.append(this.$adEl)),i.stylesheet&&(this.$stylesheet=e('<link rel="stylesheet" data-ad-stylesheet="'+i.dfp.ecid+'" href="'+i.stylesheet+'">'),this.$head.append(this.$stylesheet)),void(i.script?(i.el=this.$el,s.requireSingleUseScript(i.script).done(t.bind(function(e){var t=this._getPubSubKey();if(!this.destroyed){i.initialWidth=this.options.adWidth,i.initialHeight=this.options.adHeight,a.on(t,this._debounceAdReady,this);try{this.subviews.partnerView=new e(i)}catch(s){r.logError("AdSlot("+this.options.adUnit+"): ad delivered threw exception on creation",s.stack||s.stacktrace||s.message)}}},this))):this._adReady())):void r.logError("invalid ad returned, no dfp/ecid found",i)},_getPubSubKey:function(){return"partner:"+this.adData.dfp.ecid+":ready"},destroy:function(e){"hasad"===this.adState&&this.$el.css({width:this.getWidth(),height:this.getHeight()}),this.destroyAdPlacement();var t=this.$el.closest(".partner-placement");t.removeAttr("data-monetization-id"),t.removeAttr("data-monetization-sizes"),t.removeClass("partner-placement-visible"),this.destroyed=!0,i.prototype.destroy.call(this,e)},destroyAdPlacement:function(){if(this.tracked=!1,this.subviews.partnerView&&(this.stopAd(),this._dispatchToPartner("destroy",!1),this.subviews.partnerView=null),this.adData&&this.adData.script&&a.off(this._getPubSubKey(),this._debounceAdReady,this),this.adType=this.adData=null,this.$adEl)this.$adEl.remove(),this.$adEl=null;else if(this.$el.hasClass("partner-billboard-ad")){var t=s.getNested(window.site_vars,"ADS","cleanup_selectors");e(t).remove()}this.$stylesheet&&(this.$stylesheet.remove(),this.$stylesheet=null)},getAdPlacement:function(){var e=this.options.adPlacement;return this.options.subSection&&(e+="/"+this.options.subSection),e},getAdSizes:function(){return this.options.adSizes},getSlotType:function(){return this.options.slotType},_adReady:function(e,t,i){r.logDebug("AdPosition("+this.getAdPlacement()+") "+this.adType+" ready"),this.adData&&this.adData.script&&a.off(this._getPubSubKey(),this._debounceAdReady,this),this.adState="hasad",this.options.onAdReady?(this.options.onAdReady(this.adData,this.adType,i),this.$el.addClass("partner-placement-visible")):"in"===this.options.slotType&&(this.adType?this.playAd():(this.show(),this.$el&&this.$el.height()>1&&this.$el.addClass("partner-placement-visible")))},isAdReady:function(){var e="hasad"===this.adState;return e&&"blank"===s.getNested(this.adData,"adType")?(this.trackAd(),!1):e},getCreativeState:function(e,t){return this.adData&&this.adData.dfp&&this.adData.dfp.ecid?o.getValue("dfpc_"+this.adData.dfp.ecid,e,t):void r.logWarn("Attempted to get state on non high impact ad")},setCreativeState:function(e,t){this.adData&&this.adData.dfp&&this.adData.dfp.ecid?o.setValue("dfpc_"+this.adData.dfp.ecid,e,t):r.logWarn("Attempted to set state on non high impact ad")},getHeight:function(){return this.$el.outerHeight()},getWidth:function(){return this.$el.outerWidth()},showAd:function(e,t){this.$el.show(),this._dispatchToPartner("onShow",e,t),this.trackAd()},resizeAd:function(e,t){this.options.adWidth=e,this.options.adHeight=t,this._dispatchToPartner("onResize",e,t)},setInitialDimensions:function(e,t){this.options.adWidth=e,this.options.adHeight=t},_dispatchToPartner:function(e){var t,i=this.subviews.partnerView;if(i)if(i[e]){t=Array.prototype.slice.call(arguments,1),r.logDebug.apply(r,["AdPosition("+this.getAdPlacement()+") "+e].concat());try{i[e].apply(i,t)}catch(s){r.logError("Ad threw an exception in function "+e,s.stack||s.stacktrace||s.message)}}else r.logWarn("Ad does not implement "+e)},stopAd:function(){this._dispatchToPartner("onStopToClose"),n.updateActiveSlotStatistics(this.adType,"stopped")},pauseAd:function(){this._dispatchToPartner("onPause"),n.updateActiveSlotStatistics(this.adType,"paused")},resumeAd:function(){this._dispatchToPartner("onResume"),n.updateActiveSlotStatistics(this.adType,"playing")},trackAd:function(t){var i;if(!this.tracked&&this.adData){if(this.tracked=!0,this.adData.viewUrl){var s=e('<img src="'+this.adData.viewUrl+encodeURIComponent(window.site_static_url+"images/pixels/pixel-transparent.png")+'" style="display:none;">');this.$adEl?this.$adEl.append(s):(this.$adEl=s,this.$el.append(s)),r.logDebug("Fired Tracking Pixel",this.adData.viewUrl)}if("Yes"===this.adData.trackVCE&&this.adData.vCEUrl){t=t||this.$el,i=t.prop("id");var o=this.adData.vCEUrl.replace(/\[domid\]/g,i);n._createScript("vce_"+i,o,t),r.logDebug("Tracked vCE",o)}}},playAd:function(){this.trackAd(),this._dispatchToPartner("onPlay"),n.updateActiveSlotStatistics(this.adType,"playing")}});return l}),define("directAdPosition",["jquery","underscore","partner/ad-position","state","admanager"],function(e,t,i,s,n){"use strict";var o=i.extend({initialize:function(t){t=e.extend({targeting:{},exclusion:[],subSection:s.getActivePageInfo().cst,slotType:"in"},t),i.prototype.initialize.call(this,t),"in"==t.slotType&&this.refreshPosition()},prefetchAd:function(){return this.subviews.adSlot?!1:(this.adSlotPlacement=this.getAdPlacement(),this.subviews.adSlot=n.getAdSlot(this.adSlotPlacement,this.options.targeting,this.options.exclusion,this.options.adSizes,this,this.options.slotType),!0)},setTargeting:function(e){this.options.targeting=e,this.subviews.adSlot&&this.subviews.adSlot.setTargeting(this.options.targeting)},destroy:function(){this.destroyAdSlot(),i.prototype.destroy.apply(this,arguments)},destroyAdSlot:function(){this.subviews.adSlot&&(this.subviews.adSlot.destroy(),this.subviews.adSlot=null)},setPageInfo:function(t){t.cst&&this.setSubSection(t.cst),this.setTargeting(e.extend(n.getPageAdTargeting(t),this.options.targeting))},setSubSection:function(e){this.options.subSection=e},refreshPosition:function(){this.adState="pending",this.subviews.adSlot&&this.adSlotPlacement!==this.getAdPlacement()&&(this.destroyAdPlacement(),this.destroyAdSlot()),this.prefetchAd()||(this.destroyAdPlacement(),this.subviews.adSlot.refresh())}});return o}),define("modules/partner/poster-ad-asset2",["jquery","underscore","baseview","state","site-manager","utils","admanager","directAdPosition"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({initialize:function(a){t.bindAll(this,"_overlayScrollListener","_handleResizeWindow","onSecondAdReady","_isInViewport","_checkFocus"),a=e.extend({minTimeForAd:5e3,topMargin:30,disableRefresh:o.getNested(window.site_vars,"ADS","poster_scroll_refresh_disabled"),articleSelector:"article > div[role=main]",rightRailSelector:".story-right-rail",adPlacement:"poster_scroll"},a);var r=s.getActiveApp();this.$win=o.get("win"),this.$body=o.get("body"),this.$moreStories=e(".more-stories-wrap.vertical"),this.header=n.getHeader(),this.overlayScrollListenerThrottle=t.throttle(this._overlayScrollListener,16,{leading:!1,trailing:!0}),this.$win.on("scroll."+this.cid,this.overlayScrollListenerThrottle).on("resize."+this.cid,this._handleResizeWindow).on("blur."+this.cid,this._checkFocus).on("focus."+this.cid,this._checkFocus),this.partnerScrollHeight=0,this.belowModuleInView=!1,this.windowIsFocused=!0,this.autoRefresh=o.getNested(window.site_vars,"ADS","poster_scroll","auto_refresh_enabled"),this.autoRefreshRate=o.getNested(window.site_vars,"ADS","poster_scroll","auto_refresh_rate")||6e4,this.pubSub={"breakingbar:after:open":this._overlayScrollListener,"breakingbar:after:close":this._overlayScrollListener,"gravity:open":this._handleResizeWindow},this.$adEl=this.$(".poster-scroll-ad"),this.$adScroll=this.$(".poster-scroll"),this.$otherAds=r.$(".partner-asset-right-ad,.datasphere-community-module"),this.$rightRail=this.$el.closest(a.rightRailSelector),this.$body.on("bx_impression."+this.cid,this._setHeight()),i.prototype.initialize.call(this,a),this._handleResizeWindow()},_overlayScrollListener:function(){this.lastEngagement=(new Date).getTime(),this.moduleOffsetTop=this.$el.offset().top,this.visiblity=this._isInViewport(this.$adScroll),this._getModuleHeight()<(this.partnerScrollHeight||250)?this._goToState("dockTop"):(this._checkIfBottomInView(),this._goToState(this._getCurrentState())),this._handleRequestAds()},_getCurrentState:function(){return this.visiblity.inView?this._shouldDockBottom()?"dockBottom":this._shouldFixAd()?"fixed":"dockTop":"hidden"},_goToState:function(e){e!==this.state&&("hidden"!==this.state&&this.state||this.$adScroll.css("opacity","1"),"hidden"===e?this.$adScroll.css("opacity","0"):"fixed"===e?this.$adScroll.css({position:"fixed",top:this._getHeaderHeight()+this.options.topMargin}):"dockTop"===e?this.$adScroll.css({position:"static",top:"auto"}):"dockBottom"===e&&this._dockBottom(),this.state=e)},_checkIfBottomInView:function(){var e=this.$body.scrollTop()+this.winHeight;e>=this._getModuleOffsetBottom()&&this.belowModuleInView===!1?(this._setHeight(),this._setArticleDimensions(),this.belowModuleInView=!0):e<this._getModuleOffsetBottom()&&this.belowModuleInView===!0&&(this.belowModuleInView=!1)},_shouldFixAd:function(){return this.moduleOffsetTop-this.options.topMargin<=this._getViewportOffset()},_getViewportOffset:function(){return o.getScrollPosition()+this._getHeaderHeight()},_shouldDockBottom:function(){var e=this._getModuleOffsetBottom()-this.partnerScrollHeight-this.options.topMargin;return e<this._getViewportOffset()},_getHeaderHeight:function(){return this.header?this.header.getFixedHeight():0},_isInViewport:function(t){var i=e(t),s=i.offset().top,n=s+i.outerHeight(),o=this._getViewportOffset(),a=o+this.winHeight-this._getHeaderHeight();return{inView:!(i.is(":hidden")||o>n||s>a),isVisible:!(i.is(":hidden")||o>n-125||s+125>a)}},_isTimeToRefresh:function(){if(this.lastAdRefreshedTime){var e=(new Date).getTime();return e-this.lastAdRefreshedTime>=this.options.minTimeForAd}return!0},_getModuleHeight:function(){return this.articleOffsetTop+this.articleHeight-this.moduleOffsetTop},_getModuleOffsetBottom:function(){return this.moduleOffsetTop+this._getModuleHeight()},_hasScrolledAViewportHeight:function(){var e=o.getScrollPosition(),t=Math.abs(e-this.scrollTopAdRequestedAt);return t>=this.winHeight},_handleResizeWindow:function(){this.winHeight=this.$win.height(),this._setArticleDimensions()},_handleRequestAds:function(){("hidden"!==this.state&&!this.subviews.ad||"hidden"!==this.state&&this.needsRefresh||"fixed"===this.state&&!this.options.disableRefresh&&this._hasScrolledAViewportHeight()&&this._isTimeToRefresh())&&this._requestAd()},_dockBottom:function(){this.$adScroll.css({position:"absolute",top:this.articleHeight-this.partnerScrollHeight+this.railPositionTop})},_setArticleDimensions:function(){var e=s.getActiveApp().$(this.options.articleSelector);e.length&&(this.articleHeight=e.height(),this.articleOffsetTop=e.offset().top,this.railPositionTop=this.$rightRail.position().top),this.$moreStories.length&&(this.articleHeight+=this.$moreStories.height())},_requestAd:function(){this.needsRefresh=!1,a.getActiveSlotStatistics().done(t.bind(function(e){var i=this.subviews.ad;if(i){if(!i.isAdReady())return;i.subviews.adSlot.refresh()}else{var n=["mediumrectangle"],a=600+this.options.topMargin,l=t.findWhere(e.high_impact_info,{adType:"gravity"});this._getModuleHeight()>=a&&this.winHeight-this._getHeaderHeight()>=a&&(n=n.concat(["halfpage","portrait","halfpage"])),this.subviews.ad=new r({el:this.$adEl,adSizes:n,adPlacement:this.options.adPlacement,adType:"poster",onAdReady:this.onSecondAdReady,pageInfo:s.getActivePageInfo(),targeting:l?{creativeid:l.ecid}:{}})}this.scrollTopAdRequestedAt=o.getScrollPosition()},this))},_setHeight:function(){this.partnerScrollHeight=this.$adScroll.outerHeight()},onSecondAdReady:function(){var e=s.getActivePageInfo(),i=o.getNested(e,"comma_ssts")||"";this.subviews.ad.show(),this._setHeight(),this.lastAdRefreshedTime=(new Date).getTime(),this._overlayScrollListener(),"dockBottom"===this.state&&this._dockBottom(),("true"===this.autoRefresh||-1!==i.split(",").indexOf(this.autoRefresh)&&!o.getUrlParam("navigationtype"))&&(this.refreshTimeout=setTimeout(t.bind(function(){this._autoRefresh()},this),this.autoRefreshRate))},_autoRefresh:function(){var e=o.getNested(window.size_vars,"ADS","poster_scroll","inactive_timeout")||3e5,t=o.getNested(this,"subviews","ad","subviews","adSlot","options","targeting");t&&(t.navigationtype="autorefresh"),this.visiblity.isVisible&&this.windowIsFocused&&this.lastEngagement>=(new Date).getTime()-e?this._requestAd():this.needsRefresh=!0},_checkFocus:function(e){var t=e.type;if(this.lastEngagement=(new Date).getTime(),this.prevType!==t)switch(t){case"blur":this.windowIsFocused=!1;break;case"focus":this.windowIsFocused=!0,this.needsRefresh&&this._requestAd()}this.prevType=t},destroy:function(e){this.$body.off("."+this.cid),this.$win.off("."+this.cid),this.refreshTimeout&&window.clearTimeout(this.refreshTimeout),i.prototype.destroy.call(this,e)}});return l}),define("partner/overlay-ad-base",["jquery","underscore","pubsub","state","utils","baseview","site-manager"],function(e,t,i,s,n,o,a){"use strict";var r=o.extend({events:{"click .partner-close,.ui-film":"onClickCloseButton"},initialize:function(i){i=e.extend({getHeaderOffset:null},i),t.bindAll(this,"onResize"),this.header=a.getHeader(),this.listen(),this.$body=n.get("body"),o.prototype.initialize.call(this,i),this.$placement=this.$(".partner-placement")},showAd:function(){s.setActiveAppFixed(!0),this.header&&this.header.setClosedFixed(!0),this.showingAd=!0,this.show(!0).done(t.bind(function(){this.subviews.ad&&this.subviews.ad.playAd()},this)),this.$body.addClass("high-impact-ad-visible")},stopAd:function(){this.subviews.ad&&this.subviews.ad.stopAd()},onAdReady:function(e,t){var i=this.subviews.ad;i&&("blank"===t?i.trackAd():this.showAd())},destroy:function(e){this.close(!1,!0),o.prototype.destroy.call(this,e)},findSizeForAd:function(){var e={adSizeClass:"size-s",adTop:"50%",adHeight:450,adWidth:600},t=0;this.options.getHeaderOffset&&(t=this.options.getHeaderOffset()||0);var i=document.documentElement.clientHeight-t-80,s=document.documentElement.clientWidth-160;return s>1080&&i>810?(e.adSizeClass="size-xl",e.adHeight=810,e.adWidth=1080):s>936&&i>700?(e.adSizeClass="size-l",e.adHeight=700,e.adWidth=936):s>768&&i>576&&(e.adSizeClass="size-m",e.adHeight=576,e.adWidth=768),e.adTop=(document.documentElement.clientHeight-t-e.adHeight)/2+t+"px",e},listen:function(){this.pubSub={},this.pubSub["resize:app"]=this.onResize,this.pubSub["breakingbar:after:open"]=this.onResize,this.pubSub["breakingbar:after:close"]=this.onResize},onClickCloseButton:function(e){e.preventDefault(),this.close(!0)},close:function(e){this.showingAd&&this.subviews.ad&&(this.showingAd=!1,s.clearActiveAppFixed(!0),this.header&&this.header.restoreLastState(),this.subviews.ad.stopAd(),this.hide(e)),this.$body.removeClass("high-impact-ad-visible")},onResize:function(){var e=this.findSizeForAd();this.$placement.removeClass("size-s size-m size-l size-xl").addClass(e.adSizeClass).css({top:e.adTop}),this.subviews.ad&&this.subviews.ad.resizeAd(e.adWidth,e.adHeight)}});return r}),define("sharedAdPosition",["jquery","underscore","partner/ad-position","utils","admanager"],function(e,t,i,s,n){"use strict";var o=i.extend({initialize:function(t){t=e.extend({adType:null,defaultPosition:!1},t),i.prototype.initialize.call(this,t),n.registerSharedAdPosition(this)},isDefaultPosition:function(){return this.options.defaultPosition},getAdType:function(){return this.options.adType},refreshPosition:function(){n.refreshSharedAdPosition(this.getAdPlacement())},destroy:function(e){i.prototype.destroy.call(this,e),n.destroySharedAdPosition(this)}});return o}),define("partner/ad-utils",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=function(){};return s.prototype={changeBg:function(e,s,n){if(!s||"transparent"===s)return!1;var o=e.css("background-color");return"transparent"!==o&&o?(e.addClass("partner-background"),i.prototype.animate(e,"background-color",s,200,"ease-in").done(t.bind(function(){n?this.changeBgImg(e,n):this.changeBgImg(e,window.site_static_url+"images/pixels/pixel-transparent.png")},this)),!0):!1},changeBgImg:function(e,t){e.css({"background-image":"url('"+t+"')","background-repeat":"repeat"})},clearBg:function(e,s){e.css("background-color")!==s?i.prototype.animate(e,"background-color",s,200,"ease-in").done(t.bind(function(){e.removeClass("partner-background")},this)):(e.css("background-color",""),e.removeClass("partner-background"))}},new s}),define("partner/leavebehind",["jquery","underscore","baseview","adLogger","utils","managers/cachemanager","partner/ad-utils","state"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({events:{"click .js-partner-lb-click":"onClick"},initialize:function(o){o=e.extend({onShowAd:null,isCompact:!0,isNative:!1,behavior:{}},o),i.prototype.initialize.call(this,o),this.$el.prop("id")||this.$el.prop("id",t.uniqueId("ad-position-")),this.$body=n.get("body"),this.startBgColor=this.$body.css("background-color"),this.$clickArea=this.$(".js-partner-lb-click"),s.logDebug("LeaveBehind initialized",this)},destroy:function(t){this.hide(),this.startBgColor&&a.clearBg(this.$body,this.startBgColor),this.$("img").remove(),this.$frame&&this.$frame.remove(),this.$el.removeClass("partner-lb-frame"),this.$clickArea.find(".partner-lb-click-arrow").remove(),this.options.cards&&this.addedSpace&&this.options.cards.animate({paddingTop:"-=10px"},350,function(){e(this).css("padding-top","")}),this.$body.removeClass("partner-background"),i.prototype.destroy.call(this,!1)},render:function(i,s){var n=new e.Deferred;return this.adData=s,s.frameSliver?this._setupFrame(s,n):this.options.isNative?n.resolve():this._setupLb(s,n),n.then(t.bind(function(){this._showAdOrLb(i,s)},this)),n},_setupLb:function(t,i){var s=this.$el;this.options.isCompact?s.addClass("compact"):s.removeClass("compact"),s.append(e("<img>").attr({"class":"leavebehind-image",src:t.leaveBehindImage,alt:t.leaveBehindText})),i.resolve()},_setupFrame:function(i,s){this.$branding=e("<img>").attr({src:i.frameSliver,alt:i.leaveBehindText,"class":"lb-brand"}),i.frameArrowColor&&"None"!==i.frameArrowColor&&this.$clickArea.prepend('<svg class="partner-lb-click-arrow" fill="'+i.frameArrowColor+'" x="0px" y="0px" viewBox="0 0 26 26" enable-background="new 0 0 26 26"><path fill-rule="evenodd" clip-rule="evenodd" d="M13,0.5C6.1,0.5,0.5,6.1,0.5,13c0,6.9,5.6,12.5,12.5,12.5S25.5,19.9,25.5,13C25.5,6.1,19.9,0.5,13,0.5z M19,12l-5.3,5.3c-0.2,0.2-0.4,0.3-0.6,0.3c-0.2,0-0.5-0.1-0.6-0.3L7.1,12c-0.2-0.2-0.3-0.4-0.3-0.6c0-0.2,0.1-0.5,0.3-0.6c0.2-0.2,0.4-0.3,0.6-0.3c0.2,0,0.5,0.1,0.6,0.3l4.7,4.7l4.7-4.7c0.4-0.4,0.9-0.4,1.3,0C19.3,11,19.3,11.6,19,12z" /></svg>'),i.frameBackground?e("<img>").load(t.bind(function(t){e(t.currentTarget).remove(),this.$frame=e("<div>").css("background-image",'url("'+i.frameBackground+'")').addClass("lb-frame"),r.getActiveApp().$el.prepend(this.$frame),this.$body.addClass("partner-background"),s.resolve()},this)).attr("src",i.frameBackground):(this.$frame=e([]),s.resolve()),this.$el.append(this.$branding).addClass("partner-lb-frame")},shouldShowAd:function(e){var t=this.options.maxDisplayed||1,i=this.getAdState(e);return i.displayed<t},getStateKey:function(e){return"dfpc_"+e.dfp.ecid},getAdState:function(e){return o.getValue(this.getStateKey(e),{displayed:0},this.getExpirationMinutes(e.leaveBehindExp))},getExpirationMinutes:function(e){var t=parseInt(e,10);return isNaN(t)?n.getNested(window.site_vars,"ADS","LEAVEBEHIND_EXPIRATION_MINUTES"):t},incrementAdViewCount:function(e){var t=this.getAdState(e);t.displayed+=1,o.setValue(this.getStateKey(e),t,this.getExpirationMinutes(e.leaveBehindExp))},_showAdOrLb:function(e,t){var i=this.options;this.shouldShowAd(t)?(this.incrementAdViewCount(t),i.onShowAd&&i.onShowAd(),n.getNested(i,"behavior","initShow")&&this.$frame&&(this.$frame.fadeIn(350),a.changeBg(this.$body,t.frameColor))):(this.show(),e.trackAd(this.$el),this.track(t.leaveBehindTracking))},show:function(){if(!this.options.isNative&&this.adData){if(i.prototype.show.call(this),this.adData.frameSliver){var e=this.options.cards;e&&!this.addedSpace&&(n.flag("disable_ad_animations")?e.css("paddingTop",parseInt(e.css("paddingTop"))+20):e.animate({paddingTop:"+=10px"},350),this.addedSpace=!0),this.$el.show(),this.$branding.fadeIn(350),this.$frame.fadeIn(350),a.changeBg(this.$body,this.adData.frameColor)}this.$body.addClass("leavebehind-visible")}},hide:function(e){var s=this.options.behavior,o=this.options.cards,r=this.adData;!this.options.isNative&&r&&(r.frameSliver||i.prototype.hide.call(this),s.hidebrand&&this.$branding&&(!o||"Pushdown"!==r.adType&&"Pushdown+"!==r.adType||(n.flag("disable_ad_animations")?o.css("paddingTop",parseInt(o.css("paddingTop"))-20):o.animate({paddingTop:"-=10px"},350),this.addedSpace=!1),this.$branding.fadeOut(350,t.bind(function(){this.$el.hide()},this))),s.hideframe&&this.$frame&&this.$frame.fadeOut(350),this.startBgColor&&s.clearBgColor&&a.clearBg(this.$body,this.startBgColor),e&&this.track(r.reexpandTracking),this.$body.removeClass("leavebehind-visible"))},onClick:function(){return this.hide(!0),this.options.onShowAd&&this.options.onShowAd(!0),!1},track:function(t){var i,s=e("head");if(t)for(i=0;i<t.length;++i){var n=t[i];(n.match(/^(https:\/\/).*?\.js($|#|\?)/gi)||[]).length?s.append('<script src="'+n+'"></script>'):(new Image).src=n}}});return l}),define("partner/overlay-ad-fronts",["jquery","underscore","partner/overlay-ad-base","sharedAdPosition","partner/leavebehind","adLogger"],function(e,t,i,s,n,o){"use strict";var a=i.extend({initialize:function(s){s=e.extend({leaveBehindEl:e(".partner-leavebehind"),adSizes:["elastic"],adType:"elastic",adPlacement:"high_impact",isCardBumped:!0,isNative:!1},s),t.bindAll(this,"onAdReady","showAd"),i.prototype.initialize.call(this,s),this.loadAdPlacement(),o.logDebug("Partner Shared Overlay initialized",this)},destroy:function(e){var t=this.options.slot;t&&t.removeClass("show-slot"),i.prototype.destroy.call(this,e)},loadAdPlacement:function(){this.subviews.ad=new s({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},onAdReady:function(e){var t=this.options.slot;t&&t.addClass("show-slot"),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText&&this.options.leaveBehindEl?(this.subviews.adLeaveBehind=new n({el:this.options.leaveBehindEl,cards:this.options.cards,onShowAd:this.showAd,isCompact:this.options.isCardBumped,isNative:this.options.isNative,maxDisplayed:parseInt(e.maxDisplayed,10),behavior:{clearBgColor:!1,hideframe:!1,hidebrand:!1}}),this.subviews.adLeaveBehind.render(this.subviews.ad,e)):this.showAd()},close:function(e,t){this.subviews.adLeaveBehind&&!t&&this.subviews.adLeaveBehind.show(),i.prototype.close.apply(this,arguments)}});return a}),define("partner/slider",["jquery","underscore","baseview","sharedAdPosition","utils"],function(e,t,i,s,n){"use strict";var o=i.extend({el:".partner-slider-ad",events:{"click .partner-slider-close":"onClickCloseButton"},destroy:function(e){this.stopCloseTimer(),this.hide(!0),i.prototype.destroy.call(this,!1)},initialize:function(n){t.bindAll(this,"onAdReady"),n=e.extend({adSizes:["mediumrectangle","halfpage","portrait"],adPlacement:"high_impact"},n),i.prototype.initialize.call(this,n),this.subviews.ad=new s({el:this.$el,adSizes:n.adSizes,adPlacement:n.adPlacement,adType:"slider",defaultPosition:!0,onAdReady:this.onAdReady})},onAdReady:function(){this.subviews.ad.show(),this.show(!0).done(t.bind(function(){this.startCloseTimer()},this))},onClickCloseButton:function(e){e.preventDefault(),this.destroy(!1)},startCloseTimer:function(){var e=n.getNested(window.site_vars,"ADS","SLIDER","CLOSETIME");e&&(this.closeTimer=setTimeout(t.bind(function(){this.hide()},this),e))},stopCloseTimer:function(){clearTimeout(this.closeTimer)}});return o}),define("modules/global/brightcove-video",["jquery","underscore","baseview","pubsub","state","admanager","adLogger","utils","cookie"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({events:{"click .videoStillPlay":"swapImageForVideo","click .videoStill":"swapImageForVideo","click .videoCloseButton":"hidePlayer"},initialize:function(r){r=e.extend({live:!1,onVideoComplete:null,onVideoShow:null,onVideoHide:null,onVideoLoaded:null},r),this.$videoObj=this.$(".videoObject"),this.$brightcove=this.$(".BrightcoveExperience"),this.brightcoveId=this.$(".BrightcoveExperience").attr("id"),this.playerHTML=this.$videoObj.html();var l=this.$videoObj.data()||{},h=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),d=e.cookie("aam_uuid"),c="";this.pageinfo=n.getActivePageInfo(),this.pageinfo.series&&(c+="&series="+encodeURIComponent(this.pageinfo.series)),this.pageinfo.topic&&(c+="&topic="+encodeURIComponent(this.pageinfo.topic)),this.pageinfo.basePageType&&(c+="&pagetype="+encodeURIComponent(this.pageinfo.basePageType)),c+="&aam="+h+"&u="+d,a.logInfo("Built ad call for video, "+l.id+".",this.pageinfo,l);var u="https://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+o.buildAdUnit("preroll_video")+"/"+l.cst+"&sz=920x508&unviewed_position_start=1&cust_params=contentid%3D"+l.brightcovevideoid+encodeURIComponent(c)+'&cmsid=12768&url=""';a.logInfo("Video Ad call: "+u),e("<param>",{name:"adServerURL",value:u}).appendTo(this.$(".BrightcoveExperience")),this.$videoObj.length&&this.brightcoveId&&(t.bindAll(this,"createPlayer","onBrightCoveLoad","onTemplateReady","onVideoComplete","onVideoStart","isPlayingHandler","determineCompletion"),this.throttledDetermine=t.throttle(this.determineCompletion,1500),i.prototype.initialize.call(this,r),(this.options.autostart||this.$videoObj.attr("data-autoplay"))&&this.createPlayer(),this._buildBrightCoveLoadCallback(),this._buildBrightCoveReadyCallback(),this.pubSub={"pause:videos":this.pauseVideo},s.attach(this.pubSub,this))},_buildBrightCoveLoadCallback:function(){window.BCCallbacks||(window.BCCallbacks={}),window.BCCallbacks[this.brightcoveId]=this.onBrightCoveLoad,window.BCLoad||(window.BCLoad=t.bind(function(e){this._triggerNeon("onTemplateLoad",e),window.BCCallbacks[e]?window.BCCallbacks[e](e):console.log("received brightcove callback for video that does not exist: "+e)},this))},_buildBrightCoveReadyCallback:function(){window.BCReady||(window.BCReady=t.bind(function(e){this._triggerNeon("onTemplateReady",e)},this))},_neonEnabled:function(){return r.getNested(window.site_vars,"flags","neon")&&window.NeonPlayerTracker},_triggerNeon:function(e,i){this._neonEnabled()&&t.isFunction(window.NeonPlayerTracker[e])&&window.NeonPlayerTracker[e](i)},onBrightCoveLoad:function(e){this.$(".temp-loader").fadeOut(),this.player=window.brightcove.api.getExperience(e),this.APIModules=window.brightcove.api.modules.APIModules,this.player?(console.log("brightcove loaded successfully",this.brightcoveId),this.options.onVideoLoaded&&this.options.onVideoLoaded(this.brightcoveId),this.modVP=this.player.getModule(this.APIModules.VIDEO_PLAYER),this.modCon=this.player.getModule(this.APIModules.CONTENT),this.modExp=this.player.getModule(this.APIModules.EXPERIENCE),this.modExp.addEventListener(window.brightcove.api.events.ExperienceEvent.TEMPLATE_READY,this.onTemplateReady)):console.warn("brightcove video loaded, but could not get experience: "+e)},onTemplateReady:function(e){this.modVP&&(this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.addEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine))},onVideoStart:function(e){var t=this.getVideoDetail();e.duration<0?t.videoDuration="":e.duration<120?t.videoDuration="less than 2 min":t.videoDuration="greater than 2 min",t.completion="0%",t.liveVideoSubject?t.videoName=t.liveVideoSubject:t.videoName=e.media.displayName,t.eventtype="video:load",t.contentid=e.target.experience.id,t.videoFulllengthUrl=e.media.FLVFullLengthURL,"undefined"!=typeof t.assetid&&e.media.referenceId!==t.assetid.toString()&&(t.assetid=e.media.referenceId,t.ssts=e.media.customFields.gdp_ssts||t.ssts,t.cst=e.media.customFields.gdp_cst||t.cst,t.videocontentprovider=e.media.customFields.gannetttracking+"|"+e.media.displayName,t.keywords=e.media.customFields.gdp_tags||t.keywords,"undefined"!=typeof e.media.customFields.gdp_canonical_url&&(t.pathName=e.media.customFields.gdp_canonical_url.replace(/^.*\/\/[^\/]+/,"")),t=this.setVideoDetailMeta(t)),s.trigger("video:load",t)},onVideoComplete:function(){console.log("video playback finished: "+this.brightcoveId),e.isFunction(this.options.onVideoComplete)&&this.options.onVideoComplete()},onMediaEventFired:function(e){s.trigger("uotrack",e.type)},determineCompletion:function(e){var t=e.duration,i=e.position,n=Math.round(i/t*100),o=this.$videoObj.data().videourl;!this.fiftypercent&&n>=50&&95>n?(s.trigger("vitrack",{percentage:"50%",video_url:o}),this.fiftypercent=!0):!this.ninetyfivepercent&&n>=95&&99>n&&(s.trigger("vitrack",{percentage:"95%",video_url:o}),this.ninetyfivepercent=!0)},createPlayer:function(){if(window.brightcove){var e=this.$brightcove;e.params={forceHTML:!1},window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperiences(null,this.brightcoveId),n.stopRefreshTimer(),this.$videoObj.show()}else this.loadScripts(this.createPlayer)},destroy:function(e,s){if(n.startRefreshTimer(),this.brightcoveId&&window.brightcove&&(this.player||window.brightcove.api&&(this.player=window.brightcove.api.getExperience(this.brightcoveId)),this.player&&(this.modVP||(this.modVP=this.player.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER)),
this.modVP&&this.resetVideoState()),window.brightcove&&(window.brightcove.experiences&&delete window.brightcove.experiences[this.brightcoveId],window.brightcove.instances&&delete window.brightcove.instances[this.brightcoveId])),window.BCCallbacks){if(window.BCCallbacks[this.brightcoveId]&&delete window.BCCallbacks[this.brightcoveId],0===t.size(window.BCCallbacks)){window.BCCallbacks=void 0,window.BCLoad=void 0,window.BCReady=void 0;try{delete window.BCCallbacks,delete window.BCLoad,delete window.BCReady}catch(o){}}}else console.warn("BCCallbacks no longer available on video destroy");i.prototype.destroy.apply(this,arguments)},resetVideoState:function(){this.player&&(this.modVP&&(this.pauseVideo(),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine),this.modVP=!1,this.modCon=!1,this.modExp=!1),this.player=!1),this.$(".videoStill, .videoStillPlay").show(),this.$videoObj.html(this.playerHTML),this.hidePlayer()},hidePlayer:function(){this.$videoObj&&this.$videoObj.hide(),this.options.onVideoHide&&this.options.onVideoHide(),n.startRefreshTimer()},loadScripts:function(e){require(["https://sadmin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?(console.log("Brightcove loaded"),e()):console.log("Error loading Brightcove")})},swapImageForVideo:function(e){this.createPlayer(),this.options.onVideoShow&&this.options.onVideoShow(),this.$(".videoStill, .videoStillPlay").hide(),this.$(".temp-loader").show(),s.trigger("video:playClick")},getVideoDetail:function(){var e=this.$videoObj.data()||{};return e.pathName="",e.liveVideoSubject?e.pathName=e.liveVideoSubject:e.videourl&&(e.pathName=e.videourl.replace(/^.*\/\/[^\/]+/,"")),this.setVideoDetailMeta(e)},setVideoDetailMeta:function(e){try{e.cst||(e.cstlist=e.cst.split("/"),e.category=e.cstlist[0],e.cst=e.cstlist.slice(0,3).join(":"),e.subcategory=e.cstlist.slice(0,2).join(":")),e.sstslist||(e.sstslist=e.ssts.split("/"),e.section=e.sstslist[0],e.ssts=e.sstslist.join(":"),e.subsection=e.sstslist.slice(0,2).join(":"),e.topic=e.sstslist.slice(0,3).join(":"))}catch(t){return void console.error("Invalid page",t.stack||t.stacktrace||t.message)}return e},pauseVideo:function(){void 0!==this.modVP&&this.modVP.pause(!0)},isPlayingHandler:function(e){this.options.live||e&&this.modVP.pause(!0)},loadVideoById:function(e){this.modVP.loadVideoByID(e)}});return l}),define("blog/blog-front",["jquery","underscore","backbone","utils","state","site-manager","pubsub","base-app","directAdPosition","modules/partner/poster-ad-asset2","partner/overlay-ad-fronts","sharedAdPosition","partner/slider","modules/global/brightcove-video"],function(e,t,i,s,n,o,a,r,l,h,d,c,u,p){"use strict";var f=r.extend({el:".blt-content-container",afterPageReveal:function(e,t){this.$el.hasClass("blt-content-container")?this._initNewBlogPage():this._initializeLegacyBlogPage(),n.stopRefreshTimer()},setupAds:function(){this.subviews.sidebarAd=new l({el:this.$(".partner-sidebar-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"sidebar"}),this.subviews.posterAd=new h({el:this.$(".blog-poster-scroll-ad-wrapper"),rightRailSelector:".blt-sidebar",disableRefresh:!1,minTimeForAd:15e3})},_initNewBlogPage:function(){this.setupAds()},_initializeLegacyBlogPage:function(){var t=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var i=new p({el:e(this).parent().get(0)});t.subviews.video.push(i)}),this.subviews.overlayAd=new d({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-logo":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var e=o.getHeader();return e?e.getExpandedHeight():0}}),this.subviews.genericad=new c({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new u)}});return f}),define("apps/member-guide-apps",["jquery","base-app","site-manager"],function(e,t,i){var s=t.extend({events:{"click .js-mga-apps-icon-link":"showApp"},showApp:function(t){t.preventDefault();var i=e(t.currentTarget),s=i.data("app-number");this.$(".js-mga-apps-icon-link").removeClass("mga-icon-active"),this.$(".js-mga-panel[data-app-number]").removeClass("mga-active-app"),this.$(".js-mga-apps-icon-link[data-app-number="+s+"]").addClass("mga-icon-active"),0===s?this.$(".js-mga-panel[data-app-number]").addClass("mga-active-app"):this.$(".js-mga-panel[data-app-number="+s+"]").addClass("mga-active-app");var n=e(window).width();670>n&&e("html, body").animate({scrollTop:this.$(".mga-page-content").offset().top-60},500)},afterPageReveal:function(){e("body").addClass("mga-body").addClass("mga-body-subpage"),e(".js-mga-container").addClass("mga-body-subpage").addClass("mga-section-inline")},beforeAppRemove:function(){e("body").removeClass("mga-body")}});return s}),define("apps/member-guide-social",["jquery","base-app","site-manager"],function(e,t,i){var s=t.extend({events:{"click .js-mga-icon-link":"showSocial"},showSocial:function(t){t.preventDefault();var i=e(t.currentTarget).data("network-type");this.$(".js-mga-icon-link").removeClass("mga-icon-active"),this.$(".js-mga-page-panel").removeClass("mga-page-active"),this.$(".js-mga-icon-link[data-network-type="+i+"]").addClass("mga-icon-active"),this.$(".js-mga-page-panel[data-network-type="+i+"]").addClass("mga-page-active");var s=e(window).width();670>s&&e("html, body").animate({scrollTop:this.$(".mga-page-content").offset().top-60},500)},afterPageReveal:function(){e("body").addClass("mga-body mga-body-subpage"),e(".js-mga-container").addClass("mga-body-subpage mga-section-inline")},beforeAppRemove:function(){e("body").removeClass("mga-body mga-body-subpage")}});return s}),define("modules/global/taboola",["jquery","underscore","utils","state","managers/cachemanager"],function(e,t,i,s,n){"use strict";var o=function(s){t.bindAll(this,"getWidget");var n=i.getNested(window.site_vars,"THIRDPARTYAPI","Taboola")||{};this.options=e.extend({apiBase:n.apiBase+n.api_id,apiKey:n.apiKey,widgetUrl:"//cdn.taboola.com/libtrc/"+n.publisher_id+"/loader.js",isWidgetPresent:n.widget,taboola_enabled:n.ENABLED,isContinuousEndslate:!1},s),this.options.isWidgetPresent&&!this.options.isContinuousEndslate&&i.loadScript(this.options.widgetUrl,"_taboola",this.getWidget)};return o.prototype={setUserTaboolaSession:function(e){n.setValue("taboola_user_session_id",e)},getUserTaboolaSession:function(){return n.getValue("taboola_user_session_id","init")},getSourceId:function(t){var i=t?e("<a>").attr("href",t)[0].pathname:window.location.pathname;return i.match(/^\/videos\//)?s.getActivePageInfo().assetid:i},registerTaboolaClick:function(e,t,i){(new Image).src=this.options.apiBase+"/recommendations.notify-click?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+i+"&item.type="+t+"&item.id="+e+"&response.session="+this.getUserTaboolaSession()},registerTaboolaVisible:function(e){(new Image).src=this.options.apiBase+"/recommendations.notify-visible?app.type=desktop&app.apikey="+this.options.apiKey+"&response.id="+e+"&response.session="+this.getUserTaboolaSession()},getRelated:function(n,o,a,r,l,h,d,c,u,p){var f,g,m,v,b,y,w=e.Deferred();return this.options.taboola_enabled?(f=s.getActivePageInfo(),g={video:"video",playlist:"video",brightcove:"video",text:"text",story:"text",blogs:"text",gallery:"photo",album:"photo",home:"home",section:"section",front:"section",topic:"section","blog index":"section","media view":"section"},m=t.keys(g).join("|"),v=i.getNested(f,"contenttype")||"",b=this.options.apiBase+"/recommendations.get",y=JSON.parse(JSON.stringify({"output.callback":"define","app.type":"desktop","app.apikey":this.options.apiKey,"source.id":h||this.getSourceId()||0,"source.url":l||i.getNested(f,"canonical")||window.location.href,"source.type":o||g[v.match(m)]||"video","rec.type":a||"video","rec.visible":c===!1?c:!0,"rec.count":r||3,"source.placement":d||"","user.session":this.getUserTaboolaSession(),"rec.thumbnail.width":u,"rec.thumbnail.height":p})),i.requireSingleUseScript(b+"?"+e.param(y)).done(t.bind(function(e){i.set("taboolaResponseID",e.id),e.list||(e.list={}),this.setUserTaboolaSession(e.session),y["rec.visible"]&&this.registerTaboolaVisible(e.id),n?n(e):w.resolve(e)},this)).fail(function(e){e={},w.reject(e)})):w.reject("Taboola not enabled for this site."),w.promise()},getWidget:function(i){if(this.options.taboola_enabled){var s=window.location.href;window.taboolainitialized||(i.push({notify:"newPageLoad"}),window.taboolainitialized=!0),t.each(this.options.widget,function(e){i.push({mode:e.mode,container:e.container,placement:e.placement,target_type:e.target_type,url:e.url})}),i.push(e.extend({url:s},this.options.pagetypeWidget))}}},o}),define("meteredAdPosition",["jquery","underscore","directAdPosition","utils","managers/cachemanager","admanager","adLogger"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({initialize:function(t){t=e.extend({slotType:"out",rateMeterId:null},t),i.prototype.initialize.call(this,t)},getDefaultThreshold:function(e){var t=e||this.options.meterThreshold||this.options.adPlacement,i=t.indexOf("/");-1!==i&&(t=t.substring(0,i));var n=s.getNested(window.site_vars,"ADS","THRESHOLDS",t.toUpperCase());return n||a.logError("Could not find default threshold for metered ad: "+t),n},tickMeter:function(e,t){var i=!1,s=this.getCurrentMeter(t);return s.length?(s[0]=Math.max(0,s[0]-1),s[0]<1&&(i=!0,e||(s[0]=s[1])),n.setValue(this.getRateMeterId(t),s),i):i},resetMeter:function(e){var t=this.getCurrentMeter(e);t[0]=t[1],n.setValue(this.getRateMeterId(e),t)},getRateMeterId:function(e){return"dfpc_"+(e||this.options.rateMeterId)},getCurrentMeterCount:function(e){return this.getCurrentMeter(e)[0]||0},getCurrentMeter:function(e){var t=this.getRateMeterId(e),i=this.getDefaultThreshold(e);return i?n.getValue(t,i):[]},shouldShowAd:function(){var e=this.tickMeter();return this.prefetchAd(),e&&!this.isAdReady()&&(a.logDebug("ad skipped due to no ad being delivered in time, refreshing slot"),this.refreshPosition(),e=!1),a.logDebug("shouldShowAd: "+e,this),e}});return r}),define("modules/carousel/gallery",["jquery","underscore","backbone","baseview","pubsub","utils","state","modules/global/taboola","meteredAdPosition","directAdPosition","adLogger","cookie"],function(e,t,i,s,n,o,a,r,l,h,d){var c=s.extend({events:{"click .gallery-actions-replay, .gallery-photo":"nextSlide","click .gallery-related-link":"taboolaClick"},selectors:{endSlate:".endslate",slides:".slide:not(.partner-placement)",hiddenWhileSurvey:".p402_hide"},endSlateTemplate:'<% _.each(data, function(item) { %><li class="gallery-related-item"><a class="gallery-related-link" data-taboola-type="<%= item.type %>" data-taboola-id="<%= item.id %>" data-taboola-response-id="<%=response_id%>"href="<%= item.url %>"><span class="taboola-image-crop"><img src="<%= item.thumbnail[0].url %>" class="taboola-related-img" alt="" /></span><%= item.name %></a><span class="gallery-related-date"><%= item.created %></span></li><% }); %>',initialize:function(i){t.bindAll(this,"_showEndslate","setAdSize","beforeAdRender"),i=e.extend({ads:!0,slideTransition:0,imageLazySrcAttr:"data-src",lookAheadAmount:2,transitionSlides:null},i),this.index=i.index,s.prototype.initialize.call(this,i),this.adCount=0,this.googleSurveyNeeded=!1,o.getNested(window.site_vars,"ADS","GALLERY","SURVEY")&&(this.googleSurveyNeeded=!0),this._initializeAds(),this.endSlateBuilt=!1,this.isRotating=!1,this.galleryThumbnails=this.$(".gallery-thumbs")},destroy:function(){e.cookie("GoogleSurveyDropped")&&(e.cookie("GoogleSurveyDropped",""),0!==this.$el.parent(".p402_premium").length&&this.$el.unwrap(),e("#contain-402").remove()),this._destroySurveyCallback(),s.prototype.destroy.call(this)},_initializeAds:function(){var e,t,i,s,n,o;this.options.ads&&(this.galleryData=this.$el.data()||{},this.setAdCount(),e=this.getAdTargeting(),this.$sponsorshipAd=this.$(".snapshot-sponsor"),this.$sponsorshipAd.length&&(o=this._getSlideIn(this.index).data("qqid"),e.snapshotid=o,this.subviews.sponsorshipAd=new h({el:this.$sponsorshipAd,adPlacement:"sponsor_logo/snapshots",adSizes:["sponsor_logo"],targeting:e})),this.$viewport=this.$(".viewport"),i=this.$viewport.width(),t=this.$viewport.height(),n=a.getActivePageInfo().excludeTransitionAd,450>t||600>i?d.logWarn("Advertisement viewport is too small: "+i+"x"+t):n||(this.$adSlide=this.$(".partner-slide-ad"),this.$adContents=this.$(".partner-slide-ad .gallery-photo-border"),s=null,"snapshot"===this.galleryData.galleryId&&(s="transition_snapshot"),this.subviews.ad=new l({el:this.$adContents,adPlacement:"transition_gallery",adSizes:["elastic"],beforeAdRender:this.beforeAdRender,meterThreshold:s,rateMeterId:"gallery_"+this.galleryData.galleryId,targeting:e,subSection:this.galleryData.cst})))},setAdCount:function(){this.adCount++},getAdTargeting:function(){return{pageType:this.galleryData.basePageType,contentid:this.galleryData.galleryId,sitePage:"usat/"+(this.galleryData.ssts||"").replace(/\/\/*$/,""),series:this.galleryData.series,topic:this.galleryData.topic,count:this.adCount,surveyCookie:""+(e.cookie("GoogleSurveyTaken")||!1),surveyOn:this.googleSurveyNeeded.toString()}},completedSurvey:function(){if(e.cookie("GoogleSurveyTaken","true",{expires:1}),e.cookie("GoogleSurveyDropped",""),this.isRotating)this.options.carousel.autoplay();else{var t=this.options.carousel.subviews.controls.selectors,i=!!e(t.nextArrow).attr("data-lastClicked"),s="none"==e(t.prevArrow).css("display"),n=-1;(i||s)&&(n=1),this.options.carousel.switchSlide(null,n)}var o=this.options.carousel.subviews.controls.$el;o.find(this.selectors.hiddenWhileSurvey).css("display","block"),this._destroySurveyCallback()},_destroySurveyCallback:function(){if(window.USATGoogleSurvey){window.USATGoogleSurvey=void 0;try{delete window.USATGoogleSurvey}catch(e){}}},render:function(){this._loadImage(this.$$(this.selectors.slides).eq(this.index))},taboolaClick:function(t){if(!this.$overrideTaboola){var i=e(t.currentTarget);r.prototype.registerTaboolaClick(i.attr("data-taboola-id"),i.attr("data-taboola-type"),i.attr("data-taboola-response-id"),"end-slate")}},nextSlide:function(e){e.preventDefault(),this.options.carousel.switchSlide(null,1)},_buildEndslate:function(){var e=this.$(".gallery-endslate-related"),t=this.options.endslateOptions,i=[];if(this.endSlateBuilt=!0,t&&t.overrideTaboola){t.currentGallery;i=t.endslateGalleries.join("-"),this.$(".override_taboola").hide(),a.fetchData("/picture-gallery/"+i+"/").done(function(t){e.html(t)},this)}else{var s=window.location.href;this.$el.hasClass("hasendslate")&&this.$el.data("gallery-id")&&(s=window.location.protocol+"//"+window.location.host+"/picture-gallery/"+this.$el.data("gallery-id")+"/");var n=new r({isWidgetPresent:!1});this.$$(this.selectors.endSlate).addClass("loading"),n.getRelated(this._showEndslate,"photo","photo",4,s,this.$el.data("gallery-id"),this.getPlacement())}},getPlacement:function(){switch(a.getActivePageInfo().texttype){case"gallery":return"Endslate - Cinematic Gallery";case"galleries":return"Endslate - Gallery";case"story":return"Endslate - Asset Gallery"}},_showEndslate:function(e){var i=this.$$(this.selectors.endSlate).removeClass("loading");i.find(".gallery-endslate-related").attr("data-media-url")||"";if(t.each(e.list,function(e){e.thumbnail[0].url.indexOf("images.taboola.com")>-1&&(e.thumbnail[0].url=decodeURIComponent((e.thumbnail[0].url+"").replace(/\+/g,"%20")),e.thumbnail[0].url=e.thumbnail[0].url.replace("//images.taboola.com/taboola/image/fetch/f_jpg,q_80,c_fill,g_face,e_sharpen/",""))}),1===i.length){var s=t.template(this.endSlateTemplate,{data:e.list,response_id:e.id});i.find(".gallery-endslate-related").html(s)}},goToSlide:function(t){var i=this._getSlideOut(),s=this._getSlideIn(t);return s.length?(this.index=t,n.trigger("carousel:switchSlide",this.$el.parent()),this._switchSlides(s,i)):e.Deferred().reject()},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(){var i=this._getSlideOut();return this.showingAd=this.$adSlide,i[0]!==this.showingAd[0]?(this.$sponsorshipAd&&this.$sponsorshipAd.hide(),this._switchSlides(this.showingAd,i).done(t.bind(function(){if(e.cookie("GoogleSurveyDropped")+""=="true"){var t=this.options.carousel.subviews.controls.$el,i=this.selectors.hiddenWhileSurvey.substr(1);t.find(".media-playlist").wrap('<div class="'+i+'"></div>'),this.options.carousel.playTimer&&(this.isRotating=!0,this.options.carousel._stopCarouselRotate())}this.subviews.ad.playAd(),this.hideThumbnails()},this))):e.Deferred().reject()},hideThumbnails:function(){this.galleryThumbnails.hide()},showThumbnails:function(){this.galleryThumbnails.show()},_transitionSlides:function(e,i){var s=this.options.slideTransition;if(this.options.transitionSlides){var n=this.$$(this.selectors.slides);return this.options.transitionSlides(n.index(e),n.index(i))}return i.css({opacity:1}),this.animate(i,"opacity",0,s,"ease-in-out").then(t.bind(function(){return this._fadeInSlide(e,s).done(t.bind(function(){i.css({visibility:"hidden",opacity:0})},this))},this))},_switchSlides:function(e,i){return i===this.showingAd&&(this.subviews.ad.stopAd(),this.showThumbnails()),this._transitionSlides(e,i).then(t.bind(function(){if(i.removeClass("active"),i===this.showingAd){this.setAdCount();var t=this.getAdTargeting();this.subviews.ad.setTargeting(t),this.subviews.ad.refreshPosition(),this.showingAd=null}e!==this.showingAd&&this.$sponsorshipAd&&this.$sponsorshipAd.length&&this.refreshSponsorshipAd(e.data("qqid"))},this))},refreshSponsorshipAd:function(e){var t=this.getAdTargeting();t.snapshotid=e,this.subviews.sponsorshipAd.setTargeting(t),this.subviews.sponsorshipAd.refreshPosition()},_getSlideOut:function(){var e;return e=this.showingAd?this.showingAd:this.$$(this.selectors.slides).eq(this.index)},_getSlideIn:function(e){var t;return t=this.$$(this.selectors.slides).eq(e),this._loadImage(t,this.index>e),!this.endSlateBuilt&&t.hasClass("endslate")&&this._buildEndslate(),t},_loadImage:function(e,t){var i=this.options.lookAheadAmount;do this._fetchImage(e.find("img")),i--,e=t?e.prev():e.next();while(i>=0&&e.length>0)},_fetchImage:function(e){if(e.length>0&&o.lazyLoadImage(e,this.options.imageLazySrcAttr)){var i=e.parent();i.addClass("loading"),e.load(t.bind(function(){i.removeClass("loading"),this._resizeMeta(e)},this))}},_fadeInSlide:function(e,t){return e.css({visibility:"visible","z-index":1}),e.addClass("active"),this._resizeMeta(e.find(".gallery-photo")),this.animate(e,"opacity",1,t,"ease-in-out")},_resizeMeta:function(e){if(e.length){var t=this._getImageWidth(e);t&&e.parent().width(t)}},_getImageWidth:function(e){return e.width()},viewportResize:function(i,s){this.$(".active .gallery-photo").each(t.bind(function(t,i){this._resizeMeta(e(i))},this)),this.$adSlide&&this.subviews.ad&&(this.setAdSize(i,s),this.subviews.ad.resizeAd(i,s))},beforeAdRender:function(e,i){e.survey&&(window.USATGoogleSurvey={completedSurvey:t.bind(this.completedSurvey,this)}),this.setAdSize()},setAdSize:function(e,t){e=e||this.$viewport.outerWidth(),t=t||this.$viewport.outerHeight();var i=this.findSizeForAd(e,t);this.$adContents.removeClass("size-s size-m size-l size-xl").addClass(i.adSizeClass),this.subviews.ad.setInitialDimensions(e,t)},findSizeForAd:function(e,t){var i={adSizeClass:"size-s",marginTop:"5px"},s=450;return e>1080&&t>810?(i.adSizeClass="size-xl",s=810):e>936&&t>700?(i.adSizeClass="size-l",s=700):e>768&&t>576&&(i.adSizeClass="size-m",s=576),i.marginTop=(t-s)/2+"px",i}});return c}),define("modules/myCapture/myCapture",["jquery","underscore","baseview","pubsub","utils"],function(e,t,i,s,n){"use strict";var o=i.extend({events:{"click .js-mycapture-btn":"mycaptureBtnClick"},initialize:function(t){t=e.extend({target:null},t),i.prototype.initialize.call(this,t)},mycaptureBtnClick:function(e){e.preventDefault(),this.options.target?e.currentTarget.classList.contains(this.options.target)&&this.handleClick(e):this.handleClick(e)},handleClick:function(t){s.trigger("uotrack","mycapturepurchase");var i=this.buildLink(e(t.currentTarget.parentElement).parent());window.open(i,"mycapture")},switchMyCaptureBtn:function(e){var t=e.$(".single-photo"),i=t.find(".js-mycapture-btn-small"),s=t.find(".js-mycapture-btn"),n=e.$(".js-caption-wrapper");t.hasClass("expandable-collapsed")?(i.hide(),s.show(),n.addClass("expandable-photo-caption-with-mycapture")):(s.hide(),i.show(),n.removeClass("expandable-photo-caption-with-mycapture"))},toggleSmallTag:function(e){this.$(".mycapture-small-btn").toggle(e)},buildLink:function(t){var i=this.getHost(),s=".mycapture.com/mycapture/remoteimage.asp?",o=t.parent().find("img"),a={image:o.attr("data-mycapture-sm-src"),notes:o.attr("data-mycapture-src"),caption:e.trim(t.find(".js-caption").text()),credit:e.trim(t.find(".credit").text()),backtext:"Back to Site",backurl:location.href,pricingsheetid:n.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","PRICING_SHEET_ID")||""};return"http://"+i+s+e.param(a)},getHost:function(){return n.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","SITE_OVERRIDE")||n.getNested(window.site_vars,"site_key")}});return o}),define("modules/carousel/controls",["jquery","underscore","backbone","baseview","modules/myCapture/myCapture","pubsub","utils"],function(e,t,i,s,n,o,a){var r=s.extend({events:{"click .slide-nav":"switchSlide","click .autoplay":"autoplay","click .thumbnails":"thumbsToggle","click .captions":"captionsToggle",mouseenter:"mouseover",mouseleave:"mouseout","click .fullscreen":"launchFullscreen"},selectors:{allCaptions:".meta",captionBtnLabel:".captionLabel",nextArrow:".slide-nav.next",playBtn:".playbtn",prevArrow:".slide-nav.prev",thumbsBtnLabel:".thumbLabel",thumbsWrapper:".thumbs",ticker:".ticker",viewport:".viewport",activeSlide:".gallery-viewport-slide.active"},initialize:function(t){t=e.extend({index:0,hoverShowControls:!0,interactionDemo:!0,interactionShowDelay:600,interactionHideDelay:3600,totalImages:0,totalSlides:0},t),this.index=t.index,s.prototype.initialize.call(this,t),a.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","ENABLED")&&this.setupMyCapture()},render:function(){this.updateTicker(),this.updateNextPrevArrows(this.index),this.options.interactionDemo&&this.startInteractionDemo()},destroy:function(e){this.clearUserInteractionDemo(),s.prototype.destroy.call(this,e)},setupMyCapture:function(){this.subviews.mycapture=new n({el:this.$el})},switchSlide:function(t){t.preventDefault();var i=e(t.currentTarget),s=i.hasClass("prev");if(i.attr("data-lastClicked","true").siblings(".slide-nav").removeAttr("data-lastClicked"),s?this.options.carousel.switchSlide(null,-1,!1):this.options.carousel.switchSlide(null,1,!1),this.subviews.mycapture){var n=this.$(this.selectors.allCaptions).hasClass("on");this.subviews.mycapture.toggleSmallTag(!n)}},autoplay:function(e){e.preventDefault(),this.options.carousel.autoplay()},startInteractionDemo:function(){var e=this;this.uxTimeout1=setTimeout(function(){e.$el.addClass("hover")},this.options.interactionShowDelay),this.uxTimeout2=setTimeout(function(){e.$el.removeClass("hover")},this.options.interactionHideDelay)},clearUserInteractionDemo:function(){clearTimeout(this.uxTimeout1),clearTimeout(this.uxTimeout2)},mouseover:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).addClass("hover"),this.$el.addClass("hover"),this.clearUserInteractionDemo()},mouseout:function(){this.options.hoverShowControls&&this.$$(this.selectors.viewport).removeClass("hover"),this.$el.removeClass("hover")},launchFullscreen:function(e){e.preventDefault(),o.trigger("openFullScreenCarousel",{carousel:this,fullScreen:!0,parent:this.$el})},captionsToggle:function(e){var t=this.$$(this.selectors.allCaptions),i=this.$$(this.selectors.captionBtnLabel);e.preventDefault(),t.hasClass("on")?(t.removeClass("on"),i.html("Show Captions")):(t.addClass("on"),i.html("Hide Captions")),this.subviews.mycapture&&this.subviews.mycapture.toggleSmallTag(!t.hasClass("on"))},thumbsToggle:function(e){var t=this.$$(this.selectors.thumbsBtnLabel),i=this.$$(this.selectors.thumbsWrapper);e.preventDefault(),i.hasClass("on")?(i.removeClass("on"),t.html("Show Thumbnails"),this.options.carousel.toggleThumbnail(!1)):(i.addClass("on"),t.html("Hide Thumbnails"),this.options.carousel.toggleThumbnail(!0))},updateNextPrevArrows:function(e){var t=this.$$(this.selectors.prevArrow),i=this.$$(this.selectors.nextArrow);0===e?t.hide():t.show(),e<this.options.totalSlides-1?i.show():i.hide()},updateTicker:function(){var e=this.$$(this.selectors.ticker);e.length&&(this.index<this.options.totalImages?e.css({visibility:"visible"}):e.css({visibility:"hidden"}),e.html("<b>"+(this.index+1)+"</b> of <b>"+this.options.totalImages+"</b>"))},goToSlide:function(e){this.index=e,this.updateNextPrevArrows(e),this.updateTicker()},onPlay:function(){this.$$(this.selectors.playBtn).addClass("pause").text("Pause")},onStop:function(){this.$$(this.selectors.playBtn).removeClass("pause").text("Autoplay")}});return r}),function(e){"function"==typeof define&&define.amd?define("mousewheel",["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var a=t||window.event,r=l.call(arguments,1),h=0,c=0,u=0,p=0,f=0,g=0;if(t=e.event.fix(a),t.type="mousewheel","detail"in a&&(u=-1*a.detail),"wheelDelta"in a&&(u=a.wheelDelta),"wheelDeltaY"in a&&(u=a.wheelDeltaY),"wheelDeltaX"in a&&(c=-1*a.wheelDeltaX),"axis"in a&&a.axis===a.HORIZONTAL_AXIS&&(c=-1*u,u=0),h=0===u?c:u,"deltaY"in a&&(u=-1*a.deltaY,h=u),"deltaX"in a&&(c=a.deltaX,0===u&&(h=-1*c)),0!==u||0!==c){if(1===a.deltaMode){var m=e.data(this,"mousewheel-line-height");h*=m,u*=m,c*=m}else if(2===a.deltaMode){var v=e.data(this,"mousewheel-page-height");h*=v,u*=v,c*=v}if(p=Math.max(Math.abs(u),Math.abs(c)),(!o||o>p)&&(o=p,s(a,p)&&(o/=40)),s(a,p)&&(h/=40,c/=40,u/=40),h=Math[h>=1?"floor":"ceil"](h/o),c=Math[c>=1?"floor":"ceil"](c/o),u=Math[u>=1?"floor":"ceil"](u/o),d.settings.normalizeOffset&&this.getBoundingClientRect){var b=this.getBoundingClientRect();f=t.clientX-b.left,g=t.clientY-b.top}return t.deltaX=c,t.deltaY=u,t.deltaFactor=o,t.offsetX=f,t.offsetY=g,t.deltaMode=0,r.unshift(t,h,c,u),n&&clearTimeout(n),n=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,r)}}function i(){o=null}function s(e,t){return d.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var n,o,a=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],r="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var h=a.length;h;)e.event.fixHooks[a[--h]]=e.event.mouseHooks;var d=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=r.length;i;)this.addEventListener(r[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",d.getLineHeight(this)),e.data(this,"mousewheel-page-height",d.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=r.length;i;)this.removeEventListener(r[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),s=i["offsetParent"in e.fn?"offsetParent":"parent"]();return s.length||(s=e("body")),parseInt(s.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),define("modules/scroller/base-scroll",["jquery","underscore","backbone","baseview","pubsub","utils","mousewheel"],function(e,t,i,s,n,o){var a=s.extend({events:{mousewheel:"handleMouseWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchstart:"onTouchStart","mousedown .scrolldragger":"onDraggerMouseDown","mouseenter .scrolldragger":"onDraggerMouseOver","mouseleave .scrolldragger":"onDraggerMouseOut","mousedown .scrollbar":"onBarClick"},removeActiveDelay:300,initialize:function(i){i=e.extend({disabled:!1,contentClass:".scrollable-content",lockPageScroll:!0,delayScroll:!1,minDraggerSize:40,template:null},i),t.bindAll(this,"onDraggerMouseUp","onDraggerMouseMove","onTouchMove","onTouchStop","_setMouseInHouse","_clearMouseInHouse"),this.content=this.$(i.contentClass),this.bar=e(i.template).hide(),this.bar.addClass("scrollbar"),this.dragger=this.bar.find(".scrolldragger"),this.body=o.get("body"),this.$el.append(this.bar),this.isMouseDown=!1,this.isMouseOver=!1,this.draggerOffset=0,s.prototype.initialize.call(this,i),this.refresh()},bindEvents:function(){this.delegateEvents()},unbindEvents:function(e){e||this.undelegateEvents(),this.body.off("."+this.cid),clearInterval(this.accelerationTimer),clearTimeout(this.enterDelay),clearTimeout(this.leaveDelay)},refresh:function(){if(this.content=this.$(this.options.contentClass),!this.options.disabled&&0!==this.content.length)if(this.viewportSize=this.getViewportSize(),this.contentSize=this.getContentSize(),this.contentViewportRatio=this.viewportSize/this.contentSize,this.contentViewportRatio<1){var e=this._calculateDraggerSize(this.viewportSize,this.contentViewportRatio,this.contentSize);this.draggerSize=this._setDraggerSize(e),this.active||(this.bar.show(),this.bindEvents(),this.active=!0,this.origPosition&&this.moveContentToPosition(this.origPosition.left,this.origPosition.top)),this.shiftContent(0,0)}else this.active&&(this.origPosition=this.content.position(),this.moveContentToPosition(0,0),this.bar.hide(),this.unbindEvents(),this.active=!1)},_calculateDraggerSize:function(e,t,i){var s=Math.round(e*t);if(s<this.options.minDraggerSize){var n=i-e,o=e-this.options.minDraggerSize;this.contentViewportRatio=o/n,s=this.options.minDraggerSize}return s},onTouchStart:function(e){var t=e.originalEvent.touches;t.length>1||this.options.disabled||!this.active||(clearInterval(this.accelerationTimer),this.touchX=t[0].pageX,this.touchY=t[0].pageY,this.touchVectorX=0,this.touchVectorY=0,this.touchDragStarted=!1,this.touchLastMove=(new Date).getTime(),this.body.on("touchend."+this.cid,this.onTouchStop),this.body.on("touchcancel."+this.cid,this.onTouchStop),this.body.on("touchmove."+this.cid,this.onTouchMove))},onTouchStop:function(e){if(0===e.originalEvent.touches.length&&(this.body.off("."+this.cid),this.touchDragStarted)){var t=(new Date).getTime(),i=t-this.touchLastMove;return e.preventDefault(),100>i&&this._triggerScrollingDecelerate(this.touchVectorX,this.touchVectorY,1500),!1}},_triggerScrollingDecelerate:function(e,i,s){var n=(new Date).getTime(),o=n+s,a=n,r=window.requestAnimationFrame||window.webkitRequestAnimationFrame,l=t.bind(function(){var t=(new Date).getTime(),h=t-a;a=t,o>t&&r(l),t-=n;var d=this._adjustVelocityVector(e,t,s),c=this._adjustVelocityVector(i,t,s);this.shiftContent(d*h,c*h)},this);this.accelerationTimer=r(l)},_adjustVelocityVector:function(e,t,i){return e*Math.pow(1-t/i,3)},onTouchMove:function(e){if(1===e.originalEvent.touches.length){var t=e.originalEvent.touches,i=t[0].pageX-this.touchX,s=t[0].pageY-this.touchY;if(this.touchDragStarted||Math.abs(i)>10||Math.abs(s)>10){var n=(new Date).getTime();this.touchDragStarted=!0,this.touchX=t[0].pageX,this.touchVectorX=i/(n-this.touchLastMove),this.touchY=t[0].pageY,
this.touchVectorY=s/(n-this.touchLastMove),this.touchLastMove=(new Date).getTime(),this.shiftContent(i,s)===!1&&e.preventDefault()}}},onBarClick:function(e){if(1===e.which&&!e.isDefaultPrevented()){e.preventDefault();var t=this.bar.offset(),i=e.pageX-t.left-this.draggerSize/2,s=e.pageY-t.top-this.draggerSize/2;this.moveDraggerToPosition(i,s),this.onDraggerMouseOver(e),this.onDraggerMouseDown(e)}},onDraggerMouseDown:function(e){if(1===e.which){this.isMouseDown=!0,e.preventDefault(),this.body.on("mousemove."+this.cid,this.onDraggerMouseMove),this.body.on("mouseup."+this.cid,this.onDraggerMouseUp);var t=this.dragger.offset();this.draggerClickOffset={left:e.pageX-t.left,top:e.pageY-t.top}}},onDraggerMouseUp:function(e){1===e.which&&(e.preventDefault(),this.isMouseDown=!1,this.body.off("."+this.cid),this.isMouseOver||this.dragger.removeClass("hover"))},onDraggerMouseMove:function(e){if(this.isMouseDown){var t=this.bar.offset(),i=e.pageX-t.left-this.draggerClickOffset.left,s=e.pageY-t.top-this.draggerClickOffset.top;this.moveDraggerToPosition(i,s)}},onDraggerMouseOver:function(e){this.isMouseOver=!0,this.dragger.addClass("hover")},onDraggerMouseOut:function(e){this.isMouseOver=!1,this.isMouseDown||this.dragger.removeClass("hover")},onMouseEnter:function(e){clearTimeout(this.leaveDelay),this.enterDelay=setTimeout(this._setMouseInHouse,300)},onMouseLeave:function(e){clearTimeout(this.enterDelay),this.leaveDelay=setTimeout(this._clearMouseInHouse,300)},_setMouseInHouse:function(){this.isMouseInTheHouse=!0},_clearMouseInHouse:function(){this.isMouseInTheHouse=!1},handleMouseWheel:function(e){if(!this.isMouseDown&&this.active&&(!this.options.delayScroll||this.isMouseInTheHouse)){var t=e.deltaY*e.deltaFactor,i=-1*e.deltaX*e.deltaFactor||t;this.shiftContent(i,t)===!1&&e.preventDefault()}},shiftContent:function(e,t){var i=this.content.position(),s=this.content.parent(),n=i.left+e-(parseInt(s.css("padding-left"),10)||0)-(parseInt(s.css("margin-left"),10)||0),o=i.top+t-(parseInt(s.css("padding-top"),10)||0)-(parseInt(s.css("margin-top"),10)||0);return this.moveContentToPosition(n,o)?!1:this.options.lockPageScroll?!1:void 0},destroy:function(){this.unbindEvents(!0),this.bar.remove(),s.prototype.destroy.apply(this,arguments)},moveDraggerToPosition:function(e,t){},moveContentToPosition:function(e,t){},scrollToElement:function(e,t,i,s){},animateContentToPosition:function(e,t,i,s){},getViewportSize:function(){return 0},getContentSize:function(){return 0},_setDraggerSize:function(e){return e}});return a}),define("modules/scroller/horizontal-scroll",["jquery","underscore","pubsub","modules/scroller/base-scroll"],function(e,t,i,s){var n=s.extend({initialize:function(i){i=e.extend({color:"light",draggerPaddingLeft:0,draggerPaddingRight:2,delayScroll:!0},i);var n=t.template('<div class="horizontal-scroll ui-<%= color %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');i.template=n({color:i.color}),this.scrollerName=this.$el.attr("data-name"),this.$(".horizontal-scroll").remove(),s.prototype.initialize.call(this,i)},getViewportSize:function(){return this.$el.width()},getContentSize:function(){return this.content.width()},_setDraggerSize:function(e){return e-=this.options.draggerPaddingLeft+this.options.draggerPaddingRight,this.dragger.css({width:e}),e},animateContentToPosition:function(i,s,n,o){var a=this.viewportSize-this.contentSize,r=Math.max(a,Math.min(i,0));return o=o||"ease-out",e.when(this.animate(this.dragger,"left",-1*r*this.contentViewportRatio+"px",n||0,o),this.animate(this.content,"left",r+"px",n,o)).done(t.bind(function(){this.$el.trigger("scrollBarUpdate",[r/a])},this))},scrollToElement:function(e,t,i,s){var n,o=e.outerWidth(),a=e.position().left+e.parent().position().left,r=a+o;if(0>a){var l=this.getViewportSize();n=t?a+(o-l):a}else r>this.getViewportSize()&&(n=t?a:a+(o-this.getViewportSize()));if(n){var h=this.content.position().left-n;this.animateContentToPosition(h,0,i,s)}},moveContentToPosition:function(e,t){if(!this.active)return!1;var i=Math.min(this.viewportSize-this.contentSize,0),s=Math.max(i,Math.min(e,0));return this._positionDragger(-1*s*this.contentViewportRatio),this._positionContent(s),this.$el.trigger("scrollBarUpdate",[s/i]),s===e},moveDraggerToPosition:function(e,t){if(!this.active)return!1;var i=this.viewportSize-(this.draggerSize+this.options.draggerPaddingRight+this.options.draggerPaddingLeft),s=Math.max(0,Math.min(e,i));return this._positionDragger(s),this._positionContent(-1*s/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",s/i),s===e},_positionDragger:function(e){e+=this.options.draggerPaddingLeft,e=Math.round(e),this.dragger.css({left:e})},_positionContent:function(e){e=Math.round(e),this.content.css({left:e}),this.scrollerName&&i.trigger("hor:scrollbar:update:"+this.scrollerName)}});return n}),define("modules/carousel/thumbs",["jquery","underscore","backbone","baseview","pubsub","utils","modules/scroller/horizontal-scroll"],function(e,t,i,s,n,o,a){var r=s.extend({events:{"mouseenter li":"thumbMouseover","mouseleave li":"thumbMouseout","click li":"switchSlide"},selectors:{thumbs:"li"},initialize:function(t){t=e.extend({hoverTransition:0},t),this.index=t.index,s.prototype.initialize.call(this,t),this.subviews.scrollbar=new a({el:this.$el,color:this.options.scrollerColor,padding:2}),this.goToSlide(this.index)},switchSlide:function(t){t.preventDefault();var i=e(t.currentTarget).index();this.options.carousel.switchSlide(i)},showAd:function(){var e=this.$$(this.selectors.thumbs);e.eq(this.index).removeClass("active")},thumbMouseover:function(i){var s=i.currentTarget;this.options.hoverTransition&&(this.hoverTimeout=setTimeout(t.bind(function(){this.hoverTimeout=null,this.options.carousel.switchSlide(e(s).index(),null,!0)},this),this.options.hoverTransition))},thumbMouseout:function(e){this.options.hoverTransition&&this.hoverTimeout&&clearTimeout(this.hoverTimeout)},goToSlide:function(e){var t=this.$$(this.selectors.thumbs),i=t.eq(e);t.eq(this.index).removeClass("active"),i.addClass("active"),this.index=e,i.length&&this.subviews.scrollbar.scrollToElement(i,!1,300)},viewportResize:function(){this.subviews.scrollbar&&this.subviews.scrollbar.refresh()}});return r}),define("modules/partner/simple-ad",["jquery","underscore","baseview","state","sharedAdPosition","directAdPosition"],function(e,t,i,s,n,o){"use strict";var a=i.extend({initialize:function(n){t.bindAll(this,"onAdReady"),n=e.extend({adPlacement:"poster_front",adSizes:"mediumrectangle",pageInfo:s.getActivePageInfo(),onAdReady:this.onAdReady,isShared:!1},n),i.prototype.initialize.call(this,n)},_initAds:function(){var e=this.options,t=e.adSizes;t&&"string"==typeof t&&(t=t.split(","));var i={el:this.$el,adPlacement:e.adPlacement,pageInfo:e.pageInfo,adSizes:t,onAdReady:this.onAdReady,adType:e.adType};e.isShared?(i.defaultPosition=!0,this.subviews.simpleAd=new n(i)):this.subviews.simpleAd=new o(i)},onAdReady:function(){this.subviews.simpleAd.show()}});return a}),define("modules/partner/companion-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){t=e.extend({adPlacement:"poster_gallery_companion"},t),i.prototype.initialize.call(this,t),this._initAds(),this.refreshTime=(new Date).getTime()},refresh:function(){this.subviews.simpleAd.refreshPosition(),this.refreshTime=(new Date).getTime()}});return s}),define("modules/carousel/companion",["jquery","underscore","baseview","modules/partner/companion-ad","utils"],function(e,t,i,s,n){"use strict";var o=i.extend({PROGRESSIVE_GALLERY_REFRESH_RATE:n.getNested(window.site_vars,"ADS","progressive_gallery_refresh_rate"),PROGRESSIVE_GALLERY_REFRESH_MIN_MS:n.getNested(window.site_vars,"ADS","progressive_gallery_refresh_min_ms")||0,refreshCount:0,initialize:function(e){i.prototype.initialize.call(this,e),this.slides=e.slides,this.currentInfo=this.$(".pag-current-info"),this.subviews.ad=new s({el:this.$(".pag-ad"),adPlacement:"poster_gallery_companion"})},goToSlide:function(e){if(++this.refreshCount%this.PROGRESSIVE_GALLERY_REFRESH_RATE===0){var t=(new Date).getTime()-this.subviews.ad.refreshTime;t>this.PROGRESSIVE_GALLERY_REFRESH_MIN_MS&&this.subviews.ad.refresh()}var i=this.slides.eq(e),s=i.find(".pag-photo-info").html();this.currentInfo.html(s)}});return o}),define("modules/carousel/carousel",["jquery","underscore","backbone","baseview","pubsub","state","utils","modules/carousel/gallery","modules/carousel/controls","modules/carousel/thumbs","modules/carousel/companion"],function(e,t,i,s,n,o,a,r,l,h,d){var c=s.extend({events:{mouseenter:"mouseEnter"},selectors:{slides:".slide:not(.partner-placement)",images:".slide:not(.partner-placement,.endslate)",companion:".pag-companion-wrapper"},initialize:function(i){i=e.extend({ads:!0,slideTransition:0,hoverShowControls:!0,hoverTransition:0,interactionDemo:!0,linkPath:null,rotate:!1,controlsSelector:null,gallerySelector:null,thumbsSelector:".thumbs",imageLazySrcAttr:"data-src",scrollerColor:"light",rotateInterval:3e3,autostart:!1},i),t.bindAll(this,"rotateCarousel"),this.index=this.$(".slide.active").index(),-1===this.index&&(this.index=0),this.linkPath=i.linkPath?i.linkPath:"",this.playTimer=null,this.subviews={},this.triggerAdRefresh=0===this.$$(this.selectors.companion).length,this._initializeGallery(i.imageLazySrcAttr,i.slideTransition,i.ads,i.gallerySelector,this.triggerAdRefresh,i.endslateOptions),this._initializeControls(i.hoverShowControls,i.interactionDemo,i.controlsSelector),this._initializeThumbs(i.hoverTransition,i.scrollerColor,i.thumbsSelector),this._initializeCompanion(this.selectors.slides),this.pubSub=e.extend({"carousel:stoptimer":this.stoptimer,"carousel:starttimer":this.resumeAutoPlay},this.pubSub),s.prototype.initialize.call(this,i),i.autostart&&this._startCarouselRotate()},_initializeCompanion:function(e){this.$$(this.selectors.companion).each(t.bind(function(t,i){this.subviews.companion=new d({el:i,slides:this.$$(e)})},this))},_initializeGallery:function(e,t,i,s,n,o){this.subviews.gallery=new r({ads:i,el:s?this.$(s):this.$el,index:this.index,imageLazySrcAttr:e,slideTransition:t,carousel:this,triggerAdRefresh:n,endslateOptions:o})},_initializeControls:function(e,t,i){var s=this.$(this.selectors.images),n=this.$$(this.selectors.slides);this.subviews.controls=new l({el:i?this.$(i):this.$el,hoverShowControls:e,interactionDemo:t,index:this.index,totalSlides:n.length,totalImages:s.length,carousel:this}),this.subviews.controls.render()},_initializeThumbs:function(e,t,i){this.subviews.thumbs=new h({el:i?this.$(i):this.$el,hoverTransition:e,index:this.index,scrollerColor:t,carousel:this})},mouseEnter:function(){this.options.autostart&&this._stopCarouselRotate()},rotateCarousel:function(){var e=this.$$(this.selectors.slides).length-1;this.switchSlide(null,1,!0),this.index!==e||this.options.rotate||this._stopCarouselRotate()},destroy:function(e){this.playTimer&&this._stopCarouselRotate(),s.prototype.destroy.call(this,e)},stoptimer:function(){clearInterval(this.playTimer),this.playTimer=null},switchSlide:function(e,t,i){var s=this.$$(this.selectors.slides).length;if(!this.showingAd&&this.subviews.gallery.shouldShowAd())return this.showingAd=!0,this.slideAdStep=t,void this.triggerEvent("showAd");if(t){this.slideAdStep&&this.slideAdStep!==t&&(t+=this.slideAdStep);var n=this.index+t;e=0>n?s-1:n>=s?0:n}else 0>e?e=0:e>=s&&(e=s-1);(this.index!==e||this.showingAd)&&(this.showingAd=!1,this.slideAdStep=0,this.index=e,this.triggerEvent("goToSlide",e),i||this._trackSlideChange())},_trackSlideChange:function(){var t;t=this.$el.hasClass("galleries")?this.$el:this.$(".galleries");var i=t.attr("data-gallery-id"),s=(t.attr("data-gal-pageurl")||"").replace(/^.*\/\/[^\/]+/,""),a=o.getActivePageInfo().contenttype;a?-1===a.indexOf("gallery")&&(a=e.trim(a)+" gallery"):a="galleries";var r={gallery_id:i,gallery_title:t.attr("data-title"),gallery_index:this.index+1,slide_id:t.find(".slide.active img").attr("data-id"),ssts:t.attr("data-ssts"),cst:(t.attr("data-cst")||"bugpages").replace(/\/+$/,""),contenttype:"snapshot"===i?"snapshot":a,pathName:""===s?this.linkPath:s,publishedDate:t.data("published-date")};n.trigger("slide:change",r),e.ajax({url:"/comscorepvcandidate.xml",headers:{"Cache-Control":"no-cache, no-store, must-revalidate, private","Surrogate-Control":"max-age=0",Pragma:"no-cache",Expires:"0"},cache:!1})},autoplay:function(){this.playTimer?this._stopCarouselRotate():this._startCarouselRotate(!0)},_startCarouselRotate:function(e){0===this.options.rotateInterval?this.stoptimer():this.playTimer=setInterval(this.rotateCarousel,this.options.rotateInterval),e&&this.rotateCarousel(),this.triggerEvent("onPlay")},_stopCarouselRotate:function(){this.stoptimer(),this.options.autostart=!1,this.triggerEvent("onStop")},resumeAutoPlay:function(){this.options.autostart&&!this.playTimer&&this._startCarouselRotate()},toggleThumbnail:function(e){this.triggerEvent("viewportResize")},viewportResize:function(){this.triggerEvent("viewportResize")}});return c}),define("modules/carousel/carousel-autosize",["jquery","underscore","backbone","baseview","utils","modules/carousel/carousel"],function(e,t,i,s,n,o){var a=o.extend({initialize:function(i){t.bindAll(this,"handleResizeWindow"),this.options=e.extend({hoverShowControls:!1,verticalAdjust:80,interactionDemo:!1,horizontalAdjust:0,thumbSize:84,imageLazySrcAttr:"data-large-src"},i),this.$win=n.get("win"),this.$el.hasClass("galleries")?this.$el.addClass("autosize"):this.$(".galleries").addClass("autosize");var s=t.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,s),this.handleResizeWindow(),o.prototype.initialize.call(this,this.options),this.subviews.gallery.render()},destroy:function(e){this.$win.off("."+this.cid),o.prototype.destroy.call(this,e)},handleResizeWindow:function(){this.windowHeight=this.$win.height(),this.windowWidth=this.$win.width(),this.viewportResize()},viewportResize:function(){var e=this.windowHeight-this.options.verticalAdjust;this.showThumbs&&(e-=this.options.thumbSize),this.$$(".viewport").height(e),this.triggerEvent("viewportResize",this.windowWidth-this.options.horizontalAdjust,e)},toggleThumbnail:function(e){this.showThumbs=e,this.viewportResize()}});return a}),define("modules/videos/video-transcript",["jquery","underscore","baseview","state","pubsub"],function(e,t,i,s,n){"use strict";var o=i.extend({events:{"click .video-transcript-caption":"onClickVideoSeek","click .video-transcript-keywordresult":"onClickkeyword","keydown .video-search-input":"onKeyDown","click .ui-ramp-transcriptplus":"onClickTranscriptSlide","click .toggle-transcript":"onClickTranscriptSlide","click .video-search-btn":"onClickVideoSearch","click .video-search-close-btn":"onClickSearchCloseBtn","click .transcript-navigate-next-active":"nextslide","click .transcript-navigate-prev-active":"prevslide","mouseenter .video-full-transcript-text":"toggleautoscroll","mouseleave .video-full-transcript-text":"toggleautoscroll"},initialize:function(t){var s=e.extend(!0,{animations:{useCSSTransitions:!1}},t);i.prototype.initialize.call(this,s),this.currentplayer=this.options.player||{},this.$viewport=this.$(".keywords-viewport"),this.$searchViewport=this.$(".search-viewport"),this.$keywordWindow=this.$(".video-keywords-result"),this.$searchWindow=this.$(".video-search-result"),this.initializeTranscript(),this.$searchinput=this.$(".video-search-input"),this.$keywords=this.$(".video-transcript-keywords"),this.$search=this.$(".video-transcript-search"),this.$searchresults=this.$(".video-search-display"),this.$searchCancelBtn=this.$(".video-search-close-btn"),this.$search.hide(),this._currentSlideCount=1,this.autoscroll=!0},onClickVideoSearch:function(t){this.$currentcaption.blur();var i,s;this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows();var n=this.$searchinput.val().toLowerCase(),o=new RegExp("\\b"+n+"\\b"),a=n.split(" ");if(0!==n.length){var r=this.$videotranscriptmain.filter(function(){return e(this).text().toLowerCase().search(o)>-1});if(2==a.length){var l=this.$videotranscriptmain.filter(function(){var t=e(this),i=e.trim(t.text().toLowerCase()).split(" ");if(i[i.length-1]==a[0]){var s=e.trim(t.next().text().toLowerCase()).split(" ");return s[0]==a[1]}return!1});l.length>0&&(r=r.add(l))}if(0===r.length&&"undefined"!=typeof t&&t.currentTarget.getAttribute("data-startoffset")&&(r=r.add(e(t.currentTarget))),this.trackclicks(this.$searchinput.data().track),this.$keywords.hide(),this.$search.show(),this.$searchOpen=this.$(".transcript-search-input"),this.$searchOpen.removeClass("video-search-open-button"),this.$searchCancelBtn.addClass("video-search-close-btn-visible"),this.$searchresults.addClass("show-results"),0!==r.length){this.$searchresults.append("<span class='video-search-term'>"+n+"</span> found at");for(var h=0;h<r.length;h++)i=r[h].getAttribute("data-startoffset"),s=r[h].getAttribute("data-startoffset_display"),this.$searchWindow.append("<span class='video-transcript-caption transcript-search-result' data-track='searchclick' data-startoffset="+i+">"+s+"</span>")}else this.$searchresults.append("<span class='no-results'>No results found for <span class='video-search-term'>\""+n+'"</span></span>')}this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&(this.$searchresults.empty(),this.$searchWindow.empty(),this.onClickVideoSearch(e))},onClickSearchCloseBtn:function(e){this.$searchCancelBtn.removeClass("video-search-close-btn-visible"),this.$searchOpen.addClass("video-search-open-button"),this.$searchresults.removeClass("show-results"),this.$searchresults.empty(),this.$searchWindow.empty(),this.clearActiveArrows(),this.$searchWindow.css("left","auto"),this.$keywordWindow.css("left","auto"),this.$searchinput.val(""),this.$search.hide(),this.$keywords.show(),this.updateSlideCount(),this.loadActiveArrows(),this._currentSlideCount=1},togglesearch:function(e){var t=this.$(".video-full-transcript-control");e&&t.hasClass("searchcontroloff")?(t.removeClass("searchcontroloff"),this.trackclicks("open-search"),this.updateSlideCount(),this.loadActiveArrows()):(t.addClass("searchcontroloff"),this.trackclicks("close-search"))},isTranscriptAvailable:function(){return this.$videotranscriptmain.length>0},initializeTranscript:function(){this.$videotranscriptmain=this.$(".video-transcript-caption"),this.$currentcaption=e(this.$videotranscriptmain[0]),this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption),!this.options.player.hidesearchcontrol&&this.options.player.flashsearchcontrolOn&&(this.updateSlideCount(),this.loadActiveArrows())},loadActiveArrows:function(){this.$(".video-transcript-keywords").is(":visible")?!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$keywordWindow.width()>this.$viewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"):this.$search.is(":visible")&&!this.$(".video-transcript-navigate-next").hasClass("transcript-navigate-next-active")&&this.$searchWindow.width()>this.$searchViewport.width()&&this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active")},clearActiveArrows:function(){this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active"),this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active")},onClickVideoSeek:function(t){var i=e(t.currentTarget),s=i.data();this.trackclicks(s.track),this.options.seek&&this.options.seek(s.startoffset)},onClickkeyword:function(t){var i=e(t.currentTarget).text();this.$searchinput.val(e.trim(i)),this.onClickVideoSearch(t)},progressHighlight:function(e){this.$currentcaption&&e.position>parseFloat(this.$currentcaption.attr("data-startoffset"))+parseFloat(this.$currentcaption.attr("data-duration"))&&(this.clearHighlight(this.$currentcaption),this.addHighlight(this.$currentcaption.next()))},clearHighlight:function(e){e.hasClass("active-transcript")&&e.removeClass("active-transcript")},toggleautoscroll:function(e){"mouseenter"==e.type?this.autoscroll=!1:this.autoscroll=!0},transcriptautoscroll:function(e){if(this.autoscroll){var t=e.offsetTop-e.parentElement.offsetTop;this.$(".video-full-transcript-text").animate({scrollTop:t},1e3)}},addHighlight:function(e){e.length>0&&(this.transcriptautoscroll(e[0]),this.$currentcaption=e,this.$currentcaption.addClass("active-transcript"))},onStatusChange:function(i){if("mediaSeekNotify"===i.type){this.clearHighlight(this.$currentcaption);t.find(this.$videotranscriptmain,function(t,s){var n=e(t);return i.position<n.data().startoffset+n.data().duration?(this.$currentcaption=n,this.addHighlight(n),!0):void 0},this)}else"mediaBegin"===i.type&&i.media.referenceId.toString()!=this.options.video.id&&this.$el.hide()},onClickTranscriptSlide:function(e){this.trackclicks("transcript"),this.$(".video-full-transcript-text").toggle("slow")},keywordSlide:function(e,t){return this.animate(e,"left",t+"px",250,"easeInOutQuad")},nextslide:function(){var e=this.getCurrentSlide();0!==this.totalSlides&&e!=this.totalSlides&&(1==e?this.targetWindow=-1*this.slideWidth:this.targetWindow=this.slideWidth*e*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount+=1,this.$(".video-transcript-navigate-prev").addClass("transcript-navigate-prev-active")),this._currentSlideCount==this.totalSlides&&this.$(".video-transcript-navigate-next").removeClass("transcript-navigate-next-active")},prevslide:function(){var e=this.getCurrentSlide();0!==this.totalSlides&&1!=e&&(this.targetWindow=this.slideWidth*(e-2)*-1,this.$(".video-transcript-keywords").is(":visible")?this.keywordSlide(this.$keywordWindow,this.targetWindow):this.$search.is(":visible")&&this.keywordSlide(this.$searchWindow,this.targetWindow),this._currentSlideCount-=1,this.$(".video-transcript-navigate-next").addClass("transcript-navigate-next-active"),1==this._currentSlideCount&&this.$(".video-transcript-navigate-prev").removeClass("transcript-navigate-prev-active"))},getCurrentSlide:function(){return this._currentSlideCount},updateSlideCount:function(){var e,t;this.$(".video-transcript-keywords").is(":visible")?(e=this.$keywordWindow,t=e.width(),this.viewportWidth=this.$viewport.width()):this.$search.is(":visible")&&(e=this.$searchWindow,t=e.width(),this.viewportWidth=this.$searchViewport.width()),this.slideWidth=Math.floor(this.viewportWidth/2),t>this.viewportWidth/2&&(this.totalSlides=2*Math.ceil(t/this.viewportWidth))},trackclicks:function(e){n.trigger("uotrack","ramp"+this.currentplayer.name+e)}});return o}),define("modules/stories/taboola-recommendations",["jquery","underscore","baseview","state","fwinfo","managers/routemanager","utils","modules/global/taboola","pubsub"],function(e,t,i,s,n,o,a,r,l){"use strict";var h=i.extend({initialize:function(n){n=e.extend({videoResponse:{}},n);var o=this.pageInfo=s.getActivePageInfo();this.texttype=o.texttype||"story",t.bindAll(this,"showTaboola","showNextRecommendation","getPlacement","renderEndslate","isVideo","isStory"),i.prototype.initialize.call(this,n),this.$endslate=this.$("#endslate-taboola-template"),this.$endslate_template=this.$(".video-endslate");var r=o.basePageType;"sidebar"===a.getNested(n,"layoutType")?this.createFrontSidebarTaboolaWidget(o):"full-width"===a.getNested(n,"layoutType")||"above-content"===a.getNested(n,"layoutType")||"below-content"===a.getNested(n,"layoutType")?this.createSectionTaboolaWidget(r):this.options.isContinuousEndslate||"section-front"===r||"subsection-front"===r||"home-front"===r||this.render()},render:function(){var t,i;if(t=e(".transition-wrap:first"),"interactive"!==this.texttype){if(-1!==this.texttype.indexOf("video")||"galleries"===this.texttype)i=!1;else if(this.isStory()){var n=t.find(".double-wide"),o=t.find(".story-right-rail");if(!n.length)return;if(a.hasAutoplayVideo(s.getActivePageInfo())&&a.getNested(window.site_vars,"html5video","scrollingPlayer","docked"))i=!0;else if(o.length){var r=n.position().top,l=n.height(),h=o.position().top+o.height()+1400-r;h>l&&(i=!0)}else i=!1}e(".iframe-auto").length>0&&(i=!0),this.createTaboola(i)}},createFrontSidebarTaboolaWidget:function(e){var t,i=a.getNested(window,"site_vars","display_options","sidebar_theme"),s=a.getNested(window,"site_vars","THIRDPARTYAPI","Taboola","sidebar_widget_mode"),n=a.getNested(e,"section_name"),o={url:a.getNested(e,"canonical")},l="home"===n?"home":"category",h=[],d={};t=i?"light"===i?"thumbnails-f":"thumbnails-n":s?s:"thumbnails-f",o[l]="auto",this.$el.hasClass("dr-styling")?h.push(this.getMetadata("thumbnails-p","taboola-right-rail-thumbnails","Right Rail Thumbnails - AB Test","mix")):h.push(this.getMetadata(t,"taboola-right-rail-thumbnails","Right Rail Thumbnails","mix")),d.widget=h,d.pagetypeWidget=o,this.subviews.taboola=new r(d)},createSectionTaboolaWidget:function(e){var t=[],i={},s={};"section-front"===e||"subsection-front"===e?(t.push(this.getMetadata("thumbnails-g","taboola-section-front-thumbnails","Section Front Thumbnails","mix")),i.category="auto"):"home-front"===e&&(t.push(this.getMetadata("thumbnails-s","taboola-homepage-thumbnails","Homepage Thumbnails","mix")),i.home="auto"),i.url=a.getNested(this.pageInfo,"canonical"),s.widget=t,s.pagetypeWidget=i,this.subviews.taboola=new r(s)},createTaboola:function(t){var i,n,o,l={},h={},d=[],c=e(".transition-wrap:first");n=a.getPageUrl(),i=-1!==n.indexOf("/sports/")||-1!==n.indexOf("/gameon/"),t?(d.push(this.getMetadata("thumbnails-r","taboola-short-article-2x5","Below Article SC 3x2","mix")),d.push(this.getMetadata("thumbnails-k","taboola-organic-short-article-2x5","Below Article Organic 2x2","mix")),l.article="auto",c.find(".more-stories-wrap").addClass("vertical")):this.isVideo()?(d.push(this.getMetadata("thumbnails-b","taboola-below-video-thumbnails","Below Video Thumbnails","mix")),d.push(this.getMetadata("organic-thumbnails-d","taboola-below-video-thumbnails-2nd","Below Video Thumbnails-2nd","mix")),"video"===this.texttype&&(o=s.getActivePageInfo().assetid,l.video=o)):"galleries"===this.texttype?(d.push(this.getMetadata("thumbnails-b","taboola-below-photo-thumbnails","Below Photo Thumbnails","mix")),d.push(this.getMetadata("organic-thumbnails-d","taboola-below-photo-thumbnails-2nd","Below Photo Thumbnails-2nd","mix")),l.photo="auto"):i?(d.push(this.getMetadata("thumbnails-l","taboola-grid-sports-3x3","grid-sports-3x3","mix")),d.push(this.getMetadata("thumbnails-m","taboola-organic-grid-sports-3x3","organic-grid-sports-3x3","mix")),l.article="auto"):this.isStory()&&(d.push(this.getMetadata("thumbnails-r","taboola-grid-3x3","Below Article SC 3x2","mix")),d.push(this.getMetadata("thumbnails-k","taboola-organic-grid-3x3","Below Article Organic 2x2","mix")),l.article="auto"),(a.getNested(window.site_vars,"ADS","taboola_poster","enabled")||a.getUrlParam("enable_taboola_abp"))&&d.push(this.getMetadata("thumbnails-q-abp","taboola-abp-right-rail-thumbnails","ABP Right Rail Thumbnails","mix")),a.getNested(window.site_vars,"taboola_exchange","enabled")&&(this.isStory()||t)&&(d.push(this.getMetadata("organic-thumbnails-rr","taboola-right-rail-exchange-thumbnails","Right Rail Thumbnails - Exchange","mix")),l.article="auto"),h.widget=d,h.pagetypeWidget=l,this.subviews.taboola=new r(h)},getMetadata:function(e,t,i,s){return{mode:e,container:t,placement:i||"",target_type:s||""}},isStory:function(){return-1!==["story","Story","blog","data"].indexOf(this.texttype)},isVideo:function(){return-1!==["video","video-playlist","brightcove-video-playlist"].indexOf(this.texttype)},showTaboola:function(e){var i=this.$("#more-galleries-template");if(1===i.length){var s=t.template(i.html(),{data:e.list});this.$(".headlines.gallery-more").append(s)}},renderEndslate:function(e,t,i){this.subviews.taboola||(this.subviews.taboola=new r({isContinuousEndslate:this.options.isContinuousEndslate})),this.subviews.taboola.getRelated(this.showNextRecommendation,"video","video",1,e,t,this.getPlacement(i),!1)},getPlacement:function(e){if(e)return"Continuous Endslate - Cinematic";switch(this.texttype){case"story":case"data":return"Continuous Endslate - Article";case"video":return"Continuous Endslate - Asset";case"video-playlist":return"Continuous Endslate - Presto Playlist";case"brightcove-video-playlist":return"Continuous Endslate - Brightcove playlist"}},showNextRecommendation:function(i){if(i.list&&!e.isEmptyObject(i.list[0])){var n="",o=a.getNested(window.site_vars,"THIRDPARTYAPI","Taboola")||{};if(o.presto_recommendation)n=i.list[0].id;else{var r=decodeURIComponent(i.list[0].url.match(/\&redir\=(.+)/)[1]),h=r.replace(/^.*\/\/[^\/]+/,"");n=h.replace(/^\D+/g,"")}s.fetchData("/videos/services/"+n).done(t.bind(function(e){e?(this.videoResponse=e,this.videoResponse.taboolaResponseId=i.id,o.presto_recommendation?this.video_media_url="/media/cinematic/video/"+n:this.video_media_url=decodeURIComponent(i.list[0].url.match(/\&redir\=(.+)/)[1])):l.trigger("uotrack","taboola-no-recommendations")},this)).fail(t.bind(function(){this.videoResponse={}},this))}else this.videoResponse={}},playNextRecommendation:function(t){var i=t,s="";this.subviews.taboola||(this.subviews.taboola=new r),this.videoResponse||(this.videoResponse=this.options.videoResponse),e.isEmptyObject(this.videoResponse)||(s=this.videoResponse.url.replace(/^.*\/\/[^\/]+/,""),i&&(s=this.video_media_url.replace(/^.*\/\/[^\/]+/,"")),this.subviews.taboola.registerTaboolaVisible(this.videoResponse.taboolaResponseId),this.subviews.taboola.registerTaboolaClick(this.videoResponse.id,"video",this.videoResponse.taboolaResponseId),n.setsessionvalue("clickName","taboola-autoplay"),-1!==["video","video-playlist","brightcove-video-playlist"].indexOf(this.texttype)||i?o.goTo(s):this.options.playRecommendedVideo(this.videoResponse))},destroy:function(e){clearInterval(this.timer),window.taboolainitialized&&(window.taboolainitialized=!1),i.prototype.destroy.apply(this,arguments)}});return h}),define("modules/videos/brightcove-video",["jquery","underscore","baseview","state","utils","admanager","managers/cachemanager","pubsub","modules/videos/video-transcript","adLogger","modules/stories/taboola-recommendations","managers/autoplay"],function(e,t,i,s,n,o,a,r,l,h,d,c){"use strict";var u=i.extend({events:{"click .ui-video-still-image-active, .ui-video-play-btn-active":"onClickVideoStill"},initialize:function(s){s=e.extend({video:this.$(".ui-video-data").eq(0).html(),player:this.$(".ui-video-player-data").eq(0).html(),brightcovePlayerParams:null,onStatusChange:null,onProgressChange:null,onClickPlay:null,customContainerClass:""},s),t.bindAll(this,"onVideoStatusChange","onVideoProgressChange","seekVideo","onVideoError","destroy","playRecommendedVideo","startAutoPlay","updateURL"),this.pubSub={"pause:videos":this.onPauseVideo,"page:load":this.onPageLoad},i.prototype.initialize.call(this,s),this.$videoStill=this.$(".ui-video-still-image"),this.$playBtn=this.$(".ui-video-play-btn"),this.isVideoStillActiveClassPreExisting=this.$videoStill.hasClass("ui-video-still-image-active"),this.isPlayBtnActiveClassPreExisting=this.$playBtn.hasClass("ui-video-play-btn-active"),window.BCCallbacks||(window.BCCallbacks={}),this.video=this._buildVideoData(),this.player=this._buildPlayerData()},playerKey:1,_buildVideoData:function(){var e=this.options.video||{};return"string"==typeof e&&(e=JSON.parse(e)),e},startAutoPlay:function(){return this.playVideo(),!0},playVideo:function(){var e=this.getVideoData()||{},t=e.id,i=e.brightcove_id;t||i?(this.hideStill(),this.loadPlayer().then(function(e){e.getIsPlaying(function(s){s?e.pause(!1):t?e.loadVideoByReferenceID(t):i&&e.loadVideoByID(i)})})):console.warn("cannot autoplay video: no video id was specified!")},_buildPlayerData:function(){var t=this.options.player||{};return"string"==typeof t&&(t=e.parseJSON(t)),e.extend({
width:480,height:270},t)},getVideoData:function(){return this.video},getPlayerData:function(){return this.player},onPageLoad:function(){this.getPlayerData().autoplay&&!this.destroyed&&c.register("brightcove-video",this.startAutoPlay)},_loadScript:function(){return this._loadScriptPromise||(this._loadScriptPromise=e.Deferred(function(e){require(["https://sadmin.brightcove.com/js/BrightcoveExperiences.js"],function(){"undefined"!=typeof window.brightcove?e.resolve():(console.warn("Error loading Brightcove"),e.reject())})})),this._loadScriptPromise.promise()},loadPlayer:function(){return this._loadScript().then(t.bind(function(){if(!this._loadPlayerPromise){var e=this.getPlayerKey();this.video.transcript_available&&(this.subviews.videotranscript=new l({el:this.$el.siblings(".ui-video-controls"),seek:this.seekVideo,video:this.video,player:this.player})),this._loadPlayerPromise=this._createPlayer(e).then(t.bind(function(t){return this.setupPlayer(t,e),this.$el.addClass("video-player-loaded"),this._player=t,t},this))}return this._loadPlayerPromise},this))},setupPlayer:function(e,i){this.setupEventListeners(e),this.addPlayerCallback(i,"onClickShareButton",t.bind(function(){this.onClickShareButton()},this)),this.addPlayerCallback(i,"onClickSearchButton",t.bind(function(e){this.onClickSearchButton(e)},this))},_neonEnabled:function(){return n.getNested(window.site_vars,"flags","neon")&&window.NeonPlayerTracker},_createPlayer:function(i){return this._videoObjEl=this._buildVideoObjectHtml(i),e.Deferred(t.bind(function(e){this.getPlayerData().id?(this.addPlayerCallback(i,this.getPlayerReadyCallbackKey(),t.bind(function(t){var s=window.brightcove.api.getExperience(i),n=s.getModule(window.brightcove.api.modules.APIModules.VIDEO_PLAYER);this._triggerNeon("onTemplateReady",t),e.resolve(n)},this)),this.addPlayerCallback(i,this.getPlayerLoadCallbackKey(),t.bind(function(){var e=window.brightcove.api.getExperience(i);this._triggerNeon("onTemplateLoad",e.id)},this)),this.addPlayerCallback(i,this.getPlayerErrorCallbackKey(),function(t){var i=t.errorType;4===t.code?i="error creating video player because of "+t.errorType:(console.warn("video player error: "+i),e.reject(t))}),window.brightcove.createExperiencesPostLoad=function(){},window.brightcove.createExperience(this._videoObjEl,this.$el[0],!0)):(console.warn("error creating video player: no video player id was specified!"),e.reject())},this))},_triggerNeon:function(e,i){this._neonEnabled()&&t.isFunction(window.NeonPlayerTracker[e])&&window.NeonPlayerTracker[e](i)},updateURL:function(e,t){if(e.hasAttribute("href")&&"#"!=e.href){var i=e.href.split("?url="),s=i[0]+"?url="+t+i[1].match(/&.*$/);try{e.href=s}catch(n){console.log(e.href+"\n"+n+"\nfailed video url")}}},onClickShareButton:function(){var i=e(".email-message"),n=this.video.short_url;t.each(e("[data-share-method]"),function(e){this.updateURL(e,n)},this),t.each(e("[data-module-name]"),function(e){this.updateURL(e,n)},this),i.val(i.html().split(/https:\/\/.+\//)[0]+n),s.getActiveApp().$(".util-bar-btn-email").click()},onClickSearchButton:function(e){this.subviews.videotranscript.togglesearch(e)},onPauseVideo:function(){this._player&&this._player.pause()},addPlayerCallback:function(e,t,i){window.BCCallbacks[e]||(window.BCCallbacks[e]={}),window.BCCallbacks[e][t]||(window.BCCallbacks[e][t]={}),window.BCCallbacks[e][t]=function(){i.apply(this,arguments)}},setupEventListeners:function(e){this.eventListeners={BEGIN:this.onVideoStatusChange,COMPLETE:this.onVideoStatusChange,PLAY:this.onVideoStatusChange,STOP:this.onVideoStatusChange,SEEK_NOTIFY:this.onVideoStatusChange,PROGRESS:this.onVideoProgressChange,ERROR:this.onVideoError,CHANGE:this.onVideoProgressChange},this.mediaEventApi=window.brightcove.api.events.MediaEvent,t.each(this.eventListeners,function(t,i){e.addEventListener(this.mediaEventApi[i],t)},this)},removeEventListeners:function(e){t.each(this.eventListeners,function(t,i){e.removeEventListener(this.mediaEventApi[i],t)},this)},onVideoStatusChange:function(t){if("mediaBegin"===t.type){var i="video:load";s.stopRefreshTimer(),r.trigger(i,this.getVideoEventAnalyticsData(t,i))}else"mediaComplete"===t.type?this.player.gannett_continuous_endslate&&this.shouldIncludeRecommendation()&&!this.options.overrideGetRecommendations&&(this.subviews.TaboolaOutbrain&&!e.isEmptyObject(this.subviews.TaboolaOutbrain.videoResponse)?this.subviews.TaboolaOutbrain.playNextRecommendation(this.player.mediatemplate):this.reset()):r.trigger("uotrack",t.type);this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.onStatusChange(t),this.options.onStatusChange&&this.options.onStatusChange(t)},onVideoProgressChange:function(e){this.trackVideoProgressEvent(e),this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&this.subviews.videotranscript.progressHighlight(e),this.options.onProgressChange&&this.options.onProgressChange(e)},onVideoError:function(e){r.trigger("uotrack","videoError:"+this.player.name+":"+(e.errorType||e.code))},trackVideoProgressEvent:function(e){var t=e.duration,i=e.position,s=Math.round(i/t*100),n=this.video.url||e.media.customFields.gdp_canonical_url;!this.fiftypercent&&s>=50&&95>s?(r.trigger("vitrack",{percentage:"50%",video_url:n}),this.fiftypercent=!0):!this.ninetyfivepercent&&s>=95&&99>s&&(r.trigger("vitrack",{percentage:"95%",video_url:n}),this.ninetyfivepercent=!0,this.options.overrideGetRecommendations?this.player.gannett_continuous_endslate&&this.options.overrideGetRecommendations(e):this.shouldIncludeRecommendation()&&!this.subviews.TaboolaOutbrain&&(this.subviews.TaboolaOutbrain=new d({playRecommendedVideo:this.playRecommendedVideo,isContinuousEndslate:!0}),this.subviews.TaboolaOutbrain.renderEndslate(this.video.url,this.video.brightcove_id)))},playRecommendedVideo:function(e){this.destroy(),this.subviews.nextVideo=new u({video:e,el:this.$el}),this.subviews.nextVideo.playVideo(),this.$el.parent().find(".video-desc").html(e.description+"<span class=credit>"+e.credit+"</span>")},_buildVideoObjectHtml:function(t){var i=document.createElement("object"),s=this.getPlayerData(),n=this.getVideoData();i.setAttribute("id",t),i.className="brightcove-video-object "+this.options.customContainerClass,i.setAttribute("style","width: "+s.width+"px; height: "+s.height+"px;");var o=e.extend({},this.getDefaultParams(t),this.options.brightcovePlayerParams);for(var a in o)if(o.hasOwnProperty(a)){var r=document.createElement("param");r.name=a,r.value=o[a],i.appendChild(r)}if(n&&(n.id||n.brightcove_id)){var l=document.createElement("param");l.name="@videoPlayer",n.id?l.value="ref:"+n.id:l.value=n.brightcove_id,i.appendChild(l)}return i},getDefaultParams:function(e){var t=this.getVideoData(),i=this.getPlayerData(),s={};return s={bgcolor:"#FFFFFF",playerID:i.id,width:i.width,height:i.height,autoStart:!1,isVid:!0,isUI:!0,wmode:"transparent",htmlFallback:!0,dynamicStreaming:!0,includeAPI:!0,usat_hasEmbed:!0,templateReadyHandler:"BCCallbacks."+e+"."+this.getPlayerReadyCallbackKey(),templateLoadHandler:"BCCallbacks."+e+"."+this.getPlayerLoadCallbackKey(),templateErrorHandler:"BCCallbacks."+e+"."+this.getPlayerErrorCallbackKey(),adServerURL:this._buildAdServerParam(),usat_linkurl:t.url||"",SSTSCode:(t.ssts_string||"")+"/"},!this.player.hidesearchcontrol&&this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()&&(this.player.flashsearchcontrolOn?s.usat_searchToggled="true":s.usat_searchToggled="false",s.usat_searchFunction="function(e){setTimeout(BCCallbacks."+e+".onClickSearchButton(e), 1)}"),this.video.sharecontrol&&(this.player.overridesharecontrol=!1),this.player.overridesharecontrol&&(s.usat_shareFunction="function(){setTimeout(BCCallbacks."+e+".onClickShareButton(), 1)}"),s},_buildAdServerParam:function(){var t=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),i=e.cookie("aam_uuid"),n="",a=s.getActivePageInfo(),r=this.getVideoData();a.series&&(n+="&series="+encodeURIComponent(a.series)),a.topic&&(n+="&topic="+encodeURIComponent(a.topic)),a.basePageType&&(n+="&pagetype="+encodeURIComponent(a.basePageType)),n+="&aam="+t+"&u="+i;var l="https://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output=xml_vast2&iu="+o.buildAdUnit("preroll_video")+"/"+r.cst+"&sz=920x508&unviewed_position_start=1&cust_params=contentid%3D"+r.id+encodeURIComponent(n)+'&cmsid=12768&url=""';return h.logInfo("Built ad call for video, "+r.id+".",a,r),h.logInfo("Video Ad call: "+l),l},getVideoEventAnalyticsData:function(e,t){var i=e.duration,s=e.media,n=Math.round(e.position/i*100),o=this.getVideoData(),a=this.getPlayerData(),r={completion:n+"%",videoFulllengthUrl:s.FLVFullLengthURL,eventtype:t||e.type,videoName:s.customFields.liveVideoSubject||s.displayName,contentid:s.id,assetid:s.referenceId,ssts:o.ssts_string||s.customFields.gdp_ssts,cst:o.cst||s.customFields.gdp_cst,keywords:o.keywords||s.customFields.gdp_tags,videoplayername:a.name,videocontentprovider:o.videocontentprovider||s.customFields.gannetttracking+"|"+s.displayName,contenttype:o.type||"video",videotranscript:this.subviews.videotranscript&&this.subviews.videotranscript.isTranscriptAvailable()?"yes":"no"};return 0>i?r.videoDuration="":120>i?r.videoDuration="less than 2 min":r.videoDuration="greater than 2 min",o.url&&(r.pathName=o.url.replace(/^.*\/\/[^\/]+/,"")),r},shouldIncludeRecommendation:function(){return"sponsor-story"!=s.getActivePageInfo().section_name&&"sponsor-story"!=n.getNested(this.video,"ssts","section")},getPlayerReadyCallbackKey:function(){return"onTemplateReady"},getPlayerLoadCallbackKey:function(){return"onTemplateLoad"},getPlayerErrorCallbackKey:function(){return"onTemplateError"},getPlayerKey:function(){return this._playerKey||u.prototype.playerKey++,this._playerKey="myExperience"+u.prototype.playerKey,this._playerKey},onClickVideoStill:function(e){this.options.onClickPlay?this.options.onClickPlay(e):this.playVideo()},hideStill:function(){this.$videoStill.removeClass("ui-video-still-image-active"),this.$playBtn.removeClass("ui-video-play-btn-active")},showStill:function(){this.$videoStill.addClass("ui-video-still-image-active"),this.$playBtn.addClass("ui-video-play-btn-active")},reset:function(){var e=this._player;this.fiftypercent=!1,this.ninetyfivepercent=!1,this.showStill(),e&&e.getIsPlaying(function(t){t&&e.getVideoPosition(!1,function(t){0!==t&&e.seek(0),e.pause(!0)})})},_destroyVideoObjectElement:function(){this._videoObjEl&&(e("#"+this.getPlayerKey()).remove(),this._videoObjEl=null)},seekVideo:function(e){this._player&&this._player.seek(e)},_resetPlayerModule:function(){this._player&&(this.removeEventListeners(this._player),this._player=null)},_getPreExistingActiveClass:function(e){var t=e+"-active";return this.isPlayBtnActiveClassPreExisting||this.isVideoStillActiveClassPreExisting?t:""},destroy:function(t,n){if(s.startRefreshTimer(),!n){var o=this.getPlayerKey();window.BCCallbacks&&window.BCCallbacks[o]&&delete window.BCCallbacks[o],window.BCCallbacks&&e.isEmptyObject(window.BCCallbacks)&&delete window.BCCallbacks,this._resetPlayerModule(),this.fiftypercent=!1,this.ninetyfivepercent=!1,this._destroyVideoObjectElement(),this.$el.removeClass("video-player-loaded"),this.$videoStill.addClass(this._getPreExistingActiveClass("ui-video-still-image")),this.$playBtn.addClass(this._getPreExistingActiveClass("ui-video-play-btn"))}i.prototype.destroy.apply(this,arguments)}});return u}),define("modules/scroller/vertical-scroll",["jquery","underscore","utils","modules/scroller/base-scroll"],function(e,t,i,s){var n=s.extend({initialize:function(i){i=e.extend({color:"light",fadeout:!1,draggerPaddingTop:3,draggerPaddingBottom:3},i);var n=this.options.fadeout?"fadeout":"",o=t.template('<div class="vertical-scroll ui-<%= color %> <%= fade %>"><div class="scrolldragger"><div class="over-icon"></div></div></div>');i.template=o({color:i.color,fade:n}),this.$(".vertical-scroll").remove(),s.prototype.initialize.call(this,i)},getViewportSize:function(){return this.$el.height()},getContentSize:function(){return this.content.height()},_setDraggerSize:function(e){return e-=this.options.draggerPaddingTop+this.options.draggerPaddingBottom,this.dragger.css({height:e}),e},animateContentToPosition:function(i,s,n,o){var a=this.viewportSize-this.contentSize,r=Math.max(a,Math.min(s,0));return o=o||"ease-out",e.when(this.animate(this.dragger,"top",-1*r*this.contentViewportRatio+"px",n||0,o),this.animate(this.content,"top",r+"px",n,o)).done(t.bind(function(){this.$el.trigger("scrollBarUpdate",[r/a])},this))},scrollToElement:function(e,t,i,s){var n,o=e.outerHeight(),a=e.position().top+e.parent().position().top,r=a+o;if(0>a){var l=this.getViewportSize();n=t?a+(o-l):a}else r>this.getViewportSize()&&(n=t?a:a+(o-this.getViewportSize()));if(n){var h=this.content.position().top-n;this.animateContentToPosition(0,h,i,s)}},moveContentToPosition:function(e,t){if(!this.active)return!1;var i=Math.min(this.viewportSize-this.contentSize,0),s=Math.max(i,Math.min(t,0));return this._positionDragger(-1*s*this.contentViewportRatio),this._positionContent(s),this.$el.trigger("scrollBarUpdate",[s/i]),s===t},moveDraggerToPosition:function(e,t){if(!this.active)return!1;var i=this.viewportSize-(this.draggerSize+this.options.draggerPaddingBottom+this.options.draggerPaddingTop),s=Math.max(0,Math.min(t,i));return this._positionDragger(s),this._positionContent(-1*s/this.contentViewportRatio),this.$el.trigger("scrollBarUpdate",s/i),s===t},_positionDragger:function(e){e+=this.options.draggerPaddingTop,e=Math.round(e),this.dragger.css({top:e})},_positionContent:function(e){e=Math.round(e),this.content.css({top:e}),"function"==typeof this.options.onScroll&&this.options.onScroll(e)}});return n}),define("ui/dropdown",["jquery","underscore","utils","managers/routemanager","baseview","state","modules/scroller/vertical-scroll"],function(e,t,i,s,n,o,a){"use strict";var r=n.extend({events:{"click .ui-dropdown-value":"onClick",keydown:"onKeyDown","click .ui-dropdown-item":"onItemClick","mouseenter .ui-dropdown-item":"onItemHover","click .ui-dropdown-item-link":"onItemLinkClick"},initialize:function(s){s=e.extend({onSelect:null},s),t.bindAll(this,"refresh"),n.prototype.initialize.call(this,s),this.body=i.get("body"),this.$el.attr("tabindex")||this.$el.attr("tabindex",0),this.dropdownItems=this._setupDropdownItems(this.$(".ui-dropdown-item")),this.dropdownValueDiv=this.$(".ui-dropdown-value"),this.defaultItem=this.dropdownItems.filter('[data-selected="selected"]'),this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},_setupDropdownItems:function(t){var i=t.filter('[data-selected="selected"]');if(1!==i.length){var s=t.eq(0);s.length&&s.attr("data-selected","selected")}return t.each(function(t,i){var s=e(i),n=s.find("a");n.length?s.addClass("ui-dropdown-item-with-link"):s.addClass("ui-dropdown-item-without-link")}),t},open:function(){var i=this.getDataValue(),s=this.getDropdownItemByDataValue(i);s.eq(0).attr("data-selected","selected").addClass("ui-dropdown-item-highlight"),this.$el.addClass("expanded"),this.isDropdownOpen=!0,this.subviews.scrollbar?this.subviews.scrollbar.refresh():this.subviews.scrollbar=new a({el:this.$(".ui-dropdown-content"),contentClass:".ui-dropdown-items-container",padding:6}),s.length&&this.subviews.scrollbar.scrollToElement(s,!1,50),this.body.on("click."+this.cid,t.bind(function(t){0===e(t.target).closest(this.el).length&&this.close()},this))},close:function(){this.$el.removeClass("expanded"),this.dropdownItems.removeClass("ui-dropdown-item-highlight"),this.isDropdownOpen=!1,this.body.off("click."+this.cid)},onClick:function(e){this.isDropdownOpen?this.close():this.open()},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;38===t||40===t?(this.isDropdownOpen?this.onResultItemUpDownArrowKeyPress(t):this.open(),e.preventDefault()):27===t?this.isDropdownOpen&&(e.preventDefault(),this.close()):9===t?this.isDropdownOpen&&(e.preventDefault(),this.close()):(32===t||13===t)&&(this.onSpaceBarOrEnterKeyPress(),e.preventDefault())},onResultItemUpDownArrowKeyPress:function(e){var t=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0);this.dropdownItems.removeClass("ui-dropdown-item-highlight"),t.length?38===e?(t=t.prev(),t.length||(t=this.dropdownItems.last()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(t,!1,50)):40===e&&(t=t.next(),t.length||(t=this.dropdownItems.first()),this.subviews.scrollbar&&this.subviews.scrollbar.scrollToElement(t,!1,50)):t=this.dropdownItems.eq(0),t.addClass("ui-dropdown-item-highlight")},onSpaceBarOrEnterKeyPress:function(){var e=this.dropdownItems.filter(".ui-dropdown-item-highlight").eq(0),t=e.find("a").attr("href"),i=e.data("value"),n=e.text();e.length&&this.setValue(i,n),this.options.onSelect&&this.options.onSelect(i,n,e),t&&s.goTo(t)},onItemClick:function(t){var i=e(t.currentTarget),s=i.data("value"),n=i.text();this.setValue(s,n),this.options.onSelect&&this.options.onSelect(s,n,i)},onItemLinkClick:function(t){var i=e(t.currentTarget).closest(".ui-dropdown-item");this.setValue(i.data("value"),i.text())},onItemHover:function(t){this.dropdownItems.removeClass("ui-dropdown-item-highlight"),e(t.currentTarget).addClass("ui-dropdown-item-highlight")},setValue:function(e,t){var i;this.dropdownItems.removeAttr("data-selected"),void 0!==e?(this.dropdownValueDiv.data("value",e),i=this.getDropdownItemByDataValue(e)):i=this.getDropdownItemByDisplayValue(t),this.dropdownValueDiv.html(t),"selected"!==i.eq(0).data("selected")&&i.eq(0).attr("data-selected","selected"),this.isDropdownOpen&&this.close()},getDataValue:function(){return this.dropdownValueDiv.data("value")||""},getDisplayValue:function(){return this.dropdownValueDiv.text()||""},getDropdownItemByDataValue:function(e){return this.dropdownItems.filter('[data-value="'+e+'"]')},getDropdownItemByDisplayValue:function(e){return this.dropdownItems.filter(':contains("'+e+'")')},refresh:function(t){if(t){var i=this._setupDropdownItems(e(t));this.$(".ui-dropdown-items-container").html(i),this.dropdownItems=i}var s=this.dropdownItems.filter('[data-selected="selected"]');this.setValue(s.data("value"),s.text()),this.defaultItem=s},reset:function(){this.setValue(this.defaultItem.data("value"),this.defaultItem.text())},destroy:function(e){this.body.off("."+this.cid),n.prototype.destroy.call(this,e)}});return r}),define("apps/media",["jquery","underscore","pubsub","utils","state","base-app","sharedAdPosition","modules/carousel/carousel-autosize","modules/videos/brightcove-video","modules/global/taboola","ui/dropdown"],function(e,t,i,s,n,o,a,r,l,h,d){"use strict";var c=o.extend({el:"#media-view",events:{"click .recommended, .more-from, .expando":"mediaTabClick","mouseout .media-playlist":"mediaPlaylistMouseOut","mouseover .media-playlist":"mediaPlaylistMouseIn","click .media-playlist a":"changeMediaClick","click .media-sidebar-list li.sub":"sectionHighlight",click:"userInteraction"},initialize:function(i){i=e.extend(!0,{delay:{playlistAutoClose:250},animations:{slide:{duration:350,easing:"ease-in-out"},cinematic:{change:{fadeOut:{duration:300,easing:"ease-in-out"},fadeIn:{duration:300,easing:"ease-in-out"}}}}},i),t.bindAll(this,"switchToNextVideo","handleResizeWindow"),this.win=s.get("win"),this.scrollEl=s.get("scrollEl"),this.win.on("resize."+this.cid,t.throttle(this.handleResizeWindow,50)),this.playlistTimer=null,this.init=!1,this.subviews={},o.prototype.initialize.call(this,i);var n=e(".sidenav > li.sub-active");this.lastSectionName=n.attr("data-section")},getAd:function(){this.subviews.skinad=new a({el:this.$(".partner-media-ad"),adSizes:["cinematicvideoskin"],adPlacement:"skin_media",adType:"skinmedia",defaultPosition:!0})},handleResizeWindow:function(){this.browse&&this.columnize(this.$el)},beforePageReveal:function(e,t,i){this.isCinematicPath(t)||this.columnize(i)},afterPageReveal:function(e,t){if(this.isCinematicPath(t)){if("galleries"==this.pageInfo.media_type)this._initializeGallery();else if("videopage"==this.pageInfo.media_type){this.getAd();var i=this.pageInfo.assetid;this.subviews.taboola=new h({isWidgetPresent:!1}),this.subviews.taboola.getRelated(this.showRecommended,"video","video",10,null,i,"Recommended  Cinematic Video")}this.browse=!1,this.isCinematicPath(e)||(this.playlistStuckOpen=!1,this.delayClosePlaylist(),e&&this.$(".back-to-media").attr("href",e)),this.setupSourcePoint()}else this._initializeBrowse();this.handleResizeWindow(),this.subviews.filterDropdown||(this.subviews.filterDropdown=new d({el:this.$(".media-view-sort-by-dropdown")})),s.lazyLoadImage(this.$(".more-from").find("img"),"data-src",!0)},animateChangePagePostData:function(e,t,i,s){return this.isCinematicPath(t)?this.isCinematicPath(e)?this._fadeInNewCinematicContent(t,i):this.slide(i,"left",this.options.animations.slide.duration,this.options.animations.slide.easing):this.isCinematicPath(e)?this.slide(i,"right",this.options.animations.slide.duration,this.options.animations.slide.easing):o.prototype.animateChangePagePostData.apply(this,arguments)},animateChangePagePreData:function(e,t){return this.isCinematicPath(e)||this.isCinematicPath(t)?void 0:this.changeBrowseSection(e,t)},changeBrowseSection:function(t,i){var s=this.$(".media-sidebar-list"),o=this._getSubSectionPath(t),a=this._getSubSectionPath(i);if(o!==a){var r,l;return s.children().each(function(t,i){i=e(i);var s=i.attr("data-section")||"";s===o?(r=i.find(".media-sidenav-sublist").slideUp(250).promise(),r.done(function(){i.removeClass("active")})):s===a&&(l=i.find(".media-sidenav-sublist").slideDown(250).promise(),l.done(function(){i.addClass("active")}))}),r&&n.registerAnimation(r),l&&n.registerAnimation(l),e.when(r,l)}},_getSubSectionPath:function(e){if(e=e.replace(/^media\/((latest|popular)\/)?/,"")){var t=e.indexOf("/");return-1===t?e:e.substring(0,t)}return""},isCinematicPath:function(e){return e&&-1!==e.indexOf("/cinematic")},_fadeInNewCinematicContent:function(i,s){return e.Deferred(t.bind(function(e){this._swapRelatedMedia(s),this._swapNavBar(s),this._swapMainView(s,e)},this)).promise()},_swapNavBar:function(e){var i=this.animate(this.$(".cinematic-side-nav-ul"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(t.bind(function(){var t=e.find(".cinematic-side-nav-ul");t.css("opacity",0),this.$(".cinematic-side-nav-ul").replaceWith(t),this.animate(t,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_swapMainView:function(e,i){var s=this.animate(this.$(".media-main-view"),"opacity",0,this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);s.done(t.bind(function(){var s=e.find(".media-main-view");if(s.css("opacity",0),this.$(".media-main-view").replaceWith(s),s.length){var n=this.animate(s,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing);n.done(t.bind(function(){i.resolve()},this))}else i.resolve()},this))},_swapRelatedMedia:function(e){var i=this.animate(this.$(".recommended"),"opacity",this.options.animations.cinematic.change.fadeOut.duration,this.options.animations.cinematic.change.fadeOut.easing);i.done(t.bind(function(){var t=e.find(".media-tabs-ul .recommended"),i=e.find(".media-playlist > .recommended");t.css("opacity",0),this.$(".media-tabs-ul .recommended").replaceWith(t),this.$(".media-playlist > .recommended").replaceWith(i),t.length&&this.animate(t,"opacity",1,this.options.animations.cinematic.change.fadeIn.duration,this.options.animations.cinematic.change.fadeIn.easing)},this))},_initializeGallery:function(){var e=this.$(".galleries"),t=e.data().galleryId||0;this.subviews.carousel=new r({el:this.$el,gallerySelector:e,scrollerColor:"dark",horizontalAdjust:126,verticalAdjust:117}),this.subviews.taboola=new h({isWidgetPresent:!1}),this.subviews.taboola.getRelated(this.showRecommended,"photo","photo",10,null,t,"Recommended  Cinematic Photo")},userInteraction:function(){this.switchVideoTimer&&clearTimeout(this.switchVideoTimer)},switchToNextVideo:function(){var e=this.$(".more-from .active").next();e.length&&(this.switchVideoTimer=setTimeout(function(){e.find("a").click()},5e3))},destroyModules:function(){clearTimeout(this.switchVideoTimer),o.prototype.destroyModules.apply(this,arguments)},destroy:function(e){this.win.off("."+this.cid),o.prototype.destroy.call(this,e)},changeMediaClick:function(t){var i=e(t.target);this.$(".playlist li.active").removeClass("active"),i.closest("li").addClass("active")},mediaTabClick:function(t){var i=this.$(".media-playlist"),s=e(t.target).closest("li");s.hasClass("expando")?i.hasClass("open")?(this.playlistStuckOpen=!1,i.removeClass("open")):(this.playlistStuckOpen=!0,i.addClass("open")):s.hasClass("tab")&&(i.addClass("open"),s.hasClass("active")||(i.find(".media-tabs .active").removeClass("active"),s.addClass("active"),i.find(".playlist").addClass("hidden"),i.find("."+s.attr("for")).removeClass("hidden")))},mediaPlaylistMouseOut:function(){this.playlistStuckOpen||this.delayClosePlaylist()},mediaPlaylistMouseIn:function(){clearTimeout(this.playlistTimer)},delayClosePlaylist:function(){this.$(".media-playlist").removeClass("initial")},_initializeBrowse:function(){this.gridWrapper=this.$(".grid-wrapper"),this.browse=!0},columnize:function(t){var i=360,n=t.find(".medialistitems"),o=e(window).width(),a=o-130-31,r=Math.floor(a/i);1>r&&(r=1),t.find(".media-content").width(r*i),n.removeClass("mediaview-featured"),n.slice(0,r).addClass("mediaview-featured"),s.lazyLoadImage(this.$(".mediaview-featured").find("img"),"data-large-src",!0)},sectionHighlight:function(t){var i=e(t.currentTarget);if(i.hasClass("active")&&!e(t.target).attr("href")){var s=i.children("ul");i.hasClass("collapsed")?(n.registerAnimation(s.slideDown(250).promise()),i.removeClass("collapsed")):(n.registerAnimation(s.slideUp(250).promise()),i.addClass("collapsed"))}},slide:function(i,n,o,a){var r=null,l=null;"left"===n?(r="left",l=-100):"right"===n&&(r="left",l=100);var h=s.getScrollPosition(),d=this.$el.offset().top;h-=d,this.$el.css(r,"0%"),this.$el.css({position:"absolute",top:-1*h}),i=e(i),i.css(r,-1*l+"%"),i.css({position:"absolute",top:d}),i.insertAfter(this.$el);var c=e.Deferred();return t.defer(t.bind(function(){0!==this.$el.length&&this.animate(this.$el,r,l+"%",o,a);var e=this.animate(i,r,"0%",o,a);e.done(t.bind(function(){this.$el.remove(),i.css({position:"",top:""}),this.setElement(i),c.resolve()},this))},this)),c.promise()},showRecommended:function(i){var s=e("#mediaview-recommended-template");if(1===s.length){var n=t.template(s.html(),{data:i.list});e("#mediaview-cinematic-recommended").append(n)}},setupSourcePoint:function(){window._sp_&&s.getNested(window.site_vars,"ADS","sourcepoint","onMedia")&&!window._sp_.displayed_message&&(window._sp_.mms=window._sp_.mms||{},window._sp_.mms.cmd=window._sp_.mms.cmd||[],window._sp_.mms.cmd.push(function(){window._sp_.mms.startMsg()}))}});return c}),function(){var e={},t={};document.writeln=(self.console||{}).log||function(){},document.write=function(){for(var i in e)if(e.hasOwnProperty(i))try{e[i].apply({},arguments)}catch(s){}for(var n=Array.prototype.join.call(arguments,""),o="<script[^<>]*src=['\"]?([^'\"<> :/]*:*//[a-z0-9.]*google.com/[^'\"<> ]*)['\"]?[^<>]*>[^<>]*</script>",a=new RegExp(o,"gi"),r=new RegExp(o,"i"),l=n.match(a)||[],h=0;h<l.length;h++)l[h].match(r),$.ajax({cache:!0,dataType:"script",success:function(){for(var e in t)if(t.hasOwnProperty(e))try{t[e].apply({},arguments)}catch(i){}},url:RegExp.$1}),n=n.replace(l[h],"");if(!n.match(/^\s*$/))try{console.log("document.write ignoring ",n)}catch(s){}},document.addOnWrite=function(t,i){"function"==typeof i&&(e[t]||(e[t]=i))},document.addOnScript=function(e,i){"function"==typeof i&&(t[e]||(t[e]=i))},document.delOnWrite=function(t){delete e[t]||(e[t]=void 0)},document.delOnScript=function(e){delete t[e]||(t[e]=void 0)}}(),define("global/document-write",function(){}),define("apps/search",["jquery","underscore","backbone","pubsub","utils","base-app","state","site-manager","global/document-write"],function(e,t,i,s,n,o,a,r){"use strict";var l=o.extend({el:".search-results",events:{"click .grid-btn":"gridView","click .list-btn":"listView"},initialize:function(i){i=e.extend(!0,{delay:{playlistAutoClose:250},animations:{open:{duration:250,easing:"ease-in-out"},close:{duration:250,easing:"ease-in-out"}}},i),this.win=n.get("win"),this.body=n.get("body"),this.scrollEl=n.get("scrollEl"),this.header=r.getHeader(),t.bindAll(this,"lazyload"),this.currentView="view-grid",this.init=!1,this.requestInProgress=!1,this.win.on("scroll."+this.cid,t.throttle(this.lazyload,200)),e(".site-masthead-search-close-btn").addClass("site-masthead-search-close-btn-visible"),o.prototype.initialize.call(this,i)},getRevealAppLoader:function(){return'<article class="search-results ui-loading dark-medium"></article>'},isSearchPage:!0,animateRevealApp:function(i,s){if(null===i)return e.Deferred().resolve();this.$("#search-form").css("height",""),this.$el.css({opacity:1,position:"absolute",overflow:"hidden",display:"block",top:"-100%",height:"100%"});var n=this.animate(this.$el,"top","0%",this.options.animations.open.duration,this.options.animations.open.easing);return n.done(t.bind(function(){this.body.addClass("show-search"),this.$el.css({height:"",top:"",position:""})},this)),n},setFixedPosition:function(e,t){this.$(".summary").css({top:this.header.getCurrentHeight()}),o.prototype.setFixedPosition.apply(this,arguments)},clearFixedPosition:function(e){this.$(".summary").css({top:"",position:""}),o.prototype.clearFixedPosition.apply(this,arguments)},_onHeaderFixed:function(){o.prototype._onHeaderFixed.apply(this,arguments),this._fixedOffset&&this.$(".summary").css({top:this.header.getCollapsedHeight(),position:"fixed"})},_onHeaderUnfixed:function(){this._fixedOffset&&this.$(".summary").css({top:-1*this._fixedOffset+this.header.getCollapsedHeight(),position:"absolute"}),o.prototype._onHeaderUnfixed.apply(this,arguments)},animateRemoveApp:function(e,t){var i=n.getScrollPosition();return this.$el.css({marginTop:-1*i,overflow:"hidden",height:this.win.height()+i}),this.$(".summary").css("position","absolute"),this.body.removeClass("show-search"),this.animate(this.$el,"top","-100%",this.options.animations.close.duration,this.options.animations.close.easing)},afterAppRemove:function(t,i){e(".site-masthead-search-close-btn").removeClass("site-masthead-search-close-btn-visible"),s.trigger("uotrack","searchResultsclose")},afterPageReveal:function(e,t){this.init||(this.init=!0,this.originalPath=e),this.moreResultsPlacer=this.$(".more-results"),this.lazyload(),this.searchWrap=this.$("#search-form"),this.searchTextInput=this.searchWrap.find(".text-input"),this.setup(),this.setupTextAd()},getMoreResults:function(e){return this.requestInProgress=!0,this.moreResultsPlacer.show(),a.fetchHtml(e).done(t.bind(function(e){this.moreResultsPlacer.parent().append(e),this.moreResultsPlacer.remove(),this.moreResultsPlacer=this.$(".more-results")},this)).fail(t.bind(function(){this.moreResultsPlacer.remove(),this.moreResultsPlacer=null},this)).always(t.bind(function(){this.requestInProgress=!1},this)),!1},getTerm:function(){return e(".search-term .term",this.$el).attr("data-term")},getPubId:function(){return n.getNested(window.site_vars,"THIRDPARTYAPI","ADSENSE","pubId")||""},setup:function(){this.results=this.$(".results"),this.summary=this.$(".summary"),this.sidebar=this.$(".sidebar"),this.viewGrid=this.$(".grid-btn"),this.viewList=this.$(".list-btn"),"view-list"===this.currentView&&this.listView()},setupTextAd:function(){var t="partner_search_text_ads"+(new Date).getTime();e(".tile.ad",this.$el).attr("id",t);var i={pubId:this.getPubId(),query:this.getTerm(),hl:"en"},s={container:t,lines:"3",fontFamily:"arial",fontSizeTitle:"13px",fontSizeDescription:"12px",fontSizeDomainLink:"12px",
colorTitleLink:"1EA3FF",colorText:"FFFFFF",colorDomainLink:"00C641",colorBackground:"2C2C2C"};this.loadGoogleSearchAds(i,s)},gridView:function(){return this.viewGrid.addClass("active"),this.viewList.removeClass("active"),this.summary.removeClass("list").addClass("grid"),this.results.removeClass("view-list").addClass("view-grid"),this.currentView="view-grid",e(".ad").appendTo(".sidebar"),!1},listView:function(){return this.viewList.addClass("active"),this.viewGrid.removeClass("active"),this.summary.removeClass("grid").addClass("list"),this.results.removeClass("view-grid").addClass("view-list"),this.currentView="view-list",e(".ad").prependTo(".list-content"),!1},lazyload:function(){if(this.init&&this.moreResultsPlacer&&this.moreResultsPlacer.length&&!this.requestInProgress){var e=n.getScrollPosition(),t=this.body.height();this.moreResultsPlacer.offset().top<=e+t&&this.getMoreResults(this.moreResultsPlacer.data("href"))}},loadGoogleSearchAds:function(e,t){var i=!1,s=function(){return i?(document.delOnWrite("searchads"),void document.delOnScript("searchads")):void(window.google&&window.google.ads&&window.google.ads.search&&window.google.ads.search.Ads&&(i=new window.google.ads.search.Ads(e,t),document.delOnWrite("searchads"),document.delOnScript("searchads")))};s()||(document.addOnWrite("searchads",s),document.addOnScript("searchads",s),a.fetchData("https://www.google.com/adsense/search/ads.js",{cache:!0,dataType:"script",success:s}))},destroy:function(){document.delOnWrite("searchads"),document.delOnScript("searchads"),this.win.off("."+this.cid),o.prototype.destroy.apply(this,arguments)}});return l}),function(window,document,undefined){!function(e){"use strict";"function"==typeof define&&define.amd?define("libs/jquery/plugins/jquery.dataTables",["jquery"],e):jQuery&&!jQuery.fn.dataTable&&e(jQuery)}(function($){"use strict";var DataTable=function(oInit){function _fnAddColumn(e,t){var i=DataTable.defaults.columns,s=e.aoColumns.length,n=$.extend({},DataTable.models.oColumn,i,{sSortingClass:e.oClasses.sSortable,sSortingClassJUI:e.oClasses.sSortJUI,nTh:t?t:document.createElement("th"),sTitle:i.sTitle?i.sTitle:t?t.innerHTML:"",aDataSort:i.aDataSort?i.aDataSort:[s],mData:i.mData?i.oDefaults:s});if(e.aoColumns.push(n),e.aoPreSearchCols[s]===undefined||null===e.aoPreSearchCols[s])e.aoPreSearchCols[s]=$.extend({},DataTable.models.oSearch);else{var o=e.aoPreSearchCols[s];o.bRegex===undefined&&(o.bRegex=!0),o.bSmart===undefined&&(o.bSmart=!0),o.bCaseInsensitive===undefined&&(o.bCaseInsensitive=!0)}_fnColumnOptions(e,s,null)}function _fnColumnOptions(e,t,i){var s=e.aoColumns[t];i!==undefined&&null!==i&&(i.mDataProp&&!i.mData&&(i.mData=i.mDataProp),i.sType!==undefined&&(s.sType=i.sType,s._bAutoType=!1),$.extend(s,i),_fnMap(s,i,"sWidth","sWidthOrig"),i.iDataSort!==undefined&&(s.aDataSort=[i.iDataSort]),_fnMap(s,i,"aDataSort"));var n=s.mRender?_fnGetObjectDataFn(s.mRender):null,o=_fnGetObjectDataFn(s.mData);s.fnGetData=function(e,t){var i=o(e,t);return s.mRender&&t&&""!==t?n(i,t,e):i},s.fnSetData=_fnSetObjectDataFn(s.mData),e.oFeatures.bSort||(s.bSortable=!1),!s.bSortable||-1==$.inArray("asc",s.asSorting)&&-1==$.inArray("desc",s.asSorting)?(s.sSortingClass=e.oClasses.sSortableNone,s.sSortingClassJUI=""):-1==$.inArray("asc",s.asSorting)&&-1==$.inArray("desc",s.asSorting)?(s.sSortingClass=e.oClasses.sSortable,s.sSortingClassJUI=e.oClasses.sSortJUI):-1!=$.inArray("asc",s.asSorting)&&-1==$.inArray("desc",s.asSorting)?(s.sSortingClass=e.oClasses.sSortableAsc,s.sSortingClassJUI=e.oClasses.sSortJUIAscAllowed):-1==$.inArray("asc",s.asSorting)&&-1!=$.inArray("desc",s.asSorting)&&(s.sSortingClass=e.oClasses.sSortableDesc,s.sSortingClassJUI=e.oClasses.sSortJUIDescAllowed)}function _fnAdjustColumnSizing(e){if(e.oFeatures.bAutoWidth===!1)return!1;_fnCalculateColumnWidths(e);for(var t=0,i=e.aoColumns.length;i>t;t++)e.aoColumns[t].nTh.style.width=e.aoColumns[t].sWidth}function _fnVisibleToColumnIndex(e,t){var i=_fnGetColumns(e,"bVisible");return"number"==typeof i[t]?i[t]:null}function _fnColumnIndexToVisible(e,t){var i=_fnGetColumns(e,"bVisible"),s=$.inArray(t,i);return-1!==s?s:null}function _fnVisbleColumns(e){return _fnGetColumns(e,"bVisible").length}function _fnGetColumns(e,t){var i=[];return $.map(e.aoColumns,function(e,s){e[t]&&i.push(s)}),i}function _fnDetectType(e){for(var t=DataTable.ext.aTypes,i=t.length,s=0;i>s;s++){var n=t[s](e);if(null!==n)return n}return"string"}function _fnReOrderIndex(e,t){for(var i=t.split(","),s=[],n=0,o=e.aoColumns.length;o>n;n++)for(var a=0;o>a;a++)if(e.aoColumns[n].sName==i[a]){s.push(a);break}return s}function _fnColumnOrdering(e){for(var t="",i=0,s=e.aoColumns.length;s>i;i++)t+=e.aoColumns[i].sName+",";return t.length==s?"":t.slice(0,-1)}function _fnApplyColumnDefs(e,t,i,s){var n,o,a,r,l,h;if(t)for(n=t.length-1;n>=0;n--){var d=t[n].aTargets;for($.isArray(d)||_fnLog(e,1,"aTargets must be an array of targets, not a "+typeof d),a=0,r=d.length;r>a;a++)if("number"==typeof d[a]&&d[a]>=0){for(;e.aoColumns.length<=d[a];)_fnAddColumn(e);s(d[a],t[n])}else if("number"==typeof d[a]&&d[a]<0)s(e.aoColumns.length+d[a],t[n]);else if("string"==typeof d[a])for(l=0,h=e.aoColumns.length;h>l;l++)("_all"==d[a]||$(e.aoColumns[l].nTh).hasClass(d[a]))&&s(l,t[n])}if(i)for(n=0,o=i.length;o>n;n++)s(n,i[n])}function _fnAddData(e,t){var i,s=$.isArray(t)?t.slice():$.extend(!0,{},t),n=e.aoData.length,o=$.extend(!0,{},DataTable.models.oRow);o._aData=s,e.aoData.push(o);for(var a,r=0,l=e.aoColumns.length;l>r;r++)if(i=e.aoColumns[r],"function"==typeof i.fnRender&&i.bUseRendered&&null!==i.mData?_fnSetCellData(e,n,r,_fnRender(e,n,r)):_fnSetCellData(e,n,r,_fnGetCellData(e,n,r)),i._bAutoType&&"string"!=i.sType){var h=_fnGetCellData(e,n,r,"type");null!==h&&""!==h&&(a=_fnDetectType(h),null===i.sType?i.sType=a:i.sType!=a&&"html"!=i.sType&&(i.sType="string"))}return e.aiDisplayMaster.push(n),e.oFeatures.bDeferRender||_fnCreateTr(e,n),n}function _fnGatherData(e){var t,i,s,n,o,a,r,l,h,d,c,u,p,f,g;if(e.bDeferLoading||null===e.sAjaxSource)for(r=e.nTBody.firstChild;r;){if("TR"==r.nodeName.toUpperCase())for(l=e.aoData.length,r._DT_RowIndex=l,e.aoData.push($.extend(!0,{},DataTable.models.oRow,{nTr:r})),e.aiDisplayMaster.push(l),a=r.firstChild,s=0;a;)p=a.nodeName.toUpperCase(),("TD"==p||"TH"==p)&&(_fnSetCellData(e,l,s,$.trim(a.innerHTML)),s++),a=a.nextSibling;r=r.nextSibling}for(o=_fnGetTrNodes(e),n=[],t=0,i=o.length;i>t;t++)for(a=o[t].firstChild;a;)p=a.nodeName.toUpperCase(),("TD"==p||"TH"==p)&&n.push(a),a=a.nextSibling;for(c=0,u=e.aoColumns.length;u>c;c++){f=e.aoColumns[c],null===f.sTitle&&(f.sTitle=f.nTh.innerHTML);var m,v,b,y,w=f._bAutoType,_="function"==typeof f.fnRender,C=null!==f.sClass,S=f.bVisible;if(w||_||C||!S)for(h=0,d=e.aoData.length;d>h;h++)g=e.aoData[h],m=n[h*u+c],w&&"string"!=f.sType&&(y=_fnGetCellData(e,h,c,"type"),""!==y&&(v=_fnDetectType(y),null===f.sType?f.sType=v:f.sType!=v&&"html"!=f.sType&&(f.sType="string"))),f.mRender?m.innerHTML=_fnGetCellData(e,h,c,"display"):f.mData!==c&&(m.innerHTML=_fnGetCellData(e,h,c,"display")),_&&(b=_fnRender(e,h,c),m.innerHTML=b,f.bUseRendered&&_fnSetCellData(e,h,c,b)),C&&(m.className+=" "+f.sClass),S?g._anHidden[c]=null:(g._anHidden[c]=m,m.parentNode.removeChild(m)),f.fnCreatedCell&&f.fnCreatedCell.call(e.oInstance,m,_fnGetCellData(e,h,c,"display"),g._aData,h,c)}if(0!==e.aoRowCreatedCallback.length)for(t=0,i=e.aoData.length;i>t;t++)g=e.aoData[t],_fnCallbackFire(e,"aoRowCreatedCallback",null,[g.nTr,g._aData,t])}function _fnNodeToDataIndex(e,t){return t._DT_RowIndex!==undefined?t._DT_RowIndex:null}function _fnNodeToColumnIndex(e,t,i){for(var s=_fnGetTdNodes(e,t),n=0,o=e.aoColumns.length;o>n;n++)if(s[n]===i)return n;return-1}function _fnGetRowData(e,t,i,s){for(var n=[],o=0,a=s.length;a>o;o++)n.push(_fnGetCellData(e,t,s[o],i));return n}function _fnGetCellData(e,t,i,s){var n,o=e.aoColumns[i],a=e.aoData[t]._aData;if((n=o.fnGetData(a,s))===undefined)return e.iDrawError!=e.iDraw&&null===o.sDefaultContent&&(_fnLog(e,0,"Requested unknown parameter "+("function"==typeof o.mData?"{mData function}":"'"+o.mData+"'")+" from the data source for row "+t),e.iDrawError=e.iDraw),o.sDefaultContent;if(null===n&&null!==o.sDefaultContent)n=o.sDefaultContent;else if("function"==typeof n)return n();return"display"==s&&null===n?"":n}function _fnSetCellData(e,t,i,s){var n=e.aoColumns[i],o=e.aoData[t]._aData;n.fnSetData(o,s)}function _fnGetObjectDataFn(e){if(null===e)return function(e,t){return null};if("function"==typeof e)return function(t,i,s){return e(t,i,s)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("["))return function(t,i){return t[e]};var t=function(e,i,s){var n,o,a,r=s.split(".");if(""!==s)for(var l=0,h=r.length;h>l;l++){if(n=r[l].match(__reArray)){r[l]=r[l].replace(__reArray,""),""!==r[l]&&(e=e[r[l]]),o=[],r.splice(0,l+1),a=r.join(".");for(var d=0,c=e.length;c>d;d++)o.push(t(e[d],i,a));var u=n[0].substring(1,n[0].length-1);e=""===u?o:o.join(u);break}if(null===e||e[r[l]]===undefined)return undefined;e=e[r[l]]}return e};return function(i,s){return t(i,s,e)}}function _fnSetObjectDataFn(e){if(null===e)return function(e,t){};if("function"==typeof e)return function(t,i){e(t,"set",i)};if("string"!=typeof e||-1===e.indexOf(".")&&-1===e.indexOf("["))return function(t,i){t[e]=i};var t=function(e,i,s){for(var n,o,a,r,l=s.split("."),h=0,d=l.length-1;d>h;h++){if(o=l[h].match(__reArray)){l[h]=l[h].replace(__reArray,""),e[l[h]]=[],n=l.slice(),n.splice(0,h+1),r=n.join(".");for(var c=0,u=i.length;u>c;c++)a={},t(a,i[c],r),e[l[h]].push(a);return}(null===e[l[h]]||e[l[h]]===undefined)&&(e[l[h]]={}),e=e[l[h]]}e[l[l.length-1].replace(__reArray,"")]=i};return function(i,s){return t(i,s,e)}}function _fnGetDataMaster(e){for(var t=[],i=e.aoData.length,s=0;i>s;s++)t.push(e.aoData[s]._aData);return t}function _fnClearTable(e){e.aoData.splice(0,e.aoData.length),e.aiDisplayMaster.splice(0,e.aiDisplayMaster.length),e.aiDisplay.splice(0,e.aiDisplay.length),_fnCalculateEnd(e)}function _fnDeleteIndex(e,t){for(var i=-1,s=0,n=e.length;n>s;s++)e[s]==t?i=s:e[s]>t&&e[s]--;-1!=i&&e.splice(i,1)}function _fnRender(e,t,i){var s=e.aoColumns[i];return s.fnRender({iDataRow:t,iDataColumn:i,oSettings:e,aData:e.aoData[t]._aData,mDataProp:s.mData},_fnGetCellData(e,t,i,"display"))}function _fnCreateTr(e,t){var i,s=e.aoData[t];if(null===s.nTr){s.nTr=document.createElement("tr"),s.nTr._DT_RowIndex=t,s._aData.DT_RowId&&(s.nTr.id=s._aData.DT_RowId),s._aData.DT_RowClass&&(s.nTr.className=s._aData.DT_RowClass);for(var n=0,o=e.aoColumns.length;o>n;n++){var a=e.aoColumns[n];i=document.createElement(a.sCellType),i.innerHTML="function"!=typeof a.fnRender||a.bUseRendered&&null!==a.mData?_fnGetCellData(e,t,n,"display"):_fnRender(e,t,n),null!==a.sClass&&(i.className=a.sClass),a.bVisible?(s.nTr.appendChild(i),s._anHidden[n]=null):s._anHidden[n]=i,a.fnCreatedCell&&a.fnCreatedCell.call(e.oInstance,i,_fnGetCellData(e,t,n,"display"),s._aData,t,n)}_fnCallbackFire(e,"aoRowCreatedCallback",null,[s.nTr,s._aData,t])}}function _fnBuildHead(e){var t,i,s,n=$("th, td",e.nTHead).length;if(0!==n)for(t=0,s=e.aoColumns.length;s>t;t++)i=e.aoColumns[t].nTh,i.setAttribute("role","columnheader"),e.aoColumns[t].bSortable&&(i.setAttribute("tabindex",e.iTabIndex),i.setAttribute("aria-controls",e.sTableId)),null!==e.aoColumns[t].sClass&&$(i).addClass(e.aoColumns[t].sClass),e.aoColumns[t].sTitle!=i.innerHTML&&(i.innerHTML=e.aoColumns[t].sTitle);else{var o=document.createElement("tr");for(t=0,s=e.aoColumns.length;s>t;t++)i=e.aoColumns[t].nTh,i.innerHTML=e.aoColumns[t].sTitle,i.setAttribute("tabindex","0"),null!==e.aoColumns[t].sClass&&$(i).addClass(e.aoColumns[t].sClass),o.appendChild(i);$(e.nTHead).html("")[0].appendChild(o),_fnDetectHeader(e.aoHeader,e.nTHead)}if($(e.nTHead).children("tr").attr("role","row"),e.bJUI)for(t=0,s=e.aoColumns.length;s>t;t++){i=e.aoColumns[t].nTh;var a=document.createElement("div");a.className=e.oClasses.sSortJUIWrapper,$(i).contents().appendTo(a);var r=document.createElement("span");r.className=e.oClasses.sSortIcon,a.appendChild(r),i.appendChild(a)}if(e.oFeatures.bSort)for(t=0;t<e.aoColumns.length;t++)e.aoColumns[t].bSortable!==!1?_fnSortAttachListener(e,e.aoColumns[t].nTh,t):$(e.aoColumns[t].nTh).addClass(e.oClasses.sSortableNone);if(""!==e.oClasses.sFooterTH&&$(e.nTFoot).children("tr").children("th").addClass(e.oClasses.sFooterTH),null!==e.nTFoot){var l=_fnGetUniqueThs(e,null,e.aoFooter);for(t=0,s=e.aoColumns.length;s>t;t++)l[t]&&(e.aoColumns[t].nTf=l[t],e.aoColumns[t].sClass&&$(l[t]).addClass(e.aoColumns[t].sClass))}}function _fnDrawHead(e,t,i){var s,n,o,a,r,l,h,d,c,u=[],p=[],f=e.aoColumns.length;for(i===undefined&&(i=!1),s=0,n=t.length;n>s;s++){for(u[s]=t[s].slice(),u[s].nTr=t[s].nTr,o=f-1;o>=0;o--)e.aoColumns[o].bVisible||i||u[s].splice(o,1);p.push([])}for(s=0,n=u.length;n>s;s++){if(h=u[s].nTr)for(;l=h.firstChild;)h.removeChild(l);for(o=0,a=u[s].length;a>o;o++)if(d=1,c=1,p[s][o]===undefined){for(h.appendChild(u[s][o].cell),p[s][o]=1;u[s+d]!==undefined&&u[s][o].cell==u[s+d][o].cell;)p[s+d][o]=1,d++;for(;u[s][o+c]!==undefined&&u[s][o].cell==u[s][o+c].cell;){for(r=0;d>r;r++)p[s+r][o+c]=1;c++}u[s][o].cell.rowSpan=d,u[s][o].cell.colSpan=c}}}function _fnDraw(e){var t=_fnCallbackFire(e,"aoPreDrawCallback","preDraw",[e]);if(-1!==$.inArray(!1,t))return void _fnProcessingDisplay(e,!1);var i,s,n,o=[],a=0,r=e.asStripeClasses.length,l=e.aoOpenRows.length;if(e.bDrawing=!0,e.iInitDisplayStart!==undefined&&-1!=e.iInitDisplayStart&&(e.oFeatures.bServerSide?e._iDisplayStart=e.iInitDisplayStart:e._iDisplayStart=e.iInitDisplayStart>=e.fnRecordsDisplay()?0:e.iInitDisplayStart,e.iInitDisplayStart=-1,_fnCalculateEnd(e)),e.bDeferLoading)e.bDeferLoading=!1,e.iDraw++;else if(e.oFeatures.bServerSide){if(!e.bDestroying&&!_fnAjaxUpdate(e))return}else e.iDraw++;if(0!==e.aiDisplay.length){var h=e._iDisplayStart,d=e._iDisplayEnd;e.oFeatures.bServerSide&&(h=0,d=e.aoData.length);for(var c=h;d>c;c++){var u=e.aoData[e.aiDisplay[c]];null===u.nTr&&_fnCreateTr(e,e.aiDisplay[c]);var p=u.nTr;if(0!==r){var f=e.asStripeClasses[a%r];u._sRowStripe!=f&&($(p).removeClass(u._sRowStripe).addClass(f),u._sRowStripe=f)}if(_fnCallbackFire(e,"aoRowCallback",null,[p,e.aoData[e.aiDisplay[c]]._aData,a,c]),o.push(p),a++,0!==l)for(var g=0;l>g;g++)if(p==e.aoOpenRows[g].nParent){o.push(e.aoOpenRows[g].nTr);break}}}else{o[0]=document.createElement("tr"),e.asStripeClasses[0]&&(o[0].className=e.asStripeClasses[0]);var m=e.oLanguage,v=m.sZeroRecords;1!=e.iDraw||null===e.sAjaxSource||e.oFeatures.bServerSide?m.sEmptyTable&&0===e.fnRecordsTotal()&&(v=m.sEmptyTable):v=m.sLoadingRecords;var b=document.createElement("td");b.setAttribute("valign","top"),b.colSpan=_fnVisbleColumns(e),b.className=e.oClasses.sRowEmpty,b.innerHTML=_fnInfoMacros(e,v),o[a].appendChild(b)}_fnCallbackFire(e,"aoHeaderCallback","header",[$(e.nTHead).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]),_fnCallbackFire(e,"aoFooterCallback","footer",[$(e.nTFoot).children("tr")[0],_fnGetDataMaster(e),e._iDisplayStart,e.fnDisplayEnd(),e.aiDisplay]);var y,w=document.createDocumentFragment(),_=document.createDocumentFragment();if(e.nTBody){if(y=e.nTBody.parentNode,_.appendChild(e.nTBody),!e.oScroll.bInfinite||!e._bInitComplete||e.bSorted||e.bFiltered)for(;n=e.nTBody.firstChild;)e.nTBody.removeChild(n);for(i=0,s=o.length;s>i;i++)w.appendChild(o[i]);e.nTBody.appendChild(w),null!==y&&y.appendChild(e.nTBody)}_fnCallbackFire(e,"aoDrawCallback","draw",[e]),e.bSorted=!1,e.bFiltered=!1,e.bDrawing=!1,e.oFeatures.bServerSide&&(_fnProcessingDisplay(e,!1),e._bInitComplete||_fnInitComplete(e))}function _fnReDraw(e){e.oFeatures.bSort?_fnSort(e,e.oPreviousSearch):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(_fnCalculateEnd(e),_fnDraw(e))}function _fnAddOptionsHtml(e){var t=$("<div></div>")[0];e.nTable.parentNode.insertBefore(t,e.nTable),e.nTableWrapper=$('<div id="'+e.sTableId+'_wrapper" class="'+e.oClasses.sWrapper+'" role="grid"></div>')[0],e.nTableReinsertBefore=e.nTable.nextSibling;for(var i,s,n,o,a,r,l,h=e.nTableWrapper,d=e.sDom.split(""),c=0;c<d.length;c++){if(s=0,n=d[c],"<"==n){if(o=$("<div></div>")[0],a=d[c+1],"'"==a||'"'==a){for(r="",l=2;d[c+l]!=a;)r+=d[c+l],l++;if("H"==r?r=e.oClasses.sJUIHeader:"F"==r&&(r=e.oClasses.sJUIFooter),-1!=r.indexOf(".")){var u=r.split(".");o.id=u[0].substr(1,u[0].length-1),o.className=u[1]}else"#"==r.charAt(0)?o.id=r.substr(1,r.length-1):o.className=r;c+=l}h.appendChild(o),h=o}else if(">"==n)h=h.parentNode;else if("l"==n&&e.oFeatures.bPaginate&&e.oFeatures.bLengthChange)i=_fnFeatureHtmlLength(e),s=1;else if("f"==n&&e.oFeatures.bFilter)i=_fnFeatureHtmlFilter(e),s=1;else if("r"==n&&e.oFeatures.bProcessing)i=_fnFeatureHtmlProcessing(e),s=1;else if("t"==n)i=_fnFeatureHtmlTable(e),s=1;else if("i"==n&&e.oFeatures.bInfo)i=_fnFeatureHtmlInfo(e),s=1;else if("p"==n&&e.oFeatures.bPaginate)i=_fnFeatureHtmlPaginate(e),s=1;else if(0!==DataTable.ext.aoFeatures.length)for(var p=DataTable.ext.aoFeatures,f=0,g=p.length;g>f;f++)if(n==p[f].cFeature){i=p[f].fnInit(e),i&&(s=1);break}1==s&&null!==i&&("object"!=typeof e.aanFeatures[n]&&(e.aanFeatures[n]=[]),e.aanFeatures[n].push(i),h.appendChild(i))}t.parentNode.replaceChild(e.nTableWrapper,t)}function _fnDetectHeader(e,t){var i,s,n,o,a,r,l,h,d,c,u,p=$(t).children("tr"),f=function(e,t,i){for(var s=e[t];s[i];)i++;return i};for(e.splice(0,e.length),n=0,r=p.length;r>n;n++)e.push([]);for(n=0,r=p.length;r>n;n++)for(i=p[n],h=0,s=i.firstChild;s;){if("TD"==s.nodeName.toUpperCase()||"TH"==s.nodeName.toUpperCase())for(d=1*s.getAttribute("colspan"),c=1*s.getAttribute("rowspan"),d=d&&0!==d&&1!==d?d:1,c=c&&0!==c&&1!==c?c:1,l=f(e,n,h),u=1===d?!0:!1,a=0;d>a;a++)for(o=0;c>o;o++)e[n+o][l+a]={cell:s,unique:u},e[n+o].nTr=i;s=s.nextSibling}}function _fnGetUniqueThs(e,t,i){var s=[];i||(i=e.aoHeader,t&&(i=[],_fnDetectHeader(i,t)));for(var n=0,o=i.length;o>n;n++)for(var a=0,r=i[n].length;r>a;a++)!i[n][a].unique||s[a]&&e.bSortCellsTop||(s[a]=i[n][a].cell);return s}function _fnAjaxUpdate(e){if(e.bAjaxDataGet){e.iDraw++,_fnProcessingDisplay(e,!0);var t=(e.aoColumns.length,_fnAjaxParameters(e));return _fnServerParams(e,t),e.fnServerData.call(e.oInstance,e.sAjaxSource,t,function(t){_fnAjaxUpdateDraw(e,t)},e),!1}return!0}function _fnAjaxParameters(e){var t,i,s,n,o,a=e.aoColumns.length,r=[];for(r.push({name:"sEcho",value:e.iDraw}),r.push({name:"iColumns",value:a}),r.push({name:"sColumns",value:_fnColumnOrdering(e)}),r.push({name:"iDisplayStart",value:e._iDisplayStart}),r.push({name:"iDisplayLength",value:e.oFeatures.bPaginate!==!1?e._iDisplayLength:-1}),n=0;a>n;n++)t=e.aoColumns[n].mData,r.push({name:"mDataProp_"+n,value:"function"==typeof t?"function":t});if(e.oFeatures.bFilter!==!1)for(r.push({name:"sSearch",value:e.oPreviousSearch.sSearch}),r.push({name:"bRegex",value:e.oPreviousSearch.bRegex}),n=0;a>n;n++)r.push({name:"sSearch_"+n,value:e.aoPreSearchCols[n].sSearch}),r.push({name:"bRegex_"+n,value:e.aoPreSearchCols[n].bRegex}),r.push({name:"bSearchable_"+n,value:e.aoColumns[n].bSearchable});if(e.oFeatures.bSort!==!1){var l=0;for(i=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),n=0;n<i.length;n++)for(s=e.aoColumns[i[n][0]].aDataSort,o=0;o<s.length;o++)r.push({name:"iSortCol_"+l,value:s[o]}),r.push({name:"sSortDir_"+l,value:i[n][1]}),l++;for(r.push({name:"iSortingCols",value:l}),n=0;a>n;n++)r.push({name:"bSortable_"+n,value:e.aoColumns[n].bSortable})}return r}function _fnServerParams(e,t){_fnCallbackFire(e,"aoServerParams","serverParams",[t])}function _fnAjaxUpdateDraw(e,t){if(t.sEcho!==undefined){if(1*t.sEcho<e.iDraw)return;e.iDraw=1*t.sEcho}(!e.oScroll.bInfinite||e.oScroll.bInfinite&&(e.bSorted||e.bFiltered))&&_fnClearTable(e),e._iRecordsTotal=parseInt(t.iTotalRecords,10),e._iRecordsDisplay=parseInt(t.iTotalDisplayRecords,10);var i,s=_fnColumnOrdering(e),n=t.sColumns!==undefined&&""!==s&&t.sColumns!=s;n&&(i=_fnReOrderIndex(e,t.sColumns));for(var o=_fnGetObjectDataFn(e.sAjaxDataProp)(t),a=0,r=o.length;r>a;a++)if(n){for(var l=[],h=0,d=e.aoColumns.length;d>h;h++)l.push(o[a][i[h]]);_fnAddData(e,l)}else _fnAddData(e,o[a]);e.aiDisplay=e.aiDisplayMaster.slice(),e.bAjaxDataGet=!1,_fnDraw(e),e.bAjaxDataGet=!0,_fnProcessingDisplay(e,!1)}function _fnFeatureHtmlFilter(e){var t=e.oPreviousSearch,i=e.oLanguage.sSearch;i=-1!==i.indexOf("_INPUT_")?i.replace("_INPUT_",'<input type="text" />'):""===i?'<input type="text" />':i+' <input type="text" />';var s=document.createElement("div");s.className=e.oClasses.sFilter,s.innerHTML="<label>"+i+"</label>",e.aanFeatures.f||(s.id=e.sTableId+"_filter");var n=$('input[type="text"]',s);return s._DT_Input=n[0],n.val(t.sSearch.replace('"',"&quot;")),n.bind("keyup.DT",function(i){for(var s=e.aanFeatures.f,n=""===this.value?"":this.value,o=0,a=s.length;a>o;o++)s[o]!=$(this).parents("div.dataTables_filter")[0]&&$(s[o]._DT_Input).val(n);n!=t.sSearch&&_fnFilterComplete(e,{sSearch:n,bRegex:t.bRegex,bSmart:t.bSmart,bCaseInsensitive:t.bCaseInsensitive})}),n.attr("aria-controls",e.sTableId).bind("keypress.DT",function(e){return 13==e.keyCode?!1:void 0}),s}function _fnFilterComplete(e,t,i){var s=e.oPreviousSearch,n=e.aoPreSearchCols,o=function(e){s.sSearch=e.sSearch,s.bRegex=e.bRegex,s.bSmart=e.bSmart,s.bCaseInsensitive=e.bCaseInsensitive};if(e.oFeatures.bServerSide)o(t);else{_fnFilter(e,t.sSearch,i,t.bRegex,t.bSmart,t.bCaseInsensitive),o(t);for(var a=0;a<e.aoPreSearchCols.length;a++)_fnFilterColumn(e,n[a].sSearch,a,n[a].bRegex,n[a].bSmart,n[a].bCaseInsensitive);_fnFilterCustom(e)}e.bFiltered=!0,$(e.oInstance).trigger("filter",e),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e),_fnBuildSearchArray(e,0)}function _fnFilterCustom(e){for(var t=DataTable.ext.afnFiltering,i=_fnGetColumns(e,"bSearchable"),s=0,n=t.length;n>s;s++)for(var o=0,a=0,r=e.aiDisplay.length;r>a;a++){var l=e.aiDisplay[a-o],h=t[s](e,_fnGetRowData(e,l,"filter",i),l);h||(e.aiDisplay.splice(a-o,1),o++)}}function _fnFilterColumn(e,t,i,s,n,o){if(""!==t)for(var a=0,r=_fnFilterCreateSearch(t,s,n,o),l=e.aiDisplay.length-1;l>=0;l--){var h=_fnDataToSearch(_fnGetCellData(e,e.aiDisplay[l],i,"filter"),e.aoColumns[i].sType);r.test(h)||(e.aiDisplay.splice(l,1),a++)}}function _fnFilter(e,t,i,s,n,o){var a,r=_fnFilterCreateSearch(t,s,n,o),l=e.oPreviousSearch;if(i||(i=0),0!==DataTable.ext.afnFiltering.length&&(i=1),t.length<=0)e.aiDisplay.splice(0,e.aiDisplay.length),e.aiDisplay=e.aiDisplayMaster.slice();else if(e.aiDisplay.length==e.aiDisplayMaster.length||l.sSearch.length>t.length||1==i||0!==t.indexOf(l.sSearch))for(e.aiDisplay.splice(0,e.aiDisplay.length),_fnBuildSearchArray(e,1),a=0;a<e.aiDisplayMaster.length;a++)r.test(e.asDataSearch[a])&&e.aiDisplay.push(e.aiDisplayMaster[a]);else{var h=0;for(a=0;a<e.asDataSearch.length;a++)r.test(e.asDataSearch[a])||(e.aiDisplay.splice(a-h,1),h++)}}function _fnBuildSearchArray(e,t){if(!e.oFeatures.bServerSide){e.asDataSearch=[];for(var i=_fnGetColumns(e,"bSearchable"),s=1===t?e.aiDisplayMaster:e.aiDisplay,n=0,o=s.length;o>n;n++)e.asDataSearch[n]=_fnBuildSearchRow(e,_fnGetRowData(e,s[n],"filter",i))}}function _fnBuildSearchRow(e,t){var i=t.join("  ");return-1!==i.indexOf("&")&&(i=$("<div>").html(i).text()),i.replace(/[\n\r]/g," ")}function _fnFilterCreateSearch(e,t,i,s){var n,o;return i?(n=t?e.split(" "):_fnEscapeRegex(e).split(" "),o="^(?=.*?"+n.join(")(?=.*?")+").*$",new RegExp(o,s?"i":"")):(e=t?e:_fnEscapeRegex(e),new RegExp(e,s?"i":""))}function _fnDataToSearch(e,t){return"function"==typeof DataTable.ext.ofnSearch[t]?DataTable.ext.ofnSearch[t](e):null===e?"":"html"==t?e.replace(/[\r\n]/g," ").replace(/<.*?>/g,""):"string"==typeof e?e.replace(/[\r\n]/g," "):e}function _fnEscapeRegex(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\","$","^","-"],i=new RegExp("(\\"+t.join("|\\")+")","g");return e.replace(i,"\\$1")}function _fnFeatureHtmlInfo(e){var t=document.createElement("div");return t.className=e.oClasses.sInfo,e.aanFeatures.i||(e.aoDrawCallback.push({fn:_fnUpdateInfo,sName:"information"}),t.id=e.sTableId+"_info"),e.nTable.setAttribute("aria-describedby",e.sTableId+"_info"),t}function _fnUpdateInfo(e){if(e.oFeatures.bInfo&&0!==e.aanFeatures.i.length){var t,i=e.oLanguage,s=e._iDisplayStart+1,n=e.fnDisplayEnd(),o=e.fnRecordsTotal(),a=e.fnRecordsDisplay();t=0===a?i.sInfoEmpty:i.sInfo,a!=o&&(t+=" "+i.sInfoFiltered),t+=i.sInfoPostFix,t=_fnInfoMacros(e,t),null!==i.fnInfoCallback&&(t=i.fnInfoCallback.call(e.oInstance,e,s,n,o,a,t));for(var r=e.aanFeatures.i,l=0,h=r.length;h>l;l++)$(r[l]).html(t)}}function _fnInfoMacros(e,t){var i=e._iDisplayStart+1,s=e.fnFormatNumber(i),n=e.fnDisplayEnd(),o=e.fnFormatNumber(n),a=e.fnRecordsDisplay(),r=e.fnFormatNumber(a),l=e.fnRecordsTotal(),h=e.fnFormatNumber(l);return e.oScroll.bInfinite&&(s=e.fnFormatNumber(1)),t.replace(/_START_/g,s).replace(/_END_/g,o).replace(/_TOTAL_/g,r).replace(/_MAX_/g,h)}function _fnInitialise(e){var t,i,s=e.iInitDisplayStart;if(e.bInitialised===!1)return void setTimeout(function(){_fnInitialise(e)},200);for(_fnAddOptionsHtml(e),_fnBuildHead(e),_fnDrawHead(e,e.aoHeader),e.nTFoot&&_fnDrawHead(e,e.aoFooter),_fnProcessingDisplay(e,!0),e.oFeatures.bAutoWidth&&_fnCalculateColumnWidths(e),t=0,i=e.aoColumns.length;i>t;t++)null!==e.aoColumns[t].sWidth&&(e.aoColumns[t].nTh.style.width=_fnStringToCss(e.aoColumns[t].sWidth));if(e.oFeatures.bSort?_fnSort(e):e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e)),null!==e.sAjaxSource&&!e.oFeatures.bServerSide){var n=[];return _fnServerParams(e,n),void e.fnServerData.call(e.oInstance,e.sAjaxSource,n,function(i){var n=""!==e.sAjaxDataProp?_fnGetObjectDataFn(e.sAjaxDataProp)(i):i;for(t=0;t<n.length;t++)_fnAddData(e,n[t]);e.iInitDisplayStart=s,e.oFeatures.bSort?_fnSort(e):(e.aiDisplay=e.aiDisplayMaster.slice(),_fnCalculateEnd(e),_fnDraw(e)),_fnProcessingDisplay(e,!1),_fnInitComplete(e,i)},e)}e.oFeatures.bServerSide||(_fnProcessingDisplay(e,!1),_fnInitComplete(e))}function _fnInitComplete(e,t){e._bInitComplete=!0,_fnCallbackFire(e,"aoInitComplete","init",[e,t])}function _fnLanguageCompat(e){var t=DataTable.defaults.oLanguage;!e.sEmptyTable&&e.sZeroRecords&&"No data available in table"===t.sEmptyTable&&_fnMap(e,e,"sZeroRecords","sEmptyTable"),!e.sLoadingRecords&&e.sZeroRecords&&"Loading..."===t.sLoadingRecords&&_fnMap(e,e,"sZeroRecords","sLoadingRecords")}function _fnFeatureHtmlLength(e){if(e.oScroll.bInfinite)return null;var t,i,s='name="'+e.sTableId+'_length"',n='<select size="1" '+s+">",o=e.aLengthMenu;if(2==o.length&&"object"==typeof o[0]&&"object"==typeof o[1])for(t=0,i=o[0].length;i>t;t++)n+='<option value="'+o[0][t]+'">'+o[1][t]+"</option>";else for(t=0,i=o.length;i>t;t++)n+='<option value="'+o[t]+'">'+o[t]+"</option>";n+="</select>";var a=document.createElement("div");return e.aanFeatures.l||(a.id=e.sTableId+"_length"),a.className=e.oClasses.sLength,a.innerHTML="<label>"+e.oLanguage.sLengthMenu.replace("_MENU_",n)+"</label>",$('select option[value="'+e._iDisplayLength+'"]',a).attr("selected",!0),$("select",a).bind("change.DT",function(s){var n=$(this).val(),o=e.aanFeatures.l;for(t=0,i=o.length;i>t;t++)o[t]!=this.parentNode&&$("select",o[t]).val(n);e._iDisplayLength=parseInt(n,10),_fnCalculateEnd(e),e.fnDisplayEnd()==e.fnRecordsDisplay()&&(e._iDisplayStart=e.fnDisplayEnd()-e._iDisplayLength,e._iDisplayStart<0&&(e._iDisplayStart=0)),-1==e._iDisplayLength&&(e._iDisplayStart=0),_fnDraw(e)}),$("select",a).attr("aria-controls",e.sTableId),a}function _fnCalculateEnd(e){e.oFeatures.bPaginate===!1?e._iDisplayEnd=e.aiDisplay.length:e._iDisplayStart+e._iDisplayLength>e.aiDisplay.length||-1==e._iDisplayLength?e._iDisplayEnd=e.aiDisplay.length:e._iDisplayEnd=e._iDisplayStart+e._iDisplayLength}function _fnFeatureHtmlPaginate(e){if(e.oScroll.bInfinite)return null;var t=document.createElement("div");return t.className=e.oClasses.sPaging+e.sPaginationType,DataTable.ext.oPagination[e.sPaginationType].fnInit(e,t,function(e){_fnCalculateEnd(e),_fnDraw(e)}),e.aanFeatures.p||e.aoDrawCallback.push({fn:function(e){DataTable.ext.oPagination[e.sPaginationType].fnUpdate(e,function(e){_fnCalculateEnd(e),_fnDraw(e)})},sName:"pagination"}),t}function _fnPageChange(e,t){var i=e._iDisplayStart;if("number"==typeof t)e._iDisplayStart=t*e._iDisplayLength,e._iDisplayStart>e.fnRecordsDisplay()&&(e._iDisplayStart=0);else if("first"==t)e._iDisplayStart=0;else if("previous"==t)e._iDisplayStart=e._iDisplayLength>=0?e._iDisplayStart-e._iDisplayLength:0,e._iDisplayStart<0&&(e._iDisplayStart=0);else if("next"==t)e._iDisplayLength>=0?e._iDisplayStart+e._iDisplayLength<e.fnRecordsDisplay()&&(e._iDisplayStart+=e._iDisplayLength):e._iDisplayStart=0;else if("last"==t)if(e._iDisplayLength>=0){var s=parseInt((e.fnRecordsDisplay()-1)/e._iDisplayLength,10)+1;e._iDisplayStart=(s-1)*e._iDisplayLength}else e._iDisplayStart=0;else _fnLog(e,0,"Unknown paging action: "+t);return $(e.oInstance).trigger("page",e),i!=e._iDisplayStart}function _fnFeatureHtmlProcessing(e){var t=document.createElement("div");return e.aanFeatures.r||(t.id=e.sTableId+"_processing"),t.innerHTML=e.oLanguage.sProcessing,t.className=e.oClasses.sProcessing,e.nTable.parentNode.insertBefore(t,e.nTable),t}function _fnProcessingDisplay(e,t){if(e.oFeatures.bProcessing)for(var i=e.aanFeatures.r,s=0,n=i.length;n>s;s++)i[s].style.visibility=t?"visible":"hidden";$(e.oInstance).trigger("processing",[e,t])}function _fnFeatureHtmlTable(e){if(""===e.oScroll.sX&&""===e.oScroll.sY)return e.nTable;var t=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),r=e.nTable.cloneNode(!1),l=e.nTable.cloneNode(!1),h=e.nTable.getElementsByTagName("thead")[0],d=0===e.nTable.getElementsByTagName("tfoot").length?null:e.nTable.getElementsByTagName("tfoot")[0],c=e.oClasses;i.appendChild(s),o.appendChild(a),n.appendChild(e.nTable),t.appendChild(i),t.appendChild(n),s.appendChild(r),r.appendChild(h),null!==d&&(t.appendChild(o),a.appendChild(l),l.appendChild(d)),t.className=c.sScrollWrapper,i.className=c.sScrollHead,s.className=c.sScrollHeadInner,n.className=c.sScrollBody,o.className=c.sScrollFoot,a.className=c.sScrollFootInner,e.oScroll.bAutoCss&&(i.style.overflow="hidden",i.style.position="relative",o.style.overflow="hidden",n.style.overflow="auto"),i.style.border="0",i.style.width="100%",o.style.border="0",s.style.width=""!==e.oScroll.sXInner?e.oScroll.sXInner:"100%",r.removeAttribute("id"),r.style.marginLeft="0",e.nTable.style.marginLeft="0",null!==d&&(l.removeAttribute("id"),l.style.marginLeft="0");var u=$(e.nTable).children("caption");return u.length>0&&(u=u[0],"top"===u._captionSide?r.appendChild(u):"bottom"===u._captionSide&&d&&l.appendChild(u)),""!==e.oScroll.sX&&(i.style.width=_fnStringToCss(e.oScroll.sX),n.style.width=_fnStringToCss(e.oScroll.sX),null!==d&&(o.style.width=_fnStringToCss(e.oScroll.sX)),$(n).scroll(function(e){i.scrollLeft=this.scrollLeft,null!==d&&(o.scrollLeft=this.scrollLeft)})),""!==e.oScroll.sY&&(n.style.height=_fnStringToCss(e.oScroll.sY)),e.aoDrawCallback.push({fn:_fnScrollDraw,sName:"scrolling"}),e.oScroll.bInfinite&&$(n).scroll(function(){e.bDrawing||0===$(this).scrollTop()||$(this).scrollTop()+$(this).height()>$(e.nTable).height()-e.oScroll.iLoadGap&&e.fnDisplayEnd()<e.fnRecordsDisplay()&&(_fnPageChange(e,"next"),_fnCalculateEnd(e),_fnDraw(e))}),e.nScrollHead=i,e.nScrollFoot=o,t}function _fnScrollDraw(e){var t,i,s,n,o,a,r,l,h,d,c,u=e.nScrollHead.getElementsByTagName("div")[0],p=u.getElementsByTagName("table")[0],f=e.nTable.parentNode,g=[],m=[],v=null!==e.nTFoot?e.nScrollFoot.getElementsByTagName("div")[0]:null,b=null!==e.nTFoot?v.getElementsByTagName("table")[0]:null,y=e.oBrowser.bScrollOversize,w=function(e){r=e.style,r.paddingTop="0",r.paddingBottom="0",r.borderTopWidth="0",r.borderBottomWidth="0",r.height=0};$(e.nTable).children("thead, tfoot").remove(),h=$(e.nTHead).clone()[0],e.nTable.insertBefore(h,e.nTable.childNodes[0]),s=e.nTHead.getElementsByTagName("tr"),n=h.getElementsByTagName("tr"),null!==e.nTFoot&&(d=$(e.nTFoot).clone()[0],
e.nTable.insertBefore(d,e.nTable.childNodes[1]),a=e.nTFoot.getElementsByTagName("tr"),o=d.getElementsByTagName("tr")),""===e.oScroll.sX&&(f.style.width="100%",u.parentNode.style.width="100%");var _=_fnGetUniqueThs(e,h);for(t=0,i=_.length;i>t;t++)l=_fnVisibleToColumnIndex(e,t),_[t].style.width=e.aoColumns[l].sWidth;if(null!==e.nTFoot&&_fnApplyToChildren(function(e){e.style.width=""},o),e.oScroll.bCollapse&&""!==e.oScroll.sY&&(f.style.height=f.offsetHeight+e.nTHead.offsetHeight+"px"),c=$(e.nTable).outerWidth(),""===e.oScroll.sX?(e.nTable.style.width="100%",y&&($("tbody",f).height()>f.offsetHeight||"scroll"==$(f).css("overflow-y"))&&(e.nTable.style.width=_fnStringToCss($(e.nTable).outerWidth()-e.oScroll.iBarWidth))):""!==e.oScroll.sXInner?e.nTable.style.width=_fnStringToCss(e.oScroll.sXInner):c==$(f).width()&&$(f).height()<$(e.nTable).height()?(e.nTable.style.width=_fnStringToCss(c-e.oScroll.iBarWidth),$(e.nTable).outerWidth()>c-e.oScroll.iBarWidth&&(e.nTable.style.width=_fnStringToCss(c))):e.nTable.style.width=_fnStringToCss(c),c=$(e.nTable).outerWidth(),_fnApplyToChildren(w,n),_fnApplyToChildren(function(e){g.push(_fnStringToCss($(e).width()))},n),_fnApplyToChildren(function(e,t){e.style.width=g[t]},s),$(n).height(0),null!==e.nTFoot&&(_fnApplyToChildren(w,o),_fnApplyToChildren(function(e){m.push(_fnStringToCss($(e).width()))},o),_fnApplyToChildren(function(e,t){e.style.width=m[t]},a),$(o).height(0)),_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=g[t]},n),null!==e.nTFoot&&_fnApplyToChildren(function(e,t){e.innerHTML="",e.style.width=m[t]},o),$(e.nTable).outerWidth()<c){var C=f.scrollHeight>f.offsetHeight||"scroll"==$(f).css("overflow-y")?c+e.oScroll.iBarWidth:c;y&&(f.scrollHeight>f.offsetHeight||"scroll"==$(f).css("overflow-y"))&&(e.nTable.style.width=_fnStringToCss(C-e.oScroll.iBarWidth)),f.style.width=_fnStringToCss(C),e.nScrollHead.style.width=_fnStringToCss(C),null!==e.nTFoot&&(e.nScrollFoot.style.width=_fnStringToCss(C)),""===e.oScroll.sX?_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width."):""!==e.oScroll.sXInner&&_fnLog(e,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")}else f.style.width=_fnStringToCss("100%"),e.nScrollHead.style.width=_fnStringToCss("100%"),null!==e.nTFoot&&(e.nScrollFoot.style.width=_fnStringToCss("100%"));if(""===e.oScroll.sY&&y&&(f.style.height=_fnStringToCss(e.nTable.offsetHeight+e.oScroll.iBarWidth)),""!==e.oScroll.sY&&e.oScroll.bCollapse){f.style.height=_fnStringToCss(e.oScroll.sY);var S=""!==e.oScroll.sX&&e.nTable.offsetWidth>f.offsetWidth?e.oScroll.iBarWidth:0;e.nTable.offsetHeight<f.offsetHeight&&(f.style.height=_fnStringToCss(e.nTable.offsetHeight+S))}var x=$(e.nTable).outerWidth();p.style.width=_fnStringToCss(x),u.style.width=_fnStringToCss(x);var k=$(e.nTable).height()>f.clientHeight||"scroll"==$(f).css("overflow-y");u.style.paddingRight=k?e.oScroll.iBarWidth+"px":"0px",null!==e.nTFoot&&(b.style.width=_fnStringToCss(x),v.style.width=_fnStringToCss(x),v.style.paddingRight=k?e.oScroll.iBarWidth+"px":"0px"),$(f).scroll(),(e.bSorted||e.bFiltered)&&(f.scrollTop=0)}function _fnApplyToChildren(e,t,i){for(var s,n,o=0,a=0,r=t.length;r>a;){for(s=t[a].firstChild,n=i?i[a].firstChild:null;s;)1===s.nodeType&&(i?e(s,n,o):e(s,o),o++),s=s.nextSibling,n=i?n.nextSibling:null;a++}}function _fnConvertToWidth(e,t){if(!e||null===e||""===e)return 0;t||(t=document.body);var i,s=document.createElement("div");return s.style.width=_fnStringToCss(e),t.appendChild(s),i=s.offsetWidth,t.removeChild(s),i}function _fnCalculateColumnWidths(e){var t,i,s,n,o=(e.nTable.offsetWidth,0),a=0,r=e.aoColumns.length,l=$("th",e.nTHead),h=e.nTable.getAttribute("width"),d=e.nTable.parentNode;for(i=0;r>i;i++)e.aoColumns[i].bVisible&&(a++,null!==e.aoColumns[i].sWidth&&(t=_fnConvertToWidth(e.aoColumns[i].sWidthOrig,d),null!==t&&(e.aoColumns[i].sWidth=_fnStringToCss(t)),o++));if(r==l.length&&0===o&&a==r&&""===e.oScroll.sX&&""===e.oScroll.sY)for(i=0;i<e.aoColumns.length;i++)t=$(l[i]).width(),null!==t&&(e.aoColumns[i].sWidth=_fnStringToCss(t));else{var c=e.nTable.cloneNode(!1),u=e.nTHead.cloneNode(!0),p=document.createElement("tbody"),f=document.createElement("tr");c.removeAttribute("id"),c.appendChild(u),null!==e.nTFoot&&(c.appendChild(e.nTFoot.cloneNode(!0)),_fnApplyToChildren(function(e){e.style.width=""},c.getElementsByTagName("tr"))),c.appendChild(p),p.appendChild(f);var g=$("thead th",c);0===g.length&&(g=$("tbody tr:eq(0)>td",c));var m=_fnGetUniqueThs(e,u);for(s=0,i=0;r>i;i++){var v=e.aoColumns[i];v.bVisible&&null!==v.sWidthOrig&&""!==v.sWidthOrig?m[i-s].style.width=_fnStringToCss(v.sWidthOrig):v.bVisible?m[i-s].style.width="":s++}for(i=0;r>i;i++)if(e.aoColumns[i].bVisible){var b=_fnGetWidestNode(e,i);null!==b&&(b=b.cloneNode(!0),""!==e.aoColumns[i].sContentPadding&&(b.innerHTML+=e.aoColumns[i].sContentPadding),f.appendChild(b))}d.appendChild(c),""!==e.oScroll.sX&&""!==e.oScroll.sXInner?c.style.width=_fnStringToCss(e.oScroll.sXInner):""!==e.oScroll.sX?(c.style.width="",$(c).width()<d.offsetWidth&&(c.style.width=_fnStringToCss(d.offsetWidth))):""!==e.oScroll.sY?c.style.width=_fnStringToCss(d.offsetWidth):h&&(c.style.width=_fnStringToCss(h)),c.style.visibility="hidden",_fnScrollingWidthAdjust(e,c);var y=$("tbody tr:eq(0)",c).children();if(0===y.length&&(y=_fnGetUniqueThs(e,$("thead",c)[0])),""!==e.oScroll.sX){var w=0;for(s=0,i=0;i<e.aoColumns.length;i++)e.aoColumns[i].bVisible&&(w+=null===e.aoColumns[i].sWidthOrig?$(y[s]).outerWidth():parseInt(e.aoColumns[i].sWidth.replace("px",""),10)+($(y[s]).outerWidth()-$(y[s]).width()),s++);c.style.width=_fnStringToCss(w),e.nTable.style.width=_fnStringToCss(w)}for(s=0,i=0;i<e.aoColumns.length;i++)e.aoColumns[i].bVisible&&(n=$(y[s]).width(),null!==n&&n>0&&(e.aoColumns[i].sWidth=_fnStringToCss(n)),s++);var _=$(c).css("width");e.nTable.style.width=-1!==_.indexOf("%")?_:_fnStringToCss($(c).outerWidth()),c.parentNode.removeChild(c)}h&&(e.nTable.style.width=_fnStringToCss(h))}function _fnScrollingWidthAdjust(e,t){if(""===e.oScroll.sX&&""!==e.oScroll.sY){$(t).width();t.style.width=_fnStringToCss($(t).outerWidth()-e.oScroll.iBarWidth)}else""!==e.oScroll.sX&&(t.style.width=_fnStringToCss($(t).outerWidth()))}function _fnGetWidestNode(e,t){var i=_fnGetMaxLenString(e,t);if(0>i)return null;if(null===e.aoData[i].nTr){var s=document.createElement("td");return s.innerHTML=_fnGetCellData(e,i,t,""),s}return _fnGetTdNodes(e,i)[t]}function _fnGetMaxLenString(e,t){for(var i=-1,s=-1,n=0;n<e.aoData.length;n++){var o=_fnGetCellData(e,n,t,"display")+"";o=o.replace(/<.*?>/g,""),o.length>i&&(i=o.length,s=n)}return s}function _fnStringToCss(e){if(null===e)return"0px";if("number"==typeof e)return 0>e?"0px":e+"px";var t=e.charCodeAt(e.length-1);return 48>t||t>57?e:e+"px"}function _fnScrollBarWidth(){var e=document.createElement("p"),t=e.style;t.width="100%",t.height="200px",t.padding="0px";var i=document.createElement("div");t=i.style,t.position="absolute",t.top="0px",t.left="0px",t.visibility="hidden",t.width="200px",t.height="150px",t.padding="0px",t.overflow="hidden",i.appendChild(e),document.body.appendChild(i);var s=e.offsetWidth;i.style.overflow="scroll";var n=e.offsetWidth;return s==n&&(n=i.clientWidth),document.body.removeChild(i),s-n}function _fnSort(e,t){var i,s,n,o,a,r,l,h,d=[],c=[],u=DataTable.ext.oSort,p=e.aoData,f=e.aoColumns,g=e.oLanguage.oAria;if(!e.oFeatures.bServerSide&&(0!==e.aaSorting.length||null!==e.aaSortingFixed)){for(d=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),i=0;i<d.length;i++){var m=d[i][0],v=_fnColumnIndexToVisible(e,m);if(l=e.aoColumns[m].sSortDataType,DataTable.ext.afnSortData[l]){var b=DataTable.ext.afnSortData[l].call(e.oInstance,e,m,v);if(b.length===p.length)for(n=0,o=p.length;o>n;n++)_fnSetCellData(e,n,m,b[n]);else _fnLog(e,0,"Returned data sort array (col "+m+") is the wrong length")}}for(i=0,s=e.aiDisplayMaster.length;s>i;i++)c[e.aiDisplayMaster[i]]=i;var y,w,_=d.length;for(i=0,s=p.length;s>i;i++)for(n=0;_>n;n++)for(w=f[d[n][0]].aDataSort,a=0,r=w.length;r>a;a++)l=f[w[a]].sType,y=u[(l?l:"string")+"-pre"],p[i]._aSortData[w[a]]=y?y(_fnGetCellData(e,i,w[a],"sort")):_fnGetCellData(e,i,w[a],"sort");e.aiDisplayMaster.sort(function(e,t){var i,s,n,o,a,r;for(i=0;_>i;i++)for(a=f[d[i][0]].aDataSort,s=0,n=a.length;n>s;s++)if(r=f[a[s]].sType,o=u[(r?r:"string")+"-"+d[i][1]](p[e]._aSortData[a[s]],p[t]._aSortData[a[s]]),0!==o)return o;return u["numeric-asc"](c[e],c[t])})}for(t!==undefined&&!t||e.oFeatures.bDeferRender||_fnSortingClasses(e),i=0,s=e.aoColumns.length;s>i;i++){var C=f[i].sTitle.replace(/<.*?>/g,"");if(h=f[i].nTh,h.removeAttribute("aria-sort"),h.removeAttribute("aria-label"),f[i].bSortable)if(d.length>0&&d[0][0]==i){h.setAttribute("aria-sort","asc"==d[0][1]?"ascending":"descending");var S=f[i].asSorting[d[0][2]+1]?f[i].asSorting[d[0][2]+1]:f[i].asSorting[0];h.setAttribute("aria-label",C+("asc"==S?g.sSortAscending:g.sSortDescending))}else h.setAttribute("aria-label",C+("asc"==f[i].asSorting[0]?g.sSortAscending:g.sSortDescending));else h.setAttribute("aria-label",C)}e.bSorted=!0,$(e.oInstance).trigger("sort",e),e.oFeatures.bFilter?_fnFilterComplete(e,e.oPreviousSearch,1):(e.aiDisplay=e.aiDisplayMaster.slice(),e._iDisplayStart=0,_fnCalculateEnd(e),_fnDraw(e))}function _fnSortAttachListener(e,t,i,s){_fnBindAction(t,{},function(t){if(e.aoColumns[i].bSortable!==!1){var n=function(){var s,n;if(t.shiftKey){for(var o=!1,a=0;a<e.aaSorting.length;a++)if(e.aaSorting[a][0]==i){o=!0,s=e.aaSorting[a][0],n=e.aaSorting[a][2]+1,e.aoColumns[s].asSorting[n]?(e.aaSorting[a][1]=e.aoColumns[s].asSorting[n],e.aaSorting[a][2]=n):e.aaSorting.splice(a,1);break}o===!1&&e.aaSorting.push([i,e.aoColumns[i].asSorting[0],0])}else 1==e.aaSorting.length&&e.aaSorting[0][0]==i?(s=e.aaSorting[0][0],n=e.aaSorting[0][2]+1,e.aoColumns[s].asSorting[n]||(n=0),e.aaSorting[0][1]=e.aoColumns[s].asSorting[n],e.aaSorting[0][2]=n):(e.aaSorting.splice(0,e.aaSorting.length),e.aaSorting.push([i,e.aoColumns[i].asSorting[0],0]));_fnSort(e)};e.oFeatures.bProcessing?(_fnProcessingDisplay(e,!0),setTimeout(function(){n(),e.oFeatures.bServerSide||_fnProcessingDisplay(e,!1)},0)):n(),"function"==typeof s&&s(e)}})}function _fnSortingClasses(e){var t,i,s,n,o,a,r=e.aoColumns.length,l=e.oClasses;for(t=0;r>t;t++)e.aoColumns[t].bSortable&&$(e.aoColumns[t].nTh).removeClass(l.sSortAsc+" "+l.sSortDesc+" "+e.aoColumns[t].sSortingClass);for(o=null!==e.aaSortingFixed?e.aaSortingFixed.concat(e.aaSorting):e.aaSorting.slice(),t=0;t<e.aoColumns.length;t++)if(e.aoColumns[t].bSortable){for(a=e.aoColumns[t].sSortingClass,n=-1,s=0;s<o.length;s++)if(o[s][0]==t){a="asc"==o[s][1]?l.sSortAsc:l.sSortDesc,n=s;break}if($(e.aoColumns[t].nTh).addClass(a),e.bJUI){var h=$("span."+l.sSortIcon,e.aoColumns[t].nTh);h.removeClass(l.sSortJUIAsc+" "+l.sSortJUIDesc+" "+l.sSortJUI+" "+l.sSortJUIAscAllowed+" "+l.sSortJUIDescAllowed);var d;d=-1==n?e.aoColumns[t].sSortingClassJUI:"asc"==o[n][1]?l.sSortJUIAsc:l.sSortJUIDesc,h.addClass(d)}}else $(e.aoColumns[t].nTh).addClass(e.aoColumns[t].sSortingClass);if(a=l.sSortColumn,e.oFeatures.bSort&&e.oFeatures.bSortClasses){var c,u,p=_fnGetTdNodes(e),f=[];for(t=0;r>t;t++)f.push("");for(t=0,c=1;t<o.length;t++)u=parseInt(o[t][0],10),f[u]=a+c,3>c&&c++;var g,m,v,b=new RegExp(a+"[123]");for(t=0,i=p.length;i>t;t++)u=t%r,m=p[t].className,v=f[u],g=m.replace(b,v),g!=m?p[t].className=$.trim(g):v.length>0&&-1==m.indexOf(v)&&(p[t].className=m+" "+v)}}function _fnSaveState(e){if(e.oFeatures.bStateSave&&!e.bDestroying){var t,i,s=e.oScroll.bInfinite,n={iCreate:(new Date).getTime(),iStart:s?0:e._iDisplayStart,iEnd:s?e._iDisplayLength:e._iDisplayEnd,iLength:e._iDisplayLength,aaSorting:$.extend(!0,[],e.aaSorting),oSearch:$.extend(!0,{},e.oPreviousSearch),aoSearchCols:$.extend(!0,[],e.aoPreSearchCols),abVisCols:[]};for(t=0,i=e.aoColumns.length;i>t;t++)n.abVisCols.push(e.aoColumns[t].bVisible);_fnCallbackFire(e,"aoStateSaveParams","stateSaveParams",[e,n]),e.fnStateSave.call(e.oInstance,e,n)}}function _fnLoadState(e,t){if(e.oFeatures.bStateSave){var i=e.fnStateLoad.call(e.oInstance,e);if(i){var s=_fnCallbackFire(e,"aoStateLoadParams","stateLoadParams",[e,i]);if(-1===$.inArray(!1,s)){e.oLoadedState=$.extend(!0,{},i),e._iDisplayStart=i.iStart,e.iInitDisplayStart=i.iStart,e._iDisplayEnd=i.iEnd,e._iDisplayLength=i.iLength,e.aaSorting=i.aaSorting.slice(),e.saved_aaSorting=i.aaSorting.slice(),$.extend(e.oPreviousSearch,i.oSearch),$.extend(!0,e.aoPreSearchCols,i.aoSearchCols),t.saved_aoColumns=[];for(var n=0;n<i.abVisCols.length;n++)t.saved_aoColumns[n]={},t.saved_aoColumns[n].bVisible=i.abVisCols[n];_fnCallbackFire(e,"aoStateLoaded","stateLoaded",[e,i])}}}}function _fnCreateCookie(sName,sValue,iSecs,sBaseName,fnCallback){var date=new Date;date.setTime(date.getTime()+1e3*iSecs);var aParts=window.location.pathname.split("/"),sNameFile=sName+"_"+aParts.pop().replace(/[\/:]/g,"").toLowerCase(),sFullCookie,oData;null!==fnCallback?(oData="function"==typeof $.parseJSON?$.parseJSON(sValue):eval("("+sValue+")"),sFullCookie=fnCallback(sNameFile,oData,date.toGMTString(),aParts.join("/")+"/")):sFullCookie=sNameFile+"="+encodeURIComponent(sValue)+"; expires="+date.toGMTString()+"; path="+aParts.join("/")+"/";var aCookies=document.cookie.split(";"),iNewCookieLen=sFullCookie.split(";")[0].length,aOldCookies=[];if(iNewCookieLen+document.cookie.length+10>4096){for(var i=0,iLen=aCookies.length;iLen>i;i++)if(-1!=aCookies[i].indexOf(sBaseName)){var aSplitCookie=aCookies[i].split("=");try{oData=eval("("+decodeURIComponent(aSplitCookie[1])+")"),oData&&oData.iCreate&&aOldCookies.push({name:aSplitCookie[0],time:oData.iCreate})}catch(e){}}for(aOldCookies.sort(function(e,t){return t.time-e.time});iNewCookieLen+document.cookie.length+10>4096;){if(0===aOldCookies.length)return;var old=aOldCookies.pop();document.cookie=old.name+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+aParts.join("/")+"/"}}document.cookie=sFullCookie}function _fnReadCookie(e){for(var t=window.location.pathname.split("/"),i=e+"_"+t[t.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",s=document.cookie.split(";"),n=0;n<s.length;n++){for(var o=s[n];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(i))return decodeURIComponent(o.substring(i.length,o.length))}return null}function _fnSettingsFromNode(e){for(var t=0;t<DataTable.settings.length;t++)if(DataTable.settings[t].nTable===e)return DataTable.settings[t];return null}function _fnGetTrNodes(e){for(var t=[],i=e.aoData,s=0,n=i.length;n>s;s++)null!==i[s].nTr&&t.push(i[s].nTr);return t}function _fnGetTdNodes(e,t){var i,s,n,o,a,r,l,h,d=[],c=e.aoData.length,u=0,p=c;for(t!==undefined&&(u=t,p=t+1),o=u;p>o;o++)if(l=e.aoData[o],null!==l.nTr){for(s=[],n=l.nTr.firstChild;n;)h=n.nodeName.toLowerCase(),("td"==h||"th"==h)&&s.push(n),n=n.nextSibling;for(i=0,a=0,r=e.aoColumns.length;r>a;a++)e.aoColumns[a].bVisible?d.push(s[a-i]):(d.push(l._anHidden[a]),i++)}return d}function _fnLog(e,t,i){var s=null===e?"DataTables warning: "+i:"DataTables warning (table id = '"+e.sTableId+"'): "+i;if(0===t){if("alert"!=DataTable.ext.sErrMode)throw new Error(s);return void alert(s)}window.console&&console.log&&console.log(s)}function _fnMap(e,t,i,s){s===undefined&&(s=i),t[i]!==undefined&&(e[s]=t[i])}function _fnExtend(e,t){var i;for(var s in t)t.hasOwnProperty(s)&&(i=t[s],"object"==typeof oInit[s]&&null!==i&&$.isArray(i)===!1?$.extend(!0,e[s],i):e[s]=i);return e}function _fnBindAction(e,t,i){$(e).bind("click.DT",t,function(t){e.blur(),i(t)}).bind("keypress.DT",t,function(e){13===e.which&&i(e)}).bind("selectstart.DT",function(){return!1})}function _fnCallbackReg(e,t,i,s){i&&e[t].push({fn:i,sName:s})}function _fnCallbackFire(e,t,i,s){for(var n=e[t],o=[],a=n.length-1;a>=0;a--)o.push(n[a].fn.apply(e.oInstance,s));return null!==i&&$(e.oInstance).trigger(i,s),o}function _fnBrowserDetect(e){var t=$('<div style="position:absolute; top:0; left:0; height:1px; width:1px; overflow:hidden"><div style="position:absolute; top:1px; left:1px; width:100px; overflow:scroll;"><div id="DT_BrowserTest" style="width:100%; height:10px;"></div></div></div>')[0];document.body.appendChild(t),e.oBrowser.bScrollOversize=100===$("#DT_BrowserTest",t)[0].offsetWidth?!0:!1,document.body.removeChild(t)}function _fnExternApiFunc(e){return function(){var t=[_fnSettingsFromNode(this[DataTable.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));return DataTable.ext.oApi[e].apply(this,t)}}var __reArray=/\[.*?\]$/,_fnJsonString=window.JSON?JSON.stringify:function(e){var t=typeof e;if("object"!==t||null===e)return"string"===t&&(e='"'+e+'"'),e+"";var i,s,n=[],o=$.isArray(e);for(i in e)s=e[i],t=typeof s,"string"===t?s='"'+s+'"':"object"===t&&null!==s&&(s=_fnJsonString(s)),n.push((o?"":'"'+i+'":')+s);return(o?"[":"{")+n+(o?"]":"}")};this.$=function(e,t){var i,s,n,o=[],a=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),r=a.aoData,l=a.aiDisplay,h=a.aiDisplayMaster;if(t||(t={}),t=$.extend({},{filter:"none",order:"current",page:"all"},t),"current"==t.page)for(i=a._iDisplayStart,s=a.fnDisplayEnd();s>i;i++)n=r[l[i]].nTr,n&&o.push(n);else if("current"==t.order&&"none"==t.filter)for(i=0,s=h.length;s>i;i++)n=r[h[i]].nTr,n&&o.push(n);else if("current"==t.order&&"applied"==t.filter)for(i=0,s=l.length;s>i;i++)n=r[l[i]].nTr,n&&o.push(n);else if("original"==t.order&&"none"==t.filter)for(i=0,s=r.length;s>i;i++)n=r[i].nTr,n&&o.push(n);else if("original"==t.order&&"applied"==t.filter)for(i=0,s=r.length;s>i;i++)n=r[i].nTr,-1!==$.inArray(i,l)&&n&&o.push(n);else _fnLog(a,1,"Unknown selection options");var d=$(o),c=d.filter(e),u=d.find(e);return $([].concat($.makeArray(c),$.makeArray(u)))},this._=function(e,t){var i,s,n=[],o=this.$(e,t);for(i=0,s=o.length;s>i;i++)n.push(this.fnGetData(o[i]));return n},this.fnAddData=function(e,t){if(0===e.length)return[];var i,s=[],n=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if("object"==typeof e[0]&&null!==e[0])for(var o=0;o<e.length;o++){if(i=_fnAddData(n,e[o]),-1==i)return s;s.push(i)}else{if(i=_fnAddData(n,e),-1==i)return s;s.push(i)}return n.aiDisplay=n.aiDisplayMaster.slice(),(t===undefined||t)&&_fnReDraw(n),s},this.fnAdjustColumnSizing=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnAdjustColumnSizing(t),e===undefined||e?this.fnDraw(!1):(""!==t.oScroll.sX||""!==t.oScroll.sY)&&this.oApi._fnScrollDraw(t)},this.fnClearTable=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnClearTable(t),(e===undefined||e)&&_fnDraw(t)},this.fnClose=function(e){for(var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=0;i<t.aoOpenRows.length;i++)if(t.aoOpenRows[i].nParent==e){var s=t.aoOpenRows[i].nTr.parentNode;return s&&s.removeChild(t.aoOpenRows[i].nTr),t.aoOpenRows.splice(i,1),0}return 1},this.fnDeleteRow=function(e,t,i){var s,n,o,a=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);o="object"==typeof e?_fnNodeToDataIndex(a,e):e;var r=a.aoData.splice(o,1);for(s=0,n=a.aoData.length;n>s;s++)null!==a.aoData[s].nTr&&(a.aoData[s].nTr._DT_RowIndex=s);var l=$.inArray(o,a.aiDisplay);return a.asDataSearch.splice(l,1),_fnDeleteIndex(a.aiDisplayMaster,o),_fnDeleteIndex(a.aiDisplay,o),"function"==typeof t&&t.call(this,a,r),a._iDisplayStart>=a.fnRecordsDisplay()&&(a._iDisplayStart-=a._iDisplayLength,a._iDisplayStart<0&&(a._iDisplayStart=0)),(i===undefined||i)&&(_fnCalculateEnd(a),_fnDraw(a)),r},this.fnDestroy=function(e){var t,i,s=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),n=s.nTableWrapper.parentNode,o=s.nTBody;if(e=e===undefined?!1:e,s.bDestroying=!0,_fnCallbackFire(s,"aoDestroyCallback","destroy",[s]),!e)for(t=0,i=s.aoColumns.length;i>t;t++)s.aoColumns[t].bVisible===!1&&this.fnSetColumnVis(t,!0);for($(s.nTableWrapper).find("*").andSelf().unbind(".DT"),$("tbody>tr>td."+s.oClasses.sRowEmpty,s.nTable).parent().remove(),s.nTable!=s.nTHead.parentNode&&($(s.nTable).children("thead").remove(),s.nTable.appendChild(s.nTHead)),s.nTFoot&&s.nTable!=s.nTFoot.parentNode&&($(s.nTable).children("tfoot").remove(),s.nTable.appendChild(s.nTFoot)),s.nTable.parentNode.removeChild(s.nTable),$(s.nTableWrapper).remove(),s.aaSorting=[],s.aaSortingFixed=[],_fnSortingClasses(s),$(_fnGetTrNodes(s)).removeClass(s.asStripeClasses.join(" ")),$("th, td",s.nTHead).removeClass([s.oClasses.sSortable,s.oClasses.sSortableAsc,s.oClasses.sSortableDesc,s.oClasses.sSortableNone].join(" ")),s.bJUI&&($("th span."+s.oClasses.sSortIcon+", td span."+s.oClasses.sSortIcon,s.nTHead).remove(),$("th, td",s.nTHead).each(function(){var e=$("div."+s.oClasses.sSortJUIWrapper,this),t=e.contents();$(this).append(t),e.remove()})),!e&&s.nTableReinsertBefore?n.insertBefore(s.nTable,s.nTableReinsertBefore):e||n.appendChild(s.nTable),t=0,i=s.aoData.length;i>t;t++)null!==s.aoData[t].nTr&&o.appendChild(s.aoData[t].nTr);if(s.oFeatures.bAutoWidth===!0&&(s.nTable.style.width=_fnStringToCss(s.sDestroyWidth)),i=s.asDestroyStripes.length){var a=$(o).children("tr");for(t=0;i>t;t++)a.filter(":nth-child("+i+"n + "+t+")").addClass(s.asDestroyStripes[t])}for(t=0,i=DataTable.settings.length;i>t;t++)DataTable.settings[t]==s&&DataTable.settings.splice(t,1);s=null,oInit=null},this.fnDraw=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);e===!1?(_fnCalculateEnd(t),_fnDraw(t)):_fnReDraw(t)},this.fnFilter=function(e,t,i,s,n,o){var a=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(a.oFeatures.bFilter)if((i===undefined||null===i)&&(i=!1),(s===undefined||null===s)&&(s=!0),(n===undefined||null===n)&&(n=!0),(o===undefined||null===o)&&(o=!0),t===undefined||null===t){if(_fnFilterComplete(a,{sSearch:e+"",bRegex:i,bSmart:s,bCaseInsensitive:o},1),n&&a.aanFeatures.f)for(var r=a.aanFeatures.f,l=0,h=r.length;h>l;l++)try{r[l]._DT_Input!=document.activeElement&&$(r[l]._DT_Input).val(e)}catch(d){$(r[l]._DT_Input).val(e)}}else $.extend(a.aoPreSearchCols[t],{sSearch:e+"",bRegex:i,bSmart:s,bCaseInsensitive:o}),_fnFilterComplete(a,a.oPreviousSearch,1)},this.fnGetData=function(e,t){var i=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);if(e!==undefined){var s=e;if("object"==typeof e){var n=e.nodeName.toLowerCase();"tr"===n?s=_fnNodeToDataIndex(i,e):"td"===n&&(s=_fnNodeToDataIndex(i,e.parentNode),t=_fnNodeToColumnIndex(i,s,e))}return t!==undefined?_fnGetCellData(i,s,t,""):i.aoData[s]!==undefined?i.aoData[s]._aData:null}return _fnGetDataMaster(i)},this.fnGetNodes=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);return e!==undefined?t.aoData[e]!==undefined?t.aoData[e].nTr:null:_fnGetTrNodes(t)},this.fnGetPosition=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=e.nodeName.toUpperCase();if("TR"==i)return _fnNodeToDataIndex(t,e);if("TD"==i||"TH"==i){var s=_fnNodeToDataIndex(t,e.parentNode),n=_fnNodeToColumnIndex(t,s,e);return[s,_fnColumnIndexToVisible(t,n),n]}return null},this.fnIsOpen=function(e){for(var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),i=(t.aoOpenRows,0);i<t.aoOpenRows.length;i++)if(t.aoOpenRows[i].nParent==e)return!0;return!1},this.fnOpen=function(e,t,i){var s=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),n=_fnGetTrNodes(s);if(-1!==$.inArray(e,n)){this.fnClose(e);var o=document.createElement("tr"),a=document.createElement("td");o.appendChild(a),a.className=i,a.colSpan=_fnVisbleColumns(s),"string"==typeof t?a.innerHTML=t:$(a).html(t);var r=$("tr",s.nTBody);return-1!=$.inArray(e,r)&&$(o).insertAfter(e),s.aoOpenRows.push({nTr:o,nParent:e}),o}},this.fnPageChange=function(e,t){var i=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);_fnPageChange(i,e),_fnCalculateEnd(i),(t===undefined||t)&&_fnDraw(i)},this.fnSetColumnVis=function(e,t,i){var s,n,o,a,r,l=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),h=l.aoColumns,d=l.aoData;if(h[e].bVisible!=t){if(t){var c=0;for(s=0;e>s;s++)h[s].bVisible&&c++;if(a=c>=_fnVisbleColumns(l),!a)for(s=e;s<h.length;s++)if(h[s].bVisible){r=s;break}for(s=0,n=d.length;n>s;s++)null!==d[s].nTr&&(a?d[s].nTr.appendChild(d[s]._anHidden[e]):d[s].nTr.insertBefore(d[s]._anHidden[e],_fnGetTdNodes(l,s)[r]))}else for(s=0,n=d.length;n>s;s++)null!==d[s].nTr&&(o=_fnGetTdNodes(l,s)[e],d[s]._anHidden[e]=o,o.parentNode.removeChild(o));for(h[e].bVisible=t,_fnDrawHead(l,l.aoHeader),l.nTFoot&&_fnDrawHead(l,l.aoFooter),s=0,n=l.aoOpenRows.length;n>s;s++)l.aoOpenRows[s].nTr.colSpan=_fnVisbleColumns(l);(i===undefined||i)&&(_fnAdjustColumnSizing(l),_fnDraw(l)),_fnSaveState(l)}},this.fnSettings=function(){return _fnSettingsFromNode(this[DataTable.ext.iApiIndex])},this.fnSort=function(e){var t=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]);t.aaSorting=e,_fnSort(t)},this.fnSortListener=function(e,t,i){_fnSortAttachListener(_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),e,t,i)},this.fnUpdate=function(e,t,i,s,n){var o,a,r=_fnSettingsFromNode(this[DataTable.ext.iApiIndex]),l="object"==typeof t?_fnNodeToDataIndex(r,t):t;if($.isArray(e)&&i===undefined)for(r.aoData[l]._aData=e.slice(),o=0;o<r.aoColumns.length;o++)this.fnUpdate(_fnGetCellData(r,l,o),l,o,!1,!1);else if($.isPlainObject(e)&&i===undefined)for(r.aoData[l]._aData=$.extend(!0,{},e),o=0;o<r.aoColumns.length;o++)this.fnUpdate(_fnGetCellData(r,l,o),l,o,!1,!1);else{_fnSetCellData(r,l,i,e),a=_fnGetCellData(r,l,i,"display");var h=r.aoColumns[i];null!==h.fnRender&&(a=_fnRender(r,l,i),h.bUseRendered&&_fnSetCellData(r,l,i,a)),null!==r.aoData[l].nTr&&(_fnGetTdNodes(r,l)[i].innerHTML=a)}var d=$.inArray(l,r.aiDisplay);return r.asDataSearch[d]=_fnBuildSearchRow(r,_fnGetRowData(r,l,"filter",_fnGetColumns(r,"bSearchable"))),(n===undefined||n)&&_fnAdjustColumnSizing(r),(s===undefined||s)&&_fnReDraw(r),0},this.fnVersionCheck=DataTable.ext.fnVersionCheck,this.oApi={_fnExternApiFunc:_fnExternApiFunc,_fnInitialise:_fnInitialise,_fnInitComplete:_fnInitComplete,_fnLanguageCompat:_fnLanguageCompat,_fnAddColumn:_fnAddColumn,_fnColumnOptions:_fnColumnOptions,_fnAddData:_fnAddData,_fnCreateTr:_fnCreateTr,_fnGatherData:_fnGatherData,_fnBuildHead:_fnBuildHead,_fnDrawHead:_fnDrawHead,_fnDraw:_fnDraw,_fnReDraw:_fnReDraw,_fnAjaxUpdate:_fnAjaxUpdate,_fnAjaxParameters:_fnAjaxParameters,_fnAjaxUpdateDraw:_fnAjaxUpdateDraw,_fnServerParams:_fnServerParams,_fnAddOptionsHtml:_fnAddOptionsHtml,_fnFeatureHtmlTable:_fnFeatureHtmlTable,_fnScrollDraw:_fnScrollDraw,_fnAdjustColumnSizing:_fnAdjustColumnSizing,_fnFeatureHtmlFilter:_fnFeatureHtmlFilter,_fnFilterComplete:_fnFilterComplete,_fnFilterCustom:_fnFilterCustom,_fnFilterColumn:_fnFilterColumn,_fnFilter:_fnFilter,_fnBuildSearchArray:_fnBuildSearchArray,_fnBuildSearchRow:_fnBuildSearchRow,_fnFilterCreateSearch:_fnFilterCreateSearch,_fnDataToSearch:_fnDataToSearch,_fnSort:_fnSort,_fnSortAttachListener:_fnSortAttachListener,_fnSortingClasses:_fnSortingClasses,_fnFeatureHtmlPaginate:_fnFeatureHtmlPaginate,_fnPageChange:_fnPageChange,_fnFeatureHtmlInfo:_fnFeatureHtmlInfo,_fnUpdateInfo:_fnUpdateInfo,_fnFeatureHtmlLength:_fnFeatureHtmlLength,_fnFeatureHtmlProcessing:_fnFeatureHtmlProcessing,_fnProcessingDisplay:_fnProcessingDisplay,_fnVisibleToColumnIndex:_fnVisibleToColumnIndex,_fnColumnIndexToVisible:_fnColumnIndexToVisible,_fnNodeToDataIndex:_fnNodeToDataIndex,_fnVisbleColumns:_fnVisbleColumns,_fnCalculateEnd:_fnCalculateEnd,_fnConvertToWidth:_fnConvertToWidth,_fnCalculateColumnWidths:_fnCalculateColumnWidths,_fnScrollingWidthAdjust:_fnScrollingWidthAdjust,_fnGetWidestNode:_fnGetWidestNode,_fnGetMaxLenString:_fnGetMaxLenString,_fnStringToCss:_fnStringToCss,_fnDetectType:_fnDetectType,_fnSettingsFromNode:_fnSettingsFromNode,_fnGetDataMaster:_fnGetDataMaster,_fnGetTrNodes:_fnGetTrNodes,_fnGetTdNodes:_fnGetTdNodes,_fnEscapeRegex:_fnEscapeRegex,_fnDeleteIndex:_fnDeleteIndex,_fnReOrderIndex:_fnReOrderIndex,_fnColumnOrdering:_fnColumnOrdering,_fnLog:_fnLog,_fnClearTable:_fnClearTable,_fnSaveState:_fnSaveState,_fnLoadState:_fnLoadState,_fnCreateCookie:_fnCreateCookie,_fnReadCookie:_fnReadCookie,_fnDetectHeader:_fnDetectHeader,_fnGetUniqueThs:_fnGetUniqueThs,_fnScrollBarWidth:_fnScrollBarWidth,_fnApplyToChildren:_fnApplyToChildren,_fnMap:_fnMap,_fnGetRowData:_fnGetRowData,_fnGetCellData:_fnGetCellData,_fnSetCellData:_fnSetCellData,_fnGetObjectDataFn:_fnGetObjectDataFn,_fnSetObjectDataFn:_fnSetObjectDataFn,_fnApplyColumnDefs:_fnApplyColumnDefs,_fnBindAction:_fnBindAction,_fnExtend:_fnExtend,_fnCallbackReg:_fnCallbackReg,_fnCallbackFire:_fnCallbackFire,_fnJsonString:_fnJsonString,_fnRender:_fnRender,_fnNodeToColumnIndex:_fnNodeToColumnIndex,_fnInfoMacros:_fnInfoMacros,_fnBrowserDetect:_fnBrowserDetect,_fnGetColumns:_fnGetColumns},$.extend(DataTable.ext.oApi,this.oApi);for(var sFunc in DataTable.ext.oApi)sFunc&&(this[sFunc]=_fnExternApiFunc(sFunc));var _that=this;return this.each(function(){var e,t,i,s=0,n=this.getAttribute("id"),o=!1,a=!1;if("table"!=this.nodeName.toLowerCase())return void _fnLog(null,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName);for(s=0,e=DataTable.settings.length;e>s;s++){if(DataTable.settings[s].nTable==this){if(oInit===undefined||oInit.bRetrieve)return DataTable.settings[s].oInstance;if(oInit.bDestroy){DataTable.settings[s].oInstance.fnDestroy();break}return void _fnLog(DataTable.settings[s],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, pass no arguments or see the docs for bRetrieve and bDestroy")}if(DataTable.settings[s].sTableId==this.id){DataTable.settings.splice(s,1);break}}(null===n||""===n)&&(n="DataTables_Table_"+DataTable.ext._oExternConfig.iNextUnique++,this.id=n);var r=$.extend(!0,{},DataTable.models.oSettings,{nTable:this,oApi:_that.oApi,oInit:oInit,sDestroyWidth:$(this).width(),sInstance:n,sTableId:n});if(DataTable.settings.push(r),r.oInstance=1===_that.length?_that:$(this).dataTable(),oInit||(oInit={}),oInit.oLanguage&&_fnLanguageCompat(oInit.oLanguage),oInit=_fnExtend($.extend(!0,{},DataTable.defaults),oInit),_fnMap(r.oFeatures,oInit,"bPaginate"),_fnMap(r.oFeatures,oInit,"bLengthChange"),_fnMap(r.oFeatures,oInit,"bFilter"),_fnMap(r.oFeatures,oInit,"bSort"),_fnMap(r.oFeatures,oInit,"bInfo"),_fnMap(r.oFeatures,oInit,"bProcessing"),_fnMap(r.oFeatures,oInit,"bAutoWidth"),_fnMap(r.oFeatures,oInit,"bSortClasses"),_fnMap(r.oFeatures,oInit,"bServerSide"),_fnMap(r.oFeatures,oInit,"bDeferRender"),_fnMap(r.oScroll,oInit,"sScrollX","sX"),_fnMap(r.oScroll,oInit,"sScrollXInner","sXInner"),_fnMap(r.oScroll,oInit,"sScrollY","sY"),_fnMap(r.oScroll,oInit,"bScrollCollapse","bCollapse"),_fnMap(r.oScroll,oInit,"bScrollInfinite","bInfinite"),_fnMap(r.oScroll,oInit,"iScrollLoadGap","iLoadGap"),_fnMap(r.oScroll,oInit,"bScrollAutoCss","bAutoCss"),_fnMap(r,oInit,"asStripeClasses"),_fnMap(r,oInit,"asStripClasses","asStripeClasses"),_fnMap(r,oInit,"fnServerData"),_fnMap(r,oInit,"fnFormatNumber"),_fnMap(r,oInit,"sServerMethod"),_fnMap(r,oInit,"aaSorting"),_fnMap(r,oInit,"aaSortingFixed"),_fnMap(r,oInit,"aLengthMenu"),_fnMap(r,oInit,"sPaginationType"),_fnMap(r,oInit,"sAjaxSource"),_fnMap(r,oInit,"sAjaxDataProp"),_fnMap(r,oInit,"iCookieDuration"),_fnMap(r,oInit,"sCookiePrefix"),_fnMap(r,oInit,"sDom"),_fnMap(r,oInit,"bSortCellsTop"),_fnMap(r,oInit,"iTabIndex"),_fnMap(r,oInit,"oSearch","oPreviousSearch"),_fnMap(r,oInit,"aoSearchCols","aoPreSearchCols"),_fnMap(r,oInit,"iDisplayLength","_iDisplayLength"),_fnMap(r,oInit,"bJQueryUI","bJUI"),_fnMap(r,oInit,"fnCookieCallback"),_fnMap(r,oInit,"fnStateLoad"),_fnMap(r,oInit,"fnStateSave"),_fnMap(r.oLanguage,oInit,"fnInfoCallback"),_fnCallbackReg(r,"aoDrawCallback",oInit.fnDrawCallback,"user"),_fnCallbackReg(r,"aoServerParams",oInit.fnServerParams,"user"),_fnCallbackReg(r,"aoStateSaveParams",oInit.fnStateSaveParams,"user"),_fnCallbackReg(r,"aoStateLoadParams",oInit.fnStateLoadParams,"user"),_fnCallbackReg(r,"aoStateLoaded",oInit.fnStateLoaded,"user"),_fnCallbackReg(r,"aoRowCallback",oInit.fnRowCallback,"user"),_fnCallbackReg(r,"aoRowCreatedCallback",oInit.fnCreatedRow,"user"),_fnCallbackReg(r,"aoHeaderCallback",oInit.fnHeaderCallback,"user"),_fnCallbackReg(r,"aoFooterCallback",oInit.fnFooterCallback,"user"),_fnCallbackReg(r,"aoInitComplete",oInit.fnInitComplete,"user"),
_fnCallbackReg(r,"aoPreDrawCallback",oInit.fnPreDrawCallback,"user"),r.oFeatures.bServerSide&&r.oFeatures.bSort&&r.oFeatures.bSortClasses?_fnCallbackReg(r,"aoDrawCallback",_fnSortingClasses,"server_side_sort_classes"):r.oFeatures.bDeferRender&&_fnCallbackReg(r,"aoDrawCallback",_fnSortingClasses,"defer_sort_classes"),oInit.bJQueryUI?($.extend(r.oClasses,DataTable.ext.oJUIClasses),oInit.sDom===DataTable.defaults.sDom&&"lfrtip"===DataTable.defaults.sDom&&(r.sDom='<"H"lfr>t<"F"ip>')):$.extend(r.oClasses,DataTable.ext.oStdClasses),$(this).addClass(r.oClasses.sTable),(""!==r.oScroll.sX||""!==r.oScroll.sY)&&(r.oScroll.iBarWidth=_fnScrollBarWidth()),r.iInitDisplayStart===undefined&&(r.iInitDisplayStart=oInit.iDisplayStart,r._iDisplayStart=oInit.iDisplayStart),oInit.bStateSave&&(r.oFeatures.bStateSave=!0,_fnLoadState(r,oInit),_fnCallbackReg(r,"aoDrawCallback",_fnSaveState,"state_save")),null!==oInit.iDeferLoading){r.bDeferLoading=!0;var l=$.isArray(oInit.iDeferLoading);r._iRecordsDisplay=l?oInit.iDeferLoading[0]:oInit.iDeferLoading,r._iRecordsTotal=l?oInit.iDeferLoading[1]:oInit.iDeferLoading}if(null!==oInit.aaData&&(a=!0),""!==oInit.oLanguage.sUrl?(r.oLanguage.sUrl=oInit.oLanguage.sUrl,$.getJSON(r.oLanguage.sUrl,null,function(e){_fnLanguageCompat(e),$.extend(!0,r.oLanguage,oInit.oLanguage,e),_fnInitialise(r)}),o=!0):$.extend(!0,r.oLanguage,oInit.oLanguage),null===oInit.asStripeClasses&&(r.asStripeClasses=[r.oClasses.sStripeOdd,r.oClasses.sStripeEven]),e=r.asStripeClasses.length,r.asDestroyStripes=[],e){var h=!1,d=$(this).children("tbody").children("tr:lt("+e+")");for(s=0;e>s;s++)d.hasClass(r.asStripeClasses[s])&&(h=!0,r.asDestroyStripes.push(r.asStripeClasses[s]));h&&d.removeClass(r.asStripeClasses.join(" "))}var c,u=[],p=this.getElementsByTagName("thead");if(0!==p.length&&(_fnDetectHeader(r.aoHeader,p[0]),u=_fnGetUniqueThs(r)),null===oInit.aoColumns)for(c=[],s=0,e=u.length;e>s;s++)c.push(null);else c=oInit.aoColumns;for(s=0,e=c.length;e>s;s++)oInit.saved_aoColumns!==undefined&&oInit.saved_aoColumns.length==e&&(null===c[s]&&(c[s]={}),c[s].bVisible=oInit.saved_aoColumns[s].bVisible),_fnAddColumn(r,u?u[s]:null);for(_fnApplyColumnDefs(r,oInit.aoColumnDefs,c,function(e,t){_fnColumnOptions(r,e,t)}),s=0,e=r.aaSorting.length;e>s;s++){r.aaSorting[s][0]>=r.aoColumns.length&&(r.aaSorting[s][0]=0);var f=r.aoColumns[r.aaSorting[s][0]];for(r.aaSorting[s][2]===undefined&&(r.aaSorting[s][2]=0),oInit.aaSorting===undefined&&r.saved_aaSorting===undefined&&(r.aaSorting[s][1]=f.asSorting[0]),t=0,i=f.asSorting.length;i>t;t++)if(r.aaSorting[s][1]==f.asSorting[t]){r.aaSorting[s][2]=t;break}}_fnSortingClasses(r),_fnBrowserDetect(r);var g=$(this).children("caption").each(function(){this._captionSide=$(this).css("caption-side")}),m=$(this).children("thead");0===m.length&&(m=[document.createElement("thead")],this.appendChild(m[0])),r.nTHead=m[0];var v=$(this).children("tbody");0===v.length&&(v=[document.createElement("tbody")],this.appendChild(v[0])),r.nTBody=v[0],r.nTBody.setAttribute("role","alert"),r.nTBody.setAttribute("aria-live","polite"),r.nTBody.setAttribute("aria-relevant","all");var b=$(this).children("tfoot");if(0===b.length&&g.length>0&&(""!==r.oScroll.sX||""!==r.oScroll.sY)&&(b=[document.createElement("tfoot")],this.appendChild(b[0])),b.length>0&&(r.nTFoot=b[0],_fnDetectHeader(r.aoFooter,r.nTFoot)),a)for(s=0;s<oInit.aaData.length;s++)_fnAddData(r,oInit.aaData[s]);else _fnGatherData(r);r.aiDisplay=r.aiDisplayMaster.slice(),r.bInitialised=!0,o===!1&&_fnInitialise(r)}),_that=null,this};DataTable.fnVersionCheck=function(e){for(var t=function(e,t){for(;e.length<t;)e+="0";return e},i=DataTable.ext.sVersion.split("."),s=e.split("."),n="",o="",a=0,r=s.length;r>a;a++)n+=t(i[a],3),o+=t(s[a],3);return parseInt(n,10)>=parseInt(o,10)},DataTable.fnIsDataTable=function(e){for(var t=DataTable.settings,i=0;i<t.length;i++)if(t[i].nTable===e||t[i].nScrollHead===e||t[i].nScrollFoot===e)return!0;return!1},DataTable.fnTables=function(e){var t=[];return jQuery.each(DataTable.settings,function(i,s){(!e||e===!0&&$(s.nTable).is(":visible"))&&t.push(s.nTable)}),t},DataTable.version="1.9.4",DataTable.settings=[],DataTable.models={},DataTable.models.ext={afnFiltering:[],afnSortData:[],aoFeatures:[],aTypes:[],fnVersionCheck:DataTable.fnVersionCheck,iApiIndex:0,ofnSearch:{},oApi:{},oStdClasses:{},oJUIClasses:{},oPagination:{},oSort:{},sVersion:DataTable.version,sErrMode:"alert",_oExternConfig:{iNextUnique:0}},DataTable.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0},DataTable.models.oRow={nTr:null,_aData:[],_aSortData:[],_anHidden:[],_sRowStripe:""},DataTable.models.oColumn={aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bUseRendered:null,bVisible:null,_bAutoType:!0,fnCreatedCell:null,fnGetData:null,fnRender:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null},DataTable.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollAutoCss:!0,bScrollCollapse:!1,bScrollInfinite:!1,bServerSide:!1,bSort:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCookieCallback:null,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){if(1e3>e)return e;for(var t=e+"",i=t.split(""),s="",n=t.length,o=0;n>o;o++)o%3===0&&0!==o&&(s=this.oLanguage.sInfoThousands+s),s=i[n-o-1]+s;return s},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:function(e,t,i,s){s.jqXHR=$.ajax({url:e,data:t,success:function(e){e.sError&&s.oApi._fnLog(s,0,e.sError),$(s.oInstance).trigger("xhr",[s,e]),i(e)},dataType:"json",cache:!1,type:s.sServerMethod,error:function(e,t,i){"parsererror"==t&&s.oApi._fnLog(s,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},fnServerParams:null,fnStateLoad:function(oSettings){var sData=this.oApi._fnReadCookie(oSettings.sCookiePrefix+oSettings.sInstance),oData;try{oData="function"==typeof $.parseJSON?$.parseJSON(sData):eval("("+sData+")")}catch(e){oData=null}return oData},fnStateLoadParams:null,fnStateLoaded:null,fnStateSave:function(e,t){this.oApi._fnCreateCookie(e.sCookiePrefix+e.sInstance,this.oApi._fnJsonString(t),e.iCookieDuration,e.sCookiePrefix,e.fnCookieCallback)},fnStateSaveParams:null,iCookieDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iScrollLoadGap:100,iTabIndex:0,oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oSearch:$.extend({},DataTable.models.oSearch),sAjaxDataProp:"aaData",sAjaxSource:null,sCookiePrefix:"SpryMedia_DataTables_",sDom:"lfrtip",sPaginationType:"two_button",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET"},DataTable.defaults.columns={aDataSort:null,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bUseRendered:!0,bVisible:!0,fnCreatedCell:null,fnRender:null,iDataSort:-1,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null},DataTable.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortClasses:null,bStateSave:null},oScroll:{bAutoCss:null,bCollapse:null,bInfinite:null,iBarWidth:0,iLoadGap:null,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1},aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],asDataSearch:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:null,asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iCookieDuration:0,sCookiePrefix:"",fnCookieCallback:null,aoStateSave:[],aoStateLoad:[],oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iDisplayEnd:10,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length},fnRecordsDisplay:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length},fnDisplayEnd:function(){return this.oFeatures.bServerSide?this.oFeatures.bPaginate===!1||-1==this._iDisplayLength?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null},DataTable.ext=$.extend(!0,{},DataTable.models.ext),$.extend(DataTable.ext.oStdClasses,{sTable:"dataTable",sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"",sJUIHeader:"",sJUIFooter:""}),$.extend(DataTable.ext.oJUIClasses,DataTable.ext.oStdClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPageLast:"last ui-corner-tr ui-corner-br",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollFoot:"dataTables_scrollFoot ui-state-default",sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"}),$.extend(DataTable.ext.oPagination,{two_button:{fnInit:function(e,t,i){var s=e.oLanguage.oPaginate,n=(e.oClasses,function(t){e.oApi._fnPageChange(e,t.data.action)&&i(e)}),o=e.bJUI?'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUIPrev+'"></span></a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUINext+'"></span></a>':'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+s.sPrevious+'</a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+s.sNext+"</a>";$(t).append(o);var a=$("a",t),r=a[0],l=a[1];e.oApi._fnBindAction(r,{action:"previous"},n),e.oApi._fnBindAction(l,{action:"next"},n),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",r.id=e.sTableId+"_previous",l.id=e.sTableId+"_next",r.setAttribute("aria-controls",e.sTableId),l.setAttribute("aria-controls",e.sTableId))},fnUpdate:function(e,t){if(e.aanFeatures.p)for(var i,s=e.oClasses,n=e.aanFeatures.p,o=0,a=n.length;a>o;o++)i=n[o].firstChild,i&&(i.className=0===e._iDisplayStart?s.sPagePrevDisabled:s.sPagePrevEnabled,i=i.nextSibling,i.className=e.fnDisplayEnd()==e.fnRecordsDisplay()?s.sPageNextDisabled:s.sPageNextEnabled)}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(e,t,i){var s=e.oLanguage.oPaginate,n=e.oClasses,o=function(t){e.oApi._fnPageChange(e,t.data.action)&&i(e)};$(t).append('<a  tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPageFirst+'">'+s.sFirst+'</a><a  tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPagePrevious+'">'+s.sPrevious+'</a><span></span><a tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPageNext+'">'+s.sNext+'</a><a tabindex="'+e.iTabIndex+'" class="'+n.sPageButton+" "+n.sPageLast+'">'+s.sLast+"</a>");var a=$("a",t),r=a[0],l=a[1],h=a[2],d=a[3];e.oApi._fnBindAction(r,{action:"first"},o),e.oApi._fnBindAction(l,{action:"previous"},o),e.oApi._fnBindAction(h,{action:"next"},o),e.oApi._fnBindAction(d,{action:"last"},o),e.aanFeatures.p||(t.id=e.sTableId+"_paginate",r.id=e.sTableId+"_first",l.id=e.sTableId+"_previous",h.id=e.sTableId+"_next",d.id=e.sTableId+"_last")},fnUpdate:function(e,t){if(e.aanFeatures.p){var i,s,n,o,a,r,l,h=DataTable.ext.oPagination.iFullNumbersShowPages,d=Math.floor(h/2),c=Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength),u=Math.ceil(e._iDisplayStart/e._iDisplayLength)+1,p="",f=e.oClasses,g=e.aanFeatures.p,m=function(s){e.oApi._fnBindAction(this,{page:s+i-1},function(i){e.oApi._fnPageChange(e,i.data.page),t(e),i.preventDefault()})};for(-1===e._iDisplayLength?(i=1,s=1,u=1):h>c?(i=1,s=c):d>=u?(i=1,s=h):u>=c-d?(i=c-h+1,s=c):(i=u-Math.ceil(h/2)+1,s=i+h-1),n=i;s>=n;n++)p+=u!==n?'<a tabindex="'+e.iTabIndex+'" class="'+f.sPageButton+'">'+e.fnFormatNumber(n)+"</a>":'<a tabindex="'+e.iTabIndex+'" class="'+f.sPageButtonActive+'">'+e.fnFormatNumber(n)+"</a>";for(n=0,o=g.length;o>n;n++)l=g[n],l.hasChildNodes()&&($("span:eq(0)",l).html(p).children("a").each(m),a=l.getElementsByTagName("a"),r=[a[0],a[1],a[a.length-2],a[a.length-1]],$(r).removeClass(f.sPageButton+" "+f.sPageButtonActive+" "+f.sPageButtonStaticDisabled),$([r[0],r[1]]).addClass(1==u?f.sPageButtonStaticDisabled:f.sPageButton),$([r[2],r[3]]).addClass(0===c||u===c||-1===e._iDisplayLength?f.sPageButtonStaticDisabled:f.sPageButton))}}}}),$.extend(DataTable.ext.oSort,{"string-pre":function(e){return"string"!=typeof e&&(e=null!==e&&e.toString?e.toString():""),e.toLowerCase()},"string-asc":function(e,t){return t>e?-1:e>t?1:0},"string-desc":function(e,t){return t>e?1:e>t?-1:0},"html-pre":function(e){return e.replace(/<.*?>/g,"").toLowerCase()},"html-asc":function(e,t){return t>e?-1:e>t?1:0},"html-desc":function(e,t){return t>e?1:e>t?-1:0},"date-pre":function(e){var t=Date.parse(e);return(isNaN(t)||""===t)&&(t=Date.parse("01/01/1970 00:00:00")),t},"date-asc":function(e,t){return e-t},"date-desc":function(e,t){return t-e},"numeric-pre":function(e){return"-"==e||""===e?0:1*e},"numeric-asc":function(e,t){return e-t},"numeric-desc":function(e,t){return t-e}}),$.extend(DataTable.ext.aTypes,[function(e){if("number"==typeof e)return"numeric";if("string"!=typeof e)return null;var t,i="0123456789-",s="0123456789.",n=!1;if(t=e.charAt(0),-1==i.indexOf(t))return null;for(var o=1;o<e.length;o++){if(t=e.charAt(o),-1==s.indexOf(t))return null;if("."==t){if(n)return null;n=!0}}return"numeric"},function(e){var t=Date.parse(e);return null!==t&&!isNaN(t)||"string"==typeof e&&0===e.length?"date":null},function(e){return"string"==typeof e&&-1!=e.indexOf("<")&&-1!=e.indexOf(">")?"html":null}]),$.fn.DataTable=DataTable,$.fn.dataTable=DataTable,$.fn.dataTableSettings=DataTable.settings,$.fn.dataTableExt=DataTable.ext})}(window,document),define("modules/tools/staff-listing",["jquery","underscore","baseview","state","utils","modules/scroller/vertical-scroll","libs/jquery/plugins/jquery.dataTables"],function(e,t,i,s,n,o){var a=i.extend({events:{"mouseenter .staff-filter-dropdown":"onHoverFilterDropdown","mouseleave .staff-filter-dropdown":"onHoverFilterDropdown","click .staff-details-open":"onDetailsOpen","click .staff-details-close":"onDetailsClose"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.$popupBox=this.$(".staff-details-box"),this.$popupFilm=this.$(".staff-details-film"),this.$popupTop=parseInt(this.$popupBox.css("top"),10);var t=e.extend({},e.fn.dataTable.defaults,{bAutoWidth:!1,bFilter:!1,bDestroy:!0,bPaginate:!1,bInfo:!1});this.$staffList=this.$(".staff-listing-table").dataTable(t)},onDetailsOpen:function(t){t.preventDefault(),this.openedOnce=!0,this.$popupLink=e(t.currentTarget);var i=this.$popupLink.data("class"),s=n.getScrollPosition();this.$popupBox.css("top",s),this.$popupBox.data("url")!=this.$popupLink.data("url")&&this.loadDetails(),this.$popupBox.addClass(i),this.$popupFilm.show(),this.$popupBox.show(),e(".site-footer").css({visibility:"hidden"})},onDetailsClose:function(t){if(this.openedOnce){t&&t.preventDefault();var i=this.$popupLink.data("class");this.$popupBox.removeClass(i),this.$popupBox.hide(),this.$popupFilm.hide(),this.$(".staff-details-data").addClass("staff-loading-details"),e(".site-footer").css({visibility:"visible"})}},loadDetails:function(){this.$(".staff-details-loaded").remove();var e=this.$popupLink.data("url");this.$popupBox.data("url",e),s.fetchHtml(e).done(t.bind(function(t){t.find(".staff-details-loaded").length?(this.$(".staff-details-data").removeClass("staff-details-loading"),this.$(".staff-details-data").html(t)):console.log("Unable to load details for: "+e)},this))},onHoverFilterDropdown:function(t){if("mouseenter"===t.type){var i=e(t.currentTarget),s=i.find(".staff-filter-scroll-wrap");this.subviews.vscroll=new o({el:s,padding:6})}else this.subviews.vscroll&&this.subviews.vscroll.destroy()}});return a}),define("uiPageTurn",["jquery","transformSupport"],function(e){"use strict";var t="uiPageTurn",i={useTransforms:!!e.support.css.transform,fallback:"crossfade",pageSelector:".ui-page-turn",placerSelector:".ui-placer",transitionTiming:"linear",turnDuration:300,perspective:"2200px",slideDuration:200,fadeDuration:200,shadow:!0,shadowOpacity:.7,onPageTurn:function(e){}},s={init:function(s){return this.each(function(){var n=e(this),o=e.extend({},i,s),a=n.find(o.pageSelector+".active");0===a.length&&(a=n.children(":first")),a.next(o.pageSelector).addClass("preload"),n.data(t,{currentPage:a,busy:!1,settings:o})})},option:function(e,i){var s=this.data(t);if(s&&e){if(!i)return s[e];("function"==typeof i||"onPageTurn"!==e)&&(s[e]=i)}},nextPage:function(e,i){var s=this.data(t),o=s.settings,a=s.currentPage,r=a.next(o.pageSelector);return n.transition(this,a,r,!1,o,s,e,i)},prevPage:function(e,i){var s=this.data(t),o=s.settings,a=s.currentPage,r=a.prev(o.pageSelector);return n.transition(this,a,r,!0,o,s,e,i)},goToPage:function(i,s,o){var a=this.data(t),r=a.settings,l=a.currentPage,h=this.children(r.pageSelector),d=h.eq(i),c=h.index(l);return c===i?e.Deferred().reject():n.transition(this,l,d,c>i,r,a,s,o)},getCurrentPage:function(){var e=this.data(t);return e.currentPage}},n={transition:function(t,i,s,o,a,r,l,h){var d;return!s.length||r.busy?e.Deferred().reject():l?(n.finishTransition(i,s,o,a,r),e.Deferred().resolve()):(r.busy=!0,s.removeClass("preload"),d=!h&&a.useTransforms?n.flipTransform(t,i,s,o,a):"slide"===a.fallback?n.slideTransition(i,s,o,a):n.fadeTransition(i,s,a),d.done(function(){n.finishTransition(i,s,o,a,r)}),d)},finishTransition:function(e,t,i,s,n){s.onPageTurn(t),n.busy=!1,e.removeClass("active"),t.addClass("active"),i?t.prev(s.pageSelector).addClass("preload"):t.next(s.pageSelector).addClass("preload"),n.currentPage=t},flipTransform:function(t,i,s,o,a){i.removeClass("active");var r=i.clone(),l=s.clone(),h=e('<div class="ui-shadow"></div>'),d=e('<div class="ui-shadow"></div>'),c=e('<div class="ui-page-turn-animator"></div>');a.shadow&&(s.append(h),i.append(d),h.css({opacity:a.shadowOpacity}),d.css({opacity:0})),c.append(r),c.append(l),t.append(c),o?(i.addClass("right"),s.addClass("left"),l.addClass("right"),r.addClass("left")):(i.addClass("left"),s.addClass("right"),l.addClass("left"),r.addClass("right")),n.setupTransition(t[0],c[0],r[0],l[0],o,a);var u=e.Deferred();return e.support.css.transition.registerTransitionEndListener(c[0],u).done(function(){d.remove(),h.remove(),c.remove(),s.removeClass("left right"),i.removeClass("left right"),t[0].style[e.support.css.transform.perspectiveCssName]="",t[0].style[e.support.css.transform.styleCssName]=""}),setTimeout(function(){var t=o?"rotateY(180deg)":"rotateY(-180deg)";c[0].style[e.support.css.transform.cssName]=t,a.shadow&&(h[0].style[e.support.css.transition.cssName]=n.getTransitionStyle("opacity",a.turnDuration/2,a.transitionTiming),d[0].style[e.support.css.transition.cssName]=n.getTransitionStyle("opacity",a.turnDuration/2,a.transitionTiming,a.turnDuration/2),h.css({opacity:0}),d.css({opacity:a.shadowOpacity}))},20),u.promise()},slideTransition:function(t,i,s,o){if(i.addClass("active"),t.css({left:"0%"}),s?i.css({left:"-100%"}):i.css({left:"100%"}),e.support.css.transition){var a=n.getTransitionStyle("left",o.slideDuration,o.transitionTiming);return i[0].style[e.support.css.transition.cssName]=a,t[0].style[e.support.css.transition.cssName]=a,setTimeout(function(){i.css({left:"0%"}),t.css({left:s?"100%":"-100%"})},20),e.support.css.transition.registerTransitionEndListener(i[0])}return t.animate({left:s?"100%":"-100%"},o.slideDuration,o.transitionTiming),i.animate({left:"0%"},o.slideDuration,o.transitionTiming).promise()},fadeTransition:function(e,t,i){e.css({opacity:1,"z-index":11}).show(),t.css({opacity:1,"z-index":10}).show();var s=e.fadeOut(i.fadeDuration).promise();return s.done(function(){e.css({"z-index":""}),t.css({"z-index":""})}),s},getTransitionStyle:function(e,t,i,s){var n=e+" "+t+"ms "+i;return s&&(n+=" "+s+"ms"),n},setupTransition:function(t,i,s,o,a,r){t.style[e.support.css.transform.perspectiveCssName]=r.perspective,t.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.perspectiveCssName]=r.perspective,i.style[e.support.css.transition.cssName]=n.getTransitionStyle(e.support.css.transform.cssHyphenName,r.turnDuration,r.transitionTiming),s.style[e.support.css.transform.styleCssName]="preserve-3d",s.style[e.support.css.transform.cssName]="rotateY(0deg)",s.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",o.style[e.support.css.transform.styleCssName]="preserve-3d",a?(s.style[e.support.css.transform.originCssName]="right center",o.style[e.support.css.transform.originCssName]="left center",o.style[e.support.css.transform.cssName]="rotateY(-180deg) translateZ(1px)"):(s.style[e.support.css.transform.originCssName]="left center",o.style[e.support.css.transform.originCssName]="right center",o.style[e.support.css.transform.cssName]="rotateY(180deg) translateZ(1px)")}};e.fn.uiPageTurn=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.uiPageTurn"):s.init.apply(this,arguments)}}),define("apps/bigpage",["jquery","underscore","backbone","pubsub","utils","state","admanager","base-app","directAdPosition","uiPageTurn"],function(e,t,i,s,n,o,a,r,l){var h=r.extend({el:"#cover-view",events:{"click .big-page-prev":"prevSlide","click .ui-page-turn":"palmSlide","click .big-page-next":"nextSlide"},initialize:function(i){i=e.extend(!0,{animation:{slideDuration:350}},i),t.bindAll(this,"keyboardShortcuts","onPageTurn","resizeHandler","moveSlide","playAd"),this.$body=n.get("body"),this.$doc=n.get("doc"),this.$win=n.get("win"),this.$adContents=this.$(".partner-coverview-contents");var s=t.throttle(this.resizeHandler,50);this.$win.on("resize."+this.cid,s),r.prototype.initialize.call(this,i)},resizeHandler:function(){if(this.$pages){var t=this.$win.width(),i=this.$win.height()-40;t%2?this.$pages.addClass("width-wiggler"):this.$pages.removeClass("width-wiggler"),this.$adContents.css({width:t+"px",top:40,height:i+"px"}),e.each(this.subviews,function(e,s){0===e.indexOf("ad_")&&s.resizeAd(t,i)})}},palmSlide:function(t){var i=e(t.target);if(!(i.hasClass("load-story")||i.hasClass("parent-label")||i.closest(".partner-placement").length)){var s=t.screenX,n=this.$win.width()>>1;s>n?this.nextSlide(t):this.prevSlide(t)}},prevSlide:function(e){e&&e.preventDefault(),this.moveSlide(-1),s.trigger("heattrack","thebigpageleft")},nextSlide:function(e){e&&e.preventDefault(),this.moveSlide(1),s.trigger("heattrack","thebigpageright")},moveSlide:function(e){var t=this.$pages.uiPageTurn("getCurrentPage").index(),i=t+e,s=!1,n=this.playAd;this.isIndexAd(i)?(s=this.isAdReady(i),s||(i+=e)):this.prepareNextAd(t),o.registerAnimation(this.$pages.uiPageTurn("goToPage",i)).done(function(){s&&n(i)})},playAd:function(e){var t=this.subviews["ad_"+e];t&&(t.playAd(),t.show())},fetchAd:function(e){var t,i,s=this.$pagesChildren.eq(e),o=n.getNested(window.site_vars,"aws_site_name")||"usat",a=s.find(".partner-coverview-contents");return t=this.getPageInfo(s.prev()),this.subviews["ad_"+e]=i=new l({el:a,adPlacement:"coverview/"+t.cst,adSizes:[[1,1]],targeting:{sitePage:o+"/"+(t.ssts||"").replace(/\/\/*$/,"")},slotType:"out"}),i.prefetchAd(),this.resizeHandler(),!0},getNextAdIndex:function(e){return this.$pagesChildren.eq(e).nextAll(".partner-placement").first().index()},checkIfAdHasBeenFetched:function(e){e>0&&!this.subviews["ad_"+e]&&this.fetchAd(e)},isIndexAd:function(e){return this.$pagesChildren.eq(e).hasClass("partner-placement")},prepareNextAd:function(e){var t=this.getNextAdIndex(e);this.checkIfAdHasBeenFetched(t)},isAdReady:function(e){var t=this.subviews["ad_"+e];return t?t.isAdReady():!1},slideTransition:function(e,i){e.addClass("active"),i?e.css("left","100%"):e.css("left","-100%"),this.animate(e,"left",0,this.options.animation.slideDuration,"linear").done(t.bind(function(){this.$activePage=e,this.busy=!1},this)),this.$activePage.css("left","0%"),this.animate(this.$activePage,"left",i?"-100%":"100%",this.options.animation.slideDuration,"linear")},keyboardShortcuts:function(e){e.target===this.$body[0]&&(37===e.which?this.prevSlide(e):39===e.which&&this.nextSlide())},afterPageReveal:function(e,t,i){this.$prev=this.$(".big-page-prev"),this.$next=this.$(".big-page-next"),this.$pages=this.$("#cover-view-pages"),this.$pagesChildren=this.$pages.children(),this.$pages.uiPageTurn({onPageTurn:this.onPageTurn,turnDuration:600,fallback:"slide",shadow:!1}),this.resizeHandler(),this.$doc.on("keyup."+this.cid,this.keyboardShortcuts),this.trackPageChange(this.$(".ui-page-turn.active"))},onPageTurn:function(e){e.prev(".ui-page-turn").length?this.$prev.show():this.$prev.hide(),e.next(".ui-page-turn").length?this.$next.show():this.$next.hide(),this.trackPageChange(e)},trackPageLoad:function(){},trackPageChange:function(e){this.pageInfo=this.getPageInfo(e),s.trigger("page:load",this.pageInfo)},getPageInfo:function(e){var t,i=e.find(".coverInfo").html()||"{}";try{t=JSON.parse(i)}catch(s){console.error("could not get current asset page info",s.stack||s.stacktrace||s.message)}return t||{}},pause:function(){this.$doc.off("."+this.cid),r.prototype.pause.apply(this,arguments)},destroy:function(){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),r.prototype.destroy.apply(this,arguments)}});return h}),define("ui/generic-paginator",["jquery","underscore","backbone","baseview"],function(e,t,i,s){var n=s.extend({events:{"click .paginator-indicator-target":"onPaginatorClick"},initialize:function(t){this.$pageElements=this.$(".paginator-indicator-target"),t=e.extend({onBeforePaginator:null,onGoTo:null},t),s.prototype.initialize.call(this,t)},onPaginatorClick:function(t){t&&t.preventDefault();var i=e(t.currentTarget).index();if(this.options.onBeforePaginator){var s=this.options.onBeforePaginator(i,t);if(!s)return!1}this.goToPage(i)},goToPage:function(e){if(0!==this.$pageElements.length){0>e?e=0:e>=this.$pageElements.length&&(e=this.$pageElements.length-1);var t=this.$pageElements.eq(e);this.$(".paginator-indicator-bullet").removeClass("active"),t.find(".paginator-indicator-bullet").addClass("active"),this.options.onGoTo&&this.options.onGoTo(e)}},goToNextPage:function(e){var t=this.$(".paginator-indicator-bullet.active"),i=t.parent().index();i<this.$pageElements.length-1?this.goToPage(i+1):e&&this.goToPage(0)},goToPrevPage:function(e){var t=this.$(".paginator-indicator-bullet.active"),i=t.parent().index();i>0?this.goToPage(i-1):e&&this.goToPage(this.$pageElements.length-1)}});return n}),define("modules/fronts/most-popular-primary",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,s,n){"use strict";var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){t.bindAll(this,"automate","goTo"),s=e.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".mppm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1,n=i;this.animate(this.moveMe,"left",n+"px",450,"ease-in-out"),s.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("apps/404",["jquery","underscore","backbone","state","managers/routemanager","pubsub","apps/simple-overlay","modules/fronts/most-popular-primary","directAdPosition"],function(e,t,i,s,n,o,a,r,l){"use strict";var h=a.extend({
initialize:function(e){t.bindAll(this,"afterPageReveal"),a.prototype.initialize.call(this,e);var i=this.$el.data("sizes");i&&(i=i.split(",")),this.subviews.upperLeaderboard=new l({el:this.$(".error-leaderboard-admodule.top .leaderboard-ad"),adType:"leaderboard_atf",adSizes:i||["leaderboard","billboard"],adPlacement:"leaderboard_atf/error"}),this.subviews.lowerLeaderboard=new l({el:this.$(".error-leaderboard-admodule.bottom .leaderboard-ad"),adType:"leaderboard",adSizes:i||["leaderboard","billboard"],adPlacement:"leaderboard_atf/error"}),this.options.ajax&&(this.render(this.options.htmlFrag),s.registerFullScreenView(this),this.afterPageReveal()),this.subviews.primary=new r({el:this.$(".mppm-wrap")},e)},close:function(e){return e&&e.target!==e.currentTarget?void 0:(this.options.ajax?(s.clearFullScreenView(this),this.destroy(!0)):n.goTo(s.getPreloadedUrl()||"/"),e?!1:void 0)}});return h}),define("apps/cards/layouts",[],function(){return{"primary-suspender-sidebar-page":[{name:"large",adClass:"size-l",adTargeting:"large",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:340,belowHeroAd:!1,belowTheFoldAd:!0,cardWidth:1180,windowWidth:1250},{name:"medium",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,belowTheFoldAd:!0,cardWidth:1080,windowWidth:1150},{name:"small",adClass:"size-s",adTargeting:"small",sidebarOpen:!1,sidebarAds:!1,sidebarWidth:240,belowHeroAd:!0,belowTheFoldAd:!0,cardWidth:840,windowWidth:980}],"primary-flex-sidebar-page":[{name:"1320w",adClass:"size-xl",adTargeting:"xlarge",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,belowTheFoldAd:!0,primaryFlexWidth:960,cardWidth:1320,windowWidth:1320,layout:"flexCard"},{name:"1080w",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,belowTheFoldAd:!0,primaryFlexWidth:720,cardWidth:1080,windowWidth:1150,layout:"flexCard"}],"primary-flex-no-sidebar-page":[{name:"1080w",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:360,belowHeroAd:!1,belowTheFoldAd:!0,primaryFlexWidth:720,cardWidth:1080,windowWidth:1150,layout:"flexCard"}],"front-list-sidebar-page":[{name:"1080w",adClass:"size-m",adTargeting:"medium",sidebarOpen:!0,sidebarAds:!0,sidebarWidth:352,belowHeroAd:!0,belowTheFoldAd:!0,cardWidth:1080,windowWidth:1150}]}}),define("partner/high-impact-base",["jquery","underscore","baseview","sharedAdPosition","admanager","partner/leavebehind"],function(e,t,i,s,n,o){"use strict";var a=i.extend({initialize:function(s){t.bindAll(this,"onAdReady","showAd","beforeAdRender"),s=e.extend({leaveBehindEl:e(".partner-leavebehind"),frameBehavior:{clearBgColor:!0,hideframe:!0,hidebrand:!0}},s),i.prototype.initialize.call(this,s)},_createAd:function(e,t,i){var n=this._filterAdsByCardWidth(e,i);this.subviews.adPosition=new s({el:this.$el,adPlacement:"high_impact",adSizes:n,adType:t,onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender}),this.currentCardInfo=i},_filterAdsByCardWidth:function(e,i){var s,o;return t.filter(e,function(e){return s=n.isFlexibleAdSize(e),o=n.getSize(e),s||o&&o[0]<=i.cardWidth})},beforeAdRender:function(e){this.adData=e,(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText&&(this.subviews.adLeaveBehind=new o({el:this.options.leaveBehindEl,cards:this.options.cards,onShowAd:this.showAd,isCompact:this.isCardBumped,isNative:this.options.isNative,maxDisplayed:parseInt(e.maxDisplayed,10)||this.options.maxDisplayed,behavior:this.options.frameBehavior||{}}))},onAdReady:function(e){var t=this.options.slot;t&&t.addClass("show-slot"),this.subviews.adLeaveBehind?this.subviews.adLeaveBehind.render(this.subviews.adPosition,e):this.showAd()},showAd:function(){this.showingAd=!0,this.subviews.adPosition.show()}});return a}),define("partner/pushdown-ad",["jquery","underscore","utils","partner/high-impact-base","partner/ad-utils","adLogger","pubsub"],function(e,t,i,s,n,o,a){"use strict";var r=s.extend({events:{"click .partner-close":"closeAdClick"},initialize:function(n){n=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}},ratio:{},triggerSpeed:200},n),t.bindAll(this,"onAdReady","showAd","beforeAdRender"),s.prototype.initialize.call(this,n),this.$body=i.get("body"),this.startBgColor=this.$body.css("background-color"),this.$bigHeadline=this.$(".big-headline"),this.$aboveCardContent=this.options.cards.find(".card-above-content"),this.closeButton=this.$(".partner-close"),this.noSidebar=this.$(".primary-flex-no-sidebar-page"),o.logDebug("Pushdown Advertisment initialized",this)},renderCardInfo:function(e,t){this._createAd(["pushdown"],["pushdown"],e),this.isCardBumped=t},beforeAdRender:function(e){var t=this.currentCardInfo;this.adData=e,t&&this.onCardWidthChange(t),s.prototype.beforeAdRender.apply(this,arguments)},destroy:function(e){this.showingAd?this.closeAd(!0):this.startBgColor&&n.clearBg(this.$body,this.startBgColor),s.prototype.destroy.call(this,e)},getAdHeight:function(e){var t=this.adData.ratio;return t&&t.height&&(t.width||0===t.width)?0===t.width?t.height:t.height/t.width*e:615},onAdReady:function(e){"Pushdown+"===e.adType&&(this.persistBackground=!0,n.changeBg(this.$body,e.backgroundSolidColor,e.backgroundRepeatingImage),this.$el.css({display:"block",height:0})),s.prototype.onAdReady.call(this,e),this.subviews.adLeaveBehind&&(this.subviews.adLeaveBehind.options.behavior.clearBgColor=!1)},showAd:function(){var o,r=this.options.animations.vertical.duration,l=this.getOffsetHeight(),h=this.$el;s.prototype.showAd.call(this),this.$aboveCardContent.animate({opacity:0},150).slideUp(r-150),this.noSidebar&&this.closeButton.show(),h.css({height:0}),o=this.getAdHeight(this.currentCardInfo.cardWidth)-l,this.$bigHeadline.css("visibility","hidden");var d=t.bind(function(){this.subviews.adPosition&&(h.addClass("partner-pushdown-ad-open"),this.subviews.adPosition.playAd())},this);i.flag("disable_ad_animations")?(h.css("height",o),l&&h.css("top",0),d()):e.when(this.animate(h,"height",o,r),l?this.animate(h,"top",0,r):null).done(d),this.$body.addClass("high-impact-ad-visible"),n.changeBg(this.$body,this.adData.backgroundSolidColor,this.adData.backgroundRepeatingImage),a.trigger("pushdownAd:showAd",this.options.triggerSpeed)},closeAdClick:function(e){e.preventDefault(),this.closeAd(),this.$aboveCardContent.slideDown(this.options.animations.vertical.duration-150).animate({opacity:1},150)},getOffsetHeight:function(){return this.$bigHeadline.height()||0},closeAd:function(s){var o=this.subviews.adLeaveBehind,r=o.startBgColor||this.startBgColor,l=this.$el,h=this.getOffsetHeight(),d=this.options.animations.vertical.duration;this.showingAd=!1,this.subviews.adPosition.stopAd();var c=t.bind(function(){this.$body.removeClass("high-impact-ad-visible"),l.removeClass("partner-pushdown-ad-open"),this.$bigHeadline.css("visibility","visible"),o&&!s&&o.show()},this);i.flag("disable_ad_animations")?(l.css("height",0),h&&l.css("top",h),c()):e.when(this.animate(l,"height",0,d),h?this.animate(l,"top",h+"px",d):null).done(c),this.noSidebar&&this.closeButton.hide(),this.startBgColor&&(!this.persistBackground&&!o.startBgColor||s)&&n.clearBg(this.$body,r),a.trigger("pushdownAd:closeAd",this.options.triggerSpeed)},onCardWidthChange:function(e){if(this.subviews.adPosition&&this.adData){var t=this.adData.adType,i=this.$el,s=this.getOffsetHeight(),n=this.getAdHeight(e.cardWidth);this.currentCardInfo=e,"Pushdown+"!==t||this.showingAd||i.css("top",s),i.removeClass(this.options.adClasses).addClass(e.adClass),this.subviews.adPosition.resizeAd(e.cardWidth,n),this.adData.ratio&&this.showingAd&&(n-=s,i.css("height",n))}}});return r}),define("partner/gravity-ad",["jquery","underscore","utils","pubsub","partner/high-impact-base","site-manager","adLogger"],function(e,t,i,s,n,o,a){"use strict";var r=n.extend({breakingBarHeight:0,haveBreakingNews:!1,pubSub:{},state:"stopped",events:{"click .partner-scroll":"scrollPage"},scopedBind:t.uniqueId("gravity"),initialize:function(s){s=e.extend({adClasses:"",maxDisplayed:2},s),t.bindAll(this,"onAdReady","onResizeWindow","onScrollWindow","scrollPage"),n.prototype.initialize.call(this,s),this.header=o.getHeader(),this.header&&this.header.subviews&&(this.breakingbar=this.header.subviews.breakingbar,this.breakingBarHeight=this.breakingbar.getHeight()),this.$body=i.get("body"),this.$window=i.get("win"),this.$partnerScroll=this.$(".partner-scroll"),a.logDebug("Gravity Advertisment initialized",this)},renderCardInfo:function(e,t){this._createAd(["gravity"],"gravity",e),this.isCardBumped=t},beforeAdRender:function(){this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition.setInitialDimensions(this.windowWidth,this.windowHeight),n.prototype.beforeAdRender.apply(this,arguments)},destroy:function(e){this.closeAd(),this.header&&(this.header.destroyTransparency(),this.header.restoreLastState()),this.shiftDownTimeout&&clearTimeout(this.shiftDownTimeout),n.prototype.destroy.call(this,e)},showAd:function(e){this.showingAd=!0;var i=t.throttle(this.onResizeWindow,50),n=t.throttle(this.onScrollWindow,50);this.$window.on("resize."+this.scopedBind,i).on("scroll."+this.scopedBind,n),this.pubSub={"breakingbar:before:open":this.onResizeWindow,"breakingbar:before:close":this.onResizeWindow},s.attach(this.pubSub,this),this.onResizeWindow(),this.subviews.adPosition.show(),this.options.contentSection.css("margin-top",this.cardOffset),this.onScrollWindow(),this.$body.addClass("high-impact-ad-visible"),this.header.setClosedFixed(!0),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.hide(),this.setBreakingNewsBarrier(),s.trigger("gravity:open")},setBreakingNewsBarrier:function(){this.breakingNewsBarrier&&"resolved"!==this.breakingNewsBarrier.state()||(this.breakingNewsBarrier=new e.Deferred,this.breakingbar.addToBarrier(this.breakingNewsBarrier,999999,!1))},getHeaderOffset:function(){return this.header?this.header.getCollapsedHeight():0},closeAd:function(){this.subviews.adPosition&&this.adData&&(this.showingAd=!1,this.subviews.adPosition.stopAd(),this.breakingNewsBarrier&&this.breakingNewsBarrier.resolve(),this.options.contentSection.css({"margin-top":"",position:""}),this.$body.removeClass("high-impact-ad-visible"),this.$window.off("."+this.scopedBind))},onResizeWindow:function(){return this.windowWidth=this.$window.width(),this.windowHeight=this.$window.height(),this.subviews.adPosition?(this.subviews.adPosition.resizeAd(this.windowWidth,this.windowHeight),this.cardOffset=this.windowHeight-this.getHeaderOffset(),this.options.contentSection.css("margin-top",this.cardOffset),void this.onScrollWindow()):!1},onScrollWindow:function(){var e=this.$window.scrollTop(),t=this.header.getCurrentHeight(),i=(this.windowHeight-e-t)/(this.windowHeight-t),s=i>0?i:0;this.$el.css("opacity",s),.1>s&&"playing"===this.state?(this.state="paused",this.subviews.adPosition&&(this.subviews.adPosition.pauseAd(),this.breakingNewsBarrier.resolve(),this.expandBreakingBar()),this.header.toggleTransparency(!1)):s>.1&&"paused"===this.state?(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.resumeAd(),this.collapseBreakingBar()),this.header.toggleTransparency(!0)):s>.1&&"stopped"===this.state&&(this.state="playing",this.subviews.adPosition&&(this.subviews.adPosition.playAd(),this.collapseBreakingBar()),this.header.toggleTransparency(!0)),0===s?this.$el.css("display","none"):this.$el.css("display","block"),this.onArticleScroll&&this.onArticleScroll(s,t)},collapseBreakingBar:function(){this.breakingBarHeight=this.breakingbar.getHeight(),this.haveBreakingNews=this.breakingbar.closeBreakingBar(),this.setBreakingNewsBarrier()},expandBreakingBar:function(){this.haveBreakingNews&&this.breakingbar.openBreakingBar()},shiftContentUp:function(){var e=this.cardOffset-this.header.getCollapsedHeight()-30;this.options.contentSection.animate({"margin-top":e},350),this.shiftDownTimeout=setTimeout(t.bind(function(){this.shiftContentDown()},this),5e3)},shiftContentDown:function(){var i=this.options.contentSection;e.when(this.animate(i,"margin-top",this.cardOffset,500),this.animate(this.$partnerScroll,"margin-top",-75,500)).done(t.bind(function(){this.$partnerScroll.css("margin-top","").addClass("shifted")},this))},scrollPage:function(e){e.preventDefault();var t=this.windowHeight-this.getHeaderOffset();this.expandBreakingBar(),i.get("scrollEl").animate({scrollTop:t},500)}});return r}),define("modules/partner/paramount-ad-front",["underscore","baseview","site-manager","utils","sharedAdPosition"],function(e,t,i,s,n){"use strict";var o=t.extend({initialize:function(i){t.prototype.initialize.call(this,i),this.$body=s.get("body"),e.bindAll(this,"_onAdReady"),this.subviews.adPosition=new n({defaultPosition:i.defaultPosition,skipTargetBarrier:i.skipTargetBarrier,el:this.$el,adType:"Paramount Ad Front",adPlacement:i.adPlacement,adSizes:"fluid",onAdReady:this._onAdReady})},_onAdReady:function(t,s,n){if(e.isEqual(n,[0,0])){this.$el.addClass("partner-paramount");var o=i.getHeader();o&&o.setClosedFixed(!0)}this.subviews.adPosition.show(),this.$body.addClass("paramount-ad-visible")},destroy:function(e){this.$body.removeClass("paramount-ad-visible"),t.prototype.destroy.apply(this,arguments)}});return o}),define("partner/digital-wrap",["jquery","underscore","baseview","state","utils","partner/ad-utils","sharedAdPosition"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({initialize:function(e){t.bindAll(this,"onAdReady","showAd"),i.prototype.initialize.call(this,e),this.subviews.ad=new a({el:this.$el,adPlacement:"high_impact",adSizes:[1280,768],adType:"digitalwrap",onAdReady:this.onAdReady,slot:e.slot}),this.$body=n.get("body")},destroy:function(e){this.$wrap&&this.$wrap.remove(),this.$clickLeft&&this.$clickLeft.remove(),this.$clickRight&&this.$clickRight.remove(),this.startBgColor&&o.clearBg(this.options.backgroundEl,this.startBgColor),this.$body.removeClass("high-impact-ad-visible"),i.prototype.destroy.call(this,!1)},onAdReady:function(i){var s=this.options.slot,n=this.options.container,o=this.options.offset||0;s&&s.addClass("show-slot"),e("<img>").load(t.bind(function(t){e(t.currentTarget).remove(),this.$wrap=e("<div>").css("background-image",'url("'+i.image+'")').addClass("digital-wrap"),o>0&&this.$wrap.css({top:o}),n.prepend(this.$wrap),this.$body.addClass("partner-background"),this.showAd(i)},this)).attr("src",i.image),this.$clickLeft=e('<a class="dw-click dw-click-left" target="_blank" href="'+i.click+'" style="top: '+o+"px; "+i.styles+'">'),this.$clickRight=this.$clickLeft.clone().attr("class","dw-click dw-click-right"),n.prepend(this.$clickRight).prepend(this.$clickLeft)},showAd:function(e){this.$body.addClass("high-impact-ad-visible"),this.startBgColor=this.$body.css("background-color"),o.changeBg(this.options.backgroundEl,e.backgroundColor),this.$wrap.addClass("show")}});return r}),define("modules/partner/branded-content-tile",["jquery","underscore","baseview","utils","directAdPosition","adLogger"],function(e,t,i,s,n,o){"use strict";var a=i.extend({receivedData:!1,count:20,setup:!1,initialize:function(e){var o="flexCard"===e.layout?[155,224]:[230,250];i.prototype.initialize.call(this,e),t.bindAll(this,"_onTileReady","_onSafeFrameMsg","_setupEvergreen"),this.$placeholder=this.$el.parent().children(".partner-tile-placeholder"),this.subviews.adPosition=new n({el:e.el,adType:"Branded Content Tile",adSizes:[o,[2,3]],adPlacement:"native-front_tile",onAdReady:this._onTileReady,onNoAd:this._setupEvergreen}),window._sp_&&"function"==typeof window._sp_.checkState&&window._sp_.checkState(t.bind(function(e){e&&this._setupEvergreen()},this)),window.addEventListener("message",this._onSafeFrameMsg,!1),this.evergreenTO=setTimeout(this._setupEvergreen,s.getNested(window.site_vars,"ADS","branded_content_tile","timeout")||6e3)},_onTileReady:function(){var e=this.$(".ad-slot > div > iframe")[0],i=e.contentWindow,n=document.location.origin,a=JSON.stringify({bcTile:!0,origin:n});clearTimeout(this.evergreenTO),o.logDebug("Sending Message to Branded Content Tile Ad Slot",a);try{var r=s.getNested(i,"location","origin");this.msgInt=setInterval(t.bind(function(){this._sendMsg(i,a,r)},this),100)}catch(l){this.msgInt=setInterval(t.bind(function(){this._sendMsg(i,a)},this),100)}},_sendMsg:function(e,t,i){this.count--,(!this.count||this.receivedData)&&clearInterval(this.msgInt),i=i&&"null"!==i?i:window.location.protocol+"//tpc.googlesyndication.com",e.postMessage(t,i)},_onSafeFrameMsg:function(e){if(e&&t.isString(e.data)&&"{"===e.data.charAt(0)&&!this.receivedData)try{var i=JSON.parse(e.data);"tile"===i.ad_type&&(this.receivedData=!0,o.logDebug("Branded Content Tile Data:",i),i.section||(i.section="sponsor-story"),i.url=i.url.replace(/^.+\:\/\/[^\/]+/,""),this._setupTile(i))}catch(s){o.logDebug("Branded Content Tile Failed to parse JSON data")}},_setupEvergreen:function(){var e=s.getNested(window.site_vars,"ADS","branded_content_tile","evergreen"),t='<li class="hgpm-item partner-tile" itemscope="" itemtype="https://schema.org/<%= section %>Article" data-asset-position="9" data-asset-id="<%= asset_id %>"><a itemprop="url" class="hgpm-link hgpm-image-link hgpm-link-9 hgpm-link-col-first <%= section %>-theme-bg-hover <%= section %>-theme-border-hover js-asset-link" href="<%= url %>" data-track-label="hedgrid_9" data-asset-id="<%= asset_id %>"><span class="hgpm-grid-wrap js-grid-wrap"><span class="js-asset-section theme-bg-ssts-label hgsm-ssts-label-top-left placeholder-bg <%= section %>-theme-bg"><%= section_title %> <%= sponsor %></span><span class="hgpm-image-gradient"></span><div class="hgpfm-image js-asset-image" itemprop="image" data-crop="1_1" style="background-image:url(<%= image %>)"></div><span class="hgpm-image-hed-wrap hgpm-image-text-hed-wrap"><span class="hgpm-image-text-hed-icon js-asset-disposable"></span><p itemprop="headline" class="hgpm-image-hed js-asset-headline placeholder-bg "><%= headline %></p></span></span><span class="hgpm-list-wrap js-list-wrap"><span class="hgpm-list-image-wrap"><div class="hgpm-list-image js-asset-image" itemprop="thumbnailUrl" data-crop="16_9" style="background-image:url(<%= image %>)"></div><span class="hgpm-image-text-hed-icon js-asset-disposable"></span></span><span class="hgpm-list-text "><span itemprop="headline" class="hgpm-list-hed js-asset-headline placeholder-bg"><%= headline %></span><span class="hgpm-back-listview-text js-asset-description placeholder-bg" data-fulltext="<%= promobrief %>"><%= promobrief %></span><ul class="hgpm-meta"><li itemprop="articleSection" class="hgpm-section <%= section %>-theme-color "><span class="js-asset-section theme-bg-ssts-label hgpm-ssts-label-listview placeholder-bg <%= section %>-theme-color default-theme-color"><%= section_title %> <%= sponsor %></span></li></ul></span></span></a></li>',i='<a class="hgpfm-link hgpfm-image-link hgpfm-link-4 <%= section %>-theme-bg-hover <%= section %>-theme-border-hover js-asset-link partner-tile" href="<%= url %>" data-ht="hedgrid2_4" data-asset-position="4" data-asset-id="<%= asset_id %>"><span class="js-asset-section theme-bg-ssts-label hgsm-ssts-label-top-left <%= section %>-theme-bg"><%= section_title %> <%= sponsor %></span><span class="hgpfm-image-gradient"></span><div class="hgpfm-image-wrap"><div class="hgpfm-image js-asset-image placeholder-hide" style="background-image:url(<%= image %>)"></div></div><div class="hgpfm-image-hed-wrap hgpfm-image-text-hed-wrap"><span class="hgpfm-image-text-hed-icon js-asset-disposable"></span><p class="hgpfm-image-hed js-asset-headline placeholder-hide"><%= headline %></p></div></a>';clearTimeout(this.evergreenTO),e&&(e.template="flexCard"===this.options.layout?i:t,this._setupTile(e))},_setupTile:function(i){var s=t.template(i.template),n=e(s(i));this.setup||(this.setup=!0,i.clickUrl&&n.on("click",function(){e("<img />").attr("src",i.clickUrl)}),i.click&&n.on("click",function(){/<[a-z][\s\S]*>/i.test(i.click)?e(i.click):e("<img />").attr("src",i.click)}),this.$placeholder.hide().after(n))},destroy:function(e){this.$el.parent().children(".partner-tile, .mediavoice-native-ad").remove(),this.$placeholder.show(),window.removeEventListener("message",this._onSafeFrameMsg,!1),clearInterval(this.msgInt),i.prototype.destroy.call(this,e)}});return a}),define("template-utils",["jquery","underscore","utils"],function(e,t,i){"use strict";var s=function(){this.relUrlExp=new RegExp("https?://(www.)?("+i.getNested(window.site_vars,"base_url")+"|usatoday.com)"),this.sectionNames=e.extend({tv:"TV",mmajunkie:"MMAjunkie",ftw:"For The Win",entertainthis:"Entertain This!",usatodaycollege:"USA TODAY College",roadwarriorvoices:"Road Warrior Voices"},i.getNested(window,"section_display_names"))};return s.prototype={getDisplaySection:function(e){if(e){var t=e.split("/");return e=t.length>1?t[1]:t[0],e in this.sectionNames&&(e=this.sectionNames[e]),e.replace(/-/g," ")}return""},getCroppedImage:function(e,i,s,n,o,a){if(t.isObject(n)&&o&&n[o]&&-1!==n[o].indexOf("www.gannett-cdn.com/-mm-/"))return this.resizeImageFastly(n[o],i,s,a);if(e){if(-1!==e.indexOf("www.gannett-cdn.com/-mm-/"))return this.resizeImageFastly(e,i,s,a);if(-1!==e.indexOf("wordpress.com"))return this.cropImageWP(e,i,s)}return e},cropImageWP:function(e,t,i){return e.replace(/\?.*/,"")+"?w="+t+"&h="+i+"&crop=1"},resizeImageFastly:function(e,t,i,s){return e+"?"+(s?s:"width="+t+"&height="+i+"&fit=bounds")},getAssetIdsFromAssets:function(i){return t.chain(i).map(function(t){return e(t).attr("data-wp-asset-id")||e(t).attr("data-asset-id")}).filter(function(e){return void 0!==e}).value()},smartTruncate:function(e,t,i){if(e&&t){if(e.length<=t)return e;i=i||"&hellip;";var s=e.lastIndexOf(" ",t-1),n=s>0?s:t;return e.substr(0,n)+i}},relativizeUrl:function(e,t){t=t||this.relUrlExp;try{e=e.replace(t,"")}catch(i){}return e}},new s}),define("analytics/settealium",["jquery","underscore","pubsub","fwinfo","utils","managers/routemanager","user-manager"],function(e,t,i,s,n,o,a){"use strict";function r(e,t){c?c.push([e,t]):l(e,t)}function l(e,t){for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var s=""+t[i];"eVar"===s.substring(0,4)||i.match("gupUAID|gupInsights|contributorNames|contributorIds")||(t[i]=s.toLowerCase())}window.utag.track(e,t)}function h(e){if(-1!==e.indexOf("|")){var t="n/a",i=[d.contenttype||t,d.section||t,e];e=i.join("|")}return e}var d={},c=[],u=function(){window.tealium_url&&this.initialize(window.tealium_url)};u.prototype={initialize:function(e){this.data={},this.pubSub={"analytics:pageload:tealium":this.page_load,heattrack:this.heattrack,freetrialtrack:this.freetrialtrack,"slide:change":this.slide_change,"user:logout":this.clear_user_data,uotrack:this.uotrack,"video:load":this.video_load,track:this.track,vitrack:this.vitrack,newslettertrack:this.newslettertrack,"userUtil:personal_link":this.user_util_personal_link,group_page_view:this.group_page_view,product_name:this.product_name},this.hashRegExp=/\bht=([^&]*)/,this.cspRegExp=/[?&]csp=([^&]*)/i,this.gcionidRegExp=/\bGCIONID=([^;]*)/,this.daysArr=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],i.attach(this.pubSub,this),n.loadScript(e,"utag").done(function(e){t.each(c,function(e){l(e[0],e[1])}),c=null}).fail(t.bind(function(){c=null,this.destroy()},this))},ready:function(){},destroy:function(){i.unattach(this.pubSub,this)},relevant_data:function(e,i){var o,a,r=this._getCstList(e.cst),l=this._getSstsList(e.ssts),h=this._getHashValue(),d=e.prevPvParams||{},c=e.user||{},u=c.abTest||{},f=e.prevPageInfo||{};this.clickName=h||s.getandclearsessionvalue("clickName"),this.clickPage=s.getandclearsessionvalue("clickPage"),"gallery-cinematic"===e.basePageType&&"videopage"===e.contenttype&&(e.contenttype="videopage gallery");try{o=t.map(e.contributors,function(e){return e.DisplayName}).join(",")}catch(g){}try{a=t.map(e.contributors,function(e){return e.Id}).join(",")}catch(g){}return{assetid:e.assetid,atyponuserid:p.data.atypon_id,blogname:e.blogname||"",brandview_sponsor:e.sponsorname||"",byline:e.byline||"",category:r[0],contenttype:e.contenttype,content_protection_state:e.content_protection_state||"",contributorNames:o||"",contributorIds:a||"",cst:r.slice(0,3).join(":"),dayofweek:this._getDayOfWeek(),eventtype:i,gcionid:this._getGcionId(),halfhour:this._getHalfHour(),linkTrackVars:"prop1",numPageViewsLeft:e.numPageViewsLeft,pathName:e.pathName||"",priority_asset:e.priority_asset||"",published_date:e.published_date||"",referrerhost:h?document.referrer.split("/")[2]:"",refreshed:e.refreshed||"",searchkeywords:e.searchkeywords,section:l[0],ssts:l.join(":"),subcategory:r.slice(0,2).join(":"),subsection:l.slice(0,2).join(":"),templatetype:e.templatetype,topic:l.slice(0,3).join(":"),typeofday:this._getTypeOfDay(),user_status:p.data.user_status||"",coreuserid:p.data.core_user_id||"",videoincluded:e.videoincluded||"no",taxonomykeywords:e.taxonomykeywords||"",gallerytitle:e.gallerytitle||"",galleryindex:e.galleryindex||"",queryparamtrack:this._getCspValue()||"",viralVideoDomain:"",videoContentProvider:"",videoFulllengthUrl:"",videoName:"",videoPlayerName:"",videoOrigin:"",keywords:"",videoDuration:"",milestonetrack:"",videotranscript:"",noinitialanalytics:e.noinitialanalytics||"",embedded:e.embedded||"",abTestSlot:c.abTestSlot,abTestId:u.id,abTestVariant:n.getNested(u,"userVariant","id"),gupPersonaSegment:p.data.gupPersonaSegment||void 0,gupRootDomain:n.getNested(window.site_vars,"base_url")||"",gupUAID:n.getNested(window.site_vars,"site_code")+"-GUP"||"",feedStories:"story pages"===e.contenttype?s.getandclearsessionvalue("feedStories"):void 0,clickName:this.clickName,clickPage:this.clickPage,percentage_page_viewed:s.getandclearsessionvalue("percentagePageViewed"),clickAbTestId:d.abTestId,clickAbTestVariant:d.abTestVariant,clickPinType:d.pinType,prevpath:s.getandclearsessionvalue("prevpath"),prevAbTestId:n.getNested(f,"user","abTest","id"),prevAbTestVariant:n.getNested(f,"user","abTest","userVariant","id")}},clear_user_data:function(){p.data={}},page_load:function(e){var t;e.noinitialanalytics||(d=t=p.relevant_data(e,"page:load"),s.setsessionvalue("prevpath",document.location.pathname),a.getUserAttributes("firefly").then(function(e){p.data.gupPersonaSegment=t.gupPersonaSegment=n.getNested(e,"userAttributes","personaSegment"),p.data.for_guid=t.for_guid=n.getNested(e,"personalizedLinkData","forGuid"),p.data.for_guid_session=t.for_guid_session=n.getNested(e,"personalizedLinkData","forGuidSession"),"ClientHelpers"in window&&(p.data.gup_clientid=t.gup_clientid=window.ClientHelpers.getClientId())}).always(function(){var e=a.getAccount("firefly"),i=n.getNested(e,"user","userInfo","response","insights");if(i){for(var s=Object.keys(i),o=0;o<s.length;o++){var l=s[o],h="gupInsights_"+l;if("object"==typeof i[l]){if(null!==i[l])continue;i[l]="null"}p.data[h]=t[h]=i[l].toString()}window.localStorage.setItem("user_insights",JSON.stringify(i))}else window.localStorage.setItem("user_insights",JSON.stringify({}));"loggingIn"===a.getLoginStatus()||"loggedIn"===a.getLoginStatus()?a.getCoreUserInfo().then(function(i){p.data.atypon_id=t.atyponuserid=i.AtyponId,p.data.core_user_id=t.coreuserid=i.CoreUserId,p.data.user_status=t.user_status=i.UserLicenseType,n.getNested(e,"user","hasMarketAccess")&&(p.data.numPageViewsLeft=t.numPageViewsLeft="authorized"),r("view",t)},function(){r("view",t)}):(p.data.user_status=t.user_status="none",r("view",t))}))},track:function(e){e=e||{};var t=e.url,i=this._getLabel(e.event,e.label);this.setPageDepth(),t&&o.getInfo(t)?this.heattrack(i):i&&this.uotrack(i)},setPageDepth:function(){var e=Math.floor((n.getScrollPosition()+window.innerHeight)/document.body.clientHeight*100);s.setsessionvalue("percentagePageViewed",e)},_getLabel:function(t,i){if(t){var s=e(t.currentTarget);return s.data("trackLabel")||s.data("uotrack")||s.data("ht")||i}return i},uotrack:function(e){"string"!=typeof e&&(console.error("uotrack has been given a non-string event argument",e),e=(e||{}).prop41||"somethingbad");var t=e.match(/{% *[a-z0-9_]* *%}/gi);if(t)for(var i=0;i<t.length;i++){var s=t[i],n=s.match(/{% *([a-z0-9_]*) *%}/)&&RegExp.$1;e=e.replace(s,d[n])}r("link",{clickName:h(e),clickPage:location.href,eventtype:"uotrack",linkTrackEvents:"None",linkTrackVars:"prop41,prop64"})},vitrack:function(e){"object"!=typeof e&&(console.error("vitrack has been given a non-object event argument",e),e=(e||{}).prop9||"somethingbad"),r("link",{milestonetrack:e.percentage,eventtype:"vitrack",linkTrackEvents:"None",linkTrackVars:"prop9",video_url:e.video_url})},group_page_view:function(e){r("link",{group_page:e,eventtype:"group_page_view",linkTrackEvents:"None",linkTrackVars:"eVar99"})},product_name:function(e){r("link",{product_name:e,eventtype:"product_name",linkTrackEvents:"None",linkTrackVars:"eVar66"})},freetrialtrack:function(e){r("link",{free_trial:e,eventtype:"freetrial",linkTrackEvents:"event78",linkTrackVars:"None"})},user_util_personal_link:function(e){r("link",{gup_personal_link:e,eventtype:"gup-personal-link",linkTrackEvents:"None",linkTrackVars:"eVar63"})},newslettertrack:function(e){r("newsltr-signup",{fbid:e})},heattrack:function(e){e&&(e=h(e),s.setsessionvalue("clickName",e)),s.setsessionvalue("clickPage",location.href)},slide_change:function(e){var i,n;try{i=e.cst.split("/"),n=e.ssts.split("/")}catch(o){return void console.error("Invalid page",o.stack||o.stacktrace||o.message)}r("view",t.extend(d,{byline:e.byline||"",clickName:s.getandclearsessionvalue("clickName"),clickPage:window.location.protocol+"//"+window.location.host+e.pathName,contenttype:e.contenttype,videoincluded:e.videoincluded||"no",gallerytitle:e.gallery_title,galleryindex:e.gallery_index,assetid:e.gallery_id,eventtype:"slide:change",templatetype:"",category:i[0],cst:i.slice(0,3).join(":"),published_date:e.publishedDate||"",refreshed:"",section:n[0],ssts:n.join(":"),subcategory:i.slice(0,2).join(":"),subsection:n.slice(0,2).join(":"),topic:n.slice(0,3).join(":"),pathName:e.pathName||"",viralVideoDomain:"",videoContentProvider:"",videoFulllengthUrl:"",videoName:"",videoDuration:"",videoPlayerName:"",keywords:"",milestonetrack:"",videotranscript:""}))},video_load:function(e){r("view",t.extend(d,{byline:e.byline||"",clickName:this._getHashValue()||s.getandclearsessionvalue("clickName"),clickPage:s.getandclearsessionvalue("clickPage"),category:e.category||"",cst:e.cst||"",assetid:e.assetid||"",published_date:e.publishedDate||"",refreshed:"",section:e.section||"",ssts:e.ssts||"",subcategory:e.subcategory||"",subsection:e.subsection||"",topic:e.topic||"",videoPlayerName:e.videoplayername||"",prevpath:s.getandclearsessionvalue("prevpath"),completion:e.completion||"",keywords:e.keywords||"",taxonomykeywords:e.keywords||"",contenttype:e.contenttype||"",videoName:e.videoName||"",videoDuration:e.videoDuration||"",eventtype:e.eventtype||"",pathName:e.pathName||"",videoContentID:e.contentid||"",viralVideoDomain:e.viralVideoDomain||"",videoContentProvider:e.videocontentprovider||"",templatetype:e.templatetype||"",noinitialanalytics:!1,videoincluded:"yes",videoFulllengthUrl:e.videoFulllengthUrl||"",milestonetrack:e.milestonetrack||"",videotranscript:e.videotranscript||"",videoOrigin:e.videoOrigin||""})),s.setsessionvalue("prevpath",document.location.pathname)},_getHalfHour:function(){var e=new Date(18e5*parseInt((new Date).getTime()/18e5,10)),t=e.getHours();return 1+(t+11)%12+":"+function(e){return e.substr(e.length-2)}("0"+e.getMinutes())+(t>11?" pm":" am")},_getHashValue:function(){return location.hash.match(this.hashRegExp)&&RegExp.$1},_getCspValue:function(){return window.location.search.match(this.cspRegExp)&&RegExp.$1},_getCstList:function(e){return e.replace(/\/\/*$/,"").split("/")},_getSstsList:function(e){return e?e.split("/"):[]},_getGcionId:function(){return document.cookie.match(this.gcionidRegExp)&&RegExp.$1},_getDayOfWeek:function(){return this.daysArr[(new Date).getDay()]},_getTypeOfDay:function(){return((new Date).getDay()+8)%7>1?"weekday":"weekend"}};var p=new u;
return p}),define("third_party_integrations/pong/pong-utils",["jquery","underscore","utils","pubsub"],function(e,t,i,s){"use strict";var n=function(){this.rootUrl=i.getNested(window.site_vars,"THIRDPARTYAPI","PONG","url"),this.pubSub={"analytics:event:pong":this.logCustomEvent},this.start()};return n.prototype={start:function(){s.attach(this.pubSub,this)},stop:function(){s.unattach(this.pubSub,this)},logCustomEvent:function(e){if(!t.isEmpty(e)&&"abTestImpression"==e.eventType&&!e.abTestFail){var i={};e.abTestId&&(i.abId=e.abTestId),e.abTestVariant&&(i.abVar=e.abTestVariant),this.logAbTestImpression(i)}},logAbTestImpression:function(t){var i=new Image;i.src=this.rootUrl+"events?eventType=abImpr&"+e.param(t)}},new n}),define("api/analytics",["jquery","underscore","pubsub","utils","fwinfo","analytics/settealium","third_party_integrations/pong/pong-utils","cookie"],function(e,t,i,s,n){"use strict";var o=function(){t.bindAll(this,"_onActivePageInfoSet","_onAnalyticsClick"),this.pubSub={"page:load":this.trackPageView,"site:refresh":this._onSiteRefresh,"activePageInfo:set":this._onActivePageInfoSet,"analytics:pageload":this.trackPageView,"analytics:event":this.trackCustomEvent},this.providersEnabled=window.site_vars?s.getNested(window.site_vars,"analytics")||[]:["tealium"],this.start()};return o.prototype={start:function(){i.attach(this.pubSub,this)},stop:function(){i.unattach(this.pubSub,this)},_onActivePageInfoSet:function(e){return e.prevPvParams=this.getPrevPvParamsFromCookie()||{},this.removePrevPvParamsCookie(),e.prevPageInfo=n.getAndClearPersistentSessionValue("prevPageInfo")||{},n.setPersistentSessionValue("prevPageInfo",t.omit(e,["prevPageInfo","prevPvParams","js_modules","abtests","asset_collection","share_imgs"])),e.noinitialanalytics||(e.refreshed=n.getandclearsessionvalue("refreshed")),e},_onSiteRefresh:function(e){n.setsessionvalue("refreshed",e)},trackEvent:function(e,t){i.trigger("track",{label:e,url:t})},trackPageView:function(e,s,n){return e=t.chain({awspath:"undefined",ssts:"bugpages",cst:"undefined",contenttype:e.contentType||"undefined"}).extend(e).omit("contentType").value(),s=this._getAnalyticsProviders(s,n),t.each(s,function(t){i.trigger("analytics:pageload:"+t,e)},this),e},trackCustomEvent:function(e,s,n){e=this._getAnalyticsProviders(e,n),t.each(e,function(e){i.trigger("analytics:event:"+e,s)})},addAnalyticsToLink:function(i,s,n,o){n=n||{};var a=e(i),r=a.data("analytics")||{};s=this._getAnalyticsProviders(s,o),r.providers&&(s=t.union(s,r.providers)),a.data("analytics",{providers:s,params:t.extend(n,r.params)}).off("click.analytics").on("click.analytics",this._onAnalyticsClick)},_onAnalyticsClick:function(n){var o=e(n.currentTarget),a=o.data("analytics")||{};"/"===o.attr("href").charAt(0)?this.setPrevPvParamsCookie(a.params):o.attr("href",s.appendHashParams(o.attr("href"),a.params)),t.each(a.providers,function(e){i.trigger("analytics:click:"+e,n,a.params)},this)},setPrevPvParamsCookie:function(i){var s=this.getPrevPvParamsFromCookie();s&&(i=t.extend(s,i)),e.cookie("pv_params",JSON.stringify(i),{expires:.003,path:"/"})},getPrevPvParamsFromCookie:function(){try{return JSON.parse(e.cookie("pv_params"))}catch(t){}},removePrevPvParamsCookie:function(){e.removeCookie("pv_params",{path:"/"})},_getAnalyticsProviders:function(e,i){return e&&(t.isString(e)&&(e=[e]),i||(e=t.filter(e,function(e){return t.contains(this.providersEnabled,e)},this))),e||this.providersEnabled}},new o}),define("third_party_integrations/taboola/taboola-utils",["jquery","underscore","utils","pubsub","api/analytics"],function(e,t,i,s,n){"use strict";var o=function(){this.pubSub={"analytics:click:taboola":this._onAnalyticsClick},this.start()};return o.prototype={start:function(){s.attach(this.pubSub,this)},stop:function(){s.unattach(this.pubSub,this)},_onAnalyticsClick:function(t,i){var s=e(t.currentTarget);s.data("taboola-click-pixel")&&e.get(s.data("taboola-click-pixel"))},addLinkData:function(t,i){e(t).data("taboola-click-pixel",i),n.addAnalyticsToLink(t,"taboola")}},new o}),!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("libs/moment/moment.min",t):e.moment=t()}(this,function(){"use strict";function e(){return os.apply(null,arguments)}function t(e){os=e}function i(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function n(e,t){var i,s=[];for(i=0;i<e.length;++i)s.push(t(e[i],i));return s}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t){for(var i in t)o(t,i)&&(e[i]=t[i]);return o(t,"toString")&&(e.toString=t.toString),o(t,"valueOf")&&(e.valueOf=t.valueOf),e}function r(e,t,i,s){return Ne(e,t,i,s,!0).utc()}function l(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function h(e){return null==e._pf&&(e._pf=l()),e._pf}function d(e){if(null==e._isValid){var t=h(e),i=as.call(t.parsedDateParts,function(e){return null!=e});e._isValid=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i),e._strict&&(e._isValid=e._isValid&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)}return e._isValid}function c(e){var t=r(NaN);return null!=e?a(h(t),e):h(t).userInvalidated=!0,t}function u(e){return void 0===e}function p(e,t){var i,s,n;if(u(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),u(t._i)||(e._i=t._i),u(t._f)||(e._f=t._f),u(t._l)||(e._l=t._l),u(t._strict)||(e._strict=t._strict),u(t._tzm)||(e._tzm=t._tzm),u(t._isUTC)||(e._isUTC=t._isUTC),u(t._offset)||(e._offset=t._offset),u(t._pf)||(e._pf=h(t)),u(t._locale)||(e._locale=t._locale),rs.length>0)for(i in rs)s=rs[i],n=t[s],u(n)||(e[s]=n);return e}function f(t){p(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),ls===!1&&(ls=!0,e.updateOffset(this),ls=!1)}function g(e){return e instanceof f||null!=e&&null!=e._isAMomentObject}function m(e){return 0>e?Math.ceil(e):Math.floor(e)}function v(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=m(t)),i}function b(e,t,i){var s,n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(s=0;n>s;s++)(i&&e[s]!==t[s]||!i&&v(e[s])!==v(t[s]))&&a++;return a+o}function y(t){e.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function w(t,i){var s=!0;return a(function(){return null!=e.deprecationHandler&&e.deprecationHandler(null,t),s&&(y(t+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),s=!1),i.apply(this,arguments)},i)}function _(t,i){null!=e.deprecationHandler&&e.deprecationHandler(t,i),hs[t]||(y(i),hs[t]=!0)}function C(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function S(e){return"[object Object]"===Object.prototype.toString.call(e)}function x(e){var t,i;for(i in e)t=e[i],C(t)?this[i]=t:this["_"+i]=t;this._config=e,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function k(e,t){var i,s=a({},e);for(i in t)o(t,i)&&(S(e[i])&&S(t[i])?(s[i]={},a(s[i],e[i]),a(s[i],t[i])):null!=t[i]?s[i]=t[i]:delete s[i]);return s}function T(e){null!=e&&this.set(e)}function $(e){return e?e.toLowerCase().replace("_","-"):e}function A(e){for(var t,i,s,n,o=0;o<e.length;){for(n=$(e[o]).split("-"),t=n.length,i=$(e[o+1]),i=i?i.split("-"):null;t>0;){if(s=P(n.slice(0,t).join("-")))return s;if(i&&i.length>=t&&b(n,i,!0)>=t-1)break;t--}o++}return null}function P(e){var t=null;if(!ps[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=cs._abbr,require("./locale/"+e),D(t)}catch(i){}return ps[e]}function D(e,t){var i;return e&&(i=u(t)?E(e):I(e,t),i&&(cs=i)),cs._abbr}function I(e,t){return null!==t?(t.abbr=e,null!=ps[e]?(_("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale"),t=k(ps[e]._config,t)):null!=t.parentLocale&&(null!=ps[t.parentLocale]?t=k(ps[t.parentLocale]._config,t):_("parentLocaleUndefined","specified parentLocale is not defined yet")),ps[e]=new T(t),D(e),ps[e]):(delete ps[e],null)}function M(e,t){if(null!=t){var i;null!=ps[e]&&(t=k(ps[e]._config,t)),i=new T(t),i.parentLocale=ps[e],ps[e]=i,D(e)}else null!=ps[e]&&(null!=ps[e].parentLocale?ps[e]=ps[e].parentLocale:null!=ps[e]&&delete ps[e]);return ps[e]}function E(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return cs;if(!i(e)){if(t=P(e))return t;e=[e]}return A(e)}function L(){return ds(ps)}function N(e,t){var i=e.toLowerCase();fs[i]=fs[i+"s"]=fs[t]=e}function F(e){return"string"==typeof e?fs[e]||fs[e.toLowerCase()]:void 0}function O(e){var t,i,s={};for(i in e)o(e,i)&&(t=F(i),t&&(s[t]=e[i]));return s}function R(t,i){return function(s){return null!=s?(j(this,t,s),e.updateOffset(this,i),this):B(this,t)}}function B(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function j(e,t,i){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](i)}function z(e,t){var i;if("object"==typeof e)for(i in e)this.set(i,e[i]);else if(e=F(e),C(this[e]))return this[e](t);return this}function H(e,t,i){var s=""+Math.abs(e),n=t-s.length,o=e>=0;return(o?i?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+s}function V(e,t,i,s){var n=s;"string"==typeof s&&(n=function(){return this[s]()}),e&&(bs[e]=n),t&&(bs[t[0]]=function(){return H(n.apply(this,arguments),t[1],t[2])}),i&&(bs[i]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function U(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t,i,s=e.match(gs);for(t=0,i=s.length;i>t;t++)bs[s[t]]?s[t]=bs[s[t]]:s[t]=U(s[t]);return function(t){var n,o="";for(n=0;i>n;n++)o+=s[n]instanceof Function?s[n].call(t,e):s[n];return o}}function q(e,t){return e.isValid()?(t=G(t,e.localeData()),vs[t]=vs[t]||W(t),vs[t](e)):e.localeData().invalidDate()}function G(e,t){function i(e){return t.longDateFormat(e)||e}var s=5;for(ms.lastIndex=0;s>=0&&ms.test(e);)e=e.replace(ms,i),ms.lastIndex=0,s-=1;return e}function Y(e,t,i){Fs[e]=C(t)?t:function(e,s){return e&&i?i:t}}function X(e,t){return o(Fs,e)?Fs[e](t._strict,t._locale):new RegExp(Z(e))}function Z(e){return J(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,s,n){return t||i||s||n}))}function J(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function K(e,t){var i,s=t;for("string"==typeof e&&(e=[e]),"number"==typeof t&&(s=function(e,i){i[t]=v(e)}),i=0;i<e.length;i++)Os[e[i]]=s}function Q(e,t){K(e,function(e,i,s,n){s._w=s._w||{},t(e,s._w,s,n)})}function ee(e,t,i){null!=t&&o(Os,e)&&Os[e](t,i._a,i,e)}function te(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ie(e,t){return i(this._months)?this._months[e.month()]:this._months[Gs.test(t)?"format":"standalone"][e.month()]}function se(e,t){return i(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Gs.test(t)?"format":"standalone"][e.month()]}function ne(e,t,i){var s,n,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;12>s;++s)o=r([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(o,"").toLocaleLowerCase();return i?"MMM"===t?(n=us.call(this._shortMonthsParse,a),-1!==n?n:null):(n=us.call(this._longMonthsParse,a),-1!==n?n:null):"MMM"===t?(n=us.call(this._shortMonthsParse,a),-1!==n?n:(n=us.call(this._longMonthsParse,a),-1!==n?n:null)):(n=us.call(this._longMonthsParse,a),-1!==n?n:(n=us.call(this._shortMonthsParse,a),-1!==n?n:null))}function oe(e,t,i){var s,n,o;if(this._monthsParseExact)return ne.call(this,e,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;12>s;s++){if(n=r([2e3,s]),i&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),i||this._monthsParse[s]||(o="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[s]=new RegExp(o.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(i&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!i&&this._monthsParse[s].test(e))return s}}function ae(e,t){var i;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=v(t);else if(t=e.localeData().monthsParse(t),"number"!=typeof t)return e;return i=Math.min(e.date(),te(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function re(t){return null!=t?(ae(this,t),e.updateOffset(this,!0),this):B(this,"Month")}function le(){return te(this.year(),this.month())}function he(e){return this._monthsParseExact?(o(this,"_monthsRegex")||ce.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex}function de(e){return this._monthsParseExact?(o(this,"_monthsRegex")||ce.call(this),e?this._monthsStrictRegex:this._monthsRegex):this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex}function ce(){function e(e,t){return t.length-e.length}var t,i,s=[],n=[],o=[];for(t=0;12>t;t++)i=r([2e3,t]),s.push(this.monthsShort(i,"")),n.push(this.months(i,"")),o.push(this.months(i,"")),o.push(this.monthsShort(i,""));for(s.sort(e),n.sort(e),o.sort(e),t=0;12>t;t++)s[t]=J(s[t]),n[t]=J(n[t]),o[t]=J(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function ue(e){var t,i=e._a;return i&&-2===h(e).overflow&&(t=i[Bs]<0||i[Bs]>11?Bs:i[js]<1||i[js]>te(i[Rs],i[Bs])?js:i[zs]<0||i[zs]>24||24===i[zs]&&(0!==i[Hs]||0!==i[Vs]||0!==i[Us])?zs:i[Hs]<0||i[Hs]>59?Hs:i[Vs]<0||i[Vs]>59?Vs:i[Us]<0||i[Us]>999?Us:-1,h(e)._overflowDayOfYear&&(Rs>t||t>js)&&(t=js),h(e)._overflowWeeks&&-1===t&&(t=Ws),h(e)._overflowWeekday&&-1===t&&(t=qs),h(e).overflow=t),e}function pe(e){var t,i,s,n,o,a,r=e._i,l=Ks.exec(r)||Qs.exec(r);if(l){for(h(e).iso=!0,t=0,i=tn.length;i>t;t++)if(tn[t][1].exec(l[1])){n=tn[t][0],s=tn[t][2]!==!1;break}if(null==n)return void(e._isValid=!1);if(l[3]){for(t=0,i=sn.length;i>t;t++)if(sn[t][1].exec(l[3])){o=(l[2]||" ")+sn[t][0];break}if(null==o)return void(e._isValid=!1)}if(!s&&null!=o)return void(e._isValid=!1);if(l[4]){if(!en.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=n+(o||"")+(a||""),Ae(e)}else e._isValid=!1}function fe(t){var i=nn.exec(t._i);return null!==i?void(t._d=new Date(+i[1])):(pe(t),void(t._isValid===!1&&(delete t._isValid,e.createFromInputFallback(t))))}function ge(e,t,i,s,n,o,a){var r=new Date(e,t,i,s,n,o,a);return 100>e&&e>=0&&isFinite(r.getFullYear())&&r.setFullYear(e),r}function me(e){var t=new Date(Date.UTC.apply(null,arguments));return 100>e&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function ve(e){return be(e)?366:365}function be(e){return e%4===0&&e%100!==0||e%400===0}function ye(){return be(this.year())}function we(e,t,i){var s=7+t-i,n=(7+me(e,0,s).getUTCDay()-t)%7;return-n+s-1}function _e(e,t,i,s,n){var o,a,r=(7+i-s)%7,l=we(e,s,n),h=1+7*(t-1)+r+l;return 0>=h?(o=e-1,a=ve(o)+h):h>ve(e)?(o=e+1,a=h-ve(e)):(o=e,a=h),{year:o,dayOfYear:a}}function Ce(e,t,i){var s,n,o=we(e.year(),t,i),a=Math.floor((e.dayOfYear()-o-1)/7)+1;return 1>a?(n=e.year()-1,s=a+Se(n,t,i)):a>Se(e.year(),t,i)?(s=a-Se(e.year(),t,i),n=e.year()+1):(n=e.year(),s=a),{week:s,year:n}}function Se(e,t,i){var s=we(e,t,i),n=we(e+1,t,i);return(ve(e)-s+n)/7}function xe(e,t,i){return null!=e?e:null!=t?t:i}function ke(t){var i=new Date(e.now());return t._useUTC?[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]:[i.getFullYear(),i.getMonth(),i.getDate()]}function Te(e){var t,i,s,n,o=[];if(!e._d){for(s=ke(e),e._w&&null==e._a[js]&&null==e._a[Bs]&&$e(e),e._dayOfYear&&(n=xe(e._a[Rs],s[Rs]),e._dayOfYear>ve(n)&&(h(e)._overflowDayOfYear=!0),i=me(n,0,e._dayOfYear),e._a[Bs]=i.getUTCMonth(),e._a[js]=i.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=o[t]=s[t];for(;7>t;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[zs]&&0===e._a[Hs]&&0===e._a[Vs]&&0===e._a[Us]&&(e._nextDay=!0,e._a[zs]=0),e._d=(e._useUTC?me:ge).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[zs]=24)}}function $e(e){var t,i,s,n,o,a,r,l;t=e._w,null!=t.GG||null!=t.W||null!=t.E?(o=1,a=4,i=xe(t.GG,e._a[Rs],Ce(Fe(),1,4).year),s=xe(t.W,1),n=xe(t.E,1),(1>n||n>7)&&(l=!0)):(o=e._locale._week.dow,a=e._locale._week.doy,i=xe(t.gg,e._a[Rs],Ce(Fe(),o,a).year),s=xe(t.w,1),null!=t.d?(n=t.d,(0>n||n>6)&&(l=!0)):null!=t.e?(n=t.e+o,(t.e<0||t.e>6)&&(l=!0)):n=o),1>s||s>Se(i,o,a)?h(e)._overflowWeeks=!0:null!=l?h(e)._overflowWeekday=!0:(r=_e(i,s,n,o,a),e._a[Rs]=r.year,e._dayOfYear=r.dayOfYear)}function Ae(t){if(t._f===e.ISO_8601)return void pe(t);t._a=[],h(t).empty=!0;var i,s,n,o,a,r=""+t._i,l=r.length,d=0;for(n=G(t._f,t._locale).match(gs)||[],i=0;i<n.length;i++)o=n[i],s=(r.match(X(o,t))||[])[0],s&&(a=r.substr(0,r.indexOf(s)),a.length>0&&h(t).unusedInput.push(a),r=r.slice(r.indexOf(s)+s.length),d+=s.length),bs[o]?(s?h(t).empty=!1:h(t).unusedTokens.push(o),ee(o,s,t)):t._strict&&!s&&h(t).unusedTokens.push(o);h(t).charsLeftOver=l-d,r.length>0&&h(t).unusedInput.push(r),h(t).bigHour===!0&&t._a[zs]<=12&&t._a[zs]>0&&(h(t).bigHour=void 0),h(t).parsedDateParts=t._a.slice(0),h(t).meridiem=t._meridiem,t._a[zs]=Pe(t._locale,t._a[zs],t._meridiem),Te(t),ue(t)}function Pe(e,t,i){var s;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?(s=e.isPM(i),s&&12>t&&(t+=12),s||12!==t||(t=0),t):t}function De(e){var t,i,s,n,o;if(0===e._f.length)return h(e).invalidFormat=!0,void(e._d=new Date(NaN));for(n=0;n<e._f.length;n++)o=0,t=p({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[n],Ae(t),d(t)&&(o+=h(t).charsLeftOver,o+=10*h(t).unusedTokens.length,h(t).score=o,(null==s||s>o)&&(s=o,i=t));a(e,i||t)}function Ie(e){if(!e._d){var t=O(e._i);e._a=n([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),Te(e)}}function Me(e){var t=new f(ue(Ee(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Ee(e){var t=e._i,n=e._f;return e._locale=e._locale||E(e._l),null===t||void 0===n&&""===t?c({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),g(t)?new f(ue(t)):(i(n)?De(e):n?Ae(e):s(t)?e._d=t:Le(e),d(e)||(e._d=null),e))}function Le(t){var o=t._i;void 0===o?t._d=new Date(e.now()):s(o)?t._d=new Date(o.valueOf()):"string"==typeof o?fe(t):i(o)?(t._a=n(o.slice(0),function(e){return parseInt(e,10)}),Te(t)):"object"==typeof o?Ie(t):"number"==typeof o?t._d=new Date(o):e.createFromInputFallback(t)}function Ne(e,t,i,s,n){var o={};return"boolean"==typeof i&&(s=i,i=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=n,o._l=i,o._i=e,o._f=t,o._strict=s,Me(o)}function Fe(e,t,i,s){return Ne(e,t,i,s,!1)}function Oe(e,t){var s,n;if(1===t.length&&i(t[0])&&(t=t[0]),!t.length)return Fe();for(s=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](s))&&(s=t[n]);return s}function Re(){var e=[].slice.call(arguments,0);return Oe("isBefore",e)}function Be(){var e=[].slice.call(arguments,0);return Oe("isAfter",e)}function je(e){var t=O(e),i=t.year||0,s=t.quarter||0,n=t.month||0,o=t.week||0,a=t.day||0,r=t.hour||0,l=t.minute||0,h=t.second||0,d=t.millisecond||0;this._milliseconds=+d+1e3*h+6e4*l+1e3*r*60*60,this._days=+a+7*o,this._months=+n+3*s+12*i,this._data={},this._locale=E(),this._bubble()}function ze(e){return e instanceof je}function He(e,t){V(e,0,0,function(){var e=this.utcOffset(),i="+";return 0>e&&(e=-e,i="-"),i+H(~~(e/60),2)+t+H(~~e%60,2)})}function Ve(e,t){var i=(t||"").match(e)||[],s=i[i.length-1]||[],n=(s+"").match(hn)||["-",0,0],o=+(60*n[1])+v(n[2]);return"+"===n[0]?o:-o}function Ue(t,i){var n,o;return i._isUTC?(n=i.clone(),o=(g(t)||s(t)?t.valueOf():Fe(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+o),e.updateOffset(n,!1),n):Fe(t).local()}function We(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function qe(t,i){var s,n=this._offset||0;return this.isValid()?null!=t?("string"==typeof t?t=Ve(Es,t):Math.abs(t)<16&&(t=60*t),!this._isUTC&&i&&(s=We(this)),this._offset=t,this._isUTC=!0,null!=s&&this.add(s,"m"),n!==t&&(!i||this._changeInProgress?ht(this,st(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?n:We(this):null!=t?this:NaN}function Ge(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Ye(e){return this.utcOffset(0,e)}function Xe(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(We(this),"m")),this}function Ze(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ve(Ms,this._i)),this}function Je(e){return this.isValid()?(e=e?Fe(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function Ke(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Qe(){if(!u(this._isDSTShifted))return this._isDSTShifted;var e={};if(p(e,this),e=Ee(e),e._a){var t=e._isUTC?r(e._a):Fe(e._a);this._isDSTShifted=this.isValid()&&b(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function et(){return this.isValid()?!this._isUTC:!1}function tt(){return this.isValid()?this._isUTC:!1}function it(){return this.isValid()?this._isUTC&&0===this._offset:!1}function st(e,t){var i,s,n,a=e,r=null;return ze(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(a={},t?a[t]=e:a.milliseconds=e):(r=dn.exec(e))?(i="-"===r[1]?-1:1,a={y:0,d:v(r[js])*i,h:v(r[zs])*i,m:v(r[Hs])*i,s:v(r[Vs])*i,ms:v(r[Us])*i}):(r=cn.exec(e))?(i="-"===r[1]?-1:1,a={y:nt(r[2],i),M:nt(r[3],i),w:nt(r[4],i),d:nt(r[5],i),h:nt(r[6],i),m:nt(r[7],i),s:nt(r[8],i)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(n=at(Fe(a.from),Fe(a.to)),a={},a.ms=n.milliseconds,a.M=n.months),s=new je(a),ze(e)&&o(e,"_locale")&&(s._locale=e._locale),s}function nt(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function ot(e,t){var i={milliseconds:0,months:0};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function at(e,t){var i;return e.isValid()&&t.isValid()?(t=Ue(t,e),e.isBefore(t)?i=ot(e,t):(i=ot(t,e),i.milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function rt(e){return 0>e?-1*Math.round(-1*e):Math.round(e)}function lt(e,t){return function(i,s){var n,o;return null===s||isNaN(+s)||(_(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period)."),o=i,i=s,s=o),i="string"==typeof i?+i:i,n=st(i,s),ht(this,n,e),this}}function ht(t,i,s,n){var o=i._milliseconds,a=rt(i._days),r=rt(i._months);t.isValid()&&(n=null==n?!0:n,o&&t._d.setTime(t._d.valueOf()+o*s),a&&j(t,"Date",B(t,"Date")+a*s),r&&ae(t,B(t,"Month")+r*s),n&&e.updateOffset(t,a||r))}function dt(e,t){var i=e||Fe(),s=Ue(i,this).startOf("day"),n=this.diff(s,"days",!0),o=-6>n?"sameElse":-1>n?"lastWeek":0>n?"lastDay":1>n?"sameDay":2>n?"nextDay":7>n?"nextWeek":"sameElse",a=t&&(C(t[o])?t[o]():t[o]);return this.format(a||this.localeData().calendar(o,this,Fe(i)))}function ct(){return new f(this)}function ut(e,t){var i=g(e)?e:Fe(e);return this.isValid()&&i.isValid()?(t=F(u(t)?"millisecond":t),"millisecond"===t?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf()):!1}function pt(e,t){var i=g(e)?e:Fe(e);return this.isValid()&&i.isValid()?(t=F(u(t)?"millisecond":t),"millisecond"===t?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf()):!1}function ft(e,t,i,s){return s=s||"()",("("===s[0]?this.isAfter(e,i):!this.isBefore(e,i))&&(")"===s[1]?this.isBefore(t,i):!this.isAfter(t,i))}function gt(e,t){var i,s=g(e)?e:Fe(e);return this.isValid()&&s.isValid()?(t=F(t||"millisecond"),"millisecond"===t?this.valueOf()===s.valueOf():(i=s.valueOf(),this.clone().startOf(t).valueOf()<=i&&i<=this.clone().endOf(t).valueOf())):!1}function mt(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function vt(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function bt(e,t,i){var s,n,o,a;return this.isValid()?(s=Ue(e,this),s.isValid()?(n=6e4*(s.utcOffset()-this.utcOffset()),t=F(t),"year"===t||"month"===t||"quarter"===t?(a=yt(this,s),"quarter"===t?a/=3:"year"===t&&(a/=12)):(o=this-s,a="second"===t?o/1e3:"minute"===t?o/6e4:"hour"===t?o/36e5:"day"===t?(o-n)/864e5:"week"===t?(o-n)/6048e5:o),i?a:m(a)):NaN):NaN}function yt(e,t){var i,s,n=12*(t.year()-e.year())+(t.month()-e.month()),o=e.clone().add(n,"months");return 0>t-o?(i=e.clone().add(n-1,"months"),s=(t-o)/(o-i)):(i=e.clone().add(n+1,"months"),s=(t-o)/(i-o)),-(n+s)||0}function wt(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function _t(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?C(Date.prototype.toISOString)?this.toDate().toISOString():q(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):q(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function Ct(t){t||(t=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var i=q(this,t);return this.localeData().postformat(i)}function St(e,t){return this.isValid()&&(g(e)&&e.isValid()||Fe(e).isValid())?st({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function xt(e){return this.from(Fe(),e)}function kt(e,t){return this.isValid()&&(g(e)&&e.isValid()||Fe(e).isValid())?st({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Tt(e){return this.to(Fe(),e)}function $t(e){var t;return void 0===e?this._locale._abbr:(t=E(e),null!=t&&(this._locale=t),this)}function At(){return this._locale}function Pt(e){switch(e=F(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function Dt(e){return e=F(e),void 0===e||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function It(){return this._d.valueOf()-6e4*(this._offset||0)}function Mt(){return Math.floor(this.valueOf()/1e3)}function Et(){return this._offset?new Date(this.valueOf()):this._d}function Lt(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Nt(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Ft(){return this.isValid()?this.toISOString():null}function Ot(){return d(this)}function Rt(){return a({},h(this))}function Bt(){return h(this).overflow}function jt(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function zt(e,t){V(0,[e,e.length],0,t)}function Ht(e){return qt.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Vt(e){return qt.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Ut(){return Se(this.year(),1,4)}function Wt(){var e=this.localeData()._week;return Se(this.year(),e.dow,e.doy)}function qt(e,t,i,s,n){var o;return null==e?Ce(this,s,n).year:(o=Se(e,s,n),t>o&&(t=o),Gt.call(this,e,t,i,s,n))}function Gt(e,t,i,s,n){var o=_e(e,t,i,s,n),a=me(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Yt(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Xt(e){return Ce(e,this._week.dow,this._week.doy).week}function Zt(){return this._week.dow}function Jt(){return this._week.doy}function Kt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Qt(e){var t=Ce(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function ei(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function ti(e,t){return i(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]}function ii(e){return this._weekdaysShort[e.day()]}function si(e){return this._weekdaysMin[e.day()]}function ni(e,t,i){var s,n,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;7>s;++s)o=r([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(o,"").toLocaleLowerCase();return i?"dddd"===t?(n=us.call(this._weekdaysParse,a),-1!==n?n:null):"ddd"===t?(n=us.call(this._shortWeekdaysParse,a),-1!==n?n:null):(n=us.call(this._minWeekdaysParse,a),-1!==n?n:null):"dddd"===t?(n=us.call(this._weekdaysParse,a),-1!==n?n:(n=us.call(this._shortWeekdaysParse,a),-1!==n?n:(n=us.call(this._minWeekdaysParse,a),-1!==n?n:null))):"ddd"===t?(n=us.call(this._shortWeekdaysParse,a),-1!==n?n:(n=us.call(this._weekdaysParse,a),-1!==n?n:(n=us.call(this._minWeekdaysParse,a),-1!==n?n:null))):(n=us.call(this._minWeekdaysParse,a),-1!==n?n:(n=us.call(this._weekdaysParse,a),-1!==n?n:(n=us.call(this._shortWeekdaysParse,a),-1!==n?n:null)))}function oi(e,t,i){var s,n,o;if(this._weekdaysParseExact)return ni.call(this,e,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;7>s;s++){if(n=r([2e3,1]).day(s),i&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(n,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(n,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(n,"").replace(".",".?")+"$","i")),this._weekdaysParse[s]||(o="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[s]=new RegExp(o.replace(".",""),"i")),i&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(i&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(i&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!i&&this._weekdaysParse[s].test(e))return s}}function ai(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=ei(e,this.localeData()),this.add(e-t,"d")):t}function ri(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function li(e){return this.isValid()?null==e?this.day()||7:this.day(this.day()%7?e:e-7):null!=e?this:NaN}function hi(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||ui.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex}function di(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||ui.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}function ci(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||ui.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}function ui(){function e(e,t){return t.length-e.length}var t,i,s,n,o,a=[],l=[],h=[],d=[];for(t=0;7>t;t++)i=r([2e3,1]).day(t),s=this.weekdaysMin(i,""),n=this.weekdaysShort(i,""),o=this.weekdays(i,""),a.push(s),l.push(n),h.push(o),d.push(s),d.push(n),
d.push(o);for(a.sort(e),l.sort(e),h.sort(e),d.sort(e),t=0;7>t;t++)l[t]=J(l[t]),h[t]=J(h[t]),d[t]=J(d[t]);this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function pi(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function fi(){return this.hours()%12||12}function gi(){return this.hours()||24}function mi(e,t){V(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function vi(e,t){return t._meridiemParse}function bi(e){return"p"===(e+"").toLowerCase().charAt(0)}function yi(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"}function wi(e,t){t[Us]=v(1e3*("0."+e))}function _i(){return this._isUTC?"UTC":""}function Ci(){return this._isUTC?"Coordinated Universal Time":""}function Si(e){return Fe(1e3*e)}function xi(){return Fe.apply(null,arguments).parseZone()}function ki(e,t,i){var s=this._calendar[e];return C(s)?s.call(t,i):s}function Ti(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function $i(){return this._invalidDate}function Ai(e){return this._ordinal.replace("%d",e)}function Pi(e){return e}function Di(e,t,i,s){var n=this._relativeTime[i];return C(n)?n(e,t,i,s):n.replace(/%d/i,e)}function Ii(e,t){var i=this._relativeTime[e>0?"future":"past"];return C(i)?i(t):i.replace(/%s/i,t)}function Mi(e,t,i,s){var n=E(),o=r().set(s,t);return n[i](o,e)}function Ei(e,t,i){if("number"==typeof e&&(t=e,e=void 0),e=e||"",null!=t)return Mi(e,t,i,"month");var s,n=[];for(s=0;12>s;s++)n[s]=Mi(e,s,i,"month");return n}function Li(e,t,i,s){"boolean"==typeof e?("number"==typeof t&&(i=t,t=void 0),t=t||""):(t=e,i=t,e=!1,"number"==typeof t&&(i=t,t=void 0),t=t||"");var n=E(),o=e?n._week.dow:0;if(null!=i)return Mi(t,(i+o)%7,s,"day");var a,r=[];for(a=0;7>a;a++)r[a]=Mi(t,(a+o)%7,s,"day");return r}function Ni(e,t){return Ei(e,t,"months")}function Fi(e,t){return Ei(e,t,"monthsShort")}function Oi(e,t,i){return Li(e,t,i,"weekdays")}function Ri(e,t,i){return Li(e,t,i,"weekdaysShort")}function Bi(e,t,i){return Li(e,t,i,"weekdaysMin")}function ji(){var e=this._data;return this._milliseconds=Rn(this._milliseconds),this._days=Rn(this._days),this._months=Rn(this._months),e.milliseconds=Rn(e.milliseconds),e.seconds=Rn(e.seconds),e.minutes=Rn(e.minutes),e.hours=Rn(e.hours),e.months=Rn(e.months),e.years=Rn(e.years),this}function zi(e,t,i,s){var n=st(t,i);return e._milliseconds+=s*n._milliseconds,e._days+=s*n._days,e._months+=s*n._months,e._bubble()}function Hi(e,t){return zi(this,e,t,1)}function Vi(e,t){return zi(this,e,t,-1)}function Ui(e){return 0>e?Math.floor(e):Math.ceil(e)}function Wi(){var e,t,i,s,n,o=this._milliseconds,a=this._days,r=this._months,l=this._data;return o>=0&&a>=0&&r>=0||0>=o&&0>=a&&0>=r||(o+=864e5*Ui(Gi(r)+a),a=0,r=0),l.milliseconds=o%1e3,e=m(o/1e3),l.seconds=e%60,t=m(e/60),l.minutes=t%60,i=m(t/60),l.hours=i%24,a+=m(i/24),n=m(qi(a)),r+=n,a-=Ui(Gi(n)),s=m(r/12),r%=12,l.days=a,l.months=r,l.years=s,this}function qi(e){return 4800*e/146097}function Gi(e){return 146097*e/4800}function Yi(e){var t,i,s=this._milliseconds;if(e=F(e),"month"===e||"year"===e)return t=this._days+s/864e5,i=this._months+qi(t),"month"===e?i:i/12;switch(t=this._days+Math.round(Gi(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}}function Xi(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*v(this._months/12)}function Zi(e){return function(){return this.as(e)}}function Ji(e){return e=F(e),this[e+"s"]()}function Ki(e){return function(){return this._data[e]}}function Qi(){return m(this.days()/7)}function es(e,t,i,s,n){return n.relativeTime(t||1,!!i,e,s)}function ts(e,t,i){var s=st(e).abs(),n=eo(s.as("s")),o=eo(s.as("m")),a=eo(s.as("h")),r=eo(s.as("d")),l=eo(s.as("M")),h=eo(s.as("y")),d=n<to.s&&["s",n]||1>=o&&["m"]||o<to.m&&["mm",o]||1>=a&&["h"]||a<to.h&&["hh",a]||1>=r&&["d"]||r<to.d&&["dd",r]||1>=l&&["M"]||l<to.M&&["MM",l]||1>=h&&["y"]||["yy",h];return d[2]=t,d[3]=+e>0,d[4]=i,es.apply(null,d)}function is(e,t){return void 0===to[e]?!1:void 0===t?to[e]:(to[e]=t,!0)}function ss(e){var t=this.localeData(),i=ts(this,!e,t);return e&&(i=t.pastFuture(+this,i)),t.postformat(i)}function ns(){var e,t,i,s=io(this._milliseconds)/1e3,n=io(this._days),o=io(this._months);e=m(s/60),t=m(e/60),s%=60,e%=60,i=m(o/12),o%=12;var a=i,r=o,l=n,h=t,d=e,c=s,u=this.asSeconds();return u?(0>u?"-":"")+"P"+(a?a+"Y":"")+(r?r+"M":"")+(l?l+"D":"")+(h||d||c?"T":"")+(h?h+"H":"")+(d?d+"M":"")+(c?c+"S":""):"P0D"}var os,as;as=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),i=t.length>>>0,s=0;i>s;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var rs=e.momentProperties=[],ls=!1,hs={};e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;var ds;ds=Object.keys?Object.keys:function(e){var t,i=[];for(t in e)o(e,t)&&i.push(t);return i};var cs,us,ps={},fs={},gs=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ms=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,vs={},bs={},ys=/\d/,ws=/\d\d/,_s=/\d{3}/,Cs=/\d{4}/,Ss=/[+-]?\d{6}/,xs=/\d\d?/,ks=/\d\d\d\d?/,Ts=/\d\d\d\d\d\d?/,$s=/\d{1,3}/,As=/\d{1,4}/,Ps=/[+-]?\d{1,6}/,Ds=/\d+/,Is=/[+-]?\d+/,Ms=/Z|[+-]\d\d:?\d\d/gi,Es=/Z|[+-]\d\d(?::?\d\d)?/gi,Ls=/[+-]?\d+(\.\d{1,3})?/,Ns=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Fs={},Os={},Rs=0,Bs=1,js=2,zs=3,Hs=4,Vs=5,Us=6,Ws=7,qs=8;us=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},V("M",["MM",2],"Mo",function(){return this.month()+1}),V("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),V("MMMM",0,0,function(e){return this.localeData().months(this,e)}),N("month","M"),Y("M",xs),Y("MM",xs,ws),Y("MMM",function(e,t){return t.monthsShortRegex(e)}),Y("MMMM",function(e,t){return t.monthsRegex(e)}),K(["M","MM"],function(e,t){t[Bs]=v(e)-1}),K(["MMM","MMMM"],function(e,t,i,s){var n=i._locale.monthsParse(e,s,i._strict);null!=n?t[Bs]=n:h(i).invalidMonth=e});var Gs=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,Ys="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Xs="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Zs=Ns,Js=Ns,Ks=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,Qs=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,en=/Z|[+-]\d\d(?::?\d\d)?/,tn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],sn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],nn=/^\/?Date\((\-?\d+)/i;e.createFromInputFallback=w("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),V("Y",0,0,function(){var e=this.year();return 9999>=e?""+e:"+"+e}),V(0,["YY",2],0,function(){return this.year()%100}),V(0,["YYYY",4],0,"year"),V(0,["YYYYY",5],0,"year"),V(0,["YYYYYY",6,!0],0,"year"),N("year","y"),Y("Y",Is),Y("YY",xs,ws),Y("YYYY",As,Cs),Y("YYYYY",Ps,Ss),Y("YYYYYY",Ps,Ss),K(["YYYYY","YYYYYY"],Rs),K("YYYY",function(t,i){i[Rs]=2===t.length?e.parseTwoDigitYear(t):v(t)}),K("YY",function(t,i){i[Rs]=e.parseTwoDigitYear(t)}),K("Y",function(e,t){t[Rs]=parseInt(e,10)}),e.parseTwoDigitYear=function(e){return v(e)+(v(e)>68?1900:2e3)};var on=R("FullYear",!0);e.ISO_8601=function(){};var an=w("moment().min is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var e=Fe.apply(null,arguments);return this.isValid()&&e.isValid()?this>e?this:e:c()}),rn=w("moment().max is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var e=Fe.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:c()}),ln=function(){return Date.now?Date.now():+new Date};He("Z",":"),He("ZZ",""),Y("Z",Es),Y("ZZ",Es),K(["Z","ZZ"],function(e,t,i){i._useUTC=!0,i._tzm=Ve(Es,e)});var hn=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var dn=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,cn=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;st.fn=je.prototype;var un=lt(1,"add"),pn=lt(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var fn=w("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});V(0,["gg",2],0,function(){return this.weekYear()%100}),V(0,["GG",2],0,function(){return this.isoWeekYear()%100}),zt("gggg","weekYear"),zt("ggggg","weekYear"),zt("GGGG","isoWeekYear"),zt("GGGGG","isoWeekYear"),N("weekYear","gg"),N("isoWeekYear","GG"),Y("G",Is),Y("g",Is),Y("GG",xs,ws),Y("gg",xs,ws),Y("GGGG",As,Cs),Y("gggg",As,Cs),Y("GGGGG",Ps,Ss),Y("ggggg",Ps,Ss),Q(["gggg","ggggg","GGGG","GGGGG"],function(e,t,i,s){t[s.substr(0,2)]=v(e)}),Q(["gg","GG"],function(t,i,s,n){i[n]=e.parseTwoDigitYear(t)}),V("Q",0,"Qo","quarter"),N("quarter","Q"),Y("Q",ys),K("Q",function(e,t){t[Bs]=3*(v(e)-1)}),V("w",["ww",2],"wo","week"),V("W",["WW",2],"Wo","isoWeek"),N("week","w"),N("isoWeek","W"),Y("w",xs),Y("ww",xs,ws),Y("W",xs),Y("WW",xs,ws),Q(["w","ww","W","WW"],function(e,t,i,s){t[s.substr(0,1)]=v(e)});var gn={dow:0,doy:6};V("D",["DD",2],"Do","date"),N("date","D"),Y("D",xs),Y("DD",xs,ws),Y("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),K(["D","DD"],js),K("Do",function(e,t){t[js]=v(e.match(xs)[0],10)});var mn=R("Date",!0);V("d",0,"do","day"),V("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),V("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),V("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),V("e",0,0,"weekday"),V("E",0,0,"isoWeekday"),N("day","d"),N("weekday","e"),N("isoWeekday","E"),Y("d",xs),Y("e",xs),Y("E",xs),Y("dd",function(e,t){return t.weekdaysMinRegex(e)}),Y("ddd",function(e,t){return t.weekdaysShortRegex(e)}),Y("dddd",function(e,t){return t.weekdaysRegex(e)}),Q(["dd","ddd","dddd"],function(e,t,i,s){var n=i._locale.weekdaysParse(e,s,i._strict);null!=n?t.d=n:h(i).invalidWeekday=e}),Q(["d","e","E"],function(e,t,i,s){t[s]=v(e)});var vn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),bn="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),yn="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),wn=Ns,_n=Ns,Cn=Ns;V("DDD",["DDDD",3],"DDDo","dayOfYear"),N("dayOfYear","DDD"),Y("DDD",$s),Y("DDDD",_s),K(["DDD","DDDD"],function(e,t,i){i._dayOfYear=v(e)}),V("H",["HH",2],0,"hour"),V("h",["hh",2],0,fi),V("k",["kk",2],0,gi),V("hmm",0,0,function(){return""+fi.apply(this)+H(this.minutes(),2)}),V("hmmss",0,0,function(){return""+fi.apply(this)+H(this.minutes(),2)+H(this.seconds(),2)}),V("Hmm",0,0,function(){return""+this.hours()+H(this.minutes(),2)}),V("Hmmss",0,0,function(){return""+this.hours()+H(this.minutes(),2)+H(this.seconds(),2)}),mi("a",!0),mi("A",!1),N("hour","h"),Y("a",vi),Y("A",vi),Y("H",xs),Y("h",xs),Y("HH",xs,ws),Y("hh",xs,ws),Y("hmm",ks),Y("hmmss",Ts),Y("Hmm",ks),Y("Hmmss",Ts),K(["H","HH"],zs),K(["a","A"],function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e}),K(["h","hh"],function(e,t,i){t[zs]=v(e),h(i).bigHour=!0}),K("hmm",function(e,t,i){var s=e.length-2;t[zs]=v(e.substr(0,s)),t[Hs]=v(e.substr(s)),h(i).bigHour=!0}),K("hmmss",function(e,t,i){var s=e.length-4,n=e.length-2;t[zs]=v(e.substr(0,s)),t[Hs]=v(e.substr(s,2)),t[Vs]=v(e.substr(n)),h(i).bigHour=!0}),K("Hmm",function(e,t,i){var s=e.length-2;t[zs]=v(e.substr(0,s)),t[Hs]=v(e.substr(s))}),K("Hmmss",function(e,t,i){var s=e.length-4,n=e.length-2;t[zs]=v(e.substr(0,s)),t[Hs]=v(e.substr(s,2)),t[Vs]=v(e.substr(n))});var Sn=/[ap]\.?m?\.?/i,xn=R("Hours",!0);V("m",["mm",2],0,"minute"),N("minute","m"),Y("m",xs),Y("mm",xs,ws),K(["m","mm"],Hs);var kn=R("Minutes",!1);V("s",["ss",2],0,"second"),N("second","s"),Y("s",xs),Y("ss",xs,ws),K(["s","ss"],Vs);var Tn=R("Seconds",!1);V("S",0,0,function(){return~~(this.millisecond()/100)}),V(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),V(0,["SSS",3],0,"millisecond"),V(0,["SSSS",4],0,function(){return 10*this.millisecond()}),V(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),V(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),V(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),V(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),V(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),N("millisecond","ms"),Y("S",$s,ys),Y("SS",$s,ws),Y("SSS",$s,_s);var $n;for($n="SSSS";$n.length<=9;$n+="S")Y($n,Ds);for($n="S";$n.length<=9;$n+="S")K($n,wi);var An=R("Milliseconds",!1);V("z",0,0,"zoneAbbr"),V("zz",0,0,"zoneName");var Pn=f.prototype;Pn.add=un,Pn.calendar=dt,Pn.clone=ct,Pn.diff=bt,Pn.endOf=Dt,Pn.format=Ct,Pn.from=St,Pn.fromNow=xt,Pn.to=kt,Pn.toNow=Tt,Pn.get=z,Pn.invalidAt=Bt,Pn.isAfter=ut,Pn.isBefore=pt,Pn.isBetween=ft,Pn.isSame=gt,Pn.isSameOrAfter=mt,Pn.isSameOrBefore=vt,Pn.isValid=Ot,Pn.lang=fn,Pn.locale=$t,Pn.localeData=At,Pn.max=rn,Pn.min=an,Pn.parsingFlags=Rt,Pn.set=z,Pn.startOf=Pt,Pn.subtract=pn,Pn.toArray=Lt,Pn.toObject=Nt,Pn.toDate=Et,Pn.toISOString=_t,Pn.toJSON=Ft,Pn.toString=wt,Pn.unix=Mt,Pn.valueOf=It,Pn.creationData=jt,Pn.year=on,Pn.isLeapYear=ye,Pn.weekYear=Ht,Pn.isoWeekYear=Vt,Pn.quarter=Pn.quarters=Yt,Pn.month=re,Pn.daysInMonth=le,Pn.week=Pn.weeks=Kt,Pn.isoWeek=Pn.isoWeeks=Qt,Pn.weeksInYear=Wt,Pn.isoWeeksInYear=Ut,Pn.date=mn,Pn.day=Pn.days=ai,Pn.weekday=ri,Pn.isoWeekday=li,Pn.dayOfYear=pi,Pn.hour=Pn.hours=xn,Pn.minute=Pn.minutes=kn,Pn.second=Pn.seconds=Tn,Pn.millisecond=Pn.milliseconds=An,Pn.utcOffset=qe,Pn.utc=Ye,Pn.local=Xe,Pn.parseZone=Ze,Pn.hasAlignedHourOffset=Je,Pn.isDST=Ke,Pn.isDSTShifted=Qe,Pn.isLocal=et,Pn.isUtcOffset=tt,Pn.isUtc=it,Pn.isUTC=it,Pn.zoneAbbr=_i,Pn.zoneName=Ci,Pn.dates=w("dates accessor is deprecated. Use date instead.",mn),Pn.months=w("months accessor is deprecated. Use month instead",re),Pn.years=w("years accessor is deprecated. Use year instead",on),Pn.zone=w("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Ge);var Dn=Pn,In={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Mn={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},En="Invalid date",Ln="%d",Nn=/\d{1,2}/,Fn={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},On=T.prototype;On._calendar=In,On.calendar=ki,On._longDateFormat=Mn,On.longDateFormat=Ti,On._invalidDate=En,On.invalidDate=$i,On._ordinal=Ln,On.ordinal=Ai,On._ordinalParse=Nn,On.preparse=Pi,On.postformat=Pi,On._relativeTime=Fn,On.relativeTime=Di,On.pastFuture=Ii,On.set=x,On.months=ie,On._months=Ys,On.monthsShort=se,On._monthsShort=Xs,On.monthsParse=oe,On._monthsRegex=Js,On.monthsRegex=de,On._monthsShortRegex=Zs,On.monthsShortRegex=he,On.week=Xt,On._week=gn,On.firstDayOfYear=Jt,On.firstDayOfWeek=Zt,On.weekdays=ti,On._weekdays=vn,On.weekdaysMin=si,On._weekdaysMin=yn,On.weekdaysShort=ii,On._weekdaysShort=bn,On.weekdaysParse=oi,On._weekdaysRegex=wn,On.weekdaysRegex=hi,On._weekdaysShortRegex=_n,On.weekdaysShortRegex=di,On._weekdaysMinRegex=Cn,On.weekdaysMinRegex=ci,On.isPM=bi,On._meridiemParse=Sn,On.meridiem=yi,D("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,i=1===v(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),e.lang=w("moment.lang is deprecated. Use moment.locale instead.",D),e.langData=w("moment.langData is deprecated. Use moment.localeData instead.",E);var Rn=Math.abs,Bn=Zi("ms"),jn=Zi("s"),zn=Zi("m"),Hn=Zi("h"),Vn=Zi("d"),Un=Zi("w"),Wn=Zi("M"),qn=Zi("y"),Gn=Ki("milliseconds"),Yn=Ki("seconds"),Xn=Ki("minutes"),Zn=Ki("hours"),Jn=Ki("days"),Kn=Ki("months"),Qn=Ki("years"),eo=Math.round,to={s:45,m:45,h:22,d:26,M:11},io=Math.abs,so=je.prototype;so.abs=ji,so.add=Hi,so.subtract=Vi,so.as=Yi,so.asMilliseconds=Bn,so.asSeconds=jn,so.asMinutes=zn,so.asHours=Hn,so.asDays=Vn,so.asWeeks=Un,so.asMonths=Wn,so.asYears=qn,so.valueOf=Xi,so._bubble=Wi,so.get=Ji,so.milliseconds=Gn,so.seconds=Yn,so.minutes=Xn,so.hours=Zn,so.days=Jn,so.weeks=Qi,so.months=Kn,so.years=Qn,so.humanize=ss,so.toISOString=ns,so.toString=ns,so.toJSON=ns,so.locale=$t,so.localeData=At,so.toIsoString=w("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ns),so.lang=fn,V("X",0,0,"unix"),V("x",0,0,"valueOf"),Y("x",Is),Y("X",Ls),K("X",function(e,t,i){i._d=new Date(1e3*parseFloat(e,10))}),K("x",function(e,t,i){i._d=new Date(v(e))}),e.version="2.13.0",t(Fe),e.fn=Dn,e.min=Re,e.max=Be,e.now=ln,e.utc=r,e.unix=Si,e.months=Ni,e.isDate=s,e.locale=D,e.invalid=c,e.duration=st,e.isMoment=g,e.weekdays=Oi,e.parseZone=xi,e.localeData=E,e.isDuration=ze,e.monthsShort=Fi,e.weekdaysMin=Bi,e.defineLocale=I,e.updateLocale=M,e.locales=L,e.weekdaysShort=Ri,e.normalizeUnits=F,e.relativeTimeThreshold=is,e.prototype=Dn;var no=e;return no}),define("template-manager",["jquery","underscore","utils","template-utils","api/analytics","pubsub","state","managers/requestmanager","abtest-manager","modules/global/taboola","third_party_integrations/taboola/taboola-utils","libs/moment/moment.min"],function(e,t,i,s,n,o,a,r,l,h,d,c){"use strict";var u=function(){t.bindAll(this,"formatPongAsset"),this.baseUrl=i.getNested(window.site_vars,"base_url"),this.assetTemplates={},this._initialPageLoad()};return u.prototype={selectors:{coEl:".js-co-eligible",coModule:".js-co-eligible-module",coAsset:".js-co-eligible-asset:not(.js-sponsor-asset)",backfillAsset:".js-backfill-asset",curatedAsset:".js-curated-asset",parentCuratedAsset:".js-parent-curated-asset",assetHeadline:".js-asset-headline",assetLink:".js-asset-link",assetImage:".js-asset-image",assetSection:".js-asset-section",assetTimestamp:".js-asset-timestamp",assetDescription:".js-asset-description",assetAuthor:".js-asset-author",assetSource:".js-asset-source",assetDisposable:".js-asset-disposable",coAssetTemplate:".js-co-asset-template"},_initialPageLoad:function(){this.initialPageLoadPromise=e.Deferred(t.bind(function(s){var n=i.get("body"),o=n.find(this.selectors.coEl);if(o.length)try{var r=a.getActivePageInfo();e.when.apply(e,t.map(o,function(t){var i=e(t);return this._processContentOverride(i,r).then(function(){i.addClass("js-co-initial")})},this)).then(function(){s.resolve()},function(){s.reject()})}catch(l){s.reject()}else s.resolve()},this)).promise()},getContentOverride:function(e,i){this.initialPageLoadPromise.always(t.bind(function(){e.hasClass("js-co-failed")||e.hasClass("js-co-initial")||(e.hasClass("js-co-processed")?e.data("analyticsEvents")&&this._fireAnalyticsEvents(e):this._processContentOverride(e,i)),e.removeClass("js-co-initial")},this))},_processContentOverride:function(s,n){var o,a,r,h=e.Deferred().resolve(),d=s.find(this.selectors.coModule),c={},u=[];if(s.addClass("js-co-processed"),d.length)if(o=i.getNested(n,"user","abTest")||l.getUserTestByTarget("content-override"),c=this.getContentOverrideOptions(o),a=this.getContentOverrideModules(s,i.getNested(c,"targetModules"))||d,r=a.find(this.selectors.coAsset),c.provider&&u.push(c.provider),c.analyticsProviders&&(u=t.filter(t.union(u,c.analyticsProviders),function(e){return!t.isUndefined(e)})),c.provider){var p,f=r,g=i.getNested(c,"startAtIndex");g&&(f=r.slice(g)),i.getNested(c,"backfillOnly")&&(f=r.filter(this.selectors.backfillAsset)),f.addClass("js-co-asset"),p=r.not(f).addClass("js-neighbor-asset"),r.length?(t.each(a,function(i){var s=e(i).find(this.selectors.coAssetTemplate),n=s.attr("data-co-template-id"),o=s.html();!o||!n||n in this.assetTemplates||(this.assetTemplates[n]=t.template(o))},this),h=this._processContentOverrideByProvider(c.provider,c,r,p,u,n.ssts||"home",n.canonical||window.location.href)):h.reject()}else 0===u.length?h.reject():h=this._processContentOverrideWithoutProvider(r,c,u);else h.reject();return h.done(t.bind(function(){c.abTestId&&u.length&&this._addAnalyticsEventsAndFire(s,u,{abTestId:""+c.abTestId,abTestVariant:c.abTestVariant})},this)).fail(function(){s.addClass("js-co-failed")}).always(function(){i.lazyLoadImage(d.find("img")),d.removeClass("placeholder")}).promise()},_processContentOverrideByProvider:function(o,a,l,d,c,u,p){var f=e.Deferred().resolve(),g=a.timeout||1e4,m={},v=s.getAssetIdsFromAssets(d),b=l.length-d.length;if(b>0)switch(o){case"pong":m=t.pick(a,["days","metric"]),m.asset_type=a.assetType||"text",m.ssts=a.sstsOverride||u,m.exclude=v.join(","),m.count=b,f=r.fetchData("/modules/pong-stories.json?"+e.param(m),{timeout:g},!1,!1,!1).then(t.bind(function(e){return t.map(i.getNested(e,"assets"),this.formatPongAsset)},this));break;case"solr":var y=a.metric||"most-popular";m=t.pick(a,["days"]),m.assetTypes=a.assetType,m.ssts=a.sstsOverride||u,m.exclude=v.join(","),m.count=b,m.i=this.getImageDimensions(l.find(this.selectors.assetImage)),f=r.fetchData("/services/assets/"+y+"/?"+e.param(m),{timeout:g},!1,!1,!1).then(t.bind(function(e){return t.map(e,this.formatSolrAsset)},this));break;case"taboola":var w=new h({isWidgetPresent:!1}),_=/\/(\d*)(\/?)$/gi;f=w.getRelated(null,"section",a.assetType||"text",b+10,p,null,a.placement,!0).then(t.bind(function(e){var i,s=0;return t.chain(e.list).filter(t.bind(function(e){return i=_.exec(e.id)||[],!t.contains(v,i[1])&&b>s&&this.filterTaboolaRec(e)?(s++,!0):void 0},this)).map(this.formatTaboolaRec).value()},this))}return f.done(t.bind(function(i){t.each(l,function(s){var r=e(s),l=r.hasClass("js-co-asset")&&t.isArray(i)?i.shift():{},h=t.pick(a,["abTestId","abTestVariant"]),d=r.closest(this.selectors.coModule),u=d.find(this.selectors.coAsset).index(r)+1;t.isEmpty(l)||(l=this.setAssetContextDefaults(l),l.position=u,l.modulePosition=d.index()+1),this.updateAsset(s,l).then(function(i){e(i[0]).addClass("js-co-asset-"+(l?o:"default")),t.each(i[1],function(i){var s=e(i);l&&l.pixelUrl&&s.data(o+"-click-pixel",l.pixelUrl),n.addAnalyticsToLink(i,c,t.extend(h,{bucket:"content-override",pinType:r.hasClass("js-backfill-asset")?"backfill":"curated",assetPosition:u,navSource:s.attr("data-track-label")||s.attr("data-ht")||""}))})})},this)},this)),f.promise()},_processContentOverrideWithoutProvider:function(i,s,o){return e.Deferred(t.bind(function(a){t.each(i,function(i){var a=e(i),r=t.pick(s,["abTestId","abTestVariant"]),l=a.closest(this.selectors.coModule),h=l.find(this.selectors.coAsset).index(a)+1,d=a.find(this.selectors.assetLink).addBack(this.selectors.assetLink);a.addClass("js-co-asset-default"),t.each(d,function(i){var s=e(i);n.addAnalyticsToLink(i,o,t.extend(r,{bucket:"content-override",pinType:a.hasClass("js-backfill-asset")?"backfill":"curated",assetPosition:h,navSource:s.attr("data-track-label")||s.attr("data-ht")||""}))})},this),a.resolve()},this)).promise()},getContentOverrideModules:function(s,n){if(!t.isEmpty(n)){var o=e();return t.each(n,function(e){o=o.add(s.find("."+e.name+"-module"+this.selectors.coModule).eq(i.getNested(e,"instanceIndex")))},this),o}},updateAsset:function(s,n){return e.Deferred(t.bind(function(o){var a=e(s),r=a.attr("data-co-template"),l=r&&r in this.assetTemplates,h=a.attr("class"),d=[];if(t.isEmpty(n))d=a.find(this.selectors.assetLink).addBack(this.selectors.assetLink),o.resolve([a,d]);else{if(l)try{a=e(this.assetTemplates[r](n)).replaceAll(a),a.addClass(h)}catch(c){console.warn(r+' template failed to render for "'+n.headline+'"'),l=!1}try{d=a.find(this.selectors.assetLink).addBack(this.selectors.assetLink),t.each(d,function(t){this.updateAssetLink(e(t),n.url,n.headline,n.section)},this),a.find(this.selectors.assetImage).each(t.bind(function(t,s){var o=e(s);n.imgSrc?(this.updateAssetImage(o,n.imgSrc,n.imgAlt,n.crops,n.images),i.lazyLoadImage(o)):o.remove()},this)),l||(a=this.updateAssetContent(a,n.id,n.headline,n.shortHeadline,n.description,n.author,n.source,n.time,n.section,n.sectionDisplay)),a.addClass("js-co-asset-processed"),o.resolve([a,d])}catch(c){o.reject()}}},this)).promise()},updateAssetContent:function(i,s,n,o,a,r,l,h,d,c){return i.attr("data-asset-id",s).attr("class",t.bind(function(e,t){return this.updateThemeClassNames(t,d)},this)).find(this.selectors.assetSection).attr("class",t.bind(function(e,t){return this.updateThemeClassNames(t,d)},this)).html(c).end().find(this.selectors.assetHeadline).each(function(t,i){var s=n,a=e(i);a.hasClass("js-asset-headline-short")&&o&&(s=o),a.html(s).attr("title",n)}).end().find(this.selectors.assetAuthor).html(r).end().find(this.selectors.assetSource).html(l).end().find(this.selectors.assetDescription).html(a).end().find(this.selectors.assetTimestamp).html(h).end().find(this.selectors.assetDisposable).remove(),i},updateAssetImage:function(e,t,n,o,a){var r=i.getNested(a,e.attr("width")+"x"+e.attr("height"),"src");return t=r?r:s.getCroppedImage(t,e.attr("width"),e.attr("height"),o,e.attr("data-crop")),e.attr(e.attr("data-src")?"data-src":"src",t).attr("alt",n),e},updateAssetLink:function(e,i,s,n){return e.attr({href:i,title:s,"class":t.bind(function(e,t){return this.updateThemeClassNames(t,n)},this),target:t.bind(function(){return-1!=i.indexOf("://")&&-1==i.indexOf(this.baseUrl)?"_blank":null},this)}),e},updateThemeClassNames:function(e,t){return e.replace(/(?:sponsor-)?(\w+)-theme-(\w+)/gi,t+"-theme-$2")},setAssetContextDefaults:function(e){return t.defaults(e,{id:0,headline:"",shortHeadline:"",description:"",url:"",author:"",source:"",imgSrc:"",imgAlt:"",crops:{},images:{},section:"",sectionDisplay:"",time:"",timestamp:"",position:0,modulePosition:0,type:""})},getContentOverrideOptions:function(e){var s=i.getNested(e,"userVariant","options","contentOverride"),n=i.getNested(window.site_vars,"contentOverrides"),o={};return s?(o=s,o.abTestId=e.id,o.abTestVariant=e.userVariant.id):n&&(o=t.find(n,function(e){try{return new RegExp(e.urlRegex).test(window.location.pathname)}catch(t){return!1}})),o},formatContentLiteAsset:function(e,t){var n=i.getNested(e,"ssts","section"),o=i.getNested(e,"ssts","subsection"),a=n+(o?"/"+o:""),r=i.getNested(e,"photo","crops")||{};return{headline:e.headline,shortHeadline:e.headline,description:e.promoBrief,author:i.getNested(e,"byline","author"),url:s.relativizeUrl(i.getNested(e,"urls","longUrl")),imgSrc:r.front_thumb||r["1_1"],imgAlt:e.promoBrief,crops:r,section:n,sectionDisplay:s.getDisplaySection(a),time:c(new Date(e.datePublished)).fromNow(),timestamp:e.datePublished,position:t,type:e.content_type,id:e.id}},formatPongAsset:function(e,t){return this.formatContentLiteAsset(e,t)},formatSolrAsset:function(e,t){var i=e.images||{},s=i.crops||{};return{headline:e.headline,shortHeadline:e.headlineShort,description:e.description,author:e.author,url:e.urlLocalized,imgSrc:s.front_thumb||s.videostill||i.original,imgAlt:i.caption||"",crops:s,images:i,section:e.sstsSection,sectionDisplay:e.sstsDisplay,time:e.datePublishedTimeSince,timestamp:e.datePublished,position:t,type:e.type,id:e.id}},formatTaboolaRec:function(e,t){var n=e.categories||[],o=i.getNested(e,"thumbnail",0,"url");return o&&(o=decodeURIComponent(o.substring(o.indexOf("/http")+1))),{headline:e.name,description:e.description,url:e.id,imgSrc:o,imgAlt:e.name,section:n[0],sectionDisplay:s.getDisplaySection(n.join("/")),time:c(new Date(e.created)).fromNow(),timestamp:e.created,position:t,pixelUrl:e.url,type:e.type}},filterTaboolaRec:function(e){var t=i.getNested(e,"thumbnail",0,"url")||"",s=e.id||"",n=new Date(e.created)>Date.now();return t=t?t.toString():"",s.match(/story|videos|picture-gallery/)&&!t.match(/applogos|images\/logos/)&&!n},getImageDimensions:function(e){return t.chain(e).map(function(e){return e.hasAttribute("width")&&e.hasAttribute("height")?e.getAttribute("width")+"x"+e.getAttribute("height"):void 0}).uniq().value().join(",")},_addAnalyticsEvents:function(e,i,s){var n=e.data("analytics-events")||{};t.isString(i)&&(i=[i]),t.each(i,function(e){n[e]=s}),e.data("analytics-events",n)},_addAnalyticsEventsAndFire:function(e,i,s){t.isString(i)&&(i=[i]),t.each(i,function(t){this._addAnalyticsEvents(e,t,s),o.trigger("analytics:event",t,s)},this)},_fireAnalyticsEvents:function(e){var i=e.data("analytics-events")||{};t.each(i,function(e,t){o.trigger("analytics:event",t,e)})}},new u}),define("apps/cards/cards",["jquery","underscore","pubsub","utils","site-manager","base-app","apps/cards/layouts","partner/pushdown-ad","partner/gravity-ad","partner/overlay-ad-fronts","modules/partner/paramount-ad-front","partner/digital-wrap","modules/partner/branded-content-tile","sharedAdPosition","directAdPosition","template-manager"],function(e,t,i,s,n,o,a,r,l,h,d,c,u,p,f,g){"use strict";var m=o.extend({cards:(window.section_arrows||"home").split("|"),cardsDisplay:(window.section_arrows_display||"home").split("|"),initialize:function(i){i=e.extend(!0,{animations:{horizontal:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"},fadeIn:{duration:200}},UPDATE_FREQUENCY:9e5,keyboard:!1,peekWidth:-100,template:'<div class="card-wrap-<%= layoutType %> card-wrap"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-loader-init"></div><div class="card-loading-border"></div></section></div>',overlayTemplate:'<div class="card-wrap-<%= layoutType %> card-wrap card-wrap-behind-overlay"><section class="card <%= section %> card-loading" id="section_<%= section %>"><div class="card-suspender-color <%= section %>"></div><div class="card-loading-border"></div><div class="sidebar"></div></section></div>'},i),t.bindAll(this,"handleResizeWindow"),this.$top=s.get("scrollEl"),this.$doc=s.get("doc"),this.$body=s.get("body"),this.$win=s.get("win"),this.template=t.template(i.template),this.overlayTemplate=t.template(i.overlayTemplate),this.containerOffset=0,this.header=n.getHeader(),this.cardSizes=[];var a=t.throttle(this.handleResizeWindow,50);this.$win.on("resize."+this.cid,a),this.options.keyboard&&this.$doc.on("keydown."+this.cid,this.keyNavigation),this.pbLog=s.getUrlParam("pb_console"),this.pbLog&&console.log("CARDS: Init ----------------------",Date.now()),s.flag("lazy_front_bft_lb")&&(this.pubSub={"exited:view:frontBftLbAd":this.onBftLbAdExitView,"entered:view:frontBftLbAd":this.onBftLbAdEnterView}),o.prototype.initialize.call(this,i)},destroy:function(e){this.$win.off("."+this.cid),this.$doc.off("."+this.cid),this.$container.css("background","none"),o.prototype.destroy.call(this,e)},activateLoader:function(){var t=(e(".site-header"),this.getRevealAppLoader()),i=t.find(".card-wrap"),s=this.$currentCard;
this.$currentCard=i,s.after(i),s.remove(),this.header.scrollTop(0)},animateChangePagePreData:function(e,t){var i=s.getSectionPath(t);if(this._updateNav(t,i),s.getNested(window.site_vars,"flags","disable_front_animations"))return this.afterLoaderReveal(),n.scrollTop(0),!1;var o=this.goTo(i);if(this.$container.css("background","none"),!o&&this.currentPath!==t){var a=this.createAndInitializeEmptyCard(i,this.$win.height()),r=s.getScrollPosition();r-=n.scrollTop(0),this.$currentCard.children(".card").css({top:-1*r}),a.css({position:"relative",margin:"",left:-1*this.containerOffset}),this.$currentCard.css({left:this.leftMargin+-1*this.containerOffset}),o=this.swapContent(this.$currentCard,a),this.$currentCard=a}return o},animateChangePagePostData:function(e,t,i,s){var n=this.$currentCard,o=i.find(".card-wrap");return o.css({left:-1*this.containerOffset}),n.css({height:"",overflow:"","padding-right":"",left:this.leftMargin+-1*this.containerOffset}),this.$currentCard=o,this.beforeLoaderRemove(),this.swapContent(n,o,!1,this.getHash(t))},animateRevealApp:function(t,i,s){return s?(this.afterOverlayReveal(0,i),e.Deferred().resolve()):o.prototype.animateRevealApp.apply(this,arguments)},beforePageReveal:function(e,t,i,s){s&&i.css("display","none")},afterPageReveal:function(e,n,o,r){this.domInitialized||this.initializeDom();var l=s.getSectionPath(n);s.getNested(this.pageInfo,"bg_image")&&this.$container.css({"background-image":"url("+this.pageInfo.bg_image+")","background-size":"cover"}),this.cardSizes=a[s.getNested(this.pageInfo,"layout_type")]||[],this.calculateCardDimensions(this.$win.width()),this._updateNav(n,l),this.$currentCard=this.$container.children(".card-wrap"),this.currentIndex=t.indexOf(this.cards,l),o||(g.getContentOverride(this.$currentCard,this.pageInfo),r&&(this.subviews.view=new r({el:this.$currentCard})),this.setupAds(),this.triggerEvent("renderCardInfo",this.currentCardInfo,this.isCurrentCardBumped())),i.trigger("cards:loaded",this.$currentCard,this.pageInfo,o)},setupAds:function(){var i=s.getNested(window.site_vars,"ADS","fast_fetch"),n=this.$(".partner-billboard-ad"),o=i?this.$(".partner-high-impact"):n,a=this.$currentCard;this.pbLog&&console.log("CARDS: Setup ads -----------------",Date.now()),s.getNested(window.site_vars,"ADS","branded_content_tile","enabled")===!0&&(this.subviews.bcTile=new u({el:this.$(".partner-tile-ad"),layout:this.currentCardInfo.layout})),this.billboardDefer=e.Deferred(),this._hasBigHeadline()||(i?this.subviews.billboardAd=new f({el:n,adPlacement:"high_impact",adSizes:s.getNested(window.site_vars,"ADS","front_billboard_ad_sizes")||["billboard"],adType:["billboard"],deferred:this.billboardDefer}):this.subviews.billboardAd=new p({el:n,adPlacement:"high_impact",adSizes:s.getNested(window.site_vars,"ADS","front_billboard_ad_sizes")||["billboard"],adType:["billboard"],slot:o}),this.subviews.pushdownAd=new r({el:this.$(".partner-pushdown-ad"),adClasses:t.pluck(this.cardSizes,"adClass").join(" "),cards:a,slot:o}),this.subviews.gravityAd=new l({el:this.$(".partner-gravity-ad"),contentSection:this.$el,cards:a,slot:o}),this.subviews.overlayAd=new h({el:this.$(".partner-overlay"),cards:a,isCardBumped:this.isCurrentCardBumped(),getHeaderOffset:t.bind(function(){return this.header.getExpandedHeight()},this),slot:o}),this.subviews.paramountAd=new d({defaultPosition:!0,skipTargetBarrier:i,el:o,adPlacement:"high_impact",slot:o}),(s.getNested(window.site_vars,"ADS","digital_wrap")||s.getUrlParam("dw_debug"))&&(this.subviews.DigitalWrap=new c({el:o,slot:o,container:this.$el,backgroundEl:this.$body}),this.subviews.sponsorLogo=new f({el:this.$(".partner-sponsor-logo"),adType:"Sponsor Logo",adSizes:[800,40],adPlacement:"sponsor_logo"}))),s.flag("lazy_front_bft_lb")||this.initLeaderboardBtfAd(),this.subviews.genericad=new p({el:this.$("#ad-staging"),adPlacement:"high_impact",adSizes:["generic"],adType:"generic",slot:o,onAdReady:t.bind(function(){this.billboardDefer.reject()},this),onNoAd:t.bind(function(){this.billboardDefer.resolve()},this)}),setTimeout(function(){e(window).trigger("fetchPrebid")},s.getNested(window.site_vars,"ADS","prebid","timeout","card")||50)},initLeaderboardBtfAd:function(){s.getNested(window.site_vars,"ADS","front_leaderboard_enabled")&&(this.subviews.leaderboardAd=new f({el:this.$(".partner-leaderboard-front"),adType:"leaderboard",adSizes:["leaderboard"],adPlacement:"leaderboard_btf"}))},onBftLbAdEnterView:function(e){this.subviews.leaderboardAd||this.initLeaderboardBtfAd()},onBftLbAdExitView:function(e){this.subviews.leaderboardAd&&this.subviews.leaderboardAd.destroy()},_hasBigHeadline:function(){var e=s.getNested(this.pageInfo,"js_modules");return e?t.find(e,function(e){return"big-headline"===e.name?!0:void 0}):!1},isCurrentCardBumped:function(){return this.$currentCard.children(".card-bumped").length},beforeAppRemove:function(t,i){e(".site-nav span.site-nav-span").removeClass("site-nav-active-span")},getRevealAppLoader:function(t){var i=e(".js-ab-app-el");if(i.length)return i;var n=s.getSectionPath(t),o=this.createAndInitializeEmptyCard(n,this.$win.height());return o.css({position:"relative",margin:""}),o=e('<div class="card-container"></div>').append(o),o=e('<article id="cards" class="cards"></article>').append(o)},afterLoaderReveal:function(){this.loaderTimeout=setTimeout(t.bind(function(){var e=this.$(".card-loader-init");e.length>0&&e.removeClass("card-loader-init").addClass("card-circle-loader ui-circle-loader")},this),200)},beforeLoaderRemove:function(){clearTimeout(this.loaderTimeout)},initializeDom:function(){this.$container=this.$(".card-container"),this.$currentCard=this.$container.children(".card-wrap"),this.$prevBtn=this.$("#cards-prev-link"),this.$nextBtn=this.$("#cards-next-link"),this.buttonWidth=this.$prevBtn.width(),this.buttonsVisible=!1,this.domInitialized=!0},handleResizeWindow:function(){if(this.domInitialized){var e=this.$win.width();if(this.windowWidth===e)return!1;var t=this.currentCardInfo;this.calculateCardDimensions(e),this.currentCardInfo!==t&&this.triggerEvent("onCardWidthChange",this.currentCardInfo)}},calculateCardDimensions:function(e){var i=this.getMinCardInfo();e<i.windowWidth&&(e=i.windowWidth),this.windowWidth=e;var s=i,n=this._hasSidebar(),o=(window.matchMedia||Modernizr.mq("only all"))&&!this.$top.hasClass("lt-ie9");return t.find(this.cardSizes,function(t){if(!n)return s=i,!0;if(o){if(Modernizr.mq("only screen and (min-width: "+t.windowWidth+"px)"))return s=t,!0}else if(e>=t.windowWidth)return s=t,!0}),this.cardWrapWidth=s.cardWidth+((e-2*this.options.peekWidth-s.cardWidth)/2+.5)>>0,this.cardWrapWidth<i.cardWidth&&(this.cardWrapWidth=i.cardWidth),this.leftMargin=(e-s.cardWidth-2*this.options.peekWidth)/2+this.options.peekWidth+.5>>0,this.currentCardInfo=s,this._shouldShowBtns(s.cardWidth,e),s},_hasSidebar:function(){return this.$(".sidebar").length>0},_shouldShowBtns:function(e,t){var i=2*this.buttonWidth+e<t;i!==this.buttonsVisible&&(i?(this.$nextBtn.css("visibility","visible"),this.$prevBtn.css("visibility","visible")):(this.$nextBtn.css("visibility","hidden"),this.$prevBtn.css("visibility","hidden")),this.buttonsVisible=i)},updateNavLinks:function(e,t){t="home"===t?"/":"/"+t+"/",e.attr("href",t)},keyNavigation:function(e){switch(e.keyCode){case 37:this.previous();break;case 39:this.next()}},inBounds:function(e,t){return!isNaN(parseFloat(e,10))&&isFinite(e)&&e>=0&&t-1>=e},goTo:function(i){var n=t.indexOf(this.cards,i);if(-1!==n&&-1!==this.currentIndex&&n!==this.currentIndex){var o=s.getScrollPosition();return this.isApple&&o>0?e.Deferred(t.bind(function(e){this.$top.animate({scrollTop:0},200).promise().done(t.bind(function(){this._animateCards(n,o).done(function(){e.resolve()})},this))},this)).promise():this._animateCards(n,o)}},_animateCards:function(i,s){var o,a=0,r=e([]),l=this.$win.height(),h=this.$currentCard,d=this.currentIndex,c=this.$currentCard.height(),u=h.offset().top,p=0;p=Math.abs(i-d)>this.cards.length/2?i>d?-1:1:i>d?1:-1;do d=this._incrementIndex(d,p),o=this.createAndInitializeEmptyCard(this.cards[d],l),d!==i&&r.push(o[0]),this._positionCard(o,++a*p),this.$container.append(o);while(d!==i);this.$currentCard=o,this.containerOffset-=a*p*this.cardWrapWidth,s>c+u-l&&h.css({height:l,overflow:"hidden"}),s-=n.scrollTop(0),this.isApple||h.children(".card").css({top:-1*s});var f=this.animate(this.$container,"left",this.containerOffset+"px",this.options.animations.horizontal.duration,this.options.animations.horizontal.easing);return f.done(t.bind(function(){this.afterLoaderReveal(),o.css("position","relative")},this)).always(function(){h.remove(),r.remove()}),f},_incrementIndex:function(e,t){return(this.cards.length+e+t)%this.cards.length},createAndInitializeEmptyCard:function(t,i){var n=e(this.template({section:t,layoutType:s.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"}));return n.css({margin:0,position:"absolute",height:i,bottom:0}),n},_positionCard:function(e,t){e.css({left:this.leftMargin-this.containerOffset+t*this.cardWrapWidth})},getMinCardInfo:function(){return this.cardSizes[this.cardSizes.length-1]||{}},afterOverlayReveal:function(t,i){var n=s.getSectionPath(i||this.currentPath),o=this.$(".card-wrap > .card").position().top||50,a=this.header.getFixedThreshold(),r=o+this.header.getExpandedHeight();this.$el.hide(),r>t&&(t>a&&(r-=t-a),this.offsetPlaceholder=e('<div id="cards-offset-placeholder" style="height:'+r+'px"></div>'),this.$body.append(this.offsetPlaceholder)),this.header.isFixed()?this._fixPlaceholder():this._unfixPlaceholder(),this.fakeCardPlaceholder=e(this.overlayTemplate({section:n,layoutType:s.getNested(this.pageInfo,"layout_type")||"primary-suspender-sidebar-page"})),this.$body.append(this.fakeCardPlaceholder)},_fixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"fixed",top:-1*this.header.getFixedThreshold()})},_unfixPlaceholder:function(){this.offsetPlaceholder&&this.offsetPlaceholder.css({position:"absolute",top:0})},_onHeaderFixed:function(){this._fixPlaceholder(),o.prototype._onHeaderFixed.apply(this,arguments)},_onHeaderUnfixed:function(){this._unfixPlaceholder(),o.prototype._onHeaderUnfixed.apply(this,arguments)},beforeOverlayRemove:function(){this.$el.show(),this.offsetPlaceholder&&(this.offsetPlaceholder.remove(),this.offsetPlaceholder=null),this.fakeCardPlaceholder&&(this.fakeCardPlaceholder.remove(),this.fakeCardPlaceholder=null)},getClientAdInfo:function(){var e=s.getNested(this,"currentCardInfo","adTargeting")||"NA";return{cardsize:e}},_updateNav:function(e,i){var s,n,o=t.indexOf(this.cards,i),a=this._incrementIndex(o,1),r=this._incrementIndex(o,-1);this.header&&this.header.updateNavigation(e),this.domInitialized&&(-1===o&&(a=t.indexOf(this.cards,"home"),r=this._incrementIndex(a,-1)),s=this.cards[a],n=this.cards[r],this.updateNavLinks(this.$nextBtn,s),this.updateNavLinks(this.$prevBtn,n),this.$(".front-next-arrow-label").html(this.cardsDisplay[a]||s),this.$(".front-prev-arrow-label").html(this.cardsDisplay[r]||n),this.$nextBtn.removeClass().addClass("front-arrow-"+s),this.$prevBtn.removeClass().addClass("front-arrow-"+n),this.$(".front-overlay-next-arrows-anchor").removeClass().addClass("front-overlay-next-arrows-anchor "+s+"-theme-bg"),this.$(".front-overlay-prev-arrows-anchor").removeClass().addClass("front-overlay-prev-arrows-anchor "+n+"-theme-bg"))}});return m}),define("modules/scroller/sidebar-scroll",["jquery","underscore","modules/scroller/vertical-scroll"],function(e,t,i){var s=i.extend({initialize:function(s){t.bindAll(this,"onScrollUpdated","removeActiveClass"),s=e.extend({removeActiveDelay:700},s),Modernizr.touch&&(this.$el.css({"-webkit-overflow-scrolling":"touch"}),"touch"===this.$el.css("-webkit-overflow-scrolling")&&(this.$el.css({overflow:"scroll"}),s.disabled=!0)),this._addBottomShadow(),this._addTopShadow(),i.prototype.initialize.call(this,s),this.bar.addClass("hide")},bindEvents:function(){this.options.disabled||(this.$el.on("scrollBarUpdate."+this.cid,this.onScrollUpdated),i.prototype.bindEvents.apply(this,arguments))},destroy:function(e){this.$el.off("."+this.cid),this.topShadow.remove(),this.bottomShadow.remove(),clearTimeout(this.removeActiveClassDelay),clearTimeout(this.hideClassDelay),i.prototype.destroy.apply(this,arguments)},_addTopShadow:function(){this.topShadow=e('<div class="shadow top-shadow"></div>').hide(),this.$el.append(this.topShadow)},_addBottomShadow:function(){this.bottomShadow=e('<div class="shadow bottom-shadow"></div>').hide(),this.$el.append(this.bottomShadow)},removeActiveClass:function(){this.isMouseDown||this.isMouseOver||(this.bar.removeClass("active"),clearTimeout(this.removeActiveClassDelay),this.hideClassDelay=setTimeout(t.bind(function(){this.bar.addClass("hide")},this),1e3))},addActiveClass:function(e){this.bar.addClass("active"),this.bar.removeClass("hide"),this.startTimeout(e||this.options.removeActiveDelay)},startTimeout:function(e){clearTimeout(this.removeActiveClassDelay),this.removeActiveClassDelay=setTimeout(this.removeActiveClass,e)},onMouseOut:function(){i.prototype.onMouseOut.apply(this,arguments),this.isMouseDown||this.startTimeout(this.options.removeActiveDelay)},onMouseEnter:function(){i.prototype.onMouseEnter.apply(this,arguments),this.addActiveClass(this.options.removeActiveDelay)},onScrollUpdated:function(e,t){0===t?this.topShadow.hide():this.topShadow.show(),1===t?this.bottomShadow.hide():this.bottomShadow.show(),this.addActiveClass()}});return s}),define("modules/sidebar",["jquery","underscore","baseview","pubsub","state","modules/scroller/sidebar-scroll"],function(e,t,i,s,n,o){"use strict";var a=i.extend({events:{"click .open-sidebar":"openSidebarClick","click .close-sidebar":"closeSidebarClick"},initialize:function(s){this.sidebar=this.$(".sidebar"),this.sidebar.length&&(this.sidebarScrollableWindow=this.$(".sidebar-scrollable-window"),t.bindAll(this,"showSidebarOpenButton","showSidebarCloseButton","onScroll","_recalculateScrollBar"),s=e.extend(!0,{animations:{sidebar:{button:{fadeIn:200,fadeOut:200},slide:250}}}),this.pubSub={"sidebar:hide":this.closeSidebarClick,"sidebar:show":this.openSidebarClick,"showmore:headlines":this.onHeadlinesUpdated},i.prototype.initialize.call(this,s),this._addSidebar(),this.subviews.vscrollbar&&(this.refreshSidebarScroll=t.debounce(this._recalculateScrollBar,1e3)))},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&(this.isSidebarOpen=!0,this.refreshSidebarScroll&&this.refreshSidebarScroll())},onCardWidthChange:function(e){var t=e.sidebarOpen!==this.currentCardInfo.sidebarOpen||this.sidebarOpen!==e.sidebarOpen;this.currentCardInfo=e,this.resetSidebar(),t&&n.getActiveApp().triggerEvent(e.sidebarOpen?"openSideBar":"closeSideBar")},_recalculateScrollBar:function(){if(this.subviews.vscrollbar){this._setSideBarTitles();var e=this.$(".sidebar-fixed-content"),t=e.height(),i=this.sidebar.height(),s=Math.max(0,i-t);t>i&&(t=i,e.css("height",i)),s!==parseInt(this.sidebarScrollableWindow[0].style.height,10)&&(this.sidebarScrollableWindow.css("height",s),n.getActiveApp().triggerEvent("onSidebarScrollableHeightChange",t,s)),this.subviews.vscrollbar.refresh()}},_addSidebar:function(){this.openButton=this.$(".open-sidebar"),this.closeButton=this.$(".close-sidebar"),this.sidebarScrollableWindow.length&&(Modernizr.touch||this.initializeSidebarTitles(),this.subviews.vscrollbar=new o({el:this.sidebarScrollableWindow,contentClass:this.$(".sidebar-scrollable-content"),padding:2,lockPageScroll:!1,delayScroll:!1,fadeout:!0,onScroll:this.onScroll}))},initializeSidebarTitles:function(){this.$sidebarScrollableTitles=this.$(".sidebar-scrollable-content .sidebar-title-wrapper"),this.$sidebarStaticTitle=this.$(".sidebar-static-title-wrapper");var e=this.$(".sidebar-scrollable-content .sidebar-title-wrapper:first");e.length&&(e.hide(),this.$sidebarStaticTitle.html(e.html()).show())},_setSideBarTitles:function(){var t=this;this.sideBarTitles=[],this.$sidebarScrollableTitles&&this.$sidebarScrollableTitles.each(function(i,s){var n=e(s),o=!1;n.is(":hidden")&&(n.show(),o=!0);var a=n.position().top+n.outerHeight();o&&n.hide(),a=-1*a,t.sideBarTitles.push({position:a,html:n.html()})})},onScroll:function(e){if(this.$sidebarScrollableTitles.length>1&&0!==e){var t=this.$sidebarStaticTitle;this.sideBarTitles||this._setSideBarTitles();var i,s=this.sideBarTitles.length-1,n=t.html();for(s;s>=0;s--)if(i=this.sideBarTitles[s],i.position>e){n=i.html;break}t.html()!==n&&t.html(n)}},openSidebarClick:function(e){e&&e.preventDefault(),n.getActiveApp().triggerEvent("openSideBar"),this._slideSidebar(this.openButton,!0)},openSidebar:function(){this.isSidebarOpen=!0},closeSidebarClick:function(e){e&&e.preventDefault(),this._slideSidebar(this.closeButton,!1),n.getActiveApp().triggerEvent("closeSideBar")},closeSidebar:function(){this.isSidebarOpen=!1},_slideSidebar:function(e,i){var s=this.options.animations.sidebar.slide,o=this.options.animations.sidebar.button.fadeOut;n.registerAnimation(e.fadeOut(o,"easeInOutCubic").promise());var a=parseInt(this.sidebar.css("width"),10),r=null;if(this.currentCardInfo.sidebarOpen){var l=i?this.currentCardInfo:n.getActiveApp().getMinCardInfo();this.sidebar.removeClass("top"),r=this.animate(this.$.closest(".card"),"width",l.cardWidth,s,"ease-in-out")}else r=this.animate(this.sidebar,"right",-1*a,s,"ease-in-out");return r.then(t.bind(function(){var e=this.animate(this.sidebar,"right",0,s,"ease-in-out");return i?this.currentCardInfo.sidebarOpen?(this.sidebar.removeClass("top"),this.$el.closest(".card").css("width","")):(this.sidebar.addClass("top"),e.done(this.showSidebarCloseButton)):(e.done(this.showSidebarOpenButton),this.sidebar.removeClass("top")),e},this))},resetSidebar:function(){this.$el.closest(".card").css("width",""),this.sidebar.removeClass("top"),this.currentCardInfo.sidebarOpen?(this.openButton.hide(),this.closeButton.hide()):(this.adVisible?this.openButton.hide():this.openButton.show(),this.closeButton.hide()),this._setSideBarTitles()},showSidebarOpenButton:function(){this.adVisible||(this.openButton.css({visibility:"visible",display:"none"}),this.openButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic"))},showSidebarCloseButton:function(){this.closeButton.fadeIn(this.options.animations.sidebar.button.fadeIn,"easeInOutCubic")},onHeadlinesUpdated:function(){this.sidebarScrollableWindow.length&&(this.headlinesUpdate=setTimeout(this._recalculateScrollBar,1e3))},onHeroAdClose:function(){this.adVisible=!1,this.isSidebarOpen||this.showSidebarOpenButton()},onHeroAdOpen:function(){this.adVisible=!0,this.isSidebarOpen?this.currentCardInfo.sidebarOpen||this.closeSidebar():this.openButton.fadeOut(this.options.animations.sidebar.button.fadeOut,"easeInOutCubic")}});return a}),define("partner/overlay-ad-asset",["jquery","underscore","managers/autoplay","partner/overlay-ad-base","meteredAdPosition","adLogger"],function(e,t,i,s,n,o){"use strict";var a=s.extend({initialize:function(i){i=e.extend({adSizes:["elastic"],adPlacement:"transition",rateMeterId:"transition",pageInfo:null},i),t.bindAll(this,"onAdReady","stopAutoplay"),s.prototype.initialize.call(this,i),this.autoplayPromise=e.Deferred(),this.loadAdPlacement(this.options.pageInfo),o.logDebug("Partner Metered Overlay initialized",this)},loadAdPlacement:function(e){e=e||this.options.pageInfo,this.subviews.ad=new n({el:this.$placement,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,rateMeterId:this.options.rateMeterId,pageInfo:e,onAdReady:this.onAdReady,beforeAdRender:this.onResize})},triggerAd:function(){var e="transition_referrer"===this.options.adPlacement,t=this.options.pageInfo.excludeTransitionAd;this._tickMeterFetchAd(t),i.register("high-impact-ad",this.stopAutoplay),e&&!t&&this.$placement.children(".partner-overlay-close").data("uotrack","referreradclosed")},stopAutoplay:function(){return!1},getCurrentMeterCount:function(){return this._tellAd("getCurrentMeterCount")},_tickMeterFetchAd:function(e){this.tickMeter(e)&&!e&&this.subviews.ad.prefetchAd()},tickMeter:function(e,t){return this._tellAd("tickMeter",e,t)},_tellAd:function(e){var t=this.subviews.ad;return t&&t[e]?t[e].apply(t,Array.prototype.slice.call(arguments,1)):null},resetMeter:function(e){return this._tellAd("resetMeter",e)},refresh:function(e){this.destroyAdPosition(),this.loadAdPlacement(e)}});return a}),define("modules/partner/story-transition-ad",["jquery","underscore","baseview","state","site-manager","utils","admanager","partner/overlay-ad-asset"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.renderAd()},renderAd:function(){var e=s.getReferrer(),i=s.getActivePageInfo(),l=o.hasAutoplayVideo(i),h=i&&i.ssts?i.ssts:"",d=h.match("reviewedcom"),c="get-access"===h,u={el:this.$el,pageInfo:i,getHeaderOffset:function(){var e=n.getHeader();return e?e.getExpandedHeight():0}},p=!1,f=function(e){var t=["/search/","/story/","/media/"];if(!e)return!0;for(var i=0;i<t.length;i++)if(0===e.indexOf(t[i]))return!1;return!0};e&&f(s.lastUrl)&&(u.adPlacement="transition_referrer",u.rateMeterId="transition_referrer",p=!0),this.subviews.transitionAd=new r(u),Modernizr.history||(p=!0),0===this.subviews.transitionAd.getCurrentMeterCount()&&(p=!0),a.getActiveSlotStatistics().done(t.bind(function(e){this.destroyed||(t.findWhere(e.high_impact_info,{adType:"gravity"})&&p&&(p=!1,this.subviews.transitionAd.resetMeter("transition")),!p||l||d||c?this.subviews.transitionAd.tickMeter(!0,"transition"):this.subviews.transitionAd.triggerAd(),"transition_referrer"===u.rateMeterId&&this.subviews.transitionAd.resetMeter("transition"))},this))},getTransitionMeterCount:function(){return this.subviews.transitionAd?this.subviews.transitionAd.getCurrentMeterCount("transition"):0}});return l}),define("modules/partner/article-inline-ad",["jquery","underscore","baseview","utils","directAdPosition","adLogger","state"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({receivedData:!1,count:20,initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"_onSpikeReady","_onSafeFrameMsg","_setupSpike","_onSlotEmpty"),this.subviews.adPosition=new n({el:this.$el,adType:"Article Inline Ad",adPlacement:e.adPlacement,adSizes:["fluid",[3,3]],onAdReady:this._onSpikeReady,onNoAd:this._onSlotEmpty}),window.addEventListener("message",this._onSafeFrameMsg,!1)},_onSafeFrameMsg:function(e){if(e&&"string"==typeof e.data&&"{"===e.data.charAt(0)&&!this.receivedData)try{var t=JSON.parse(e.data);"spike"===t.adType?(this.receivedData=!0,o.logDebug("Branded Content Spike Data Received",t),t.url=t.url.replace(/^.+\:\/\/[^\/]+/,""),this._setupSpike(t)):"paramount"===t.adType&&(this.receivedData=!0,o.logDebug("Paramount Data Received",t),this.$el.addClass("ad-gray-border ad-notice ad-paramount-inline"))}catch(i){o.logDebug("Article Inline Ad Failed to parse JSON data")}},_setupSpike:function(e){var i=t.template(e.template)(e);this.$el.hide().after(i)},_onSpikeReady:function(){var e=this.$(".ad-slot > div > iframe")[0],i=e.contentWindow,n=document.location.origin,a=JSON.stringify({bcSpike:!0,origin:n});this.subviews.adPosition.show(),o.logDebug("SENDING MESSAGE",a);try{var r=s.getNested(i,"location","origin");r&&"null"!=r||(this.msgInt=setInterval(t.bind(function(){this._sendMsg(i,a,r)},this),100))}catch(l){this.msgInt=setInterval(t.bind(function(){this._sendMsg(i,a)},this),100)}},_sendMsg:function(e,t,i){this.count--,(!this.count||this.receivedData)&&clearInterval(this.msgInt),i=i&&"null"!==i?i:window.location.protocol+"//tpc.googlesyndication.com",e.postMessage(t,i)},_onSlotEmpty:function(){var t=a.getActivePageInfo(),i=s.hasAutoplayVideo(t),o=e(".partner-outstream").length;o||i||(this.el.classList.add("partner-outstream"),this.subviews.outstreamAd=new n({el:this.el,adSizes:[1,1],adPlacement:"outstream_video",adType:"outstream",pageInfo:t}))},destroy:function(e){window.removeEventListener("message",this._onSafeFrameMsg,!1),clearInterval(this.msgInt),i.prototype.destroy.call(this,e)}});return r}),define("partner/gravity-ad-article",["jquery","underscore","utils","sharedAdPosition","managers/autoplay","partner/gravity-ad"],function(e,t,i,s,n,o){"use strict";var a=o.extend({articleElsHidden:!1,initialize:function(e){o.prototype.initialize.call(this,e);var t=this.options.contentSection;this.$recommended=t.find(".recommended-flyout-container"),this.$utilityBarPrimaryModules=t.find(".util-bar-primary-modules"),this.$utilityBarSecondaryModules=t.find(".util-bar-secondary-modules"),this.$closeWrap=t.find(".close-wrap"),this._createAd(["gravity"],"gravity")},_createAd:function(){var e=this._filterAdsByCardWidth(["gravity"]);this.subviews.adPosition=new s({el:this.$el,adPlacement:"high_impact",adSizes:e,adType:"gravity",onAdReady:this.onAdReady,beforeAdRender:this.beforeAdRender})},beforeAdRender:function(e){this.adData=e,n.register("high-impact-ad",this.startAutoPlay)},onAdReady:function(e){this.showAd(),this.options.slot.css({minHeight:null}).removeClass("partner-has-min-height"),i.get("scrollEl").animate({scrollTop:0},500)},onArticleScroll:function(e,t){var i=this.$utilityBarSecondaryModules.height();.1>e&&this.articleElsHidden?(this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:0},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$recommended.show(),this.$closeWrap.show(),this.$body.removeClass("high-impact-ad-visible"),this.articleElsHidden=!1):e>.1&&!this.articleElsHidden&&(this.$recommended.hide(),this.$closeWrap.hide(),this.$utilityBarSecondaryModules.stop("gravity").animate({bottom:-1*i},{duration:200,queue:"gravity"}).dequeue("gravity"),this.$body.addClass("high-impact-ad-visible"),this.articleElsHidden=!0),0>=e?(this.$utilityBarPrimaryModules.css({position:"fixed",top:80+t}),this.$closeWrap.css({position:"fixed",top:80+t})):e>0&&(this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$closeWrap.css({position:"absolute",top:80}))},shiftContentUp:function(){o.prototype.shiftContentUp.call(this),this.$utilityBarPrimaryModules.css({position:"absolute",top:80}),this.$partnerScroll.animate({"margin-top":-145},350)},showAd:function(){o.prototype.showAd.call(this),this.shiftContentUp()}});return a}),define("apps/overlay/overlay",["jquery","underscore","backbone","utils","site-manager","apps/simple-overlay","state","admanager","managers/requestmanager","modules/partner/story-transition-ad","modules/partner/article-inline-ad","directAdPosition","meteredAdPosition","partner/gravity-ad-article","partner/digital-wrap","managers/routemanager","pubsub","sharedAdPosition"],function(e,t,i,s,n,o,a,r,l,h,d,c,u,p,f,g,m,v){"use strict";var b=o.extend({el:"#overlay",events:function(){return e.extend({},o.prototype.events,{"click .overlay-content-arrows":"nextArticleClick"})},initialize:function(i){i=e.extend({inbetweenAdTemplate:'<div class="partner-inbetween transition-wrap"><div class="partner-inbetween-content partner-placement"></div></div>'},i),this.init=!1,this.$doc=s.get("doc"),this.$body=s.get("body"),this.$win=s.get("win"),t.bindAll(this,"keyboardEvent","beforeInbetweenAdRender","afterPageReveal","_overlayScrollListener","_setupInlineSpike","loadTeadsAd"),this.pbLog=s.getUrlParam("pb_console"),this.pbLog&&console.log("OVERLAY: Init --------------------",Date.now()),this.currentStoryIndex=-1,this.storyCollection=[],this.animationIndex=0,this.setupSourcePoint(),o.prototype.initialize.call(this,i)},resizeHandler:function(){o.prototype.resizeHandler.apply(this,arguments),this.inbetweenAd&&this.inbetweenAd.resizeAd(980,this.winSize.height),this.$inbetweenPartner&&this.$inbetweenPartner.css(this.winSize)},afterPageReveal:function(e,i,n,a){o.prototype.afterPageReveal.apply(this,arguments),this.$doc.on("keyup."+this.cid,this.keyboardEvent),this.init?(this.renderInbetweenAd(),this.updateArrowLinks()):(this.initializeDom(),this.init=!0,this.updateArrowLinks(!0),this.subviews.storyTransitionAd=new h({el:this.$(".partner-overlay")}),0===this.subviews.storyTransitionAd.getTransitionMeterCount()&&this.renderInbetweenAd()),null!==e?this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex):s.flag("disable_overlay_preload")&&this.fetchStoryCollection().done(t.bind(function(){this.updateArrowLinks(!0),this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex)},this)),this.freeTrialCheck(),this.spikeAdLoaded=!1,this.$spikeAdEl=this.$(".partner-spike"),this._overlayScrollListener(),this.overlayScrollListenerThrottle=t.throttle(this._overlayScrollListener,16,{leading:!1,trailing:!0}),this.$win.on("scroll."+this.cid,this.overlayScrollListenerThrottle),this.loadAdPlacements()},_overlayScrollListener:function(){!this.spikeAdLoaded&&this.$spikeAdEl.length&&"outside"!==s.isElementInViewport(this.$spikeAdEl)&&(this._setupInlineSpike(),this.spikeAdLoaded=!0)},_setupInlineSpike:function(){var e=a.getActivePageInfo(),i=e&&e.ssts?e.ssts.match("reviewedcom"):!1;e.sponsored_series||e.sponsor_story||e.series||e.noadvertising||i||!this.$spikeAdEl||r.getActiveSlotStatistics().done(t.bind(function(e){t.findWhere(e.high_impact_info,{adType:"gravity"})||s.getNested(this.subviews.inlineAd)||(this.subviews.inlineAd=new d({el:this.$spikeAdEl,adPlacement:"native-article_link"}))},this))},loadAdPlacements:function(){var i=this.$(".partner-overlay-top-ad"),o=(this.$(".partner-spike"),this.$(".transition-wrap:first")),r=a.getActivePageInfo(),l=s.hasAutoplayVideo(r),h=r&&r.ssts?r.ssts.match("reviewedcom"):!1,d=(s.getNested(window.site_vars,"ADS","story_top_ad","enabled_section")||"").split(","),u=s.getNested(r,"comma_ssts")||"",g=s.getNested(window.site_vars,"ADS","story_top_ad","enabled")||t.intersection(u.split(","),d).length>0,m=s.getNested(window.site_vars,"ADS","partner_send2news","playerTimeout"),b=s.getNested(window.site_vars,"ADS","partner_send2news","section_name"),y=s.getNested(window.site_vars,"ADS","partner_send2news","subsection_name"),w=this.$$(".partner-video"),_=this.$$(".story-oembed-sendtonews");this.header=n.getHeader(),this.breakingbar=s.getNested(this.header,"subviews","breakingbar"),r&&r.sponsor_story&&this.breakingbar&&this.breakingbar.closeBreakingBar(),this.showSend2News=!1,s.getNested(window.site_vars,"ADS","partner_send2news","enabled")&&!_.length&&(this.showSend2News=r.section_name&&-1!==r.section_name.indexOf(b)||y&&-1!==y.indexOf(u.split(",")[1])),this.pbLog&&console.log("OVERLAY: Load ads ----------------",Date.now()),r.sponsored_series||r.sponsor_story||r.series||"get-access"===r.ssts||(g&&"video-asset"!==r.basePageType&&"gallery-asset"!==r.basePageType&&(this.subviews.billboardAd=new v({defaultPosition:!0,el:i,adPlacement:"high_impact",adSizes:s.getNested(window.site_vars,"ADS","story_top_ad","sizes")||["billboard","leaderboard","generic"],adType:["Billboard","Leaderbaord"],onAdReady:function(e,i,s){var n="",o=t.isArray(s)?s[1]:0;if(o>1){switch(o){case 90:n="is-leaderboard";break;case 250:n="is-billboard"}this.el.addClass(n).show()}}})),l||h||"gallery-asset"===r.basePageType||(this.subviews.gravityAd=new p({el:this.$(".partner-gravity-ad"),contentSection:this.$el,slot:i})),!w.length||r.breaking===!0&&s.getNested(window.site_vars,"ADS","breaking_news")||l||!r.asset_status||"published"!==r.asset_status.toLowerCase()||h||(s.getNested(window.site_vars,"ADS","partner_inform","enabled")?this.requirePartnerScript("inform").done(t.bind(function(){var e=window._informq||[];e.push(["embed"]),e.push(["hook","inform-placement-1/placementUnavailable",t.bind(this.loadTeadsAd,this)])},this)):this.showSend2News?(this.requirePartnerScript("send2news"),setTimeout(t.bind(function(){w.length||(w.remove(),this.loadTeadsAd())},this),m)):this.loadTeadsAd())),(s.getNested(window.site_vars,"ADS","digital_wrap")||s.getUrlParam("dw_debug"))&&(this.subviews.DigitalWrap=new f({el:i,slot:i,container:o,backgroundEl:o}),this.subviews.sponsorLogo=new c({el:this.$(".partner-sponsor-logo"),adType:"Sponsor Logo",adSizes:[800,40],adPlacement:"sponsor_logo"})),setTimeout(function(){e(window).trigger("fetchPrebid");
},s.getNested(window.site_vars,"ADS","prebid","timeout","overlay")||50)},loadTeadsAd:function(){var e=a.getActivePageInfo();s.getNested(window.site_vars,"ADS","teads_enabled")&&r.getActiveSlotStatistics().done(t.bind(function(i){t.findWhere(i.high_impact_info,{adType:"gravity"})||(this.subviews.outstreamAd=new c({el:this.$(".partner-outstream"),adSizes:[1,1],adPlacement:"outstream_video",adType:"outstream",pageInfo:e}))},this))},preloadPath:function(){a.preloadPath(this.preloadedUrl).done(t.bind(function(){this.updateArrowLinks(!0),this.triggerEvent("storyCollectionLoaded",this.getStoryCollection(),this.currentStoryIndex)},this))},beforeInbetweenAdRender:function(){this.inbetweenAd.setInitialDimensions(980,this.winSize.height)},renderInbetweenAd:function(){var i=a.getActivePageInfo();this.$inbetweenPartner?this.$inbetweenPartner.parent().length||this.$el.append(this.$inbetweenPartner.hide()):(this.$inbetweenPartner=e(this.options.inbetweenAdTemplate),this.$el.append(this.$inbetweenPartner)),this.inbetweenAd?this.isShowingAd&&(this.isShowingAd=!1):this.inbetweenAd=new u({el:this.$inbetweenPartner.find(".partner-inbetween-content"),adPlacement:"transition",adSizes:[[1,1]],beforeAdRender:this.beforeInbetweenAdRender,rateMeterId:"transition"}),this.inbetweenAd.setPageInfo(a.getActivePageInfo()),this.inbetweenAd.tickMeter(!0)&&r.getActiveSlotStatistics().done(t.bind(function(e){t.findWhere(e.high_impact_info,{adType:"gravity"})||"get-access"===i.ssts?this.inbetweenAd.resetMeter():(this.timeToShowAd=!0,this.inbetweenAd.refreshPosition())},this))},keyboardEvent:function(t){if(t.target===this.$body[0]&&!window.pluto360Asset)switch(t.which){case 37:e(".overlay-content-arrows-previous-wrap").trigger("click");break;case 39:e(".overlay-content-arrows-next-wrap").trigger("click")}},nextArticleClick:function(i){var s=1,n=e(i.currentTarget),o=n.attr("href"),a=this.inbetweenAd;if(n.hasClass("overlay-content-arrows-previous-wrap")&&(s=-1),this.subviews&&this.subviews.billboardAd&&this.subviews.billboardAd.hide(),!this.isShowingAd&&this.timeToShowAd&&a.isAdReady()&&(a.tickMeter(),this.timeToShowAd=!1,i.preventDefault(),g.goToInterstitual(o))){var r=this.getStoryCollection();return n.siblings().remove(),this.arrowContainer.append(this.buildArrowDom(r[this.currentStoryIndex],0>s?"next":"previous")),this.currentStoryIndex+=s/2,a.showAd(980,this.winSize.height),this.animateToContent(this.$inbetweenPartner,s).done(t.bind(function(){a&&(this.isShowingAd=!0,a.playAd())},this))}},initializeDom:function(){this.arrowWrapTemplate=this.$("#overlay-arrow-wrap"),this.arrowContainer=this.$(".overlay-arrows")},destroyModules:function(){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),o.prototype.destroyModules.apply(this,arguments)},beforeAppRemove:function(e,t){this.inbetweenAd&&(this.inbetweenAd.destroy(),this.inbetweenAd=null),o.prototype.beforeAppRemove.apply(this,arguments)},updateArrowLinks:function(e){if(-1!==this.currentStoryIndex||(this.currentStoryIndex=this.getBestStoryIndex(window.location.pathname,e),-1!==this.currentStoryIndex)){var t=this.getStoryCollection(),i=this.buildArrowDom(t[this.currentStoryIndex-1],"previous"),s=this.buildArrowDom(t[this.currentStoryIndex+1],"next");this.arrowContainer.empty().append(i).append(s)}},buildArrowDom:function(i,s){var n=!i;if(i?i.disabled="":i={disabled:"disabled"},i.dir=s,i.photo&&i.photo.crops&&i.photo.crops["1_1"]&&-1!==i.photo.crops["1_1"].indexOf(".jpg")&&(i.image=i.photo.crops["1_1"]),!this.arrowWrapTemplate.length)return e([]);var o=e(e.trim(t.template(this.arrowWrapTemplate.html(),i)));return n?this.isApple?o.css({display:"none"}):o.css({"z-index":1}):this.isApple&&o.find(".preview").remove(),o},getBestStoryIndex:function(e,t){e&&"/"!==e[0]&&(e="/"+e);var i=this.getStoryCollection();if(!i||0===i.length)return-1;var s=-1,n=-1,o=Math.round(this.currentStoryIndex);-1===o&&(o=0);var a;for(a=o;a>=0;a--)if(i[a].links===e){s=a;break}for(a=o;a<i.length;a++)if(i[a].links===e){n=a;break}if(-1===n&&-1===s&&t){var r={links:e};return this.storyCollection.unshift(r),0}return-1===n?s:-1===s?n:n-o>o-s?s:n},fetchStoryCollection:function(i){return(i=i||this.currentSection)?(i="/"===i?"home":i.replace(/\//g,""),l.fetchData("/services/assets/collection/"+i,{},!1,!1,!1).then(t.bind(function(e){this.storyCollection=t.filter(e,this._filterStoryCollection)},this))):e.Deferred().reject()},getStoryCollection:function(){if(0===this.storyCollection.length){var e=a.getPreloadedPageInfo(),i=e&&e.asset_collection;i&&(this.storyCollection=t.filter(i,this._filterStoryCollection))}return this.storyCollection},_filterStoryCollection:function(e){var t,i,s;return e.links&&(t=g.getInfo(e.links),i=t&&t.app&&t.app.AppClass),s=i===b,e.headline&&e.links&&!e.links.match("http")&&s},animateChangePagePreData:function(t,i){var s,n=this.getBestStoryIndex(i);return-1!==this.currentStoryIndex&&-1!==n&&(s=this.currentStoryIndex>n?"left":"right"),this.currentStoryIndex=n,this.animateToContent(e(this.options.template).find(".transition-wrap"),s)},animateToContent:function(i,o){var a=this.winSize.height,r=s.getScrollPosition(),l=this.$(".transition-wrap:first");if(r-=n.scrollTop(0),this.$el.css({position:"relative"}),l.css({overflow:"hidden"}),this.prepareContentForTransition(l,r,a),i.css({position:"absolute",top:0,display:"block"}),i.attr("data-animation-index",++this.animationIndex),this.prepareContentForTransition(i,0,a),i.closest("body").length||this.$el.prepend(i),this.header.isFixed()&&this.positionCloseButton("absolute",r,l),o){l.css({left:"0%"});var h,d="0%";return"left"===o?(i.css("left","-100%"),h="100%"):(i.css("left","100%"),h="-100%"),s.getNested(window.site_vars,"flags","disable_overlay_animations")?(l.css("left",h),i.css("left",d),this.postAnimate(i,l),e.Deferred().resolve()):e.Deferred(t.bind(function(s){var n=e.when(this.animate(l,"left",h,350,"ease-in-out"),this.animate(i,"left",d,350,"ease-in-out"));n.done(t.bind(function(){this.postAnimate(i,l),s.resolve()},this))},this)).promise()}return this.afterLoaderReveal(),i.css({position:"relative"}),this.swapContent(l,i)},postAnimate:function(e,t){this.afterLoaderReveal(),this.isShowingAd&&this.inbetweenAd&&this.inbetweenAd.destroyAdPlacement(),t.remove(),parseInt(e.attr("data-animation-index"),10)===this.animationIndex&&this.resetContentTransition(e)},prepareContentForTransition:function(e,t,i){e.css({height:i}),e.children().css({top:-1*t})},resetContentTransition:function(e){e.css({position:"relative"}),this.$el.css({position:"",top:""})},freeTrialCheck:function(){var e=window.location.href;e.indexOf("freeTrialComplete")>-1&&m.trigger("freetrialtrack")},setupSourcePoint:function(){window._sp_&&s.getNested(window.site_vars,"ADS","sourcepoint","onOverlay")&&!window._sp_.displayed_message&&(window._sp_.mms=window._sp_.mms||{},window._sp_.mms.cmd=window._sp_.mms.cmd||[],window._sp_.mms.cmd.push(function(){window._sp_.mms.startMsg()}))},requirePartnerScript:function(i){var n=e.Deferred();switch(i){case"inform":var o=require.config({paths:{partnerInform:s.getNested(window.site_vars,"ADS","partner_inform","scriptUrl")}});o(["partnerInform"],t.bind(function(){n.resolve()},this));break;case"send2news":var a=require.config({paths:{partnerSend2news:s.getNested(window.site_vars,"ADS","partner_send2news","scriptUrl")}});a(["partnerSend2news"],t.bind(function(){n.resolve()},this))}return n}});return b}),define("modules/global/userUtil",["jquery","underscore","baseview","utils"],function(e,t,i,s){"use strict";var n=i.extend({initialize:function(){this.deferred=null,this.PersonalizedLinkFactory=null,this.UserFactory=null,this.ClientHelpers=null,i.prototype.initialize.call(this)},getUser:function(){if(!this.deferred){this.deferred=e.Deferred();var t={gupasURLTemplate:"https://user-stage.{domain-name}/{uaid}/{path}"},i=null,n=s.getNested(window.site_vars,"base_url")||"",o=s.getNested(window.site_vars,"gupUAID")||"";this.poll(this.checkFactories,function(){return this.setFactories(),i="prod"===s.getNested(window.site_vars,"site_env")||"production"===s.getNested(window.site_vars,"site_env")?new this.UserFactory:new this.UserFactory(t),n&&o&&i&&this.PersonalizedLinkFactory?void i.fetch(n,o,function(e){var t=new this.PersonalizedLinkFactory(e),i={};i.forGuid=this.PersonalizedLinkFactory.getGuidFromUrl(window.location),i.forGuidSession=this.PersonalizedLinkFactory.getSessionGuidFromUrl(window.location),t.doFeature(window.location,n,o),this.deferred.resolve(e.data,i)}.bind(this)):(console.warn("UserUtil: No domain name and/or uaid found"),this.deferred.reject())}.bind(this),function(){return console.warn("UserUtil: No factories found"),this.deferred.reject()}.bind(this))}return this.deferred},poll:function(e,t,i,s,n){var o=Number(new Date)+(s||2e3);n=n||100,function a(){e()?t():Number(new Date)<o?setTimeout(a,n):i(new Error("timed out for "+e+": "+arguments))}()},checkFactories:function(){return"UserFactory"in window&&"PersonalizedLinkFactory"in window&&"ClientHelpers"in window?!0:!1},setFactories:function(){"UserFactory"in window&&"PersonalizedLinkFactory"in window&&"ClientHelpers"in window&&(this.UserFactory=window.UserFactory,this.PersonalizedLinkFactory=window.PersonalizedLinkFactory,this.ClientHelpers=window.ClientHelpers)}});return n}),function(){var e="undefined"!=typeof exports?exports:window,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=function(){try{document.createElement("$")}catch(e){return e}}();e.btoa||(e.btoa=function(e){for(var s,n,o=0,a=t,r="";e.charAt(0|o)||(a="=",o%1);r+=a.charAt(63&s>>8-o%1*8)){if(n=e.charCodeAt(o+=.75),n>255)throw i;s=s<<8|n}return r}),e.atob||(e.atob=function(e){if(e=e.replace(/=+$/,""),e.length%4==1)throw i;for(var s,n,o=0,a=0,r="";n=e.charAt(a++);~n&&(s=o%4?64*s+n:n,o++%4)?r+=String.fromCharCode(255&s>>(-2*o&6)):0)n=t.indexOf(n);return r})}(),define("base64",function(){}),define("third-party-apis/firefly/firefly",["jquery","underscore","third-party-apis/base-third-party-api","managers/requestmanager","utils","modules/global/userUtil","base64"],function(e,t,i,s,n,o){"use strict";var a=i.extend({getUserInfo:function(){return this.userInfo&&"rejected"!==this.userInfo.state()||(this.userInfo=this.getUserResponse().then(function(i,s){var o=i,a=n.getNested(window.site_vars,"userAuthentication","user","response_user_path");return t.each(a,function(e){o=n.getNested(o,e)}),o.userInfo=i,o.personalizedLinkData=s,i.meta.isAuthenticatedInCurrentContext||0===i.meta.status?o:e.Deferred().reject("Not logged in.")})),this.userInfo},getUserAttributes:function(){return this.userAttributes||(this.userAttributes=this.getUserResponse().then(function(t,i){if(200===t.meta.status){var s=e.extend({},n.getNested(t,"response","user","profileAttributes"),n.getNested(t,"response","attributes"));return{userAttributes:s,personalizedLinkData:i}}return e.Deferred().reject("Attribute retrieval failed.")})),this.userAttributes},getUserResponse:function(){return this.userUtil||(this.userUtil=new o),this.userResponse||(this.userResponse=this.userUtil.getUser()),this.userResponse},sanitizeFireflyViewsObject:function(e){return t.isObject(e)?e.viewCount&&e.viewThreshold&&e.viewedContent?t.isNumber(e.viewCount)&&t.isNumber(e.viewThreshold)&&t.isArray(e.viewedContent)?(e.viewCount<1&&(e.viewCount=1),e.viewThreshold<1&&(e.viewThreshold=1),e.viewCount>e.viewThreshold&&(e.viewThreshold=e.viewCount),e):(console.error("Wrong format in Firefly views object values"),!1):(console.error("Missing Firefly views object properties"),!1):(console.error("Firefly views cookie is not an object"),!1)},getFireflyViewsCookie:function(){var t=null,i=e.cookie("firefly_akamai_open");if(i&&(t=this._parseCookie(i))){t=this.sanitizeFireflyViewsObject(t);var s=t.viewThreshold-t.viewCount;t.viewsRemaining=s}return t},_parseCookie:function(e){try{return JSON.parse(atob(e))}catch(t){try{return JSON.parse(e)}catch(i){}}return null},getLoginStatus:function(){return this.getUserInfo()},loginUser:function(){return this.getLoginStatus()},logoutUser:function(){return this.userInfo=null,this.userAttributes=null,this.userResponse=null,e.Deferred().resolve()}});return new a}),define("modules/stories/utility-bar-module-popups",["jquery","underscore","backbone"],function(e,t,i){var s=i.View.extend({});return new s}),define("modules/stories/utility-bar",["jquery","underscore","backbone","pubsub","utils","state","baseview","site-manager","managers/resourcemanager","third-party-apis/firefly/firefly","user-manager","modules/stories/utility-bar-module-popups","managers/autoplay"],function(e,t,i,s,n,o,a,r,l,h,d,c,u){var p=a.extend({el:".utility-bar-wrap",events:{"click .util-bar-btn":"onClickUtilityBtn"},initialize:function(i){t.bindAll(this,"onDestroySubview","scrollHandler","breakingNewsCheck","breakingNewsCloseCheck","onVideoBarExpand","onVideoBarCollapse"),this.pubSub={"user:statuschange":this._loginStatus,"fireflyout:open":this.allowOpenFireflyout,"video:after:expandBar":this.onVideoBarExpand,"video:collapseBar":this.onVideoBarCollapse,"breakingbar:after:open":this.breakingNewsCheck,"breakingbar:after:close":this.breakingNewsCloseCheck},this.$primaryModules=this.$(".util-bar-primary-modules"),this.$secondaryModules=this.$(".util-bar-secondary-modules"),this.canFireflyoutOpen=!n.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY","ENABLED")||!1,this.isFireflyoutOpen=!1,this.header=r.getHeader(),this.header&&this.header.isFixed()&&this.onHeaderFixed(),this.win=n.get("win"),this.breakingNewsCheck(),this.win.on("scroll."+this.cid,t.throttle(this.scrollHandler,50)),a.prototype.initialize.call(this,i),this.autoPopoutComments(),this.fireflyAutoplayEnabled=n.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","autoplayEnabled")||!1,this.fireflyAutoplayEnabled&&(t.bindAll(this,"resolveFireflyPromise","returnFireflyPromise"),this.fireflyAutoplayPromise=e.Deferred(),u.register("firefly",this.returnFireflyPromise)),this.setupFireflyout()},resolveFireflyPromise:function(){this.fireflyAutoplayEnabled&&this.fireflyAutoplayPromise.resolve()},returnFireflyPromise:function(){return this.fireflyAutoplayPromise},breakingNewsCloseCheck:function(){this.breakingbar=!1,this.bnmHeight=0},breakingNewsCheck:function(){this.breakingbar=n.getNested(this.header,"subviews","breakingbar")||!1,this.bnmHeight=e(".bnm-bar").outerHeight()||0},onVideoBarExpand:function(){this.videoOffset=e(".js-pvb").outerHeight(),this.scrollHandler()},onVideoBarCollapse:function(){this.videoOffset=0,this.$primaryModules.css({top:120})},scrollHandler:function(){var e=this.$primaryModules[0].getBoundingClientRect(),t=this.$primaryModules.offset().top,i=this.$el.offset().top,s=this.bnmHeight||0,n=this.videoOffset||0,o=s+n;80>t-i+o?this.$primaryModules.css({position:"absolute",top:""}):e.top<=120+o&&this.$primaryModules.css({position:"fixed",top:120+o})},autoPopoutComments:function(){this.$commentsBtn=this.$(".util-bar-btn-comments"),window.location.search.search("[?&]fb_comment_id=.+")>-1&&t.defer(t.bind(function(){this.openComments()},this))},setupFireflyout:function(){this.$fireflyModule=this.$(".util-bar-module-firefly"),this.$fireflyBtn=this.$(".util-bar-btn-firefly"),this.$fireflyModule.length?this._checkUserAccount():this.resolveFireflyPromise()},_checkUserAccount:function(){var e=d.getAccount("firefly");e?e.getUserInfo().always(t.bind(function(t){this._loginStatus("firefly",e.getLoginStatus(),t)},this)):this.resolveFireflyPromise()},_loginStatus:function(e,t,i){if("firefly"!==e)return void this.resolveFireflyPromise();"loggedIn"===t?this.$fireflyModule.addClass("util-bar-module-firefly-authenticated"):"loggingIn"!==t&&this.$fireflyModule.removeClass("util-bar-module-firefly-authenticated");var s=o.getActivePageInfo().content_protection_state,n=!s||"free"===s;"loggedIn"===t&&i&&i.hasMarketAccess||n?(this.$fireflyModule.removeClass("util-bar-module-firefly-visible"),this.resolveFireflyPromise()):"loggingIn"!==t&&(this.$fireflyModule.addClass("util-bar-module-firefly-visible"),this.fireflyCookieCheck())},fireflyCookieCheck:function(){this.shouldShowFireFly()?t.delay(t.bind(function(){this.isFireflyoutOpen=!0,this.openFireflyout()},this),0):this.resolveFireflyPromise()},shouldShowFireFly:function(){var e=o.getActivePageInfo(),t=h.getFireflyViewsCookie(),i=n.hasAutoplayVideo(e);return t&&this._canFireflyoutOpen()&&!this.isFireflyoutOpen&&(1===t.viewCount||t.viewsRemaining<2||this._overrideFlyoutOpen(t.viewsRemaining))&&!i},_overrideFlyoutOpen:function(e){return t.indexOf(n.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","flyoutOverrideArticleViewsRemaining"),e)>-1},_canFireflyoutOpen:function(){return this.canFireflyoutOpen},allowOpenFireflyout:function(){this.canFireflyoutOpen=!0;var e=d.getAccount("firefly");if(e){var t=e.getLoginStatus();("loggedIn"!==t||"loggingIn"!==t)&&this.fireflyCookieCheck()}},openFireflyout:function(){s.trigger("track",{label:"utilitybarfireflyopen|auto"}),this.$fireflyBtn.trigger("click")},openComments:function(){this.$commentsBtn.trigger("click")},onHeaderFixed:function(){this.$primaryModules.css({position:"fixed",top:"auto"})},onHeaderUnfixed:function(){this.$primaryModules.css({position:"absolute",top:""})},onClickUtilityBtn:function(i){var n=e(i.currentTarget);if(n.data("popup-callback")){var o=n.data("popup-callback");c[o]()}else if("A"!==n.prop("tagName")){i.preventDefault();var a=n.data("module-name"),r=n.data("module-section")||"";this.subviews[a]?r&&r!==this.subviews[a].activeSection?("utility-bar-module-firefly"===a&&void 0===i.isTrigger&&s.trigger("track",{label:"utilitybarfireflyopen|click"}),this.subviews[a].open(r)):this.subviews[a].close&&this.subviews[a].close():(t.each(this.subviews,function(e){e&&e.close&&e.close()}),l.getSiteModuleByName(a).done(t.bind(function(e){this.destroyed||(this.subviews[e.name]=new e.ModuleClass(t.extend({el:e.selector,onDestroy:this.onDestroySubview},e.options)),this.subviews[e.name].open&&("utility-bar-module-firefly"===a&&void 0===i.isTrigger&&s.trigger("track",{label:"utilitybarfireflyopen|click"}),this.subviews[e.name].open(r)))},this)).fail(function(){console.error("Failed to load utility bar module: "+a+".js")}))}},onDestroySubview:function(e){t.each(this.subviews,function(t,i){t===e&&(this.subviews[i]=null)},this)},show:function(){this.$el.addClass("show")},hide:function(){this.$el.removeClass("show")},destroy:function(e){this.destroyed=!0,this.$el.css("padding-top",n.getScrollPosition()),this.$primaryModules.css("position","absolute"),this.$secondaryModules.css("position","absolute"),this.win.off("."+this.cid),a.prototype.destroy.call(this,e)}});return p}),define("modules/stories/recommended-flyout",["jquery","underscore","baseview","utils","state","managers/cachemanager"],function(e,t,i,s,n,o){"use strict";var a=i.extend({events:{"click .closed":"toggle","click .recommended-flyout-close":"toggle"},initialize:function(){t.bindAll(this,"scrollListener","fetchTrendingStories"),this.isOpen=!1,this.forcedStatus=!1,this.hasOpened=!1,this.rendered=!1,this.$flyout=this.$(".recommended-flyout"),this.$flyoutWrap=this.$(".recommended-flyout-wrap"),this.$flyoutTemplate=this.$("#recommended-flyout-template"),this.$win=s.get("win"),this.winHeight=this.$win.height(),this.trackLimit=10,this.audienceSegments=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(),this.trendingUrl="/feeds/recommended-for-you/",this.trackAsset(),this.getRecommendation(),i.prototype.initialize.apply(this,arguments)},bind:function(){var e=t.throttle(this.scrollListener,100);this.$win.on("scroll."+this.cid,e)},unbind:function(){this.$win.off("."+this.cid)},getTracker:function(){return this.tracker?this.tracker:(this.tracker=localStorage.getItem("recommendation-history"),this.tracker?this.tracker=JSON.parse(this.tracker):this.tracker={history:[]},this.tracker)},trackAsset:function(){var e=n.getActivePageInfo(),i=this.getTracker(),s=Number(e.assetid);s&&-1==t.indexOf(i.history,s)&&(i.history.length>=this.trackLimit&&i.history.pop(),i.history.unshift(s),localStorage.setItem("recommendation-history",JSON.stringify(i)))},getRecommendation:function(){this.$triggerDom=this.$el.next();var e=this.$triggerDom.offset();e&&(this.triggerDomOffset=e.top,this.bind(),o.getValue("recommendation-trendingStories",this.fetchTrendingStories,5).done(t.bind(function(e){var i=this.tracker.history;i.length&&(e=t.reject(e,function(e){return-1!==t.indexOf(i,e.asset_id)})),e&&e.length&&"object"==typeof e[0]&&this.renderRecommendation(e)},this)))},fetchTrendingStories:function(){var e=n.getActivePageInfo();return n.fetchData(this.trendingUrl,{data:{segments:this.audienceSegments,site:"1",front:e.section_name}})},renderRecommendation:function(e){var t=e[0];t&&this.render(t)},scrollListener:function(){var e=s.getScrollPosition(),t=e+this.winHeight;this.forcedStatus||(this.triggerDomOffset<=t?this.openFlyout():this.closeFlyout())},render:function(e){var i=this.$flyoutTemplate.html();if(i){var s=t.template(i,{data:e});this.$flyout.html(s),this.rendered=!0}},toggle:function(e){e.preventDefault(),this.forcedStatus=!0,this.isOpen?this.closeFlyout():this.openFlyout()},openFlyout:function(){!this.isOpen&&this.rendered&&(this.animate(this.$flyoutWrap,"width",360,350,"ease-out"),this.$flyout.removeClass("closed"),this.isOpen=!0,this.hasOpened=!0)},closeFlyout:function(){this.hasOpened&&this.isOpen&&(this.animate(this.$flyoutWrap,"width",24,250,"ease-out"),this.$flyout.addClass("closed"),this.isOpen=!1)},destroy:function(e){this.unbind(),i.prototype.destroy.apply(this,arguments)}});return a}),define("apps/stag-front",["jquery","underscore","backbone","utils","state","site-manager","pubsub","base-app","sharedAdPosition","partner/slider","partner/overlay-ad-fronts","modules/global/brightcove-video"],function(e,t,i,s,n,o,a,r,l,h,d,c){"use strict";var u=r.extend({el:".cards.stag",afterPageReveal:function(e,t){this._initializeTopic(e,"stag")},_initializeTopic:function(t,i){var s=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var t=new c({el:e(this).parent().get(0)});s.subviews.video.push(t)}),this.subviews.overlayAd=new d({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-legal":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative,getHeaderOffset:function(){var e=o.getHeader();return e?e.getExpandedHeight():0}}),this.subviews.genericad=new l({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new h)}});return u}),define("ui/button-toggle",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({initialize:function(s){s=e.extend({onSelect:null},s),i.prototype.initialize.call(this,s),this.toggleItems=this.$(".ui-button-toggle-item"),this.toggleItems.on("click."+this.cid,t.bind(function(t){this.onClick(e(t.currentTarget))},this))},onClick:function(e){e.hasClass("active")||(this.toggleItems.removeClass("active"),e.addClass("active"),this.options.onSelect&&this.options.onSelect(e))},destroy:function(e){this.toggleItems.off("."+this.cid),i.prototype.destroy.call(this,e)}});return s}),define("modules/fronts/headline-grid",["jquery","underscore","backbone","state","pubsub","utils","baseview","ui/button-toggle"],function(e,t,i,s,n,o,a,r){"use strict";var l=a.extend({events:{"click .button-add-content":"showMore"},initialize:function(e){this.$button=this.$(".button-add-content"),a.prototype.initialize.call(this,e),t.bindAll(this,"transitionMore","toggleGridListView");var i=this.$(".headline-toggler");i.length&&(this.subviews.gridListViewToggler=new r({el:i,onSelect:this.toggleGridListView}))},getMoreHeadlines:function(e,i){s.fetchHtml(window.location.pathname+e+"/").done(t.bind(function(e){var t=e.find(".headline-page").removeClass("active").addClass("inactive"),s=e.find(".button-add-content");this.$(".headline-collection").append(t),s.length>0?this.$(".headlines-show-more").empty().append(s):this.$button.addClass("inactive").text("No More News"),i(t)},this)).fail(t.bind(function(){this.$button.removeClass("loading").addClass("inactive").text("No More News")},this))},showMore:function(t){if(e(t.target).hasClass("inactive"))return!1;if(this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.$el.hasClass("stagfront-primary")&&!this.$(".front-headlines-header").hasClass("staff")){var i=parseInt(e(t.target).data("next"),10);this.getMoreHeadlines(i,this.transitionMore)}else{var s=this.$(".headline-page.active:last").next(),a=s.attr("data-itemnum"),r=s.attr("data-items-per-page"),l=Math.round(a/r);this.load(),n.trigger("uotrack",o.getSectionPath(window.location.pathname)+"morestories"+l),this.transitionMore(s)}t.preventDefault()},toggleGridListView:function(e){var t=e.hasClass("grid-big")?"grid-big":"list-big",i=this.$(".headline-collection");"list-big"===t?(i.addClass("listview"),n.trigger("uotrack","listview")):(i.removeClass("listview"),n.trigger("uotrack","gridview")),this.load()},load:function(){var e=this.$(".headline-collection").hasClass("listview"),t=this.$(".headline-page.active .js-"+(e?"list":"grid")+"-wrap img");o.lazyLoadImage(t)},transitionMore:function(t){Modernizr.csstransitions?t.removeClass("inactive").addClass("active"):t.animate({"max-height":"5000px"},200,function(){e(this).removeClass("inactive").addClass("active").css("max-height","")}),this.$(".headline-page.inactive").length<=0&&this.$button.addClass("inactive").text("No More News"),this.load(),this.$button.removeClass("loading").text(this.$button.attr("data-default")),n.trigger("showmore:headlines")}});return l}),define("partner/pushdown-ad-article",["jquery","partner/pushdown-ad"],function(e,t){"use strict";var i=t.extend({initialize:function(i){i=e.extend({adClasses:"",animations:{vertical:{duration:350,easing:"cubic-bezier(0.645, 0.045, 0.355, 1.000)"}},ratio:{},cardInfo:{}},i),t.prototype.initialize.call(this,i),this._createAd(["pushdown"],["pushdown"],i.cardInfo)}});return i}),define("apps/topics",["jquery","underscore","utils","state","site-manager","base-app","sharedAdPosition","directAdPosition","partner/slider","partner/overlay-ad-fronts","modules/global/brightcove-video","partner/gravity-ad-article","partner/pushdown-ad-article","modules/partner/poster-ad-asset2","partner/digital-wrap"],function(e,t,i,s,n,o,a,r,l,h,d,c,u,p,f){"use strict";var g=o.extend({initialize:function(e){this.pubSub={"topicgallery:open":this.gravityPause,"topicgallery:close":this.gravityResume,"topicarticles:fetched":this._handleFetchedArticles},o.prototype.initialize.call(this,e)},afterPageReveal:function(e,t){this.$el.hasClass("topics-page-automated")?this._initNewTopicPage():this._initLegacyTopicPage(),s.stopRefreshTimer()},_initNewTopicPage:function(){this.$pageWrap=this.$(".tpa-page-wrap"),this.setupAds()},_getHeaderOffset:function(){var e=n.getHeader();return e?e.getExpandedHeight():0},_initLegacyTopicPage:function(){var t=this;this.isNative=this.$el.hasClass("stag-native"),this.subviews.video=[],e(".stag.hero .video").each(function(){var i=new d({el:e(this).parent().get(0)});t.subviews.video.push(i)}),this.subviews.overlayAd=new h({el:this.$(".partner-overlay"),leaveBehindEl:this.$(this.isNative?".stag-masthead-legal":".partner-leavebehind"),isCardBumped:!1,isNative:this.isNative}),this.subviews.genericad=new a({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),(i.getNested(window.site_vars,"ADS","digital_wrap")||i.getUrlParam("dw_debug"))&&(this.subviews.DigitalWrap=new f({el:"#ad-staging",container:this.$(".stagfront-content"),backgroundEl:e("#partner-content")}),this.subviews.sponsorLogo=new r({el:this.$(".partner-sponsor-logo"),adType:"Sponsor Logo",adSizes:[800,40],adPlacement:"sponsor_logo"})),this.$(".hero-1up").length<1&&(this.subviews.sliderad=new l)},activateLoader:function(){window.scrollTo(0,0),this.$el.html('<section class="tpa-page-loader"></section>')},deactivateLoader:function(){window.scrollTo(0,0),this.$el.html("")},setupAds:function(){this.subviews.pushdownAd=new u({defaultPosition:!0,el:this.$(".partner-pushdown-ad"),cards:this.$pageWrap,cardInfo:{adClass:"size-m",adTargeting:"medium",cardWidth:1080}}),this.subviews.gravityAd=new c({cards:this.$pageWrap,contentSection:this.$pageWrap,el:this.$(".partner-gravity-ad"),slot:this.$(".partner-pushdown-ad")}),this.subviews.ad=new r({el:this.$(".tpa-ad-sidebar-wrapper"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"sidebar"}),this.subviews.posterAd=new p({el:this.$(".tpa-scroller-ad-sidebar-wrapper"),articleSelector:".tpa-content-wrap",rightRailSelector:".tpa-sidebar-wrap",disableRefresh:!1,minTimeForAd:15e3}),this.subviews.genericad=new a({el:"#ad-staging",adSizes:["generic"],adPlacement:"high_impact",adType:"generic"}),(i.getNested(window.site_vars,"ADS","digital_wrap")||i.getUrlParam("dw_debug"))&&(this.subviews.DigitalWrap=new f({el:"#ad-staging",slot:this.$(".partner-pushdown-ad"),container:e("body"),backgroundEl:e("body"),offset:this._getHeaderOffset()}),this.subviews.sponsorLogo=new r({el:this.$(".partner-sponsor-logo"),adType:"Sponsor Logo",adSizes:[800,40],adPlacement:"sponsor_logo"}))},gravityPause:function(){this.subviews.gravityAd&&this.subviews.gravityAd.showingAd&&(this.subviews.gravityAd.subviews.adPosition.pauseAd(),this.subviews.gravityAd.$el.css("display","none"))},gravityResume:function(){this.subviews.gravityAd&&this.subviews.gravityAd.showingAd&&(this.subviews.gravityAd.$el.css("display","block"),this.subviews.gravityAd.subviews.adPosition.resumeAd())},_handleFetchedArticles:function(){this.subviews.posterAd&&this.subviews.posterAd._setArticleDimensions()}});return g}),define("apps/featured-newsletter",["jquery","underscore","state","base-app","pubsub","utils"],function(e,t,i,s,n,o){var a=s.extend({events:{"submit .js-fnls-form":"onFormSubmit"},validEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},afterPageReveal:function(){o.get("body").addClass("fnls-body"),this.originalViewportContent=e("meta[name=viewport]").attr("content"),e("meta[name=viewport]").attr("content","width=device-width, initial-scale=1.0"),n.trigger("group_page_view","LDSN"),n.trigger("product_name","Millennial Newsletter")},beforeAppRemove:function(){o.get("body").removeClass("fnls-body"),e("meta[name=viewport]").attr("content",this.originalViewportContent)},onFormSubmit:function(s){s.preventDefault();var a=e(s.currentTarget),r=a.data("newsletter-id"),l=a.find(".js-fnls-email").val(),h=a.find(".js-fnls-email-confirm").val(),d=a.find(".js-fnls-status-success"),c=a.find(".js-fnls-status-error"),u=a.find(".js-fnls-status-updating"),p=a.find(".js-fnls-fieldset");if(l==h&&l&&this.validEmail(l)){u.show().siblings().hide();var f=JSON.stringify([{id:r,signup:!0}]);i.fetchData(null,{type:"POST",url:a.attr("action")+l+"/"+a.data("business-unit")+"/",data:{newsletter_choices:f}}).done(t.bind(function(t){if(t.success===!0){""===e.trim(d.html())&&d.html(t.message),p.hide(),d.show().siblings().hide();var i=o.getUrlParam("refer")||"organic",s="featured-newsletter-signup|"+r+"|"+i;n.trigger("uotrack",s),n.trigger("utagtrack",s);var l=o.getNested(window.site_vars.featured_newsletter,a.data("newsletter-slug"),"fbid");0!==l&&n.trigger("newslettertrack",l)}else c.html(t.message),c.show().siblings().hide()},this))}else l!=h&&c.html("Email addresses do not match."),l&&this.validEmail(l)||c.html("Please enter a valid email address."),c.show().siblings().hide()}});return a}),define("apps/member-guide",["jquery","underscore","state","base-app","site-manager","pubsub"],function(e,t,i,s,n,o){var a=s.extend({initialize:function(){o.trigger("group_page_view","LDSN"),o.trigger("product_name","Member Guide"),s.prototype.initialize.call(this)},afterPageReveal:function(){e("body").addClass("mga-body"),o.on("user:login",this.killLoginBanner,this)},killLoginBanner:function(t,i){
e(".mga-login-wrap").remove(),e(".js-mga-subscribe-hide").remove()},beforeAppRemove:function(){e("body").removeClass("mga-body"),o.off("user:login",this.killLoginBanner,this)}});return a}),define("modules/carousel/carousel-fullscreen",["jquery","exports","underscore","backbone","baseview","utils","state","site-manager","modules/carousel/carousel-autosize"],function(e,t,i,s,n,o,a,r,l){var h=l.extend({initialize:function(t){i.bindAll(this,"handleKeyPress","close"),t=e.extend({scrollerColor:"dark"},t),this.$body=o.get("body"),this.$doc=o.get("document"),this.carousel=t.carousel,this.parent=t.parent,a.registerFullScreenView(this),r.getHeader().setClosedFixed(!0),r.scrollTop(0),this.$doc.on("keydown."+this.cid,this.handleKeyPress),this.$body.on("click."+this.cid,".close",this.close),this.launch(),l.prototype.initialize.call(this,t)},close:function(t){t&&t.preventDefault(),r.getHeader().restoreLastState(),this.animate(this.$el.parent(),"opacity",0,300,"ease-in-out").done(i.bind(function(){this.destroy(!0),a.clearFullScreenView().done(i.bind(function(){if(this.carousel){var t=e(".thumbs li",this.parent);t.eq(this.index).click()}},this))},this))},destroy:function(e){this.$doc.off("."+this.cid),this.$body.off("."+this.cid),e&&this.$el.parent().remove(),l.prototype.destroy.call(this,!1)},launch:function(){var t=e('<article class="gallery fullscreen" style="opacity: 0"><a class="close" href="#"></a><div class="ui-film fullscreen"></div></article>'),i=this.parent.clone();i.find(".viewport").removeClass("hover");var s=i.find(".partner-placement");if(s.length){var n=s.attr("id")+"_fs";s.attr("id",n).attr("data-slot-id",n)}t.append(i),this.$body.append(t),this.animate(t,"opacity",1,300,"ease-in-out"),this.setElement(i)},handleKeyPress:function(e){return 37===e.keyCode?(this.prevSlide(),!1):39===e.keyCode?(this.nextSlide(),!1):27===e.keyCode?(this.close(),!1):void 0}});return h}),define("modules/global/livevideo",["jquery","underscore","backbone","pubsub","state","utils","modules/global/brightcove-video"],function(e,t,i,s,n,o,a){var r=i.View.extend({events:{"click #close_modal_link":"close"},initialize:function(t){this.m_uiModal={},this.m_uiModalBgrnd={},this.win=o.get("win")[0],this.body=o.get("body"),t&&t.service?this.service=t.service:this.service="/services/livevideos/",this.win.gannett={};var i=this;this.win.gannett.videoplayer_modal={openPopup:function(){var t="/livevideos/popout/",s=e("#videoplayer_modal .video-title").text(),n=e("#videoplayer_modal .sponsor-text").text(),a=e("#videoplayer_modal .video-logo").attr("src"),r=e("#videoplayer_modal").attr("data-assetid");t+="?videoid="+r+"&description="+s+"&sponsor="+n+"&sourcelogo="+a,r&&(o.openPopup(t,640,440),i.close())}}},loadLiveVideo:function(t){var i=this;n.registerFullScreenView(this),n.fetchHtml(this.service+t+"/").done(function(t){i.body.append(t),i.video=new a({el:e("#videoplayer_modal"),autostart:!0,live:!0}),i.m_uiModal=e("#videoplayer_modal"),i.m_uiModalBgrnd=e("#lightbox"),i.m_uiModal.show(),i.m_uiModalBgrnd.fadeIn(300),i.setElement("#videoplayer_modal")})},close:function(){if(this.m_uiModal){n.clearFullScreenView();var e=this.m_uiModalBgrnd;this.destroy(!0),this.m_uiModalBgrnd.fadeOut(300,function(){e.remove()}),this.m_uiModal.remove(),this.m_uiModalBgrnd.remove(),this.m_uiModal=null,this.m_uiModalBgrnd=null,this.win.gannett={}}},destroy:function(e){this.video&&this.video.destroy(!0),this.undelegateEvents(),e&&this.remove()}});return r}),define("animatecolors",["jquery"],function(e){function t(e,t,i){var s="rgb"+(Modernizr.rgba?"a":"")+"("+parseInt(e[0]+i*(t[0]-e[0]),10)+","+parseInt(e[1]+i*(t[1]-e[1]),10)+","+parseInt(e[2]+i*(t[2]-e[2]),10);return Modernizr.rgba&&(s+=","+(e&&t?parseFloat(e[3]+i*(t[3]-e[3])):1)),s+=")"}function i(e){var t,i;return(t=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(e))?i=[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),1]:(t=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(e))?i=[17*parseInt(t[1],16),17*parseInt(t[2],16),17*parseInt(t[3],16),1]:(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))?i=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),1]:(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(e))&&(i=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4])]),i}var s=["color","backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","outlineColor"];e.each(s,function(s,n){e.Tween.propHooks[n]={get:function(t){return e(t.elem).css(n)},set:function(s){var o=s.elem.style,a=i(e(s.elem).css(n)),r=i(s.end);s.run=function(e){o[n]=t(a,r,e)}}}}),e.Tween.propHooks.borderColor={set:function(n){var o=n.elem.style,a=[],r=s.slice(2,6);e.each(r,function(t,s){a[s]=i(e(n.elem).css(s))});var l=i(n.end);n.run=function(i){e.each(r,function(e,s){o[s]=t(a[s],l,i)})}}}}),define("modules/global/breaking-news",["jquery","underscore","baseview","pubsub","utils","state","modules/global/barrier","modules/global/livevideo","easing","animatecolors"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({events:{"click .bnm-breaking-link":"onClickBreakingLink","click .bnm-close-btn":"onClickCloseBreakingBtn"},breakingColors:{breaking:{normal:"rgb(247,0,0)",highlight:"rgb(191,49,49)"},live:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"},developing:{normal:"rgb(0,170,255)",highlight:"rgb(0,145,218)"}},breakingBarHeight:0,initialize:function(s){s=e.extend({slideSpeed:200,onBreakingNewsChange:null},s),t.bindAll(this,"updateBreakingBar","checkBreakingNewsBarrier"),this.lastUpdate=localStorage.getItem("breakingLastUpdateClosed"),this.updateBreakingBar(),this.breakingBarPoll=setInterval(this.updateBreakingBar,91e3),this.barrier=new a,i.prototype.initialize.call(this,s)},destroy:function(){clearTimeout(this.initBreakingBar),clearInterval(this.breakingBarPoll),i.prototype.destroy.apply(this,arguments)},getHeight:function(){return this.breakingBarHeight},onClickCloseBreakingBtn:function(e){this.closeBreakingBar(!0),s.trigger("uotrack","breakingnewsbarexit")},onClickBreakingLink:function(t){var i=e(t.currentTarget).attr("href");if(i.indexOf("livevideoassetid")>0){"undefined"!=typeof this.currentlivevideo&&this.currentlivevideo.close();var s=new r;s.loadLiveVideo(i.split("#")[1].split("=")[1]),this.currentlivevideo=s,t.preventDefault()}},closeBreakingBar:function(e){return s.trigger("breakingbar:closing",this.options.slideSpeed),this.breakingBarHeight?(e&&localStorage.setItem("breakingLastUpdateClosed",this.lastUpdate),this.breakingBarHeight=0,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!1),this.$el.animate({height:0},this.options.slideSpeed,t.bind(function(){this.$el.css("background-color",""),this.$el.hide(),s.trigger("breakingbar:after:close")},this))):!1},openBreakingBar:function(){s.trigger("breakingbar:opening",this.options.slideSpeed),this.$el.show();var e=this.$(".bnm-bar").outerHeight();e!=this.breakingBarHeight&&(this.breakingBarHeight=e,this.options.onBreakingNewsChange&&this.options.onBreakingNewsChange(!0),this.animate(this.$el,"height",this.breakingBarHeight,this.options.slideSpeed).done(this.onCompleteOpenBreakingBar))},onCompleteOpenBreakingBar:function(){s.trigger("breakingbar:after:open")},updateBreakingBar:function(){this.busyCheckingBreakingNews||(this.busyCheckingBreakingNews=!0,o.persistentFetchHtml("/services/breaking-news/nav-bar/",{headers:{"x-no-nav":"true"}}).done(this.checkBreakingNewsBarrier))},addToBarrier:function(e,t,i){this.barrier.add(e,t,i)},checkBreakingNewsBarrier:function(e){var i=e.find(".bnm-bar");return i.length?void this.barrier.wait().done(t.bind(function(){this.parseBreakingNews(i)},this)):void(this.busyCheckingBreakingNews=!1)},parseBreakingNews:function(e){try{var t=e.data("type"),i=e.data("lastUpdate"),s=o.getActivePageInfo();if(s&&s.sponsor_story)this.closeBreakingBar();else if(this.lastUpdate!=i&&this.lastUpdate!=i&&!s.sponsor_story){this.$el.html(e).stop(),this.lastUpdate=i;var n=this.breakingBarHeight>0;if(this.openBreakingBar(),n){var a=this.breakingColors[t].highlight,r=this.breakingColors[t].normal;this.$(".bnm-bar").animate({backgroundColor:a}).animate({backgroundColor:r})}}}catch(l){this.closeBreakingBar()}finally{this.busyCheckingBreakingNews=!1}}});return l}),define("modules/header/site-nav-dropdown",["jquery","underscore","baseview","easing"],function(e,t,i){"use strict";var s=i.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .site-nav-dropdown":"closeDropdown","click .site-masthead-search-form-input":"onClickSearchDropdown","click .search-tr-module-input":"onClickSearchDropdown"},initialize:function(e){t.bindAll(this,"openDropdown","closeDropdown"),this.fadeSpeed=80,this.showDelay=120,this.$dropdown=this.$(".site-nav-dropdown"),this.$searchForm=this.$(".site-masthead-search-form"),this.$searchDropdown=this.$(".site-masthead-search-form-input"),i.prototype.initialize.call(this,e)},onMouseEnter:function(e){clearTimeout(this.hideTimer),this.isMouseOnDropdown=!0,this.openDropdown(e)},onMouseLeave:function(e){this.isMouseOnDropdown=!1,this.hideTimer=setTimeout(t.partial(this.closeDropdown,e),this.hideDelay),this.$searchDropdown&&(this.$searchDropdown.blur(),this.$searchDropdown.val(""))},closeDropdown:function(e){!this.isDropdownOpen||"mouseout"==e.type&&this.isMouseOnDropdown||(this.isDropdownOpen=!1,this.$dropdown.css("display","none"),this.$el.removeClass("site-nav-active-item"))},openDropdown:function(e){this.isDropdownOpen||"mouseover"==e.type&&!this.isMouseOnDropdown||(this.isDropdownOpen=!0,this.$el.addClass("site-nav-active-item"),this.$dropdown.css("display","block"),this.animate(this.$dropdown,"opacity",1,this.fadeSpeed))},onClickSearchDropdown:function(e){e.stopPropagation()}});return s}),define("modules/header/site-nav-more-module",["underscore","modules/header/site-nav-dropdown"],function(e,t){"use strict";var i=t.extend({initialize:function(e){this.$navDropdown=this.$(".site-nav-dropdown"),this.$navDropdownList=this.$(".site-nav-more-dropdown-list"),this.$navDropdownItems=this.$(".site-nav-more-dropdown-item"),t.prototype.initialize.call(this,e)},convertColumnLayout:function(e){var t="1col"==e?"2col":"1col";this.$navDropdown.removeClass("site-nav-more-dropdown-"+t).addClass("site-nav-more-dropdown-"+e),this.$navDropdownList.removeClass("site-nav-more-dropdown-list-"+t).addClass("site-nav-more-dropdown-list-"+e),this.$navDropdownItems.removeClass("site-nav-more-dropdown-item-"+t).addClass("site-nav-more-dropdown-item-"+e)}});return i}),define("modules/global/header",["jquery","underscore","base-app","pubsub","utils","state","user-manager","managers/routemanager","modules/global/breaking-news","directAdPosition","modules/header/site-nav-more-module","modules/global/userUtil","easing","animatecolors"],function(e,t,i,s,n,o,a,r,l,h,d,c){"use strict";var u=i.extend({el:".site-header",events:{"click .site-nav-search-link":"onClickNavSearchIcon","click .site-masthead-search-close-btn":"onClickSearchCloseBtn","click .site-masthead-search-btn-div":"onClickSearchBtnDiv","click .pr-outer-wrap a":"onClickAllLinksInPR"},navHeaderHeight:40,mastheadHeight:80,fixedHeaderThreshold:80,hoverDropdownDelay:120,videoBarHeight:156,TWO_COL_THRESHOLD:5,SITE_NAV_HIDDEN_CLASS:"site-nav-item-hidden",SITE_NAV_MORE_VISIBLE_CLASS:"site-nav-more-dropdown-item-visible",initialize:function(){this.isMulti=!!this.$el.attr("data-multi-header"),this.isThirdParty=!!this.$el.attr("data-third-party"),this.$win=n.get("win"),this.$top=n.get("scrollEl"),this.$siteHeaderInnerWrap=this.$(".site-header-inner-wrap"),this.$siteMasthead=this.$(".site-masthead"),this.$searchWrap=this.$(".site-masthead-search-wrap"),this.$navLogo=this.$(".site-nav-logo-item"),this.$navLogoLink=this.$(".site-nav-logo-link"),this.$navMoreItem=this.$(".site-nav-more-item"),this.$navLogoImg=this.$navLogo.find(".site-nav-logo-img"),this.$searchCancelBtn=this.$(".site-masthead-search-close-btn"),this.navLogoImgWidth=this.$navLogoImg.outerWidth(!0),this.$specialOffersMastheadAd=this.$(".site-masthead-special-offers-ad"),this.$subscribeWrap=this.$(".site-masthead-subscribe-wrap"),this.$siteMoreDropdownItems=this.$(".site-nav-more-dropdown-item:not(.site-nav-more-dropdown-item-hidden)"),this.$searchInput=this.$$(".site-masthead-search-form-input"),this.navHeight=this.$siteHeaderInnerWrap.outerHeight(),this.minHeight=this.$el.outerHeight(),this.smallerLogo=this.$(".site-nav-logo-img"),this.prTag=this.$(".pr-outer-wrap"),this.prodCdn=this.prTag.attr("data-prod-cdn"),this.dataSiteKey=this.prTag.attr("data-site-key"),this.largeLogo=this.$(".logo-link").find("img"),this.smallLogo=this.$(".site-nav-logo-img"),t.bindAll(this,"onBreakingNewsChange","onFixingScroll","onClosingScroll","_handleOnAdReady","_onResizeWindow"),this.slideSpeed=200,n.set("headerHeight",this.navHeight),this.slideEasing="ease-out";var e=this.$el.data("open"),s=this.$el.data("fixed"),o=this.$el.data("default-open")||!1,a=this.$el.data("default-fixed")||!1;void 0===e&&(e=o),void 0===s&&(s=a),this.state={open:e,defaultOpen:o,fixed:s,defaultFixed:a,hasFixingScroller:!1,hasClosingScroller:!1},this.pubSub={"user:statuschange":this._loginStatus,"page:load":this._onPageLoad,"header:open":this.navAutoFitItems,"header:closed":this.navAutoFitItems},i.prototype.initialize.apply(this,arguments),this.start(),s||(this._setState({hasFixingScroller:!0}),n.getScrollPosition()&&this.onFixingScroll())},start:function(){this.loadHeaderModules(),n.getNested(window.site_vars,"userAuthentication","personal_link","enabled")&&(this.subviews.userUtil=new c),this.subviews.breakingbar=new l({el:this.$(".bnm-container"),slideSpeed:this.slideSpeed,onBreakingNewsChange:this.onBreakingNewsChange}),this.moreLayout="1col",this.isThirdParty||(this.subviews.moreModule=new d({el:this.$navMoreItem[0]}));var e=t.throttle(this._onResizeWindow,500);this.$win.on("resize."+this.cid,e),this.navAutoFitStart()},navAutoFitStart:function(){this.$siteNavDynamicPrimaryItems=this.$(".site-nav-primary-item:not(.site-nav-more-item,.site-nav-logo-item,.site-nav-always-visible-item,.site-nav-spacer-item)"),this.$siteNavAlwaysVisibleItems=this.$(".site-nav-always-visible-item,.site-nav-secondary-item"),this.siteNavDynamicItemsWidths=this.getNavGroupWidths(this.$siteNavDynamicPrimaryItems),this.siteNavAlwaysVisibleItemsWidths=this.getNavGroupWidths(this.$siteNavAlwaysVisibleItems),this.siteNavMoreItemWidth=this.$navMoreItem.outerWidth(),this.siteNavAlwaysVisibleItemsTotalWidth=t.reduce(this.siteNavAlwaysVisibleItemsWidths,function(e,t){return e+t},0),this.siteNavLogoWidth=this.navLogoImgWidth-10,this.isThirdParty||(this.hiddenPrimaryItemsCount=0),this._updateMastheadWidth(),this.navRevealed||(this.isThirdParty||0!==this.hiddenPrimaryItemsCount||this.$navMoreItem.addClass(this.SITE_NAV_HIDDEN_CLASS),this.$(".site-nav-item").addClass("site-nav-item-visible"),this.navRevealed=!0)},navAutoFitItems:function(){var e=this.state.open?0:this.siteNavLogoWidth,t=this.isThirdParty?0:this.siteNavMoreItemWidth,i=this.siteNavAlwaysVisibleItemsTotalWidth+e,s=this.siteNavDynamicItemsWidths.length;this.firstHiddenNavItemIndex||(this.firstHiddenNavItemIndex=s);for(var n=0;n<this.siteNavDynamicItemsWidths.length;n++){var o=this.siteNavDynamicItemsWidths[n];if(i+o>this.mastheadWidth){if(i+t<=this.mastheadWidth){s=n;break}for(var a=n-1;a>=0;a--){var r=this.siteNavDynamicItemsWidths[a];if(i+t-r<=this.mastheadWidth){s=a;break}i-=r}break}i+=o}if(s!==this.firstHiddenNavItemIndex){var l=s<this.firstHiddenNavItemIndex,h=l?s:this.firstHiddenNavItemIndex,d=l?this.firstHiddenNavItemIndex:s;this.togglePrimaryNavItems(s,h,d),this.toggleMoreNavItems(s,h,d),this.firstHiddenNavItemIndex=s}},togglePrimaryNavItems:function(e,t,i){this.$siteNavDynamicPrimaryItems.slice(t,i).toggleClass(this.SITE_NAV_HIDDEN_CLASS)},toggleMoreNavItems:function(e,t,i){if(!this.isThirdParty){var s=e<this.firstHiddenNavItemIndex,n=this.siteNavDynamicItemsWidths.length-e,o=this.willMoreDropdownAppear(n)||this.willMoreDropdownHide(n);if(this.$siteMoreDropdownItems.slice(t,i).toggleClass(this.SITE_NAV_MORE_VISIBLE_CLASS),o){var a=0===n;this.$navMoreItem.toggleClass(this.SITE_NAV_HIDDEN_CLASS,a),this.allPrimaryNavItemsShown=!s}this.hiddenPrimaryItemsCount=n,this._updateMoreColumnLayout()}},willMoreDropdownAppear:function(e){return 0===e&&this.hiddenPrimaryItemsCount>0},willMoreDropdownHide:function(e){return 0===this.hiddenPrimaryItemsCount&&e>0},getNavGroupWidths:function(i){return t.map(i,function(t){return e(t).outerWidth()})},_updateMastheadWidth:function(){var e=this.$siteMasthead.outerWidth();if(e!==this.mastheadWidth){var t=e>this.mastheadWidth?"wider":"narrower";this.mastheadWidth=e,"wider"===t&&this.allPrimaryNavItemsShown||this.navAutoFitItems()}},_updateMoreColumnLayout:function(){this.isThirdParty||(this.hiddenPrimaryItemsCount>this.TWO_COL_THRESHOLD&&"2col"!=this.moreLayout?(this.subviews.moreModule.convertColumnLayout("2col"),this.moreLayout="2col"):"1col"!=this.moreLayout&&(this.subviews.moreModule.convertColumnLayout("1col"),this.moreLayout="1col"))},_onPageLoad:function(e){void 0!==window.adsEnabled&&this._buildSpecialOffersMastheadAd(),this._onResizeWindow(e)},_onResizeWindow:function(e){this._updateMastheadWidth()},_buildSpecialOffersMastheadAd:function(){if(this.$specialOffersMastheadAd.length){var e,i=o.getActivePageInfo().numPageViewsLeft,s=a.getAccount("firefly");void 0!==i&&(e={pwvr:i>0?i:"0"}),this.subviews.specialOffersMastheadAd?e&&(this.subviews.specialOffersMastheadAd.setTargeting(e),this.subviews.specialOffersMastheadAd.refreshPosition()):s?s.getUserInfo().done(t.bind(function(t){t.hasMarketAccess||this._applyMastheadDirectPositionAd(e)},this)).fail(t.bind(function(){this._applyMastheadDirectPositionAd(e)},this)):this._applyMastheadDirectPositionAd(e)}},_applyMastheadDirectPositionAd:function(e){this.subviews.specialOffersMastheadAd=new h({el:this.$specialOffersMastheadAd,adSizes:[122,50],adPlacement:"consumer_sales-masthead",onAdReady:this._handleOnAdReady,targeting:e})},_handleOnAdReady:function(){this.$subscribeWrap.remove(),this.$specialOffersMastheadAd.addClass("site-masthead-subscribe-wrap-visible"),this.subviews.specialOffersMastheadAd.showAd()},destroy:function(){this._unregisterFixingScroller(),this.$win.off("."+this.cid),clearTimeout(this.headerTransparencyTimeout),i.prototype.destroy.call(this)},_loginStatus:function(e,t,i){"firefly"===e&&("loggedIn"===t&&i&&i.hasMarketAccess?this.$subscribeWrap.removeClass("site-masthead-subscribe-wrap-visible"):"loggingIn"!==t&&this.$subscribeWrap.addClass("site-masthead-subscribe-wrap-visible"))},isFixedAndClosed:function(e){return!(e.open||!e.fixed||e.hasFixingScroller||e.hasClosingScroller)},_setState:function(i){var n,o="",a=new e.Deferred;t.each(i,function(e,s){this.state[s]!==e&&("fixed"===s?e?(this.$siteHeaderInnerWrap.addClass("site-header-inner-wrap-fixed"),o+=" header:fixed"):(this.$siteHeaderInnerWrap.removeClass("site-header-inner-wrap-fixed"),o+=" header:unfixed"):"open"===s?(n=this.state.fixed===!0&&(void 0===i.fixed||i.fixed===!0)||void 0!==i.hasFixingScroller&&this.state.hasFixingScroller!==i.hasFixingScroller,this._setMasthead(e,n,a),o+=e?" header:open":" header:closed"):"hasFixingScroller"===s?e?this._registerFixingScroller():this._unregisterFixingScroller():"hasClosingScroller"===s?e?a.then(t.bind(function(){this._registerClosingScroller()},this)):this._unregisterClosingScroller():console.warn("Unknown state key: "+s))},this),this.listenerTimeout=setTimeout(function(){a.resolve()},this.slideSpeed+50),this._checkTransition(this.state,i),t.extend(this.state,i),o&&s.trigger(o)},_checkTransition:function(t,i){i=e.extend({},t,i);var s=this.isFixedAndClosed(t),n=this.isFixedAndClosed(i),o=t.open!==i.open;s!==n&&(n?this._transitionToCloseFixed(o):this._transitionFromCloseFixed(o))},_transitionToCloseFixed:function(e){this.navHeight=this.navHeaderHeight,this.updateHeaderMinHeight(e)},_transitionFromCloseFixed:function(e){this.navHeight=this.navHeaderHeight+this.mastheadHeight,this.updateHeaderMinHeight(e)},_registerFixingScroller:function(){this.isMulti||(this.hasFixingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasFixingScroller=!0,this.$win.on("scroll.headerFixingScroller",t.throttle(this.onFixingScroll,20))))},_unregisterFixingScroller:function(){this.hasFixingScroller=!1,this.$win.off(".headerFixingScroller")},onFixingScroll:function(){var e=n.getScrollPosition()>=this.mastheadHeight;e!==this.state.fixed&&this._setState({open:!e,fixed:e})},_registerClosingScroller:function(){this.isApple||this.isMulti||(this.hasClosingScroller?console.warn("Attempting to register headerFixingScroller twice"):(this.hasClosingScroller=!0,this.$win.on("scroll.headerClosingScroller",t.throttle(this.onClosingScroll,20))))},_unregisterClosingScroller:function(){this.hasClosingScroller=!1,this.$win.off(".headerClosingScroller")},onClosingScroll:function(){this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0)},loadHeaderModules:function(){this.$(".headermodules").each(t.bind(function(t,i){try{var s=JSON.parse(e(i).html()).js_modules||[];this.buildModules(s)}catch(n){console.error("Failure loading header modules",n)}},this))},onClickNavSearchIcon:function(e){e.preventDefault(),n.getNested(window.site_vars,"search","ENABLED")&&(this.$searchInput.focus(),this.state.open||(this._setState({open:!0,fixed:!0,hasClosingScroller:!0}),this.$searchCancelBtn.addClass("site-masthead-search-close-btn-visible"),this.transparencySetup&&this.headerIsTransparent&&this.toggleTransparency(!1)))},scrollTop:function(e,t){if(!t)if(this.state.open){var i=n.getScrollPosition();if(e<this.fixedHeaderThreshold&&i<this.fixedHeaderThreshold)return i}else this.state.hasFixingScroller&&e<this.fixedHeaderThreshold&&(e=this.fixedHeaderThreshold);return this.$top.scrollTop(e),e},isFixed:function(){return this.state.fixed},isOpen:function(){return this.state.open},setOpenFixed:function(t){t&&(this.lastState=e.extend({},this.state)),this._setState({open:!0,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},getFixedHeight:function(){return this.isFixedAndClosed(this.state)?this.minHeight:window.videoIsScrolling?this.videoBarHeight:this.minHeight-this.mastheadHeight},setFixingScroller:function(e){e?this._setState({hasFixingScroller:!0,hasClosingScroller:!1}):this._setState({hasFixingScroller:!1,hasClosingScroller:!1})},setClosedFixed:function(t){t&&(this.lastState=e.extend({},this.state)),this._setState({open:!1,fixed:!0,hasFixingScroller:!1,hasClosingScroller:!1})},restoreLastState:function(){this.lastState&&(this._setState(this.lastState),this.lastState=null)},restoreDefaultState:function(){if(this.state.defaultFixed)this._setState({open:this.state.defaultOpen,fixed:this.state.defaultFixed,hasFixingScroller:!this.state.defaultFixed,hasClosingScroller:!1});else{var e=n.getScrollPosition()>=this.mastheadHeight;this._setState({open:!e,fixed:e,hasFixingScroller:!0,hasClosingScroller:!1})}},onClickSearchBtnDiv:function(t){e(t.currentTarget).parents("form").trigger("submit")},onClickSearchCloseBtn:function(){o.getActiveApp().isSearchPage?r.goTo("/"):(this._setState({open:!1,fixed:!0,hasClosingScroller:!1}),this.transparencySetup&&!this.headerIsTransparent&&this.toggleTransparency(!0))},_collapseMasthead:function(e,i){e?this.animate(this.$searchWrap,"height",0,this.slideSpeed,this.slideEasing).always(t.bind(function(){this.$searchCancelBtn.length&&this.$searchCancelBtn.removeClass("site-masthead-search-close-btn-visible"),i&&i.resolve()},this)):(this.$searchWrap.css("height",0),i&&i.resolve()),this.toggleNavLogo(!0,!0)},_expandMasthead:function(e,i){e?this.animate(this.$searchWrap,"height",this.mastheadHeight+"px",this.slideSpeed,this.slideEasing).done(t.bind(function(){this.$searchInput.focus(),i&&i.resolve()},this)):(this.$searchWrap.css("height",this.mastheadHeight),i&&i.resolve()),this.toggleNavLogo(!0,!1)},_setMasthead:function(e,t,i){e?this._expandMasthead(t,i):this._collapseMasthead(t,i)},getExpandedHeight:function(){return this.minHeight},getScrollOffset:function(){return this.isFixed()?this.minHeight!=this.navHeaderHeight?this.minHeight-this.navHeaderHeight:this.minHeight:0},getFixedThreshold:function(){return this.fixedHeaderThreshold},getCollapsedHeight:function(){return this.navHeaderHeight},getCurrentHeight:function(){return this.navHeight},toggleNavLogo:function(e,t){var i=t?1:0,s=t?"100%":0;this.$navLogoImg.css("opacity",i),this.$navLogoLink.css("width",s)},updateHeaderMinHeight:function(e){this.minHeight=this.navHeight+(this.subviews.breakingbar?this.subviews.breakingbar.getHeight():0),e?this.animate(this.$el,"min-height",this.minHeight,this.slideSpeed):this.$el.css("min-height",this.minHeight)},onBreakingNewsChange:function(e){this.updateHeaderMinHeight(),e?s.trigger("breakingbar:before:open",this.minHeight,this.options.slideSpeed):s.trigger("breakingbar:before:close",this.minHeight,this.options.slideSpeed)},updateNavigation:function(e){var t,i,n,o="site-nav-active-span",a="site-nav-active-item";for(this.$("."+o).removeClass(o),this.$("."+a).removeClass(a),e=e||"home",n=e.indexOf("?"),-1!==n&&(e=e.substring(0,n)),"/"===e[0]&&(e=e.substring(1)),"/"===e[e.length-1]&&(e=e.substring(0,e.length-1)),e=e.replace(/[^_a-zA-Z0-9\-/]/g,""),t=e?e.split("/"):["home"];t.length&&(i=this.$(".site-nav-"+t.join("-")+"-item"),!i.length);)t=t.splice(0,t.length-1);var r=t.join("-");s.trigger("update:navigation",r),i&&i.length&&(this.$(".site-nav-"+r+"-span").addClass(o),i.addClass(a))},setupTransparency:function(){this.siteHeaderInnerWrapBg=this.$siteHeaderInnerWrap.css("background"),this.transparencySetup=!0},destroyTransparency:function(){this.$el.removeClass("transparent-header"),this.transparencySetup=!1,this.listenerTimeout&&clearTimeout(this.listenerTimeout),this.headerTransparencyTimeout=t.delay(t.bind(function(){this.$siteHeaderInnerWrap.css("background",this.siteHeaderInnerWrapBg)},this),350)},toggleTransparency:function(e){this.transparencySetup||this.setupTransparency(),e?(this.$el.addClass("transparent-header"),this.headerIsTransparent=!0):(this.$el.removeClass("transparent-header"),this.headerIsTransparent=!1)},onClickAllLinksInPR:function(){var e=this.largeLogo.attr("data-new-src"),i=this.prodCdn+"/sites/"+this.dataSiteKey+"/images/site-nav-logo@2x.png";window.setTimeout(t.bind(function(){this.largeLogo.attr("src",""),this.largeLogo.attr("src",e),this.smallLogo.attr("src",i)},this),300),n.getScrollPosition()>=this.mastheadHeight?this.toggleNavLogo(!0,!0):this.toggleNavLogo(!1,!1)}});return u}),define("user-accounts/base-user-account",["jquery","underscore","pubsub","baseview","managers/cachemanager"],function(e,t,i,s,n){"use strict";var o=s.extend({initialize:function(e){t.bindAll(this,"_handleGetCoreUserInfo","logout"),s.prototype.initialize.call(this,e)},getUserInfo:function(){return this.loginPromise?this.loginPromise.then(t.bind(function(){return this._handleGetUserInfo()},this)):e.Deferred().reject("account not logged in")},_handleGetUserInfo:function(){return console.error("getUserInfo failed: unimplemented function!"),e.Deferred().reject("unimplemented feature")},getCoreUserInfo:function(){return this.loginPromise?this.loginPromise.then(t.bind(function(){return n.getValue("coreuserinfo",this._handleGetCoreUserInfo).done(function(t){e.cookie("atyponid",t.AtyponId,{expires:14,path:"/",domain:window.site_vars.base_url})})},this)):e.Deferred().reject("account not logged in")},_handleGetCoreUserInfo:function(){return e.Deferred(t.bind(function(t){e.ajax("/user-service/getcoreuser/"+this.getUserId()+"/"+this.getName(),{type:"POST",data:{token:this.getUserToken()}}).done(function(e){e&&e.success&&e.success.status?"valid"===e.success.status.state?t.resolve(e.success.response):t.reject(e.success.status.message):t.reject("unable to get core user data, invalid response!")}).fail(function(){t.reject("unable to get core user data!")})},this)).promise()},login:function(e){var i=this.getLoginStatus();return"loggingOut"===i?this.logoutPromise.then(t.bind(function(){return this.login(e)},this),t.bind(function(){return this.login(e)},this)):("loggedIn"!==i&&"loggingIn"!==i&&this._triggerLogin(e),this.loginPromise)},_triggerLogin:function(e){this.loginPromise=this._handleLogin(e),"pending"===this.loginPromise.state()&&this._onLoginStatusChange(),this.loginPromise.always(t.bind(function(e){this._onLoginStatusChange.apply(this,arguments)},this))},getLoginStatus:function(){return this.logoutPromise?"loggingOut":this.loginPromise?"rejected"===this.loginPromise.state()?"loginFailed":"pending"===this.loginPromise.state()?"loggingIn":"loggedIn":"loggedOut"},_onLoginStatusChange:function(){i.trigger.apply(i,["user:statuschange",this.getName(),this.getLoginStatus()].concat(Array.prototype.slice.call(arguments,0)))},_handleLogin:function(t){return console.error("Login failed: unimplemented function!"),e.Deferred().reject("unimplemented feature")},_flushCaches:function(){n.clearValue("coreuserinfo")},logout:function(){var t=this.getLoginStatus();return"loggingOut"===t?this.logoutPromise:"loggingIn"===t?this.loginPromise.then(this.logout,this.logout):"loggedOut"!==t?this._triggerLogout():e.Deferred().resolve()},_triggerLogout:function(){this._flushCaches(),this.loginPromise=null;var e=this._handleLogout().always(t.bind(function(){this.logoutPromise=null,this._onLoginStatusChange()},this));return"pending"===e.state()&&(this.logoutPromise=e,this._onLoginStatusChange()),e},_handleLogout:function(){return e.Deferred().resolve()},whenLoggedIn:function(){return this.loginPromise?this.loginPromise:e.Deferred().reject()},getUserToken:function(){return""},getUserId:function(){return""},getUserAvatar:function(){return""},getUserFirstName:function(){return""},getUserLastName:function(){return""},getName:function(){throw"No name defined"}});return o}),define("third-party-apis/facebook/facebook",["jquery","underscore","third-party-apis/base-third-party-api"],function(e,t,i){"use strict";var s=i.extend({initialize:function(){this._config=this.getApiSiteConfig("FACEBOOK"),this._config&&(this._appid=this._config.APPID,this._channelUrl=window.location.protocol+"//"+window.location.host+window.site_static_url+"html/channel.html"),i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._facebookPromise||(this._facebookPromise=e.Deferred(t.bind(function(i){return this._config.ENABLED?void e.ajax("//connect.facebook.net/en_US/sdk.js",{cache:!0,data:{},dataType:"script"}).done(t.bind(function(){FB?(this._initializeFacebook(),i.resolve(FB)):i.reject()},this)).fail(function(){i.reject()}):void i.reject()},this)).promise()),this._facebookPromise},_initializeFacebook:function(){FB.init({appId:this._appid,version:"v2.3",channelUrl:this._channelUrl,status:!0,cookie:!0,xfbml:!1})},getUserPermissions:function(){return this._config.PERMISSIONS}});return new s}),define("user-accounts/facebook-user-account",["jquery","underscore","pubsub","user-accounts/base-user-account","user-manager","third-party-apis/facebook/facebook","cookie"],function(e,t,i,s,n,o){"use strict";var a=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.user={},n.registerAccount(this)},_handleGetUserInfo:function(){return o.loadScript().then(function(){return e.Deferred(function(e){FB.api("/me?fields=name,first_name,last_name,gender,picture",function(t){!t||t.error?(console.error("Facebook returned erroneous response!",t),e.reject(t)):e.resolve(t)})})})},_handleLogin:function(e){var i;return i=e?this._getLoginStatus():this._loginUser(),i.then(t.bind(function(e){return this.sessionToken=e.accessToken,this._handleGetUserInfo()},this)).done(t.bind(function(e){this.user=e},this)).fail(t.bind(function(e){"unknown"===e&&this.logout()},this))},_getLoginStatus:function(){return o.loadScript().then(function(){return e.Deferred(function(e){FB.getLoginStatus(function(t){"connected"===t.status?e.resolve(t.authResponse):e.reject(t.status);
})})})},_loginUser:function(){return o.loadScript().then(function(){return e.Deferred(function(e){FB.login(function(t){"connected"===t.status?e.resolve(t.authResponse):e.reject(t.status)},{scope:o.getUserPermissions()})})})},_handleLogout:function(){return this.user={},this.sessionToken=null,o.loadScript().then(function(){FB.logout()})},getName:function(){return"facebook"},getUserToken:function(){return this.sessionToken},getUserId:function(){return this.user.id},getUserAvatar:function(){return this.user.picture&&this.user.picture.data?this.user.picture.data.url:""},getUserFirstName:function(){return this.user.first_name},getUserLastName:function(){return this.user.last_name}});return new a}),define("third-party-apis/google/googleplus",["jquery","underscore","third-party-apis/base-third-party-api"],function(e,t,i){"use strict";var s=i.extend({initialize:function(){var e=this.getApiSiteConfig("GOOGLEPLUS");e&&(this._clientid=e.CLIENTID,this._plusonejslib=e.JSLIBURL,this._cookiePolicy=e.COOKIEPOLICY,this._appPackageName=e.APPPACKAGENAME,this._logoutUrl=e.LOGOUT_URL),i.prototype.initialize.call(this)},_handleLoadScript:function(){return this._loadScriptPromise||(this._loadScriptPromise=e.Deferred(),this.setupOnLoadCallbacks("afterLoadGPScript",t.bind(function(){this._loadGooglePlusApi().done(t.bind(function(){this._loadScriptPromise.resolve()},this))},this)),e.ajax(this._plusonejslib,{data:{onload:"afterLoadGPScript"},cache:!0,dataType:"script"})),this._loadScriptPromise.promise()},_loadGooglePlusApi:function(){var i=e.Deferred();return gapi.client.load("plus","v1",t.bind(function(){gapi.auth.init(function(){i.resolve()})},this)),i.promise()},getUserInfo:function(){var t=e.Deferred();return this.userInfo?t.resolveWith(this,[this.userInfo]):this.loadScript().done(function(){var e=gapi.client.plus.people.get({userId:"me"});e.execute(function(e){e.error?(console.error("Google returned erroneous response!",e),t.reject()):t.resolveWith(this,[e])})}),t.promise()},signInUser:function(){var i=e.Deferred();return this.loadScript().done(t.bind(function(){gapi.auth.authorize({client_id:this._clientid,requestvisibleactions:"http://schemas.google.com/AddActivity",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",apppackagename:this._appPackageName,approvalprompt:"force",immediate:!1},t.bind(function(e){e.access_token?i.resolveWith(this,[e]):e.error&&(console.log("There was an error: "+e.error),i.rejectWith(this,[e]))},this))},this)),i.promise()},signOutUser:function(i){var s=e.Deferred();return this.loadScript().done(t.bind(function(){e.ajax({type:"GET",url:this._logoutUrl,data:{token:i},async:!1,contentType:"application/json",dataType:"jsonp",success:function(){s.resolve()},error:function(e){s.reject()}})},this)),s.promise()},getAuthStatus:function(){var i=e.Deferred();return this.loadScript().done(t.bind(function(){gapi.auth.authorize({client_id:this._clientid,scope:"https://www.googleapis.com/auth/plus.login",immediate:!0},function(e){i.resolve(e)})},this)),i.promise()}});return new s}),define("user-accounts/googleplus-user-account",["jquery","underscore","user-manager","user-accounts/base-user-account","third-party-apis/google/googleplus","cookie"],function(e,t,i,s,n){"use strict";var o=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.user={},i.registerAccount(this)},_handleGetUserInfo:function(){return n.getUserInfo().done(t.bind(function(e){this.user=e},this))},_handleLogin:function(e){var i=e?"getAuthStatus":"signInUser";return n[i]().then(t.bind(function(e){return this.sessionToken=e.access_token,this._handleGetUserInfo()},this)).fail(t.bind(function(){this.logout()},this))},_handleLogout:function(){return this.sessionToken?n.signOutUser(this.sessionToken):e.Deferred().resolve()},getName:function(){return"google"},getUserToken:function(){return this.sessionToken},getUserId:function(){return this.user.id},getUserAvatar:function(){return this.user.image?this.user.image.url:""},getUserFirstName:function(){return this.user.name?this.user.name.givenName:""},getUserLastName:function(){return this.user.name?this.user.name.familyName:""}});return new o}),function(){var e;e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,s,n,o,a;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),o=e.childNodes,a=[],s=0,n=o.length;n>s;s++)i=o[s],a.push(this.add_option(i,t,e.disabled));return a},e.prototype.add_option=function(e,t,i){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:i===!0?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e}(),e.select_to_array=function(t){var i,s,n,o,a;for(s=new e,a=t.childNodes,n=0,o=a.length;o>n;n++)i=a[n],s.add_node(i);return s.parsed},this.SelectParser=e}.call(this),function(){var e,t;t=this,e=function(){function e(e,t){this.form_field=e,this.options=null!=t?t:{},this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.search_contains=this.options.search_contains||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},e.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(e){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(e){var t=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return t.blur_test()},100))},e.prototype.result_add_option=function(e){var t,i;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=""!==e.style.cssText?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+i+">"+e.html+"</li>")},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(e){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t,i;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=Math.floor(Math.random()*e.length),t=e.substring(i,i+1)},e}(),t.AbstractChosen=e}.call(this),function(){var e,t,i,s,n,o={}.hasOwnProperty,a=function(e,t){function i(){this.constructor=e}for(var s in t)o.call(t,s)&&(e[s]=t[s]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};s=this,e=jQuery,e.fn.extend({chosen:function(i){var s,n,o;return o=navigator.userAgent.toLowerCase(),n=/(msie) ([\w.]+)/.exec(o)||[],s={name:n[1]||"",version:n[2]||"0"},"msie"===s.name&&("6.0"===s.version||"7.0"===s.version&&7===document.documentMode)?this:this.each(function(s){var n;return n=e(this),n.hasClass("chzn-done")?void 0:n.data("chosen",new t(this,i))})}}),t=function(t){function o(){return n=o.__super__.constructor.apply(this,arguments)}return a(o,t),o.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_value=this.form_field_jq.val(),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},o.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},o.prototype.set_up_html=function(){var t,s,n,o,a,r;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",t=["chzn-container"],t.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chzn-rtl"),this.f_width=this.form_field_jq.outerWidth(),n={id:this.container_id,"class":t.join(" "),style:"width: "+this.f_width+"px;",title:this.form_field.title},s=e("<div />",n),this.is_multiple?s.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):s.html('<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(s),this.container=e("#"+this.container_id),this.dropdown=this.container.find("div.chzn-drop").first(),o=this.container.height(),a=this.f_width-i(this.dropdown),this.dropdown.css({width:a+"px",top:o+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),r=a-i(this.search_container)-i(this.search_field),this.search_field.css({width:r+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},o.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){e.container_mousedown(t)}),this.container.mouseup(function(t){e.container_mouseup(t)}),this.container.mouseenter(function(t){e.mouse_enter(t)}),this.container.mouseleave(function(t){e.mouse_leave(t)}),this.search_results.mouseup(function(t){e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){e.search_results_mouseout(t)}),this.form_field_jq.bind("liszt:updated",function(t){e.results_update_field(t)}),this.form_field_jq.bind("liszt:activate",function(t){e.activate_field(t)}),this.form_field_jq.bind("liszt:open",function(t){e.container_mousedown(t)}),this.search_field.blur(function(t){e.input_blur(t)}),this.search_field.keyup(function(t){e.keyup_checker(t)}),this.search_field.keydown(function(t){e.keydown_checker(t)}),this.search_field.focus(function(t){e.input_focus(t)}),this.is_multiple?this.search_choices.click(function(t){e.choices_click(t)}):this.container.click(function(e){e.preventDefault()})},o.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},o.prototype.container_mousedown=function(t){var i;return this.is_disabled?void 0:(i=null!=t?e(t.target).hasClass("search-choice-close"):!1,t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),this.pending_destroy_click||i?this.pending_destroy_click=!1:(this.active_field?!this.is_multiple&&t&&(e(t.target)[0]===this.selected_item[0]||e(t.target).parents("a.chzn-single").length)&&(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field()))},o.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},o.prototype.blur_test=function(e){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},o.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},o.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},o.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},o.prototype.results_build=function(){var e,t,i,n,o;for(this.parsing=!0,this.results_data=s.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),e="",o=this.results_data,i=0,n=o.length;n>i;i++)t=o[i],t.group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},o.prototype.result_add_group=function(t){return t.disabled?"":(t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>")},o.prototype.result_do_highlight=function(e){var t,i,s,n,o;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),s=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),n=s+o,i=this.result_highlight.position().top+this.search_results.scrollTop(),t=i+this.result_highlight.outerHeight(),t>=n)return this.search_results.scrollTop(t-s>0?t-s:0);if(o>i)return this.search_results.scrollTop(i)}},o.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},o.prototype.results_show=function(){var e;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);return e=this.is_multiple?this.container.height():this.container.height()-1,this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.dropdown.css({top:e+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},o.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},o.prototype.set_tab_index=function(e){var t;return this.form_field_jq.attr("tabindex")?(t=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",t)):void 0},o.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},o.prototype.search_results_mouseup=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(t),this.search_field.focus()):void 0},o.prototype.search_results_mouseover=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},o.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},o.prototype.choices_click=function(t){return t.preventDefault(),!this.active_field||e(t.target).hasClass("search-choice")||this.results_showing?void 0:this.results_show()},o.prototype.choice_build=function(t){var i,s,n,o=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(i=this.container_id+"_c_"+t.array_index,this.choices+=1,s=t.disabled?'<li class="search-choice search-choice-disabled" id="'+i+'"><span>'+t.html+"</span></li>":'<li class="search-choice" id="'+i+'"><span>'+t.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+t.array_index+'"></a></li>',this.search_container.before(s),n=e("#"+i).find("a").first(),n.click(function(e){return o.choice_destroy_link_click(e)}))},o.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),this.is_disabled?t.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(e(t.target)))},o.prototype.choice_destroy=function(e){return this.result_deselect(e.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},o.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},o.prototype.results_reset_cleanup=function(){return this.current_value=this.form_field_jq.val(),this.selected_item.find("abbr").remove()},o.prototype.result_select=function(e){var t,i,s,n;return this.result_highlight?(t=this.result_highlight,i=t.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(t):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t,this.selected_item.removeClass("chzn-default")),t.addClass("result-selected"),n=i.substr(i.lastIndexOf("_")+1),s=this.results_data[n],s.selected=!0,this.form_field.options[s.options_index].selected=!0,this.is_multiple?this.choice_build(s):(this.selected_item.find("span").first().text(s.text),this.allow_single_deselect&&this.single_deselect_control_build()),(!e.metaKey&&!e.ctrlKey||!this.is_multiple)&&this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[s.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()):void 0},o.prototype.result_activate=function(e){return e.addClass("active-result")},o.prototype.result_deactivate=function(e){return e.removeClass("active-result")},o.prototype.result_deselect=function(t){var i,s;return s=this.results_data[t],this.form_field.options[s.options_index].disabled?!1:(s.selected=!1,this.form_field.options[s.options_index].selected=!1,i=e("#"+this.container_id+"_o_"+t),i.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[s.options_index].value}),this.search_field_scale(),!0)},o.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},o.prototype.winnow_results=function(){var t,i,s,n,o,a,r,l,h,d,c,u,p,f,g,m,v,b;for(this.no_results_clear(),h=0,d=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),a=this.search_contains?"":"^",o=new RegExp(a+d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),p=new RegExp(d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),b=this.results_data,f=0,m=b.length;m>f;f++)if(i=b[f],!i.disabled&&!i.empty)if(i.group)e("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(t=!1,l=i.dom_id,r=e("#"+l),o.test(i.html))t=!0,h+=1;else if(this.enable_split_word_search&&(i.html.indexOf(" ")>=0||0===i.html.indexOf("["))&&(n=i.html.replace(/\[|\]/g,"").split(" "),n.length))for(g=0,v=n.length;v>g;g++)s=n[g],o.test(s)&&(t=!0,h+=1);t?(d.length?(c=i.html.search(p),u=i.html.substr(0,c+d.length)+"</em>"+i.html.substr(c+d.length),u=u.substr(0,c)+"<em>"+u.substr(c)):u=i.html,r.html(u),this.result_activate(r),null!=i.group_array_index&&e("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(r))}return 1>h&&d.length?this.no_results(d):this.winnow_results_set_highlight()},o.prototype.winnow_results_clear=function(){var t,i,s,n,o;for(this.search_field.val(""),i=this.search_results.find("li"),o=[],s=0,n=i.length;n>s;s++)t=i[s],t=e(t),t.hasClass("group-result")?o.push(t.css("display","auto")):this.is_multiple&&t.hasClass("result-selected")?o.push(void 0):o.push(this.result_activate(t));return o},o.prototype.winnow_results_set_highlight=function(){var e,t;return this.result_highlight||(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null==e)?void 0:this.result_do_highlight(e)},o.prototype.no_results=function(t){var i;return i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(t),this.search_results.append(i)},o.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},o.prototype.keydown_arrow=function(){var t,i;return this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first(),i&&this.result_do_highlight(i)):(t=this.search_results.find("li.active-result").first(),t&&this.result_do_highlight(e(t))),this.results_showing?void 0:this.results_show()},o.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},o.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},o.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},o.prototype.keydown_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},o.prototype.search_field_scale=function(){var t,i,s,n,o,a,r,l,h;if(this.is_multiple){for(s=0,r=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",a=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],l=0,h=a.length;h>l;l++)n=a[l],o+=n+":"+this.search_field.css(n)+";";return i=e("<div />",{style:o}),i.text(this.search_field.val()),e("body").append(i),r=i.width()+25,i.remove(),r>this.f_width-10&&(r=this.f_width-10),this.search_field.css({width:r+"px"}),t=this.container.height(),this.dropdown.css({top:t+"px"})}},o.prototype.generate_random_id=function(){var t;for(t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();e("#"+t).length>0;)t+=this.generate_random_char();return t},o}(AbstractChosen),s.Chosen=t,i=function(e){var t;return t=e.outerWidth()-e.width()},s.get_side_border_padding=i}.call(this),define("chosen",function(){}),define("modules/sports/scorespage",["jquery","underscore","backbone","pubsub","state","admanager","baseview","chosen","animatecolors"],function(e,t,i,s,n,o,a){var r=a.extend({el:"#scorespage",initialize:function(i){e.extend(i,{refreshInterval:3e4,adInterval:1e3},i),a.prototype.initialize.call(this,i),t.bindAll(this,"onScoresUpdate","scoresPageRefresher"),this.continueRefresh=!0,this.refreshID=setTimeout(this.scoresPageRefresher,this.options.refreshInterval),this.adTimer=setTimeout(this.isAdStatsLoaded,this.options.adInterval)},isAdStatsLoaded:function(){o.getActiveSlotStatistics().done(function(t){e("#scorespage > .clearfix").remove(),"none"===e("#scorespage > .poster").css("display")?e("#scorespage > .game-even").after('<div class="clearfix"></div>'):e("#scorespage > .game:nth-child(2n)").after('<div class="clearfix"></div>')})},scoresPageRefresher:function(){if(this.continueRefresh){var e=window.location.pathname;this.fetchData(e,this.onScoresUpdate),this.isAdStatsLoaded()}},stopRefresh:function(){this.continueRefresh=!1,this.refreshID&&clearTimeout(this.refreshID)},fetchData:function(e,t){n.fetchHtml(e).done(t).fail(function(){console.log("ERROR: Scores Page AJAX load failed!")})},onScoresUpdate:function(i){if(i){var s=this.$el.closest("#scorespage"),n=e(i).find("#scorespage");s.find(".game").each(t.bind(function(t,i){var s=e(i),o=s.attr("id"),a=n.find("#"+o);if(a.length){var r=a.find(".total"),l=s.find(".total");this.markChangedScores(r,l),s.html(a.html())}},this)),this.addScoreHighlight(s.find(".scoreChangeFont"),"rgb(164, 23, 18)",1500),this.refreshID=setTimeout(this.scoresPageRefresher,this.options.refreshInterval)}},markChangedScores:function(i,s){i.each(t.bind(function(t,i){var n=e(i);n.html()!==s.eq(t).html()&&n.addClass("scoreChangeFont")},this))},addScoreHighlight:function(e,t,i){var s=t||"#FFFF9C",n=i||1e3,o=e.css("color");e.stop().css("color",s).animate({color:o},n).animate({color:s},n).animate({color:o},n)},destroy:function(){this.stopRefresh(),a.prototype.destroy.call(this)}});return r}),define("modules/sports/sports-more-teams",["jquery","underscore","backbone","baseview","utils","easing"],function(e,t,i,s,n){var o=s.extend({events:{"click .sp-more-teams-next-arrow":"onArrowClick","click .sp-more-teams-prev-arrow":"onArrowClick","click .sp-more-teams-nav-item-link":"onPaginationLinkClick"},initialize:function(){s.prototype.initialize.call(this,this.options),t.bindAll(this,"setup","update"),this.$viewport=this.$(".sp-more-teams-viewport"),this.$divisions=this.$viewport.find(".sp-more-teams-division"),this.divisionsCount=this.$divisions.length,this.$scroller=this.$(".sp-more-teams-scroll"),this.$arrows=this.$(".sp-more-teams-next-arrow, .sp-more-teams-prev-arrow"),this.$indicator=this.$(".sp-more-teams-nav-indicator"),this.$paginationLinks=this.$(".sp-more-teams-nav-item-link"),this.$navBelt=this.$(".sp-more-teams-nav-belt"),this.$navItemWrapper=this.$(".sp-more-teams-nav-item-wrap"),this.$navItems=this.$navItemWrapper.find(".sp-more-teams-nav-item"),this.$win=n.get("win");var e=t.throttle(this.update,1e3);this.$win.on("resize."+this.cid,e),this.currentDivisionIndex=this.$divisions.index(this.$divisions.filter(".current")),this.setup()},setup:function(){this._addTileSpacing(),this._addNavItemSpacing(),this._setupTicks(),this.scrollTo(this.currentDivisionIndex)},update:function(){this._addTileSpacing(),this._addNavItemSpacing(),this._setupTicks(),this.moveScroller(this.getAnimPosition(this.currentDivisionIndex)),this.moveIndicator(this.currentDivisionIndex)},_addNavItemSpacing:function(){var i,s=this.$navItemWrapper.width(),n=this.$navItems.length,o=0;this.$navItems.each(function(){o+=e(this).outerWidth()}),i=(s-o)/(2*n-2),i=parseInt(i,0),t.each(this.$navItems,function(t,s){var n=e(t),o=s+1,a=i+"px";1===o?n.css("margin-right",a):o===this.$navItems.length?n.css("margin-left",a):(n.css("margin-right",a),n.css("margin-left",a))},this)},_addTileSpacing:function(){t.each(this.$divisions,function(t){var i,s=e(t),n=s.find(".sp-more-teams-division-team-tile"),o=n.length,a=100/o;i=parseInt(this.$viewport.width(),0),s.width(i),n.each(function(){e(this).width(a+"%")})},this)},_setupTicks:function(){var i=this.$navBelt,s=i.find(".sp-more-teams-nav-indicator-tick"),n=s.eq(0).width(),o=s.length-1;t.each(s,function(t,s){var a=i.width()/o*s-n/2;e(t).css("left",a+"px")},this)},onArrowClick:function(t){var i,s=e(t.currentTarget),n=this.divisionsCount-1;
t.preventDefault(),s.hasClass("sp-more-teams-prev-arrow")?(i=this.currentDivisionIndex-1,n>i&&this.scrollTo(i)):(i=this.currentDivisionIndex+1,i>0&&this.scrollTo(i))},onPaginationLinkClick:function(t){var i=this.$paginationLinks.index(e(t.currentTarget));t.preventDefault(),this.scrollTo(i)},scrollTo:function(e){var i,s=this.$divisions.eq(e),n=this.divisionsCount-1;s.hasClass("active")||(i=this.getAnimPosition(e),this.$divisions.removeClass("active"),this.$arrows.show(),0===n?(this.$arrows.filter(".sp-more-teams-next-arrow").hide(),this.$arrows.filter(".sp-more-teams-prev-arrow").hide()):e===n?this.$arrows.filter(".sp-more-teams-next-arrow").hide():0===e&&this.$arrows.filter(".sp-more-teams-prev-arrow").hide(),this.moveScroller(i).done(t.bind(function(){s.addClass("active"),this.moveIndicator(e)},this)),this.currentDivisionIndex=e)},moveScroller:function(i){return e.Deferred(t.bind(function(e){this.$scroller.stop().animate({left:i+"px"},200,"easeInOutQuad",function(){e.resolve()})},this))},moveIndicator:function(e){var t,i=this.$navItems.length-1;t=this.$navBelt.width()/i*e-this.$indicator.width()/2,this.$indicator.stop().animate({left:t+"px"},100,"linear"),this.$paginationLinks.removeClass("sp-more-teams-nav-item-link-active"),this.$paginationLinks.eq(e).addClass("sp-more-teams-nav-item-link-active")},getAnimPosition:function(e){return-1*this.$viewport.outerWidth()*e},destroy:function(e){this.$win.off("."+this.cid),s.prototype.destroy.call(this,e)}});return o}),define("modules/interactive-poll",["jquery","underscore","baseview","pubsub","utils","state","cookie"],function(e,t,i,s,n,o){var a=i.extend({events:{"click .story-poll-choices .story-poll-vote-btn":"registerVote","click .story-poll-results-btn":"revealResults","click .poll-vote-results .story-poll-vote-btn":"revealChoices"},initialize:function(){this.poll_id=this.$el.attr("data-pollid"),this.user_id="unauthenticated",e.cookie(this.poll_id)&&this.revealResults(),i.prototype.initialize.apply(this,arguments)},revealResults:function(i){var s=this.$(".quickpoll-results"),n=this.$(".story-poll-choices"),a=this.$(".story-poll-chart"),r="/polls/get/"+this.poll_id+"/";o.fetchData(r).done(t.bind(function(o){var r=t.pluck(o[0].answer,"count"),l=t.reduce(r,function(e,t){return e+parseFloat(t)},0),h=0===l?!0:!1,d=0;isNaN(i)||(l+=1,e.cookie(this.poll_id,!0)),t.each(o[0].answer,function(e,t){var s;h?s=i==t?100:0:(i==t+1&&(e.count+=1),s=Math.round(parseFloat(e.count)/l*100)),d+=s,e.percent=s,e.percent_width=.8*s});var c=t.template(s.html(),{data:o[0],total:l});n.hide(),a.html(c).fadeIn(),e.cookie(this.poll_id)&&e(".poll-vote-results .story-poll-vote-wrapper").hide(),a.css("height","auto")},this))},registerVote:function(e){var i=this.$(".story-poll-answer:checked").val(),n="/polls/save/"+this.poll_id+"/"+this.user_id+"/"+i+"/";return o.fetchData(n,{method:"post"}).done(t.bind(function(e){e&&(s.trigger("uotrack","pollvote"),this.revealResults(i))},this)),!1},revealChoices:function(){var e=this.$(".story-poll-choices"),t=this.$(".story-poll-chart");t.hide(),e.fadeIn()}});return a}),define("user-accounts/firefly-user-account",["jquery","underscore","pubsub","user-accounts/base-user-account","user-manager","utils","third-party-apis/firefly/firefly","cookie"],function(e,t,i,s,n,o,a){"use strict";var r=s.extend({initialize:function(e){s.prototype.initialize.call(this,e),this.user={},n.registerAccount(this),n.loginUser("firefly")},_handleGetUserInfo:function(){return a.getUserInfo().done(t.bind(function(e){this.user=e},this))},_handleGetCoreUserInfo:function(){return a.getUserInfo().then(t.bind(function(e){for(var t=e.fireflyUserId||e.userId,i={CoreUserId:o.getNested(e,"userService","coreUserId"),AtyponSessionKey:this.getUserToken(),GooglePlusId:void 0,AtyponId:t,UserLicenseType:e.userLicenseType,FaceBookId:void 0,FileMobileId:void 0},s=o.getNested(e,"userService","identities")||[],n=0;n<s.length;n++){var a=s[n];"Facebook"===a.ProviderName?i.FaceBookId=a.ProviderUserId:"Google"===a.ProviderName&&(i.GooglePlusId=a.ProviderUserId)}return i},this))},getUserInfo:function(){return a.getUserInfo()},getUserAttributes:function(){return a.getUserAttributes()},getUserResponse:function(){return a.getUserResponse()},getViewsCookie:function(){return a.getFireflyViewsCookie()||{}},_handleLogin:function(e){var i;return i=e?"getLoginStatus":"loginUser",a[i]().then(t.bind(function(){return this._handleGetUserInfo()},this),t.bind(function(){this.logout()},this))},_handleLogout:function(){return this.getUserToken()?a.logoutUser(this.sessionToken):e.Deferred().resolve()},getName:function(){return"firefly"},getUserToken:function(){return e.cookie("sessionKey")},getUserId:function(){return this.user.userId},getUserAvatar:function(){return this.user.picture&&this.user.picture.data?this.user.picture.data.url:""},getUserFirstName:function(){return this.user.firstName},getUserLastName:function(){return this.user.lastName},getWelcomeName:function(){return this.user.welcomeName},getUserPhoto:function(){var e=t.find(this.user.attributes,function(e){return"preferredPhoto"===e.attributeName});return e?o.getNested(e,"attributeValues",0,"attributeValue"):void 0}});return new r}),define("modules/global/expired-card",["jquery","underscore","baseview","pubsub","state","utils"],function(e,t,i,s,n,o){var a=i.extend({events:{"click .cc-close_modal_link, .cc-remind-later-link":"close","click .cc-payment-button":"updatePaymentClick"},initialize:function(e){this.licenseId=e.licenseId||"",this.body=o.get("body"),n.registerFullScreenView(this),this.buildModal()},buildModal:function(){var t=this;n.fetchHtml("/services/expired-license/").done(function(i){t.modal_html=i,t.body.append(i),t.m_uiModal=e("#cc_modal"),t.m_uiModalBgrnd=e("#lightbox"),t.m_uiModal.show(),t.m_uiModalBgrnd.fadeIn(300),t.setElement("#cc_modal")})},updatePaymentClick:function(e){e.preventDefault(),o.openPopup(e.currentTarget.href+"?licenseId="+this.licenseId,screen.width,screen.height),this.close()},close:function(){if(this.m_uiModal){this.setLocalTimestamp(),n.clearFullScreenView();var e=this.m_uiModalBgrnd;this.destroy(!0),this.m_uiModalBgrnd.fadeOut(300,function(){e.remove()}),this.m_uiModal=null,this.m_uiModalBgrnd=null,this.modal_html=null}},setLocalTimestamp:function(){var e=new Date;localStorage["expired-credit-card"]=e.getTime()},destroy:function(e){this.modal_html&&this.modal_html.remove(),i.prototype.destroy.call(this,e)}});return a}),define("modules/users/site-nav-firefly-module",["jquery","underscore","modules/header/site-nav-dropdown","pubsub","utils","user-manager","state","user-accounts/firefly-user-account","modules/global/expired-card","admanager"],function(e,t,i,s,n,o,a,r,l,h){"use strict";var d=i.extend({events:{"click .ff-insider":"onClickInsider",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .site-nav-dropdown":"closeDropdown"},initialize:function(e){this.pubSub={"page:load":this.updateOnPageLoad,"user:statuschange":this.showLoggedInStatus,"user:logout":this.updateOnLogout},this.$siteNavDropdown=this.$(".site-nav-dropdown"),this.$navSpan=this.$(".site-nav-firefly-span"),this.$name=this.$(".site-nav-firefly-user-display-name"),this.loginData=n.getNested(window.site_vars,"userAuthentication","login"),this.logoutData=n.getNested(window.site_vars,"userAuthentication","logout"),this.pianoEnabled=n.getNested(window.site_vars,"THIRDPARTYAPI","PIANO","enabled"),h.getActiveSlotStatistics().done(t.bind(function(e){if(!this.destroyed&&!e.high_impact&&"loggedIn"==o.getLoginStatus()&&n.getNested(window.site_vars,"flags","expired_credit_card_modal")){var i=o.getAccount("firefly");i&&i.getUserInfo().done(t.bind(function(e){this.destroyed||this.checkCreditCardStatus(e)},this))}},this)),window.pianoHaltLoad=!0,this.userHasMarketAccess=!1,this.logoutOverride=!1,i.prototype.initialize.call(this,e)},updateOnPageLoad:function(i){var s=encodeURIComponent(window.location),a=encodeURIComponent(window.firefly_urls.onSuccessRedirectURL),r=this.loginData.success_qsp,l=this.loginData.cancel_qsp,h=this.logoutData.return_qsp,d="?"+r+"="+a+"&"+l+"="+s+"&"+h+"="+a;e(".userAuth-redirect").each(function(i,s){var n,o,a="",c=e(s),u=c.attr("href"),p=new RegExp("^"+r+"|^"+l+"|^"+h);t.isString(u)&&(n=u.split(/[\?\&]/),o=n.splice(1),o.length>0&&(o=t.filter(o,function(e){return p.test(e)?void 0:e}),a="&"+o.join("&")),c.attr("href",n[0]+d+a))}),e(".userActivate-redirect").each(function(t,i){var s=e(i),n=s.attr("href"),o=n.split(/[\?\&]/),r=o.slice(1).join("&");d="?onSuccessRedirectURL="+a,s.attr("href",o[0]+d+"&"+r)}),this.pianoEnabled&&("loggedOut"===o.getLoginStatus()||"loggedIn"===o.getLoginStatus()&&!this.userHasMarketAccess?(window.pianoHaltLoad=!0,this.logoutOverride&&(window.pianoHaltLoad=!1,this.logoutOverride=!1),n.getNested(window.tp,"experience")&&window.pianoTag_execute&&window.pianoTag_execute()):this.userHasMarketAccess&&window.pianoComplete&&window.pianoComplete())},updateOnLogout:function(e){window.pianoHaltLoad=!1,this.logoutOverride=!0,n.getNested(window.tp,"experience")&&window.pianoTag_execute&&window.pianoTag_execute()},showLoggedInStatus:function(e,t,i){"firefly"===e&&(this.$navSpan&&this.$navSpan.addClass("loaded"),"loggedIn"===t?this.showLoggedInUser(i):"loggingIn"!==t&&this.showLoggedOutUser())},checkCreditCardStatus:function(e){if(!e)return!1;var i=new Date;if(i.getTime()<parseInt(localStorage.getItem("expired-credit-card"))+864e5)return!1;var s,o=n.getNested(window.site_vars,"market_id"),a=e.licenses;t.each(a,function(e){e.marketId==o&&(s=e)}),this._verifyExpiredLicense(s)&&this._setupExpiredCardSubview(s.licenseId)},onClickInsider:function(){s.trigger("uotrack","myaccount|insider")},_verifyExpiredLicense:function(e){var t=new Date;return e&&e.creditCardExpirationMonth&&e.creditCardExpirationYear?e.lastPaymentFailed?!0:t.getFullYear()>parseInt(e.creditCardExpirationYear,10)?!0:t.getFullYear()==parseInt(e.creditCardExpirationYear,10)&&t.getMonth()+1>e.creditCardExpirationMonth?!0:t.getFullYear()>=parseInt(e.creditCardExpirationYear,10)&&t.getMonth()+1>=e.creditCardExpirationMonth&&t.getDate()>=15?!0:!1:!1},_setupExpiredCardSubview:function(e){this.subviews.expiredcard=new l({licenseId:e})},showLoggedOutUser:function(){this.$siteNavDropdown.removeClass("authenticated subscribed"),this.$name.html("")},showLoggedInUser:function(e){var t=o.getAccount("firefly");this.$siteNavDropdown.addClass("authenticated"),e.hasMarketAccess?(this.userHasMarketAccess=!0,this.$siteNavDropdown.addClass("subscribed"),window.pianoHaltLoad=!0,n.getNested(window.tp,"offer")&&window.tp.offer.close(),this.pianoEnabled&&window.pianoComplete&&window.pianoComplete()):(window.pianoHaltLoad=!1,n.getNested(window.tp,"experience")&&window.pianoTag_execute&&window.pianoTag_execute()),this.$name.text(t.getWelcomeName()),t.getUserPhoto()&&this.$navSpan.css({"background-image":"url("+t.getUserPhoto()+")"}).addClass("no-after")},destroy:function(){delete window.pianoHaltLoad,i.prototype.destroy.call(this)}});return d}),define("modules/travel/travel-featured-content",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(e,t,i,s,n,o){var a=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){s=e.extend({transition:{interval:15e3}},s),t.bindAll(this,"automate","goTo"),this.subviews={},this.moveMe=e(this.$el).find(".travel-featured-content-wrapper"),this.viewport=this.moveMe.parent(),this.slides=e(this.$el).find(".travel-featured-content-slide"),this.moveMe.width(this.moveMe.width()*this.moveMe.children().length),this.slides.length>1&&(this.subviews.paginator=new o({el:e(this.$el).find(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer())),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e;this.animate(this.moveMe,"left","-"+(i+1)+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return a}),define("modules/sports/sports-data-video",["jquery","underscore","baseview","modules/global/brightcove-video"],function(e,t,i,s){"use strict";var n=s.extend({events:function(){var e=s.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .videoStillPlay":"swapImageForVideo"})},initialize:function(t){this.$(".util-bar-primary-modules").addClass("util-bar-primary-modules-topic"),this.$(".util-bar-primary-modules-topic").removeClass("util-bar-primary-modules"),this.$playing=!1,this.$(".videoStillPlay").data("autoplay")===!0&&(t=e.extend({autostart:!0},t),this.$playing=!0),s.prototype.initialize.call(this,t)},onCardWidthChange:function(e){this.currentCardInfo=e;var t=e.name;if(this.$(".still").removeClass("active"),this.$(".still."+t).addClass("active"),this.$playing){var i=this.$(".still.active").width(),s=this.$(".still.active").data("video-height"),n=this.$(".videoObject object");n.attr("width",i),n.attr("height",s),this.$(".still").removeClass("active")}},renderCardInfo:function(e){this.currentCardInfo=e;var t=e.name,i=this.$(".still."+t).width(),s=this.$(".still."+t).data("video-height"),n=this.$(".videoObject object");this.$(".still").removeClass("active"),this.$(".videoStillPlay").data("autoplay")===!0?(this.$(".videoStillPlay").css("display","none"),n.find('[name="width"]').val(i),n.find('[name="height"]').val(s),n.attr("width",i),n.attr("height",s)):this.$(".still."+t).addClass("active")},swapImageForVideo:function(t){console.log("swap");var i=(e(t.currentTarget),this.$(".still.active").width()),n=this.$(".still.active").data("video-height");this.$(".videoObject param").each(function(){"width"==e(this).attr("name")?e(this).attr("value",i):"height"==e(this).attr("name")&&e(this).attr("value",n)}),this.$playing=!0,this.$(".still").removeClass("active"),s.prototype.swapImageForVideo.call(this,t)},destroy:function(e){s.prototype.destroy.call(this,!1)}});return n}),define("modules/stories/utility-bar-flyout",["jquery","underscore","backbone","baseview","pubsub","utils","managers/routemanager","site-manager","modules/scroller/vertical-scroll","state"],function(e,t,i,s,n,o,a,r,l,h){var d=s.extend({events:{"click .util-bar-flyout-close-ribbon":"close",click:"onClickFlyout"},initialize:function(e){t.bindAll(this,"onBodyClick","onWindowResize"),this.$body=o.get("body"),this.$win=o.get("win"),this.$flyout=this.$(".util-bar-flyout"),this.pubSub=this.pubSub||{},this.pubSub["breakingbar:after:open"]=this.onWindowResize,s.prototype.initialize.call(this,e)},onWindowResize:function(){var e=this.getAvailableVerticalSpace();this.updateFlyoutHeight(e),this.options.noFlyoutScroll||this.updateFlyoutScroller()},getAvailableVerticalSpace:function(){var e=r.getHeader(),t=0;return e&&e.isFixed()===!0?t=e.getCollapsedHeight():e&&e.isFixed()===!1&&(t=e.getCurrentHeight()),this.$win.height()-t},getContentHeight:function(){return this.$scrollableContent.outerHeight()},updateFlyoutHeight:function(e){this.$flyout.css("height",e)},updateFlyoutScroller:function(){this.subviews.vscroll?this.subviews.vscroll.refresh():this.subviews.vscroll=new l({el:this.$flyout})},open:function(e){this.$scrollableContent=this.$(".scrollable-content").eq(0),this.$(".util-bar-btn").removeClass("active"),this.$btn=e?this.$(".util-bar-btn-"+e):this.$(".util-bar-btn"),this.$btn.addClass("active"),this.$body.on("click."+this.cid,this.onBodyClick),this.$win.on("resize."+this.cid,t.throttle(this.onWindowResize,50)),this.$flyout.css({visibility:"visible"}).addClass("open"),e&&("share"==e?this.showSection("facebook"):this.showSection(e)),this.onWindowResize(),e&&n.trigger("uotrack","utilitybar"+e+"open")},updateURL:function(e,t){if(e.hasAttribute("href")&&"#"!=e.href)try{var i=e.href.split("?url=");e.href=i[0]+"?url="+t+i[1].match(/&.*$/)}catch(s){console.log(e.href+"\n"+s+"\nfailed video url")}},close:function(){var i=h.getActivePageInfo().share_url;t.each(e("[data-share-method]"),function(e){this.updateURL(e,i)},this),t.each(e("[data-module-name]"),function(e){this.updateURL(e,i)},this);var s=e(".email-message");s.length>0&&s.val(s.html().split(/http:\/\/.+\//)[0]+i),this.destroy()},onBodyClick:function(t){var i=e(t.target);(!t.isDefaultPrevented()||a.isAjax(i.attr("href")))&&this.close()},onClickFlyout:function(t){var i=e(t.target);i.closest("a").attr("href")||t.preventDefault()},destroy:function(e){this.$body.off("."+this.cid),this.$win.off("."+this.cid),this.$btn&&this.$btn.removeClass("active"),this.$flyout.css({visibility:"hidden"}).removeClass("open"),s.prototype.destroy.call(this,e),this.options.onDestroy&&this.options.onDestroy(this)}});return d}),define("modules/stories/utility-bar-module-firefly",["jquery","underscore","backbone","pubsub","third-party-apis/firefly/firefly","modules/stories/utility-bar-flyout","directAdPosition","state","utils","user-manager"],function(e,t,i,s,n,o,a,r,l,h){"use strict";var d=o.extend({initialize:function(i){i=e.extend({noFlyoutScroll:!0},i),t.bindAll(this,"fireflyFlyoutAdReady"),this.events=t.extend({},o.prototype.events,this.events),this.$title=this.$(".util-bar-flyout-firefly-title"),this.$subBtn=this.$(".util-bar-flyout-firefly-subscribe-btn"),this.$fireflyFlyoutAd=this.$(".util-bar-flyout-firefly-ad"),this.messaging=l.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","flyoutMessageOverrides"),this.gps_tracking=l.getNested(window.site_vars,"THIRDPARTYAPI","FIREFLY","gps"),this.viewsCookie=n.getFireflyViewsCookie(),o.prototype.initialize.call(this,i),void 0!==window.adsEnabled&&this._buildSpecialOffersFireflyFlyoutAd()},_buildSpecialOffersFireflyFlyoutAd:function(){var e=h.getAccount("firefly");this.subviews.fireflyFlyoutAd||(e?e.getUserInfo().done(t.bind(function(e){e.hasMarketAccess||this._applySpecialOffersDirectPositionAd()},this)).fail(t.bind(function(){this._applySpecialOffersDirectPositionAd()},this)):this._applySpecialOffersDirectPositionAd())},_applySpecialOffersDirectPositionAd:function(){this.subviews.fireflyFlyoutAd=new a({el:this.$fireflyFlyoutAd,targeting:{pwvr:this.viewsCookie?this.viewsCookie.viewsRemaining.toString():"0"},adSizes:[264,200],adPlacement:"consumer_sales-flyout",onAdReady:this.fireflyFlyoutAdReady})},fireflyFlyoutAdReady:function(){this.$subBtn.addClass("hidden"),this.$fireflyFlyoutAd.removeClass("hidden"),this.subviews.fireflyFlyoutAd.showAd()},setTitle:function(e,t){this.$title.text(e),t?this.$title.addClass("util-bar-flyout-firefly-title-large"):this.$title.removeClass("util-bar-flyout-firefly-title-large")},setGPS:function(e){var t=this.$subBtn.attr("href");t=t.replace(/(gps-source)=.*/,"$1="+e),this.$subBtn.attr("href",t)},open:function(){if(this.viewsCookie)if(1===this.viewsCookie.viewCount)this.setTitle(this.messaging.first),this.setGPS(this.gps_tracking.first);else if(0===this.viewsCookie.viewsRemaining)this.setTitle(this.messaging.last),this.setGPS(this.gps_tracking.last);else{var e,i,s=this.viewsCookie.viewsRemaining,n=!1;n=t.find(l.getNested(this.messaging,"extra_overrides"),function(e){return e.view_remaining===s}),n?(e=n.message,i=this.gps_tracking.custom):(e=this.viewsCookie.viewsRemaining>1?this.viewsCookie.viewsRemaining+this.messaging.tweener:this.viewsCookie.viewsRemaining+this.messaging.tweener_singular,i=this.viewsCookie.viewsRemaining>1?this.gps_tracking.tweener:this.gps_tracking.tweener_singular),this.setTitle(e,!0),this.setGPS(i)}o.prototype.open.call(this)},close:function(){s.trigger("uotrack","UtilityBarFireflyClose"),this.destroy()}});return d}),document.createElement("canvas").getContext||!function(){function e(){return this.context_||(this.context_=new w(this))}function t(e,t,i){var s=j.call(arguments,2);return function(){return e.apply(t,s.concat(j.call(arguments)))}}function i(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;")}function s(e,t,i){e.namespaces[t]||e.namespaces.add(t,i,"#default#VML")}function n(e){if(s(e,"g_vml_","urn:schemas-microsoft-com:vml"),s(e,"g_o_","urn:schemas-microsoft-com:office:office"),!e.styleSheets.ex_canvas_){var t=e.createStyleSheet();t.owningElement.id="ex_canvas_",t.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}"}}function o(e){var t=e.srcElement;switch(e.propertyName){case"width":t.getContext().clearRect(),t.style.width=t.attributes.width.nodeValue+"px",t.firstChild.style.width=t.clientWidth+"px";break;case"height":t.getContext().clearRect(),t.style.height=t.attributes.height.nodeValue+"px",t.firstChild.style.height=t.clientHeight+"px"}}function a(e){var t=e.srcElement;t.firstChild&&(t.firstChild.style.width=t.clientWidth+"px",t.firstChild.style.height=t.clientHeight+"px")}function r(){return[[1,0,0],[0,1,0],[0,0,1]]}function l(e,t){for(var i=r(),s=0;3>s;s++)for(var n=0;3>n;n++){for(var o=0,a=0;3>a;a++)o+=e[s][a]*t[a][n];i[s][n]=o}return i}function h(e,t){t.fillStyle=e.fillStyle,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY,t.strokeStyle=e.strokeStyle,t.globalAlpha=e.globalAlpha,t.font=e.font,t.textAlign=e.textAlign,t.textBaseline=e.textBaseline,t.arcScaleX_=e.arcScaleX_,t.arcScaleY_=e.arcScaleY_,t.lineScale_=e.lineScale_}function d(e){var t=e.indexOf("(",3),i=e.indexOf(")",t+1),s=e.substring(t+1,i).split(",");return(4!=s.length||"a"!=e.charAt(3))&&(s[3]=1),s}function c(e){return parseFloat(e)/100}function u(e,t,i){return Math.min(i,Math.max(t,e))}function p(e){var t,i,s,n,o,a;if(n=parseFloat(e[0])/360%360,0>n&&n++,o=u(c(e[1]),0,1),a=u(c(e[2]),0,1),0==o)t=i=s=a;else{var r=.5>a?a*(1+o):a+o-a*o,l=2*a-r;t=f(l,r,n+1/3),i=f(l,r,n),s=f(l,r,n-1/3)}return"#"+H[Math.floor(255*t)]+H[Math.floor(255*i)]+H[Math.floor(255*s)]}function f(e,t,i){return 0>i&&i++,i>1&&i--,1>6*i?e+6*(t-e)*i:1>2*i?t:2>3*i?e+(t-e)*(2/3-i)*6:e}function g(e){if(e in q)return q[e];var t,i=1;if(e=String(e),"#"==e.charAt(0))t=e;else if(/^rgb/.test(e)){for(var s,n=d(e),t="#",o=0;3>o;o++)s=-1!=n[o].indexOf("%")?Math.floor(255*c(n[o])):+n[o],t+=H[u(s,0,255)];i=+n[3]}else if(/^hsl/.test(e)){var n=d(e);t=p(n),i=n[3]}else t=W[e]||e;return q[e]={color:t,alpha:i}}function m(e){if(Y[e])return Y[e];var t=document.createElement("div"),i=t.style;try{i.font=e}catch(s){}return Y[e]={style:i.fontStyle||G.style,variant:i.fontVariant||G.variant,weight:i.fontWeight||G.weight,size:i.fontSize||G.size,family:i.fontFamily||G.family}}function v(e,t){var i={};for(var s in e)i[s]=e[s];var n=parseFloat(t.currentStyle.fontSize),o=parseFloat(e.size);return"number"==typeof e.size?i.size=e.size:-1!=e.size.indexOf("px")?i.size=o:-1!=e.size.indexOf("em")?i.size=n*o:-1!=e.size.indexOf("%")?i.size=n/100*o:-1!=e.size.indexOf("pt")?i.size=o/.75:i.size=n,i.size*=.981,i}function b(e){return e.style+" "+e.variant+" "+e.weight+" "+e.size+"px "+e.family}function y(e){return X[e]||"square"}function w(e){this.m_=r(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*R,this.globalAlpha=1,this.font="10px sans-serif",this.textAlign="left",this.textBaseline="alphabetic",this.canvas=e;var t="width:"+e.clientWidth+"px;height:"+e.clientHeight+"px;overflow:hidden;position:absolute",i=e.ownerDocument.createElement("div");i.style.cssText=t,e.appendChild(i);var s=i.cloneNode(!1);s.style.backgroundColor="red",s.style.filter="alpha(opacity=0)",e.appendChild(s),this.element_=i,this.arcScaleX_=1,this.arcScaleY_=1,this.lineScale_=1}function _(e,t,i,s){e.currentPath_.push({type:"bezierCurveTo",cp1x:t.x,cp1y:t.y,cp2x:i.x,cp2y:i.y,x:s.x,y:s.y}),e.currentX_=s.x,e.currentY_=s.y}function C(e,t){var i=g(e.strokeStyle),s=i.color,n=i.alpha*e.globalAlpha,o=e.lineScale_*e.lineWidth;1>o&&(n*=o),t.push("<g_vml_:stroke",' opacity="',n,'"',' joinstyle="',e.lineJoin,'"',' miterlimit="',e.miterLimit,'"',' endcap="',y(e.lineCap),'"',' weight="',o,'px"',' color="',s,'" />')}function S(e,t,i,s){var n=e.fillStyle,o=e.arcScaleX_,a=e.arcScaleY_,r=s.x-i.x,l=s.y-i.y;if(n instanceof $){var h=0,d={x:0,y:0},c=0,u=1;if("gradient"==n.type_){var p=n.x0_/o,f=n.y0_/a,m=n.x1_/o,v=n.y1_/a,b=x(e,p,f),y=x(e,m,v),w=y.x-b.x,_=y.y-b.y;h=180*Math.atan2(w,_)/Math.PI,0>h&&(h+=360),1e-6>h&&(h=0)}else{var b=x(e,n.x0_,n.y0_);d={x:(b.x-i.x)/r,y:(b.y-i.y)/l},r/=o*R,l/=a*R;var C=M.max(r,l);c=2*n.r0_/C,u=2*n.r1_/C-c}var S=n.colors_;S.sort(function(e,t){return e.offset-t.offset});for(var k=S.length,T=S[0].color,P=S[k-1].color,D=S[0].alpha*e.globalAlpha,I=S[k-1].alpha*e.globalAlpha,E=[],L=0;k>L;L++){var N=S[L];E.push(N.offset*u+c+" "+N.color)}t.push('<g_vml_:fill type="',n.type_,'"',' method="none" focus="100%"',' color="',T,'"',' color2="',P,'"',' colors="',E.join(","),'"',' opacity="',I,'"',' g_o_:opacity2="',D,'"',' angle="',h,'"',' focusposition="',d.x,",",d.y,'" />')}else if(n instanceof A){if(r&&l){var F=-i.x,O=-i.y;t.push("<g_vml_:fill",' position="',F/r*o*o,",",O/l*a*a,'"',' type="tile"',' src="',n.src_,'" />')}}else{var B=g(e.fillStyle),j=B.color,z=B.alpha*e.globalAlpha;t.push('<g_vml_:fill color="',j,'" opacity="',z,'" />')}}function x(e,t,i){var s=e.m_;return{x:R*(t*s[0][0]+i*s[1][0]+s[2][0])-B,y:R*(t*s[0][1]+i*s[1][1]+s[2][1])-B}}function k(e){return isFinite(e[0][0])&&isFinite(e[0][1])&&isFinite(e[1][0])&&isFinite(e[1][1])&&isFinite(e[2][0])&&isFinite(e[2][1])}function T(e,t,i){if(k(t)&&(e.m_=t,i)){var s=t[0][0]*t[1][1]-t[0][1]*t[1][0];e.lineScale_=O(F(s))}}function $(e){this.type_=e,this.x0_=0,this.y0_=0,this.r0_=0,this.x1_=0,this.y1_=0,this.r1_=0,this.colors_=[]}function A(e,t){switch(D(e),t){case"repeat":case null:case"":this.repetition_="repeat";break;case"repeat-x":case"repeat-y":case"no-repeat":this.repetition_=t;break;default:P("SYNTAX_ERR")}this.src_=e.src,this.width_=e.width,this.height_=e.height}function P(e){throw new I(e)}function D(e){e&&1==e.nodeType&&"IMG"==e.tagName||P("TYPE_MISMATCH_ERR"),"complete"!=e.readyState&&P("INVALID_STATE_ERR")}function I(e){this.code=this[e],this.message=e+": DOM Exception "+this.code}var M=Math,E=M.round,L=M.sin,N=M.cos,F=M.abs,O=M.sqrt,R=10,B=R/2,j=(+navigator.userAgent.match(/MSIE ([\d.]+)?/)[1],Array.prototype.slice);n(document);var z={init:function(e){var i=e||document;i.createElement("canvas"),i.attachEvent("onreadystatechange",t(this.init_,this,i))},init_:function(e){for(var t=e.getElementsByTagName("canvas"),i=0;i<t.length;i++)this.initElement(t[i])},initElement:function(t){if(!t.getContext){t.getContext=e,n(t.ownerDocument),t.innerHTML="",t.attachEvent("onpropertychange",o),t.attachEvent("onresize",a);var i=t.attributes;i.width&&i.width.specified?t.style.width=i.width.nodeValue+"px":t.width=t.clientWidth,i.height&&i.height.specified?t.style.height=i.height.nodeValue+"px":t.height=t.clientHeight}return t}};z.init();for(var H=[],V=0;16>V;V++)for(var U=0;16>U;U++)H[16*V+U]=V.toString(16)+U.toString(16);var W={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",grey:"#808080",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",oldlace:"#FDF5E6",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",whitesmoke:"#F5F5F5",yellowgreen:"#9ACD32"},q={},G={style:"normal",variant:"normal",weight:"normal",size:10,family:"sans-serif"},Y={},X={butt:"flat",round:"round"},Z=w.prototype;Z.clearRect=function(){this.textMeasureEl_&&(this.textMeasureEl_.removeNode(!0),this.textMeasureEl_=null),this.element_.innerHTML=""},Z.beginPath=function(){this.currentPath_=[]},Z.moveTo=function(e,t){var i=x(this,e,t);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},Z.lineTo=function(e,t){var i=x(this,e,t);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},Z.bezierCurveTo=function(e,t,i,s,n,o){var a=x(this,n,o),r=x(this,e,t),l=x(this,i,s);_(this,r,l,a)},Z.quadraticCurveTo=function(e,t,i,s){var n=x(this,e,t),o=x(this,i,s),a={x:this.currentX_+2/3*(n.x-this.currentX_),y:this.currentY_+2/3*(n.y-this.currentY_)},r={x:a.x+(o.x-this.currentX_)/3,y:a.y+(o.y-this.currentY_)/3};_(this,a,r,o)},Z.arc=function(e,t,i,s,n,o){i*=R;var a=o?"at":"wa",r=e+N(s)*i-B,l=t+L(s)*i-B,h=e+N(n)*i-B,d=t+L(n)*i-B;r!=h||o||(r+=.125);var c=x(this,e,t),u=x(this,r,l),p=x(this,h,d);this.currentPath_.push({type:a,x:c.x,y:c.y,radius:i,xStart:u.x,yStart:u.y,xEnd:p.x,yEnd:p.y})},Z.rect=function(e,t,i,s){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath()},Z.strokeRect=function(e,t,i,s){var n=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath(),this.stroke(),this.currentPath_=n},Z.fillRect=function(e,t,i,s){var n=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+s),this.lineTo(e,t+s),this.closePath(),this.fill(),this.currentPath_=n},Z.createLinearGradient=function(e,t,i,s){var n=new $("gradient");return n.x0_=e,n.y0_=t,n.x1_=i,n.y1_=s,n},Z.createRadialGradient=function(e,t,i,s,n,o){var a=new $("gradientradial");return a.x0_=e,a.y0_=t,a.r0_=i,a.x1_=s,a.y1_=n,a.r1_=o,a},Z.drawImage=function(e,t){var i,s,n,o,a,r,l,h,d=e.runtimeStyle.width,c=e.runtimeStyle.height;e.runtimeStyle.width="auto",e.runtimeStyle.height="auto";var u=e.width,p=e.height;if(e.runtimeStyle.width=d,e.runtimeStyle.height=c,3==arguments.length)i=arguments[1],s=arguments[2],a=r=0,l=n=u,h=o=p;else if(5==arguments.length)i=arguments[1],
s=arguments[2],n=arguments[3],o=arguments[4],a=r=0,l=u,h=p;else{if(9!=arguments.length)throw Error("Invalid number of arguments");a=arguments[1],r=arguments[2],l=arguments[3],h=arguments[4],i=arguments[5],s=arguments[6],n=arguments[7],o=arguments[8]}var f=x(this,i,s),g=[],m=10,v=10;if(g.push(" <g_vml_:group",' coordsize="',R*m,",",R*v,'"',' coordorigin="0,0"',' style="width:',m,"px;height:",v,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]||1!=this.m_[1][1]||this.m_[1][0]){var b=[];b.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",E(f.x/R),",","Dy=",E(f.y/R),"");var y=f,w=x(this,i+n,s),_=x(this,i,s+o),C=x(this,i+n,s+o);y.x=M.max(y.x,w.x,_.x,C.x),y.y=M.max(y.y,w.y,_.y,C.y),g.push("padding:0 ",E(y.x/R),"px ",E(y.y/R),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",b.join(""),", sizingmethod='clip');")}else g.push("top:",E(f.y/R),"px;left:",E(f.x/R),"px;");g.push(' ">','<g_vml_:image src="',e.src,'"',' style="width:',R*n,"px;"," height:",R*o,'px"',' cropleft="',a/u,'"',' croptop="',r/p,'"',' cropright="',(u-a-l)/u,'"',' cropbottom="',(p-r-h)/p,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",g.join(""))},Z.stroke=function(e){for(var t=10,i=10,s=5e3,n={x:null,y:null},o={x:null,y:null},a=0;a<this.currentPath_.length;a+=s){var r=[];r.push("<g_vml_:shape",' filled="',!!e,'"',' style="position:absolute;width:',t,"px;height:",i,'px;"',' coordorigin="0,0"',' coordsize="',R*t,",",R*i,'"',' stroked="',!e,'"',' path="');for(var l=a;l<Math.min(a+s,this.currentPath_.length);l++){l%s==0&&l>0&&r.push(" m ",E(this.currentPath_[l-1].x),",",E(this.currentPath_[l-1].y));var h,d=this.currentPath_[l];switch(d.type){case"moveTo":h=d,r.push(" m ",E(d.x),",",E(d.y));break;case"lineTo":r.push(" l ",E(d.x),",",E(d.y));break;case"close":r.push(" x "),d=null;break;case"bezierCurveTo":r.push(" c ",E(d.cp1x),",",E(d.cp1y),",",E(d.cp2x),",",E(d.cp2y),",",E(d.x),",",E(d.y));break;case"at":case"wa":r.push(" ",d.type," ",E(d.x-this.arcScaleX_*d.radius),",",E(d.y-this.arcScaleY_*d.radius)," ",E(d.x+this.arcScaleX_*d.radius),",",E(d.y+this.arcScaleY_*d.radius)," ",E(d.xStart),",",E(d.yStart)," ",E(d.xEnd),",",E(d.yEnd))}d&&((null==n.x||d.x<n.x)&&(n.x=d.x),(null==o.x||d.x>o.x)&&(o.x=d.x),(null==n.y||d.y<n.y)&&(n.y=d.y),(null==o.y||d.y>o.y)&&(o.y=d.y))}r.push(' ">'),e?S(this,r,n,o):C(this,r),r.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",r.join(""))}},Z.fill=function(){this.stroke(!0)},Z.closePath=function(){this.currentPath_.push({type:"close"})},Z.save=function(){var e={};h(this,e),this.aStack_.push(e),this.mStack_.push(this.m_),this.m_=l(r(),this.m_)},Z.restore=function(){this.aStack_.length&&(h(this.aStack_.pop(),this),this.m_=this.mStack_.pop())},Z.translate=function(e,t){var i=[[1,0,0],[0,1,0],[e,t,1]];T(this,l(i,this.m_),!1)},Z.rotate=function(e){var t=N(e),i=L(e),s=[[t,i,0],[-i,t,0],[0,0,1]];T(this,l(s,this.m_),!1)},Z.scale=function(e,t){this.arcScaleX_*=e,this.arcScaleY_*=t;var i=[[e,0,0],[0,t,0],[0,0,1]];T(this,l(i,this.m_),!0)},Z.transform=function(e,t,i,s,n,o){var a=[[e,t,0],[i,s,0],[n,o,1]];T(this,l(a,this.m_),!0)},Z.setTransform=function(e,t,i,s,n,o){var a=[[e,t,0],[i,s,0],[n,o,1]];T(this,a,!0)},Z.drawText_=function(e,t,s,n,o){var a=this.m_,r=1e3,l=0,h=r,d={x:0,y:0},c=[],u=v(m(this.font),this.element_),p=b(u),f=this.element_.currentStyle,g=this.textAlign.toLowerCase();switch(g){case"left":case"center":case"right":break;case"end":g="ltr"==f.direction?"right":"left";break;case"start":g="rtl"==f.direction?"right":"left";break;default:g="left"}switch(this.textBaseline){case"hanging":case"top":d.y=u.size/1.75;break;case"middle":break;default:case null:case"alphabetic":case"ideographic":case"bottom":d.y=-u.size/2.25}switch(g){case"right":l=r,h=.05;break;case"center":l=h=r/2}var y=x(this,t+d.x,s+d.y);c.push('<g_vml_:line from="',-l,' 0" to="',h,' 0.05" ',' coordsize="100 100" coordorigin="0 0"',' filled="',!o,'" stroked="',!!o,'" style="position:absolute;width:1px;height:1px;">'),o?C(this,c):S(this,c,{x:-l,y:0},{x:h,y:u.size});var w=a[0][0].toFixed(3)+","+a[1][0].toFixed(3)+","+a[0][1].toFixed(3)+","+a[1][1].toFixed(3)+",0,0",_=E(y.x/R)+","+E(y.y/R);c.push('<g_vml_:skew on="t" matrix="',w,'" ',' offset="',_,'" origin="',l,' 0" />','<g_vml_:path textpathok="true" />','<g_vml_:textpath on="true" string="',i(e),'" style="v-text-align:',g,";font:",i(p),'" /></g_vml_:line>'),this.element_.insertAdjacentHTML("beforeEnd",c.join(""))},Z.fillText=function(e,t,i,s){this.drawText_(e,t,i,s,!1)},Z.strokeText=function(e,t,i,s){this.drawText_(e,t,i,s,!0)},Z.measureText=function(e){if(!this.textMeasureEl_){var t='<span style="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;"></span>';this.element_.insertAdjacentHTML("beforeEnd",t),this.textMeasureEl_=this.element_.lastChild}var i=this.element_.ownerDocument;return this.textMeasureEl_.innerHTML="",this.textMeasureEl_.style.font=this.font,this.textMeasureEl_.appendChild(i.createTextNode(e)),{width:this.textMeasureEl_.offsetWidth}},Z.clip=function(){},Z.arcTo=function(){},Z.createPattern=function(e,t){return new A(e,t)},$.prototype.addColorStop=function(e,t){t=g(t),this.colors_.push({offset:e,color:t.color,alpha:t.alpha})};var J=I.prototype=new Error;J.INDEX_SIZE_ERR=1,J.DOMSTRING_SIZE_ERR=2,J.HIERARCHY_REQUEST_ERR=3,J.WRONG_DOCUMENT_ERR=4,J.INVALID_CHARACTER_ERR=5,J.NO_DATA_ALLOWED_ERR=6,J.NO_MODIFICATION_ALLOWED_ERR=7,J.NOT_FOUND_ERR=8,J.NOT_SUPPORTED_ERR=9,J.INUSE_ATTRIBUTE_ERR=10,J.INVALID_STATE_ERR=11,J.SYNTAX_ERR=12,J.INVALID_MODIFICATION_ERR=13,J.NAMESPACE_ERR=14,J.INVALID_ACCESS_ERR=15,J.VALIDATION_ERR=16,J.TYPE_MISMATCH_ERR=17,G_vmlCanvasManager=z,CanvasRenderingContext2D=w,CanvasGradient=$,CanvasPattern=A,DOMException=I}(),define("libs/flot/excanvas",function(){}),function(e){e.color={},e.color.make=function(t,i,s,n){var o={};return o.r=t||0,o.g=i||0,o.b=s||0,o.a=null!=n?n:1,o.add=function(e,t){for(var i=0;i<e.length;++i)o[e.charAt(i)]+=t;return o.normalize()},o.scale=function(e,t){for(var i=0;i<e.length;++i)o[e.charAt(i)]*=t;return o.normalize()},o.toString=function(){return o.a>=1?"rgb("+[o.r,o.g,o.b].join(",")+")":"rgba("+[o.r,o.g,o.b,o.a].join(",")+")"},o.normalize=function(){function e(e,t,i){return e>t?e:t>i?i:t}return o.r=e(0,parseInt(o.r),255),o.g=e(0,parseInt(o.g),255),o.b=e(0,parseInt(o.b),255),o.a=e(0,o.a,1),o},o.clone=function(){return e.color.make(o.r,o.b,o.g,o.a)},o.normalize()},e.color.extract=function(t,i){var s;do{if(s=t.css(i).toLowerCase(),""!=s&&"transparent"!=s)break;t=t.parent()}while(!e.nodeName(t.get(0),"body"));return"rgba(0, 0, 0, 0)"==s&&(s="transparent"),e.color.parse(s)},e.color.parse=function(i){var s,n=e.color.make;if(s=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(i))return n(parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10));if(s=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return n(parseInt(s[1],10),parseInt(s[2],10),parseInt(s[3],10),parseFloat(s[4]));if(s=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(i))return n(2.55*parseFloat(s[1]),2.55*parseFloat(s[2]),2.55*parseFloat(s[3]));if(s=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(i))return n(2.55*parseFloat(s[1]),2.55*parseFloat(s[2]),2.55*parseFloat(s[3]),parseFloat(s[4]));if(s=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(i))return n(parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16));if(s=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(i))return n(parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16));var o=e.trim(i).toLowerCase();return"transparent"==o?n(255,255,255,0):(s=t[o]||[0,0,0],n(s[0],s[1],s[2]))};var t={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(e){function t(t,i){var s=i.children("."+t)[0];if(null==s&&(s=document.createElement("canvas"),s.className=t,e(s).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(i),!s.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");s=window.G_vmlCanvasManager.initElement(s)}this.element=s;var n=this.context=s.getContext("2d"),o=window.devicePixelRatio||1,a=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;this.pixelRatio=o/a,this.resize(i.width(),i.height()),this.textContainer=null,this.text={},this._textCache={}}function i(i,n,o,a){function r(e,t){t=[me].concat(t);for(var i=0;i<e.length;++i)e[i].apply(this,t)}function l(){for(var i={Canvas:t},s=0;s<a.length;++s){var n=a[s];n.init(me,i),n.options&&e.extend(!0,ne,n.options)}}function h(t){e.extend(!0,ne,t),t&&t.colors&&(ne.colors=t.colors),null==ne.xaxis.color&&(ne.xaxis.color=e.color.parse(ne.grid.color).scale("a",.22).toString()),null==ne.yaxis.color&&(ne.yaxis.color=e.color.parse(ne.grid.color).scale("a",.22).toString()),null==ne.xaxis.tickColor&&(ne.xaxis.tickColor=ne.grid.tickColor||ne.xaxis.color),null==ne.yaxis.tickColor&&(ne.yaxis.tickColor=ne.grid.tickColor||ne.yaxis.color),null==ne.grid.borderColor&&(ne.grid.borderColor=ne.grid.color),null==ne.grid.tickColor&&(ne.grid.tickColor=e.color.parse(ne.grid.color).scale("a",.22).toString());var s,n,o,a={style:i.css("font-style"),size:Math.round(.8*(+i.css("font-size").replace("px","")||13)),variant:i.css("font-variant"),weight:i.css("font-weight"),family:i.css("font-family")};for(a.lineHeight=1.15*a.size,o=ne.xaxes.length||1,s=0;o>s;++s)n=ne.xaxes[s],n&&!n.tickColor&&(n.tickColor=n.color),n=e.extend(!0,{},ne.xaxis,n),ne.xaxes[s]=n,n.font&&(n.font=e.extend({},a,n.font),n.font.color||(n.font.color=n.color));for(o=ne.yaxes.length||1,s=0;o>s;++s)n=ne.yaxes[s],n&&!n.tickColor&&(n.tickColor=n.color),n=e.extend(!0,{},ne.yaxis,n),ne.yaxes[s]=n,n.font&&(n.font=e.extend({},a,n.font),n.font.color||(n.font.color=n.color));for(ne.xaxis.noTicks&&null==ne.xaxis.ticks&&(ne.xaxis.ticks=ne.xaxis.noTicks),ne.yaxis.noTicks&&null==ne.yaxis.ticks&&(ne.yaxis.ticks=ne.yaxis.noTicks),ne.x2axis&&(ne.xaxes[1]=e.extend(!0,{},ne.xaxis,ne.x2axis),ne.xaxes[1].position="top"),ne.y2axis&&(ne.yaxes[1]=e.extend(!0,{},ne.yaxis,ne.y2axis),ne.yaxes[1].position="right"),ne.grid.coloredAreas&&(ne.grid.markings=ne.grid.coloredAreas),ne.grid.coloredAreasColor&&(ne.grid.markingsColor=ne.grid.coloredAreasColor),ne.lines&&e.extend(!0,ne.series.lines,ne.lines),ne.points&&e.extend(!0,ne.series.points,ne.points),ne.bars&&e.extend(!0,ne.series.bars,ne.bars),null!=ne.shadowSize&&(ne.series.shadowSize=ne.shadowSize),null!=ne.highlightColor&&(ne.series.highlightColor=ne.highlightColor),s=0;s<ne.xaxes.length;++s)m(de,s+1).options=ne.xaxes[s];for(s=0;s<ne.yaxes.length;++s)m(ce,s+1).options=ne.yaxes[s];for(var l in ge)ne.hooks[l]&&ne.hooks[l].length&&(ge[l]=ge[l].concat(ne.hooks[l]));r(ge.processOptions,[ne])}function d(e){se=c(e),v(),b()}function c(t){for(var i=[],s=0;s<t.length;++s){var n=e.extend(!0,{},ne.series);null!=t[s].data?(n.data=t[s].data,delete t[s].data,e.extend(!0,n,t[s]),t[s].data=n.data):n.data=t[s],i.push(n)}return i}function u(e,t){var i=e[t+"axis"];return"object"==typeof i&&(i=i.n),"number"!=typeof i&&(i=1),i}function p(){return e.grep(de.concat(ce),function(e){return e})}function f(e){var t,i,s={};for(t=0;t<de.length;++t)i=de[t],i&&i.used&&(s["x"+i.n]=i.c2p(e.left));for(t=0;t<ce.length;++t)i=ce[t],i&&i.used&&(s["y"+i.n]=i.c2p(e.top));return void 0!==s.x1&&(s.x=s.x1),void 0!==s.y1&&(s.y=s.y1),s}function g(e){var t,i,s,n={};for(t=0;t<de.length;++t)if(i=de[t],i&&i.used&&(s="x"+i.n,null==e[s]&&1==i.n&&(s="x"),null!=e[s])){n.left=i.p2c(e[s]);break}for(t=0;t<ce.length;++t)if(i=ce[t],i&&i.used&&(s="y"+i.n,null==e[s]&&1==i.n&&(s="y"),null!=e[s])){n.top=i.p2c(e[s]);break}return n}function m(t,i){return t[i-1]||(t[i-1]={n:i,direction:t==de?"x":"y",options:e.extend(!0,{},t==de?ne.xaxis:ne.yaxis)}),t[i-1]}function v(){var t,i=se.length,s=-1;for(t=0;t<se.length;++t){var n=se[t].color;null!=n&&(i--,"number"==typeof n&&n>s&&(s=n))}s>=i&&(i=s+1);var o,a=[],r=ne.colors,l=r.length,h=0;for(t=0;i>t;t++)o=e.color.parse(r[t%l]||"#666"),t%l==0&&t&&(h=h>=0?.5>h?-h-.2:0:-h),a[t]=o.scale("rgb",1+h);var d,c=0;for(t=0;t<se.length;++t){if(d=se[t],null==d.color?(d.color=a[c].toString(),++c):"number"==typeof d.color&&(d.color=a[d.color].toString()),null==d.lines.show){var p,f=!0;for(p in d)if(d[p]&&d[p].show){f=!1;break}f&&(d.lines.show=!0)}null==d.lines.zero&&(d.lines.zero=!!d.lines.fill),d.xaxis=m(de,u(d,"x")),d.yaxis=m(ce,u(d,"y"))}}function b(){function t(e,t,i){t<e.datamin&&t!=-b&&(e.datamin=t),i>e.datamax&&i!=b&&(e.datamax=i)}var i,s,n,o,a,l,h,d,c,u,f,g,m=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,b=Number.MAX_VALUE;for(e.each(p(),function(e,t){t.datamin=m,t.datamax=v,t.used=!1}),i=0;i<se.length;++i)a=se[i],a.datapoints={points:[]},r(ge.processRawData,[a,a.data,a.datapoints]);for(i=0;i<se.length;++i){if(a=se[i],f=a.data,g=a.datapoints.format,!g){if(g=[],g.push({x:!0,number:!0,required:!0}),g.push({y:!0,number:!0,required:!0}),a.bars.show||a.lines.show&&a.lines.fill){var y=!!(a.bars.show&&a.bars.zero||a.lines.show&&a.lines.zero);g.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:y}),a.bars.horizontal&&(delete g[g.length-1].y,g[g.length-1].x=!0)}a.datapoints.format=g}if(null==a.datapoints.pointsize){a.datapoints.pointsize=g.length,h=a.datapoints.pointsize,l=a.datapoints.points;var w=a.lines.show&&a.lines.steps;for(a.xaxis.used=a.yaxis.used=!0,s=n=0;s<f.length;++s,n+=h){u=f[s];var _=null==u;if(!_)for(o=0;h>o;++o)d=u[o],c=g[o],c&&(c.number&&null!=d&&(d=+d,isNaN(d)?d=null:d==1/0?d=b:d==-(1/0)&&(d=-b)),null==d&&(c.required&&(_=!0),null!=c.defaultValue&&(d=c.defaultValue))),l[n+o]=d;if(_)for(o=0;h>o;++o)d=l[n+o],null!=d&&(c=g[o],c.autoscale&&(c.x&&t(a.xaxis,d,d),c.y&&t(a.yaxis,d,d))),l[n+o]=null;else if(w&&n>0&&null!=l[n-h]&&l[n-h]!=l[n]&&l[n-h+1]!=l[n+1]){for(o=0;h>o;++o)l[n+h+o]=l[n+o];l[n+1]=l[n-h+1],n+=h}}}}for(i=0;i<se.length;++i)a=se[i],r(ge.processDatapoints,[a,a.datapoints]);for(i=0;i<se.length;++i){a=se[i],l=a.datapoints.points,h=a.datapoints.pointsize,g=a.datapoints.format;var C=m,S=m,x=v,k=v;for(s=0;s<l.length;s+=h)if(null!=l[s])for(o=0;h>o;++o)d=l[s+o],c=g[o],c&&c.autoscale!==!1&&d!=b&&d!=-b&&(c.x&&(C>d&&(C=d),d>x&&(x=d)),c.y&&(S>d&&(S=d),d>k&&(k=d)));if(a.bars.show){var T;switch(a.bars.align){case"left":T=0;break;case"right":T=-a.bars.barWidth;break;case"center":T=-a.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+a.bars.align)}a.bars.horizontal?(S+=T,k+=T+a.bars.barWidth):(C+=T,x+=T+a.bars.barWidth)}t(a.xaxis,C,x),t(a.yaxis,S,k)}e.each(p(),function(e,t){t.datamin==m&&(t.datamin=null),t.datamax==v&&(t.datamax=null)})}function y(){i.css("padding",0).children(":not(.flot-base,.flot-overlay)").remove(),"static"==i.css("position")&&i.css("position","relative"),oe=new t("flot-base",i),ae=new t("flot-overlay",i),le=oe.context,he=ae.context,re=e(ae.element).unbind();var s=i.data("plot");s&&(s.shutdown(),ae.clear()),i.data("plot",me)}function w(){ne.grid.hoverable&&(re.mousemove(W),re.bind("mouseleave",q)),ne.grid.clickable&&re.click(G),r(ge.bindEvents,[re])}function _(){be&&clearTimeout(be),re.unbind("mousemove",W),re.unbind("mouseleave",q),re.unbind("click",G),r(ge.shutdown,[re])}function C(e){function t(e){return e}var i,s,n=e.options.transform||t,o=e.options.inverseTransform;"x"==e.direction?(i=e.scale=pe/Math.abs(n(e.max)-n(e.min)),s=Math.min(n(e.max),n(e.min))):(i=e.scale=fe/Math.abs(n(e.max)-n(e.min)),i=-i,s=Math.max(n(e.max),n(e.min))),n==t?e.p2c=function(e){return(e-s)*i}:e.p2c=function(e){return(n(e)-s)*i},o?e.c2p=function(e){return o(s+e/i)}:e.c2p=function(e){return s+e/i}}function S(e){var t=e.options,i=e.ticks||[],s=t.labelWidth||0,n=t.labelHeight||0,o=s||"x"==e.direction?Math.floor(oe.width/(i.length||1)):null;legacyStyles=e.direction+"Axis "+e.direction+e.n+"Axis",layer="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+legacyStyles,font=t.font||"flot-tick-label tickLabel";for(var a=0;a<i.length;++a){var r=i[a];if(r.label){var l=oe.getTextInfo(layer,r.label,font,null,o);s=Math.max(s,l.width),n=Math.max(n,l.height)}}e.labelWidth=t.labelWidth||s,e.labelHeight=t.labelHeight||n}function x(t){var i,s=t.labelWidth,n=t.labelHeight,o=t.options.position,a=t.options.tickLength,r=ne.grid.axisMargin,l=ne.grid.labelMargin,h="x"==t.direction?de:ce,d=e.grep(h,function(e){return e&&e.options.position==o&&e.reserveSpace});if(e.inArray(t,d)==d.length-1&&(r=0),null==a){var c=e.grep(h,function(e){return e&&e.reserveSpace});i=0==e.inArray(t,c),a=i?"full":5}isNaN(+a)||(l+=+a),"x"==t.direction?(n+=l,"bottom"==o?(ue.bottom+=n+r,t.box={top:oe.height-ue.bottom,height:n}):(t.box={top:ue.top+r,height:n},ue.top+=n+r)):(s+=l,"left"==o?(t.box={left:ue.left+r,width:s},ue.left+=s+r):(ue.right+=s+r,t.box={left:oe.width-ue.right,width:s})),t.position=o,t.tickLength=a,t.box.padding=l,t.innermost=i}function k(e){"x"==e.direction?(e.box.left=ue.left-e.labelWidth/2,e.box.width=oe.width-ue.left-ue.right+e.labelWidth):(e.box.top=ue.top-e.labelHeight/2,e.box.height=oe.height-ue.bottom-ue.top+e.labelHeight)}function T(){var t,i=ne.grid.minBorderMargin,s={x:0,y:0};if(null==i)for(i=0,t=0;t<se.length;++t)i=Math.max(i,2*(se[t].points.radius+se[t].points.lineWidth/2));s.x=s.y=Math.ceil(i),e.each(p(),function(e,t){var i=t.direction;t.reserveSpace&&(s[i]=Math.ceil(Math.max(s[i],("x"==i?t.labelWidth:t.labelHeight)/2)))}),ue.left=Math.max(s.x,ue.left),ue.right=Math.max(s.x,ue.right),ue.top=Math.max(s.y,ue.top),ue.bottom=Math.max(s.y,ue.bottom)}function $(){var t,i=p(),s=ne.grid.show;for(var n in ue){var o=ne.grid.margin||0;ue[n]="number"==typeof o?o:o[n]||0}r(ge.processOffset,[ue]);for(var n in ue)"object"==typeof ne.grid.borderWidth?ue[n]+=s?ne.grid.borderWidth[n]:0:ue[n]+=s?ne.grid.borderWidth:0;if(e.each(i,function(e,t){t.show=t.options.show,null==t.show&&(t.show=t.used),t.reserveSpace=t.show||t.options.reserveSpace,A(t)}),s){var a=e.grep(i,function(e){return e.reserveSpace});for(e.each(a,function(e,t){P(t),D(t),I(t,t.ticks),S(t)}),t=a.length-1;t>=0;--t)x(a[t]);T(),e.each(a,function(e,t){k(t)})}pe=oe.width-ue.left-ue.right,fe=oe.height-ue.bottom-ue.top,e.each(i,function(e,t){C(t)}),s&&F(),V()}function A(e){var t=e.options,i=+(null!=t.min?t.min:e.datamin),s=+(null!=t.max?t.max:e.datamax),n=s-i;if(0==n){var o=0==s?1:.01;null==t.min&&(i-=o),(null==t.max||null!=t.min)&&(s+=o)}else{var a=t.autoscaleMargin;null!=a&&(null==t.min&&(i-=n*a,0>i&&null!=e.datamin&&e.datamin>=0&&(i=0)),null==t.max&&(s+=n*a,s>0&&null!=e.datamax&&e.datamax<=0&&(s=0)))}e.min=i,e.max=s}function P(t){var i,n=t.options;i="number"==typeof n.ticks&&n.ticks>0?n.ticks:.3*Math.sqrt("x"==t.direction?oe.width:oe.height);var o=(t.max-t.min)/i,a=-Math.floor(Math.log(o)/Math.LN10),r=n.tickDecimals;null!=r&&a>r&&(a=r);var l,h=Math.pow(10,-a),d=o/h;if(1.5>d?l=1:3>d?(l=2,d>2.25&&(null==r||r>=a+1)&&(l=2.5,++a)):l=7.5>d?5:10,l*=h,null!=n.minTickSize&&l<n.minTickSize&&(l=n.minTickSize),t.delta=o,t.tickDecimals=Math.max(0,null!=r?r:a),t.tickSize=n.tickSize||l,"time"==n.mode&&!t.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(t.tickGenerator||(t.tickGenerator=function(e){var t,i=[],n=s(e.min,e.tickSize),o=0,a=Number.NaN;do t=a,a=n+o*e.tickSize,i.push(a),++o;while(a<e.max&&a!=t);return i},t.tickFormatter=function(e,t){var i=t.tickDecimals?Math.pow(10,t.tickDecimals):1,s=""+Math.round(e*i)/i;if(null!=t.tickDecimals){var n=s.indexOf("."),o=-1==n?0:s.length-n-1;if(o<t.tickDecimals)return(o?s:s+".")+(""+i).substr(1,t.tickDecimals-o)}return s}),e.isFunction(n.tickFormatter)&&(t.tickFormatter=function(e,t){return""+n.tickFormatter(e,t)}),null!=n.alignTicksWithAxis){var c=("x"==t.direction?de:ce)[n.alignTicksWithAxis-1];if(c&&c.used&&c!=t){var u=t.tickGenerator(t);if(u.length>0&&(null==n.min&&(t.min=Math.min(t.min,u[0])),null==n.max&&u.length>1&&(t.max=Math.max(t.max,u[u.length-1]))),t.tickGenerator=function(e){var t,i,s=[];for(i=0;i<c.ticks.length;++i)t=(c.ticks[i].v-c.min)/(c.max-c.min),t=e.min+t*(e.max-e.min),s.push(t);return s},!t.mode&&null==n.tickDecimals){var p=Math.max(0,-Math.floor(Math.log(t.delta)/Math.LN10)+1),f=t.tickGenerator(t);f.length>1&&/\..*0$/.test((f[1]-f[0]).toFixed(p))||(t.tickDecimals=p)}}}}function D(t){var i=t.options.ticks,s=[];null==i||"number"==typeof i&&i>0?s=t.tickGenerator(t):i&&(s=e.isFunction(i)?i(t):i);var n,o;for(t.ticks=[],n=0;n<s.length;++n){var a=null,r=s[n];"object"==typeof r?(o=+r[0],r.length>1&&(a=r[1])):o=+r,null==a&&(a=t.tickFormatter(o,t)),isNaN(o)||t.ticks.push({v:o,label:a})}}function I(e,t){e.options.autoscaleMargin&&t.length>0&&(null==e.options.min&&(e.min=Math.min(e.min,t[0].v)),null==e.options.max&&t.length>1&&(e.max=Math.max(e.max,t[t.length-1].v)))}function M(){oe.clear(),r(ge.drawBackground,[le]);var e=ne.grid;e.show&&e.backgroundColor&&L(),e.show&&!e.aboveData&&N();for(var t=0;t<se.length;++t)r(ge.drawSeries,[le,se[t]]),O(se[t]);r(ge.draw,[le]),e.show&&e.aboveData&&N(),oe.render(),X()}function E(e,t){for(var i,s,n,o,a=p(),r=0;r<a.length;++r)if(i=a[r],i.direction==t&&(o=t+i.n+"axis",e[o]||1!=i.n||(o=t+"axis"),e[o])){s=e[o].from,n=e[o].to;break}if(e[o]||(i="x"==t?de[0]:ce[0],s=e[t+"1"],n=e[t+"2"]),null!=s&&null!=n&&s>n){var l=s;s=n,n=l}return{from:s,to:n,axis:i}}function L(){le.save(),le.translate(ue.left,ue.top),le.fillStyle=ie(ne.grid.backgroundColor,fe,0,"rgba(255, 255, 255, 0)"),le.fillRect(0,0,pe,fe),le.restore()}function N(){var t,i,s,n;le.save(),le.translate(ue.left,ue.top);var o=ne.grid.markings;if(o)for(e.isFunction(o)&&(i=me.getAxes(),i.xmin=i.xaxis.min,i.xmax=i.xaxis.max,i.ymin=i.yaxis.min,i.ymax=i.yaxis.max,o=o(i)),t=0;t<o.length;++t){var a=o[t],r=E(a,"x"),l=E(a,"y");null==r.from&&(r.from=r.axis.min),null==r.to&&(r.to=r.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),r.to<r.axis.min||r.from>r.axis.max||l.to<l.axis.min||l.from>l.axis.max||(r.from=Math.max(r.from,r.axis.min),r.to=Math.min(r.to,r.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max),(r.from!=r.to||l.from!=l.to)&&(r.from=r.axis.p2c(r.from),r.to=r.axis.p2c(r.to),l.from=l.axis.p2c(l.from),l.to=l.axis.p2c(l.to),r.from==r.to||l.from==l.to?(le.beginPath(),le.strokeStyle=a.color||ne.grid.markingsColor,le.lineWidth=a.lineWidth||ne.grid.markingsLineWidth,le.moveTo(r.from,l.from),le.lineTo(r.to,l.to),le.stroke()):(le.fillStyle=a.color||ne.grid.markingsColor,le.fillRect(r.from,l.to,r.to-r.from,l.from-l.to))))}i=p(),s=ne.grid.borderWidth;for(var h=0;h<i.length;++h){var d,c,u,f,g=i[h],m=g.box,v=g.tickLength;if(g.show&&0!=g.ticks.length){for(le.lineWidth=1,"x"==g.direction?(d=0,c="full"==v?"top"==g.position?0:fe:m.top-ue.top+("top"==g.position?m.height:0)):(c=0,d="full"==v?"left"==g.position?0:pe:m.left-ue.left+("left"==g.position?m.width:0)),g.innermost||(le.strokeStyle=g.options.color,le.beginPath(),u=f=0,"x"==g.direction?u=pe+1:f=fe+1,1==le.lineWidth&&("x"==g.direction?c=Math.floor(c)+.5:d=Math.floor(d)+.5),le.moveTo(d,c),le.lineTo(d+u,c+f),le.stroke()),le.strokeStyle=g.options.tickColor,le.beginPath(),t=0;t<g.ticks.length;++t){var b=g.ticks[t].v;u=f=0,isNaN(b)||b<g.min||b>g.max||"full"==v&&("object"==typeof s&&s[g.position]>0||s>0)&&(b==g.min||b==g.max)||("x"==g.direction?(d=g.p2c(b),f="full"==v?-fe:v,"top"==g.position&&(f=-f)):(c=g.p2c(b),u="full"==v?-pe:v,"left"==g.position&&(u=-u)),1==le.lineWidth&&("x"==g.direction?d=Math.floor(d)+.5:c=Math.floor(c)+.5),le.moveTo(d,c),le.lineTo(d+u,c+f))}le.stroke()}}s&&(n=ne.grid.borderColor,"object"==typeof s||"object"==typeof n?("object"!=typeof s&&(s={top:s,right:s,bottom:s,left:s}),"object"!=typeof n&&(n={top:n,right:n,bottom:n,left:n}),s.top>0&&(le.strokeStyle=n.top,le.lineWidth=s.top,le.beginPath(),le.moveTo(0-s.left,0-s.top/2),le.lineTo(pe,0-s.top/2),le.stroke()),s.right>0&&(le.strokeStyle=n.right,le.lineWidth=s.right,le.beginPath(),le.moveTo(pe+s.right/2,0-s.top),le.lineTo(pe+s.right/2,fe),le.stroke()),s.bottom>0&&(le.strokeStyle=n.bottom,le.lineWidth=s.bottom,le.beginPath(),le.moveTo(pe+s.right,fe+s.bottom/2),le.lineTo(0,fe+s.bottom/2),le.stroke()),s.left>0&&(le.strokeStyle=n.left,le.lineWidth=s.left,le.beginPath(),le.moveTo(0-s.left/2,fe+s.bottom),le.lineTo(0-s.left/2,0),le.stroke())):(le.lineWidth=s,le.strokeStyle=ne.grid.borderColor,le.strokeRect(-s/2,-s/2,pe+s,fe+s))),le.restore()}function F(){e.each(p(),function(e,t){if(t.show&&0!=t.ticks.length){var i,s,n,o,a,r=t.box,l=t.direction+"Axis "+t.direction+t.n+"Axis",h="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+l,d=t.options.font||"flot-tick-label tickLabel";oe.removeText(h);for(var c=0;c<t.ticks.length;++c)i=t.ticks[c],!i.label||i.v<t.min||i.v>t.max||("x"==t.direction?(o="center",s=ue.left+t.p2c(i.v),"bottom"==t.position?n=r.top+r.padding:(n=r.top+r.height-r.padding,a="bottom")):(a="middle",n=ue.top+t.p2c(i.v),"left"==t.position?(s=r.left+r.width-r.padding,o="right"):s=r.left+r.padding),oe.addText(h,s,n,i.label,d,null,null,o,a))}})}function O(e){e.lines.show&&R(e),e.bars.show&&z(e),e.points.show&&B(e)}function R(e){function t(e,t,i,s,n){var o=e.points,a=e.pointsize,r=null,l=null;le.beginPath();for(var h=a;h<o.length;h+=a){var d=o[h-a],c=o[h-a+1],u=o[h],p=o[h+1];if(null!=d&&null!=u){if(p>=c&&c<n.min){if(p<n.min)continue;d=(n.min-c)/(p-c)*(u-d)+d,c=n.min}else if(c>=p&&p<n.min){if(c<n.min)continue;u=(n.min-c)/(p-c)*(u-d)+d,p=n.min}if(c>=p&&c>n.max){if(p>n.max)continue;d=(n.max-c)/(p-c)*(u-d)+d,c=n.max}else if(p>=c&&p>n.max){if(c>n.max)continue;u=(n.max-c)/(p-c)*(u-d)+d,p=n.max}if(u>=d&&d<s.min){if(u<s.min)continue;c=(s.min-d)/(u-d)*(p-c)+c,d=s.min}else if(d>=u&&u<s.min){if(d<s.min)continue;p=(s.min-d)/(u-d)*(p-c)+c,u=s.min}if(d>=u&&d>s.max){if(u>s.max)continue;c=(s.max-d)/(u-d)*(p-c)+c,d=s.max}else if(u>=d&&u>s.max){if(d>s.max)continue;p=(s.max-d)/(u-d)*(p-c)+c,u=s.max}(d!=r||c!=l)&&le.moveTo(s.p2c(d)+t,n.p2c(c)+i),r=u,l=p,le.lineTo(s.p2c(u)+t,n.p2c(p)+i)}}le.stroke()}function i(e,t,i){for(var s=e.points,n=e.pointsize,o=Math.min(Math.max(0,i.min),i.max),a=0,r=!1,l=1,h=0,d=0;;){if(n>0&&a>s.length+n)break;a+=n;var c=s[a-n],u=s[a-n+l],p=s[a],f=s[a+l];if(r){if(n>0&&null!=c&&null==p){d=a,n=-n,l=2;continue}if(0>n&&a==h+n){le.fill(),r=!1,n=-n,l=1,a=h=d+n;continue}}if(null!=c&&null!=p){if(p>=c&&c<t.min){if(p<t.min)continue;u=(t.min-c)/(p-c)*(f-u)+u,c=t.min}else if(c>=p&&p<t.min){if(c<t.min)continue;f=(t.min-c)/(p-c)*(f-u)+u,p=t.min}if(c>=p&&c>t.max){if(p>t.max)continue;u=(t.max-c)/(p-c)*(f-u)+u,c=t.max}else if(p>=c&&p>t.max){if(c>t.max)continue;f=(t.max-c)/(p-c)*(f-u)+u,p=t.max}if(r||(le.beginPath(),le.moveTo(t.p2c(c),i.p2c(o)),r=!0),u>=i.max&&f>=i.max)le.lineTo(t.p2c(c),i.p2c(i.max)),le.lineTo(t.p2c(p),i.p2c(i.max));else if(u<=i.min&&f<=i.min)le.lineTo(t.p2c(c),i.p2c(i.min)),le.lineTo(t.p2c(p),i.p2c(i.min));else{var g=c,m=p;f>=u&&u<i.min&&f>=i.min?(c=(i.min-u)/(f-u)*(p-c)+c,u=i.min):u>=f&&f<i.min&&u>=i.min&&(p=(i.min-u)/(f-u)*(p-c)+c,f=i.min),u>=f&&u>i.max&&f<=i.max?(c=(i.max-u)/(f-u)*(p-c)+c,u=i.max):f>=u&&f>i.max&&u<=i.max&&(p=(i.max-u)/(f-u)*(p-c)+c,f=i.max),c!=g&&le.lineTo(t.p2c(g),i.p2c(u)),le.lineTo(t.p2c(c),i.p2c(u)),le.lineTo(t.p2c(p),i.p2c(f)),p!=m&&(le.lineTo(t.p2c(p),i.p2c(f)),le.lineTo(t.p2c(m),i.p2c(f)))}}}}le.save(),le.translate(ue.left,ue.top),le.lineJoin="round";var s=e.lines.lineWidth,n=e.shadowSize;if(s>0&&n>0){le.lineWidth=n,le.strokeStyle="rgba(0,0,0,0.1)";var o=Math.PI/18;t(e.datapoints,Math.sin(o)*(s/2+n/2),Math.cos(o)*(s/2+n/2),e.xaxis,e.yaxis),le.lineWidth=n/2,t(e.datapoints,Math.sin(o)*(s/2+n/4),Math.cos(o)*(s/2+n/4),e.xaxis,e.yaxis)}le.lineWidth=s,le.strokeStyle=e.color;var a=H(e.lines,e.color,0,fe);a&&(le.fillStyle=a,i(e.datapoints,e.xaxis,e.yaxis)),s>0&&t(e.datapoints,0,0,e.xaxis,e.yaxis),le.restore()}function B(e){function t(e,t,i,s,n,o,a,r){for(var l=e.points,h=e.pointsize,d=0;d<l.length;d+=h){var c=l[d],u=l[d+1];null==c||c<o.min||c>o.max||u<a.min||u>a.max||(le.beginPath(),c=o.p2c(c),u=a.p2c(u)+s,"circle"==r?le.arc(c,u,t,0,n?Math.PI:2*Math.PI,!1):r(le,c,u,t,n),le.closePath(),i&&(le.fillStyle=i,le.fill()),le.stroke())}}le.save(),le.translate(ue.left,ue.top);var i=e.points.lineWidth,s=e.shadowSize,n=e.points.radius,o=e.points.symbol;if(0==i&&(i=1e-4),i>0&&s>0){var a=s/2;le.lineWidth=a,le.strokeStyle="rgba(0,0,0,0.1)",t(e.datapoints,n,null,a+a/2,!0,e.xaxis,e.yaxis,o),le.strokeStyle="rgba(0,0,0,0.2)",t(e.datapoints,n,null,a/2,!0,e.xaxis,e.yaxis,o)}le.lineWidth=i,le.strokeStyle=e.color,t(e.datapoints,n,H(e.points,e.color),0,!1,e.xaxis,e.yaxis,o),le.restore()}function j(e,t,i,s,n,o,a,r,l,h,d,c){var u,p,f,g,m,v,b,y,w;d?(y=v=b=!0,m=!1,u=i,p=e,g=t+s,f=t+n,u>p&&(w=p,p=u,u=w,m=!0,v=!1)):(m=v=b=!0,y=!1,u=e+s,p=e+n,f=i,g=t,f>g&&(w=g,g=f,f=w,y=!0,b=!1)),p<r.min||u>r.max||g<l.min||f>l.max||(u<r.min&&(u=r.min,m=!1),p>r.max&&(p=r.max,v=!1),f<l.min&&(f=l.min,y=!1),g>l.max&&(g=l.max,b=!1),u=r.p2c(u),f=l.p2c(f),p=r.p2c(p),g=l.p2c(g),a&&(h.beginPath(),h.moveTo(u,f),h.lineTo(u,g),h.lineTo(p,g),h.lineTo(p,f),h.fillStyle=a(f,g),h.fill()),c>0&&(m||v||b||y)&&(h.beginPath(),h.moveTo(u,f+o),m?h.lineTo(u,g+o):h.moveTo(u,g+o),b?h.lineTo(p,g+o):h.moveTo(p,g+o),v?h.lineTo(p,f+o):h.moveTo(p,f+o),y?h.lineTo(u,f+o):h.moveTo(u,f+o),h.stroke()))}function z(e){function t(t,i,s,n,o,a,r){for(var l=t.points,h=t.pointsize,d=0;d<l.length;d+=h)null!=l[d]&&j(l[d],l[d+1],l[d+2],i,s,n,o,a,r,le,e.bars.horizontal,e.bars.lineWidth)}le.save(),le.translate(ue.left,ue.top),le.lineWidth=e.bars.lineWidth,le.strokeStyle=e.color;var i;switch(e.bars.align){case"left":i=0;break;case"right":i=-e.bars.barWidth;break;case"center":i=-e.bars.barWidth/2;break;default:throw new Error("Invalid bar alignment: "+e.bars.align)}var s=e.bars.fill?function(t,i){return H(e.bars,e.color,t,i)}:null;t(e.datapoints,i,i+e.bars.barWidth,0,s,e.xaxis,e.yaxis),le.restore()}function H(t,i,s,n){var o=t.fill;if(!o)return null;if(t.fillColor)return ie(t.fillColor,s,n,i);var a=e.color.parse(i);return a.a="number"==typeof o?o:.4,a.normalize(),a.toString()}function V(){if(i.find(".legend").remove(),ne.legend.show){for(var t,s,n=[],o=[],a=!1,r=ne.legend.labelFormatter,l=0;l<se.length;++l)t=se[l],t.label&&(s=r?r(t.label,t):t.label,s&&o.push({label:s,color:t.color}));if(ne.legend.sorted)if(e.isFunction(ne.legend.sorted))o.sort(ne.legend.sorted);else if("reverse"==ne.legend.sorted)o.reverse();else{var h="descending"!=ne.legend.sorted;o.sort(function(e,t){return e.label==t.label?0:e.label<t.label!=h?1:-1})}for(var l=0;l<o.length;++l){var d=o[l];l%ne.legend.noColumns==0&&(a&&n.push("</tr>"),n.push("<tr>"),a=!0),n.push('<td class="legendColorBox"><div style="border:1px solid '+ne.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+d.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+d.label+"</td>")}if(a&&n.push("</tr>"),0!=n.length){var c='<table style="font-size:smaller;color:'+ne.grid.color+'">'+n.join("")+"</table>";if(null!=ne.legend.container)e(ne.legend.container).html(c);else{var u="",p=ne.legend.position,f=ne.legend.margin;
null==f[0]&&(f=[f,f]),"n"==p.charAt(0)?u+="top:"+(f[1]+ue.top)+"px;":"s"==p.charAt(0)&&(u+="bottom:"+(f[1]+ue.bottom)+"px;"),"e"==p.charAt(1)?u+="right:"+(f[0]+ue.right)+"px;":"w"==p.charAt(1)&&(u+="left:"+(f[0]+ue.left)+"px;");var g=e('<div class="legend">'+c.replace('style="','style="position:absolute;'+u+";")+"</div>").appendTo(i);if(0!=ne.legend.backgroundOpacity){var m=ne.legend.backgroundColor;null==m&&(m=ne.grid.backgroundColor,m=m&&"string"==typeof m?e.color.parse(m):e.color.extract(g,"background-color"),m.a=1,m=m.toString());var v=g.children();e('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+u+"background-color:"+m+';"> </div>').prependTo(g).css("opacity",ne.legend.backgroundOpacity)}}}}}function U(e,t,i){var s,n,o,a=ne.grid.mouseActiveRadius,r=a*a+1,l=null;for(s=se.length-1;s>=0;--s)if(i(se[s])){var h=se[s],d=h.xaxis,c=h.yaxis,u=h.datapoints.points,p=d.c2p(e),f=c.c2p(t),g=a/d.scale,m=a/c.scale;if(o=h.datapoints.pointsize,d.options.inverseTransform&&(g=Number.MAX_VALUE),c.options.inverseTransform&&(m=Number.MAX_VALUE),h.lines.show||h.points.show)for(n=0;n<u.length;n+=o){var v=u[n],b=u[n+1];if(null!=v&&!(v-p>g||-g>v-p||b-f>m||-m>b-f)){var y=Math.abs(d.p2c(v)-e),w=Math.abs(c.p2c(b)-t),_=y*y+w*w;r>_&&(r=_,l=[s,n/o])}}if(h.bars.show&&!l){var C="left"==h.bars.align?0:-h.bars.barWidth/2,S=C+h.bars.barWidth;for(n=0;n<u.length;n+=o){var v=u[n],b=u[n+1],x=u[n+2];null!=v&&(se[s].bars.horizontal?p<=Math.max(x,v)&&p>=Math.min(x,v)&&f>=b+C&&b+S>=f:p>=v+C&&v+S>=p&&f>=Math.min(x,b)&&f<=Math.max(x,b))&&(l=[s,n/o])}}}return l?(s=l[0],n=l[1],o=se[s].datapoints.pointsize,{datapoint:se[s].datapoints.points.slice(n*o,(n+1)*o),dataIndex:n,series:se[s],seriesIndex:s}):null}function W(e){ne.grid.hoverable&&Y("plothover",e,function(e){return 0!=e.hoverable})}function q(e){ne.grid.hoverable&&Y("plothover",e,function(e){return!1})}function G(e){Y("plotclick",e,function(e){return 0!=e.clickable})}function Y(e,t,s){var n=re.offset(),o=t.pageX-n.left-ue.left,a=t.pageY-n.top-ue.top,r=f({left:o,top:a});r.pageX=t.pageX,r.pageY=t.pageY;var l=U(o,a,s);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+n.left+ue.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+n.top+ue.top,10)),ne.grid.autoHighlight){for(var h=0;h<ve.length;++h){var d=ve[h];d.auto!=e||l&&d.series==l.series&&d.point[0]==l.datapoint[0]&&d.point[1]==l.datapoint[1]||K(d.series,d.point)}l&&J(l.series,l.datapoint,e)}i.trigger(e,[r,l])}function X(){var e=ne.interaction.redrawOverlayInterval;return-1==e?void Z():void(be||(be=setTimeout(Z,e)))}function Z(){be=null,he.save(),ae.clear(),he.translate(ue.left,ue.top);var e,t;for(e=0;e<ve.length;++e)t=ve[e],t.series.bars.show?te(t.series,t.point):ee(t.series,t.point);he.restore(),r(ge.drawOverlay,[he])}function J(e,t,i){if("number"==typeof e&&(e=se[e]),"number"==typeof t){var s=e.datapoints.pointsize;t=e.datapoints.points.slice(s*t,s*(t+1))}var n=Q(e,t);-1==n?(ve.push({series:e,point:t,auto:i}),X()):i||(ve[n].auto=!1)}function K(e,t){if(null==e&&null==t)return ve=[],void X();if("number"==typeof e&&(e=se[e]),"number"==typeof t){var i=e.datapoints.pointsize;t=e.datapoints.points.slice(i*t,i*(t+1))}var s=Q(e,t);-1!=s&&(ve.splice(s,1),X())}function Q(e,t){for(var i=0;i<ve.length;++i){var s=ve[i];if(s.series==e&&s.point[0]==t[0]&&s.point[1]==t[1])return i}return-1}function ee(t,i){var s=i[0],n=i[1],o=t.xaxis,a=t.yaxis,r="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString();if(!(s<o.min||s>o.max||n<a.min||n>a.max)){var l=t.points.radius+t.points.lineWidth/2;he.lineWidth=l,he.strokeStyle=r;var h=1.5*l;s=o.p2c(s),n=a.p2c(n),he.beginPath(),"circle"==t.points.symbol?he.arc(s,n,h,0,2*Math.PI,!1):t.points.symbol(he,s,n,h,!1),he.closePath(),he.stroke()}}function te(t,i){var s="string"==typeof t.highlightColor?t.highlightColor:e.color.parse(t.color).scale("a",.5).toString(),n=s,o="left"==t.bars.align?0:-t.bars.barWidth/2;he.lineWidth=t.bars.lineWidth,he.strokeStyle=s,j(i[0],i[1],i[2]||0,o,o+t.bars.barWidth,0,function(){return n},t.xaxis,t.yaxis,he,t.bars.horizontal,t.bars.lineWidth)}function ie(t,i,s,n){if("string"==typeof t)return t;for(var o=le.createLinearGradient(0,s,0,i),a=0,r=t.colors.length;r>a;++a){var l=t.colors[a];if("string"!=typeof l){var h=e.color.parse(n);null!=l.brightness&&(h=h.scale("rgb",l.brightness)),null!=l.opacity&&(h.a*=l.opacity),l=h.toString()}o.addColorStop(a/(r-1),l)}return o}var se=[],ne={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},oe=null,ae=null,re=null,le=null,he=null,de=[],ce=[],ue={left:0,right:0,top:0,bottom:0},pe=0,fe=0,ge={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},me=this;me.setData=d,me.setupGrid=$,me.draw=M,me.getPlaceholder=function(){return i},me.getCanvas=function(){return oe.element},me.getPlotOffset=function(){return ue},me.width=function(){return pe},me.height=function(){return fe},me.offset=function(){var e=re.offset();return e.left+=ue.left,e.top+=ue.top,e},me.getData=function(){return se},me.getAxes=function(){var t={};return e.each(de.concat(ce),function(e,i){i&&(t[i.direction+(1!=i.n?i.n:"")+"axis"]=i)}),t},me.getXAxes=function(){return de},me.getYAxes=function(){return ce},me.c2p=f,me.p2c=g,me.getOptions=function(){return ne},me.highlight=J,me.unhighlight=K,me.triggerRedrawOverlay=X,me.pointOffset=function(e){return{left:parseInt(de[u(e,"x")-1].p2c(+e.x)+ue.left,10),top:parseInt(ce[u(e,"y")-1].p2c(+e.y)+ue.top,10)}},me.shutdown=_,me.resize=function(){var e=i.width(),t=i.height();oe.resize(e,t),ae.resize(e,t)},me.hooks=ge,l(me),h(o),y(),d(n),$(),M(),w();var ve=[],be=null}function s(e,t){return t*Math.floor(e/t)}var n=Object.prototype.hasOwnProperty;t.prototype.resize=function(e,t){if(0>=e||0>=t)throw new Error("Invalid dimensions for plot, width = "+e+", height = "+t);var i=this.element,s=this.context,n=this.pixelRatio;this.width!=e&&(i.width=e*n,i.style.width=e+"px",this.width=e),this.height!=t&&(i.height=t*n,i.style.height=t+"px",this.height=t),s.restore(),s.save(),s.scale(n,n)},t.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},t.prototype.render=function(){var e=this._textCache;for(var t in e)if(n.call(e,t)){var i=this.getTextLayer(t),s=e[t];i.hide();for(var o in s)if(n.call(s,o)){var a=s[o];for(var r in a)if(n.call(a,r)){for(var l,h=a[r].positions,d=0;l=h[d];d++)l.active?l.rendered||(i.append(l.element),l.rendered=!0):(h.splice(d--,1),l.rendered&&l.element.detach());0==h.length&&delete a[r]}}i.show()}},t.prototype.getTextLayer=function(t){var i=this.text[t];return null==i&&(null==this.textContainer&&(this.textContainer=e("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),i=this.text[t]=e("<div></div>").addClass(t).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),i},t.prototype.getTextInfo=function(t,i,s,n,o){var a,r,l,h;if(i=""+i,a="object"==typeof s?s.style+" "+s.variant+" "+s.weight+" "+s.size+"px/"+s.lineHeight+"px "+s.family:s,r=this._textCache[t],null==r&&(r=this._textCache[t]={}),l=r[a],null==l&&(l=r[a]={}),h=l[i],null==h){var d=e("<div></div>").html(i).css({position:"absolute","max-width":o,top:-9999}).appendTo(this.getTextLayer(t));"object"==typeof s?d.css({font:a,color:s.color}):"string"==typeof s&&d.addClass(s),h=l[i]={width:d.outerWidth(!0),height:d.outerHeight(!0),element:d,positions:[]},d.detach()}return h},t.prototype.addText=function(e,t,i,s,n,o,a,r,l){var h=this.getTextInfo(e,s,n,o,a),d=h.positions;"center"==r?t-=h.width/2:"right"==r&&(t-=h.width),"middle"==l?i-=h.height/2:"bottom"==l&&(i-=h.height);for(var c,u=0;c=d[u];u++)if(c.x==t&&c.y==i)return void(c.active=!0);c={active:!0,rendered:!1,element:d.length?h.element.clone():h.element,x:t,y:i},d.push(c),c.element.css({top:Math.round(i),left:Math.round(t),"text-align":r})},t.prototype.removeText=function(e,t,i,s,o,a){if(null==s){var r=this._textCache[e];if(null!=r)for(var l in r)if(n.call(r,l)){var h=r[l];for(var d in h)if(n.call(h,d))for(var c,u=h[d].positions,p=0;c=u[p];p++)c.active=!1}}else for(var c,u=this.getTextInfo(e,s,o,a).positions,p=0;c=u[p];p++)c.x==t&&c.y==i&&(c.active=!1)},e.plot=function(t,s,n){var o=new i(e(t),s,n,e.plot.plugins);return o},e.plot.version="0.8.1",e.plot.plugins=[],e.fn.plot=function(t,i){return this.each(function(){e.plot(this,t,i)})}}(jQuery),define("libs/flot/jquery.flot",function(){}),define("modules/sports/line-chart",["jquery","underscore","baseview","pubsub","utils","libs/flot/jquery.flot"],function(e,t,i,s,n,o){var a=i.extend({events:{"plothover .chart-area":"lazyLineHover"},initialize:function(e){this.createLine(".graph")},createLine:function(){var t=this,i=t.$el,s=[],n=i.data("section"),a=i.data("colors")||"",r=a.split("|"),l=i.data("xaxis")||"",h=a?r:o.color[n];t.tickLabels=t.createTicks(l),i.find(".chart-area-legend ul li").each(function(t){e(this).css("background-color",h[t])}),i.find(".data tr").each(function(t){var n=i.find("tr:eq("+t+")"),o=n.find("td:eq(0)").text(),a=[];n.find("td.coord").each(function(){var t=e(this).text().split(",");a.push([t[0],t[1]])});h[t];s.push({label:o,data:a,color:h[t],points:{fillColor:h[t]}})});var d=i.find(".graph");if(d.length){e.plot(d,s,{legend:{show:!1,noColumns:1},xaxis:{ticks:t.tickLabels,autoscaleMargin:.03,position:"bottom",borderColor:"rgb(237,236,236)"},yaxis:{position:"left",labelHeight:25,borderColor:"rgb(237,236,236)"},lines:{show:!0},points:{show:!0,radius:2,fill:!0},grid:{borderWidth:1,borderColor:"rgb(237,236,236)",labelMargin:5,axisMargin:0,clickable:!0,hoverable:!0,autoHighlight:!0}})}},lazyLineHover:function(){this.lazyLineDebounce||(this.lazyLineDebounce=t.debounce(this.lineHover,10)),this.lazyLineDebounce.apply(this,arguments)},createTicks:function(t){var i=t.split("|"),s=[];return e.each(i,function(e,t){s.push([e,t])}),s},lineHover:function(e,t,i){var s=this.$(".chart-area");if(!i)return void s.find(".chart-hover").hide();s.find(".chart-hover").show();var o=" <div class='{{pointerClass}}'></div>{{label}}<h4 class='weather'>{{body}}</h4>",a=s.find(".chart-hover"),r=s.data("prefix"),l=s.data("suffix"),h=s.offset().top,d=s.offset().left,c="",u="",p=h+s.height()/2,f=d+s.width()/3,g=d+s.width()/3*2,m=(h+s.height()/3*2,""),v=a.height(),b=a.width();t.pageX<f?(m="middleleft-hover",c="pointer-left",u={top:t.pageY-v/2-h,left:t.pageX-d}):t.pageX>g?(m="middleright-hover",c="pointer-right",u={top:t.pageY-v/2-h,left:t.pageX-b-d}):t.pageY<p?(m="top-hover",c="pointer-top",u={top:t.pageY-h,left:t.pageX-b/2-d}):t.pageY>p?(m="bottom-hover",c="pointer-bottom",u={top:t.pageY-v-h,left:t.pageX-b/2-d}):a.hide();var y=r+""+n.addCommas(i.datapoint[1])+" "+l,w=""!==i.series.label?"<h3>"+i.series.label+"</h3>":'<h3 class="empty"></h3>',_=o.replace("{{pointerClass}}","").replace("{{label}}",w).replace("{{body}}",y);a.css(u).html(_).attr("class",m+" chart-hover")}});return a}),define("modules/sports/popup-details",["jquery","underscore","backbone","pubsub","state","utils","baseview","modules/scroller/sidebar-scroll","modules/sports/line-chart"],function(e,t,i,s,n,o,a,r,l){var h=a.extend({el:".interactive.sp-line-graph",events:{"click .sp-details-open":"onDetailsOpen","click .sp-details-close":"onDetailsClose","click .sp-filter-link.sp-popup-filter":"onPopupFilter","click .sp-graph-btn, .sp-table-btn":"showGraph","click .sp-conf-item":"onConfSelect","mouseenter .sp-head-item.teams-hover, .sp-hover-team-front-picker":"onTeamsEnter","mouseleave .sp-head-item.teams-hover, .sp-hover-team-front-picker":"onTeamsLeave"},initialize:function(){a.prototype.initialize.apply(this,arguments),t.bindAll(this,"loadDetails","onDetailsClose"),this.$popupBox=this.$(".sp-details-box"),this.$popupFilm=this.$(".sp-details-film"),this.$popupTop=parseInt(this.$popupBox.css("top"),10)},onDetailsOpen:function(t){t.preventDefault(),this.openedOnce=!0,this.$popupLink=e(t.currentTarget);var i=(this.$popupLink.data("ht"),this.$popupLink.data("class")),s=o.getScrollPosition();this.$popupBox.css("top",s+"px"),this.$popupBox.data("url")!=this.$popupLink.data("url")&&this.loadDetails(),this.$popupBox.addClass(i),this.$popupFilm.show(),this.$popupBox.show(),e(".site-footer").css({visibility:"hidden"})},onDetailsClose:function(t){if(this.openedOnce){t&&t.preventDefault();var i=this.$popupLink.data("class");this.$popupBox.removeClass(i),this.$popupBox.hide(),this.$popupFilm.hide(),this.$(".sp-details-data").addClass("sp-loading-details"),this.$revenuesSportsCharts=null,this.$expensesSportsCharts=null,e(".site-footer").css({visibility:"visible"})}},loadDetails:function(){this.$(".sp-details-loaded").remove();var e=this.$popupLink.data("url");this.$popupBox.data("url",e),n.fetchHtml(e).done(t.bind(function(t){this.subviews.vscroll&&this.subviews.vscroll.destroy(),t.find(".sp-details-loaded").length?(this.$(".sp-details-data").removeClass("sp-loading-details"),this.$(".sp-details-data").html(t),this.subviews.vscroll&&this.subviews.vscroll.destroy(),this.subviews.vscroll=new r({el:this.$(".sp-scrollable-details")})):console.log("Unable to load details for: "+e)},this)),this.$popupLink.data("class").indexOf("hover")>=0?this.$popupBox.find(".sp-details-close").hide():this.$popupBox.find(".sp-details-close").show()},onPopupFilter:function(i){var n,o,a=e(i.currentTarget),r=a.closest(".sp-filter-dropdown"),h=r.find(".sp-filter-scroll-wrap"),d=a.data("ht"),c=a.data("value"),u=a.data("filter"),p=this.$(".sp-finances-icon");this.$popupDiv=this.$(".sp-salaries-profile-popup"),this.$popupDiv.removeClass("active").addClass("inactive"),p.hasClass("table-on")?(n=c+"table-on",o=this.$('div[data-profile="'+n+'"]'),o.removeClass("inactive").addClass("active"),d+="table"):p.hasClass("graph-on")&&(n=c+"graph-on",d+="graph","Revenues"==u?(this.$revenuesSportsCharts||(this.$revenuesSportsCharts=this.$(".interactive.revenues-line-graph"),this.subviews.lgraph=new l({el:this.$revenuesSportsCharts})),this.$collegeRevenueGraph.removeClass("inactive").addClass("active"),this.$collegeExpensesGraph.removeClass("active").addClass("inactive")):"Expenses"==u&&(this.$expensesSportsCharts||(this.$expensesSportsCharts=this.$(".interactive.expenses-line-graph"),this.subviews.lgraph=new l({el:this.$expensesSportsCharts})),this.$collegeRevenueGraph.removeClass("active").addClass("inactive"),this.$collegeExpensesGraph.removeClass("inactive").addClass("active"))),this.$(".sp-filter-btn").text(u),h.hide(),t.delay(function(){h.removeAttr("style")},50),a.parent().addClass("selected").siblings().removeClass("selected"),d&&s.trigger("uotrack",d)},showGraph:function(t){var i=e(t.currentTarget).data("ht"),n=e(t.currentTarget).data("icon-value"),o=n+"-"+this.$(".sp-filter-btn").text().toLowerCase(),a=this.$(".sp-filter-btn").text();this.$revenuesTableOn=this.$(".revenuestable-on"),this.$expensesTableOn=this.$(".expensestable-on"),this.$collegeRevenueGraph=this.$(".collegeRevenueGraph"),this.$collegeExpensesGraph=this.$(".collegeExpensesGraph"),this.$salariesProfilePopupDiv=this.$(".sp-salaries-profile-popup"),this.$salariesProfilePopupDiv.removeClass("active").addClass("inactive");var r=this.$('div[data-icon="'+o+'"]');r.removeClass("inactive").addClass("active"),"sp-profile-table"==n?("Revenues"==a?(this.$revenuesTableOn.removeClass("inactive").addClass("active"),this.$expensesTableOn.removeClass("active").addClass("inactive")):"Expenses"==a&&(this.$expensesTableOn.removeClass("inactive").addClass("active"),this.$revenuesTableOn.removeClass("active").addClass("inactive")),this.$(".sp-table-btn.sp-finances-icon").removeClass("table-off").addClass("table-on"),this.$(".sp-graph-btn.sp-finances-icon").removeClass("graph-on").addClass("graph-off")):"sp-profile-graph"==n&&(this.$(".sp-graph-btn").removeClass("graph-off").addClass("graph-on"),this.$(".sp-table-btn").removeClass("table-on").addClass("table-off"),"Revenues"==a?(this.$revenuesSportsCharts||(this.$revenuesSportsCharts=this.$(".interactive.revenues-line-graph"),this.subviews.lgraph=new l({el:this.$revenuesSportsCharts})),this.$collegeRevenueGraph.removeClass("inactive").addClass("active"),this.$collegeExpensesGraph.removeClass("active").addClass("inactive")):"Expenses"==a&&(this.$expensesSportsCharts||(this.$expensesSportsCharts=this.$(".interactive.expenses-line-graph"),this.subviews.lgraph=new l({el:this.$expensesSportsCharts})),this.$(".coordExpenses").removeClass("coordExpenses").addClass("coord"),this.$collegeRevenueGraph.removeClass("active").addClass("inactive"),this.$collegeExpensesGraph.removeClass("inactive").addClass("active"))),i+=a,i&&s.trigger("uotrack",i)},onConfSelect:function(t){var i=e(t.currentTarget),n=i.data("ht"),o=i.data("value");i.data("div");this.$popupBox.find(".conf_team_box").removeClass("active"),this.$popupBox.find(".sp-conf-item").removeClass("active"),this.$("."+o).addClass("active"),i.addClass("active"),n&&s.trigger("uotrack",n)},onTeamsEnter:function(t){if(this.$teamLink=e(t.currentTarget),this.$teamLink.hasClass("teams-hover")){this.$teamTab=this.$teamLink.find(".sp-head-link"),this.$teamTab.addClass("active-box"),this.openedOnce=!0,this.$popupLink=this.$teamLink.find(".sp-details-open");var i=this.$popupLink.data("class");this.$popupBox.data("url")!=this.$popupLink.data("url")&&this.loadDetails(),this.$popupBox.addClass(i),this.$popupBox.show(),e.datepicker.dpDiv.css({display:"none"})}e(".card-container.card-container-primary-suspender-sidebar-page").css({"z-index":"1"})},onTeamsLeave:function(t){var i=this.$popupBox.offset().top,s=this.$popupBox.offset().left,n=this.$popupBox.outerWidth(),o=this.$popupBox.outerHeight();(t.pageX<s||t.pageX>s+n||t.pageY<i||t.pageY>i+o)&&(this.onDetailsClose(),this.$teamTab.removeClass("active-box"),e(".card-container.card-container-primary-suspender-sidebar-page").css({"z-index":"0"}))},destroy:function(){this.onDetailsClose(),a.prototype.destroy.apply(this,arguments)}});return h}),define("modules/travel/shermans",["jquery","underscore","backbone","state","baseview"],function(e,t,i,s,n){"use strict";var o=n.extend({initialize:function(e){this.$dealsList=this.$(".shermans-deal-list"),this.$placeholder=this.$(".shermans-placeholder"),n.prototype.initialize.call(this,e),s.fetchData("http://api.deals.shermanstravel.com/v1/deals?consumer_key=8a3c1b45da1e6e8e919bd0d42d7a130e9bbaea645886122733bd7f23802f0b0c",{dataType:"jsonp"}).done(t.bind(function(e){this.displayDeals(e.deals)},this)).fail(t.bind(function(e){this.$placeholder.html("No deals..")},this))},displayDeals:function(e){t.each(e,t.bind(function(e){e.title.length>45&&(e.title=e.title.slice(0,44)+"...");var t='<li><a href="'+e.url+'" target="_blank">'+e.title+"</a></li>";this.$dealsList.append(t)},this)),this.$placeholder.hide()}});return o}),define("ui/tooltip",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({initialize:function(s){s=e.extend({text:this.$el.data("tooltip-text"),customContainerClass:"ui-tooltip",customPanelClass:"",showEvent:"mouseenter",hideEvent:"mouseleave",onShow:null,onHide:null,position:"right"},s),i.prototype.initialize.call(this,s),this._tooltipText=this.options.text,this.$tooltipPanel=this._buildHtml(this.$el),this.$tooltipPanel.addClass("ui-tooltip-panel-"+this.options.position),t.bindAll(this,"show","hide"),this._addTriggerEvent(this.options.showEvent,this.show),this._addTriggerEvent(this.options.hideEvent,this.hide)},_addTriggerEvent:function(e,t){e&&this.$el.on(e+"."+this.cid,t)},_buildHtml:function(t){var i=e('<div class="'+this.options.customContainerClass+'">');t.wrap(i);var s=e('<div class="ui-tooltip-panel '+this.options.customPanelClass+'">'+this.options.text+"</div>");return s.insertAfter(t),s},isPanelShowing:function(){return this._isPanelShowing},show:function(){this.$tooltipPanel.css(this._getPositionCss(this.options.position)),this.$tooltipPanel.stop().fadeIn(400),this._isPanelShowing=!0,this.options.onShow&&this.options.onShow()},hide:function(){this.$tooltipPanel.stop().fadeOut(400),this._isPanelShowing=!1,this.options.onHide&&this.options.onHide()},_getPositionCss:function(e){var t=10,i=this.$tooltipPanel.outerHeight(),s=this.$tooltipPanel.outerWidth(),n=this.$el.outerWidth(),o=this.$el.outerHeight();return"right"===e?{top:-(i/2)+o/2,left:n+t}:"left"===e?{top:-(i/2)+o/2,right:n+t}:"top"===e?{bottom:o+t,left:-(s/2)+n/2}:"bottom"===e?{top:o+t,right:-(s/2)+n/2}:{}},getText:function(){return this._tooltipText},setText:function(e){this.$tooltipPanel.text(e),this._tooltipText=e,this.isPanelShowing()&&this.$tooltipPanel.css(this._getPositionCss(this.options.position))},destroy:function(e){this.$el.off("."+this.cid),this.$el.unwrap(),this.$tooltipPanel.remove(),i.prototype.destroy.call(this,e)}});return s}),define("modules/videos/video-gallery",["jquery","underscore","baseview","pubsub","utils","state","modules/carousel/gallery","modules/videos/brightcove-video","modules/carousel/thumbs","ui/tooltip","modules/stories/taboola-recommendations","modules/scroller/horizontal-scroll","managers/autoplay"],function(e,t,i,s,n,o,a,r,l,h,d,c,u){"use strict";var p=i.extend({events:{"click .carousel-prev":"onClickPrevArrow","click .carousel-next":"onClickNextArrow"},initialize:function(s){s=e.extend({viewportSelector:".gallery-viewport",slidesContainerSelector:".gallery-slides",slidesSelector:".gallery-slide",hoverTransition:0,scrollerColor:"light",thumbsSelector:".vgm-thumbs",tooltipOptions:null},s),t.bindAll(this,"_transitionSlides","_getOnStatusChangeMethod","_getOnClickPlayVideoMethod","goToNextVideo","getIntermediateRecommendation","startAutoPlay"),this.$viewport=this.$(s.viewportSelector),this.$slidesContainer=this.$viewport.find(s.slidesContainerSelector),this.$slides=this.$slidesContainer.find(s.slidesSelector),this.$arrows=this.$(".carousel-prev, .carousel-next"),this.$title=this.$(".video-gallery-page-title"),this.subviewPrefix="galleryItem";var o=e.extend(s,{animations:{useCSSTransitions:!1}});i.prototype.initialize.call(this,o),this.index=this.$(".vgm-thumb-item.active").index(),this.subviews.gallery=new a({el:this.$el,slideTransition:200,ads:!1,index:0,lookAheadAmount:3,transitionSlides:this._transitionSlides}),this._initializeThumbs(s.hoverTransition,s.scrollerColor,s.thumbsSelector),this._initializeTooltips(this.$(".vgm-thumb-box")),this.goTo(this.index).done(t.bind(function(){var e=n.getNested(this.getPlayerSubview(this.index),"player","autoplay");(void 0===e||e)&&u.register("brightcove-video",this.startAutoPlay)},this))},startAutoPlay:function(){return this.startVideo(this.index),s.trigger("uotrack","videoplaylist|nextauto"),!0},_initializeThumbs:function(e,t,i){this.subviews.thumbs=new l({el:i?this.$(i):this.$el,hoverTransition:e,index:this.index,scrollerColor:t,carousel:this})},_initializeTooltips:function(i){t.each(i,function(t,i){this._setupTooltipView(t,e(t).data("duration"),i)},this)},_setupTooltipView:function(t,i,s){var n=e.extend({el:t,text:i,customContainerClass:"vgm-ui-tooltip",position:"bottom"},this.options.tooltipOptions),o=this.subviewPrefix+s;this.subviews[o]||(this.subviews[o]=new h(n))},onVideoStatusChange:function(e,t){if("mediaComplete"===e.type){var i=this.getActiveSlideIndex(),s=i+1,o=this.$slides.length-1;if(n.getNested(this.getPlayerSubview(i),"player","gannett_continuous_endslate")&&!this.subviews["intermediateEndslate"+i])return void this.displayEndslate();o>=s&&this.goToNextVideo()}this.getActiveSlideIndex()===t||"mediaBegin"!==e.type&&"mediaPlay"!==e.type||this.enterBackgroundState(t)},onClickPrevArrow:function(e){e.preventDefault();var i=this.getActiveSlideIndex()-1;this.goTo(i).done(t.bind(function(){this.startVideo(i),this.triggerEvent("goToSlide",i),s.trigger("uotrack","videoplaylist|prev")},this))},onClickNextArrow:function(e){e.preventDefault();var i=this.getActiveSlideIndex()+1;this.goTo(i).done(t.bind(function(){this.startVideo(i),this.triggerEvent("goToSlide",i),s.trigger("uotrack","videoplaylist|next")},this))},switchSlide:function(e){var i=this.getActiveSlideIndex();this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e),s.trigger("uotrack","videoplaylist"+(e+1)),void 0!==i&&this.enterBackgroundState(i)},this))},startVideo:function(e){var t=this.getPlayerSubview(e);t&&t.playVideo()},enterBackgroundState:function(e){var t=this.getPlayerSubview(e);t&&t.reset()},goTo:function(e){var i=this.getActiveSlideIndex();return this.updateArrows(e),this._activeSlide=e,this.subviews.gallery.goToSlide(e).done(t.bind(function(){var t=this.subviews["video"+e],s=this.$slides.eq(e).find(".ui-video");!t&&void 0!==e&&s.length&&(this.subviews["video"+e]=new r({el:s[0],onStatusChange:this._getOnStatusChangeMethod(e),onClickPlay:this._getOnClickPlayVideoMethod(e),overrideGetRecommendations:this.getIntermediateRecommendation,autoPlay:!1})),void 0!==i&&this.enterBackgroundState(i)},this))},getIntermediateRecommendation:function(){var e=this.getActiveSlideIndex(),t="",i=e+1,s=this.$slides.length-1,n=this.getPlayerSubview(e);s>=i?(t=this.$slides.eq(i).find(".ui-video-data").html(),this.videoresponse=JSON.parse(t)):i>s&&(this.subviews.TaboolaOutbrain||(this.subviews.TaboolaOutbrain=new d,this.subviews.TaboolaOutbrain.renderEndslate(n.video.url,n.video.brightcove_id)))},displayEndslate:function(){var e=this.getActiveSlideIndex(),t=e+1,i=this.$slides.length-1,s=this.getPlayerSubview(e);this.$slides.eq(e).find(".video-endslate");i>=t?s.player.gannett_continuous_endslate&&(this.subviews["intermediateEndslate"+e]||(this.subviews["intermediateEndslate"+e]=new d({videoResponse:this.videoresponse,endCountdown:this.goToNextVideo}),this.subviews["intermediateEndslate"+e].playNextRecommendation(s.player.mediatemplate))):t>i&&s.player.gannett_continuous_endslate&&this.subviews.TaboolaOutbrain.playNextRecommendation(s.player.mediatemplate)},goToNextVideo:function(){var e=this.getActiveSlideIndex()+1;this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e),s.trigger("uotrack","videoplaylist|nextauto")},this))},_transitionSlides:function(e){var t=this.$viewport.outerWidth(),i=t*e*-1,s=this.$slidesContainer;return this.animate(s,"left",i+"px",250,"easeInOutQuad")},getPlayerSubview:function(e){return this.subviews["video"+e]},_getOnClickPlayVideoMethod:function(e){return t.bind(function(t){this.onClickPlayVideo(t,e)},this)},onClickPlayVideo:function(e,t){this.startVideo(t)},_getOnStatusChangeMethod:function(e){return t.bind(function(t){this.onVideoStatusChange(t,e)},this)},getActiveSlideIndex:function(){return this._activeSlide},updateArrows:function(e){var t;this.$slides.length<=1||(this.$arrows.addClass("gallery-nav-active"),0===e?t="prev":e===this.$slides.length-1&&(t="next"),this.$arrows.filter(".carousel-"+t).removeClass("gallery-nav-active"))}});return p}),define("modules/videos/pluto/pluto-ads",["jquery","underscore","baseview","utils","cookie"],function(e,t,i,s){"use strict";var n=i.extend({events:{"click .pluto-skip-ad-button":"skipAd","mouseenter .vjs-ima3-ad-container":"showAdControlBar"},initialize:function(s){s=e.extend({actionName:"plutoVideoReport",adAccountId:null,adAccountName:null,adLabel:null,adPlacement:null,adUnit:null,videostart:null,ima3:null,minimumAdLength:null,onAdEnd:null,onAdPause:null,onAdPlay:null,onVolumeChange:null,pageInfo:null,placementData:null,playVideo:null,videoData:null,vjsPlayer:null,bidSlot:null},s),this.bidSlot=this.options.bidSlot,i.prototype.initialize.call(this,s),t.bindAll(this,"renderAdCounter"),this.minumumAdLength=this.options.minimumAdLength,this.msgSkip="Skip in ",this.vjsPlayer=this.options.vjsPlayer,this.ima3Settings=this.options.ima3,this.blockFlash=this.isSafari()&&this.isDockedPlayer(),this.isIPhone=navigator.userAgent.match(/(iPhone)/i),this.isIPad=navigator.userAgent.match(/(iPad)/i),this.isIOS=this.isIPad||this.isIPhone,this.blockFlash&&(this.ima3Settings.adTechOrder=["html5"]),this.vjsPlayer.ima3.settings?e.extend(this.vjsPlayer.ima3.settings,this.ima3Settings):this.vjsPlayer.ima3(this.ima3Settings),this.hasListeners||this.setupAdEventListeners(this.vjsAdEvents),this.$adContainer=this.$(".vjs-ima3-ad-container"),this.$adOverlayContainer=this.$(".pluto-ad-overlay"),this.$adOverlayMsg=this.$(".pluto-ad-msg"),this.$adOverlaySkip=this.$(".pluto-skip-ad-button")},setBid:function(e){this.bidSlot=e},buildAdServerParam:function(){var t=s.getUrlParam("adserverurl");if(t)return decodeURIComponent(t);var i=((e.cookie("aamusat")||"").match(/[0-9]+/g)||[]).join(","),n=this.ima3Settings.adRule||"0",o=e.cookie("aam_uuid"),a="",r=this.ima3Settings.output,l=this.options.pageInfo,h=this.vjsPlayer.width()+"x"+this.vjsPlayer.height(),d=(window.simpleExclusion||[]).join(","),c=(window.simpleTarget||[]).join(","),u="920x508",p=this.options.videoData,f=this.options.cstObj,g=p.presto_keywords||"",m=this.options.sstsObj,v=p.series||l.series||"",b=p.keywords||"",y=this.ima3Settings.cmsId||"12768",w="",_=s.getNested(l,"breaking"),C=_?"breaking":_===!1?"none":"NA",S=s.getUrlParam("navigationtype");l.basePageType&&(a+="&pagetype="+encodeURIComponent(l.basePageType)),this.options.adLabel&&(a+="&adlabel="+encodeURIComponent(this.options.adLabel)),l.adSize&&(u=l.adSize),l.topic&&(g+=","+l.topic),c&&(a+="&categoryvalue="+c),d&&(a+="&excl_cat="+d),l.texttype&&(w=this.getpageLevelInfo(l)||""),a+="&aam="+i,a+="&contentid="+p.id,a+="&credit="+p.credit,a+="&origin="+p.origin,a+="&cst_section="+f.section,a+="&cst_subsection="+f.subsection,a+="&cst_topic="+f.topic,a+="&playersize="+h,a+="&playertype="+this.options.placementData.name,a+="&series="+v,a+="&ssts_section="+m.section,a+="&ssts_subsection="+m.subsection,a+="&ssts_topic="+m.topic,a+="&ssts_subtopic="+m.subtopic,a+="&topic="+g,a+="&videolength="+Math.round(this.vjsPlayer.mediainfo.duration),a+="&videostart="+this.options.videoStart,a+="&videotag="+b,a+="&u="+o,a+="&mutedAutoplay="+this.options.placementData.mutedAutoplay,a+="&alerttype="+C,S&&(a+="&navigationtype="+S),(this.options.adAccountId||this.options.adAccountName||"preroll_video"!==this.options.adPlacement)&&this.rebuildAdUnit();var x="https://pubads.g.doubleclick.net/gampad/ads?env=vp&gdfp_req=1&impl=s&output="+r+"&iu="+this.options.adUnit+"/"+p.cst+"&ad_rule="+n+"&description_url="+p.url+"&sz="+u+"&unviewed_position_start=1&pageInfo="+w+"&cmsid="+y+"&vid="+p.brightcove_id;if(this.bidSlot&&this.bidSlot.encodedQsParams&&(x+="&scp="+this.bidSlot.encodedQsParams),window.videoPrebidBids&&window.videoPrebidBids["video-"+p.id]){var k={adserver:"dfp",code:"video-"+p.id};x=window.pbjs.buildMasterVideoTagFromAdserverTag(x,k)}return x+="&cust_params="+encodeURIComponent(a)},getpageLevelInfo:function(e){switch(e.texttype){case"front":return"front:"+e.ssts.toUpperCase();case"story":case"blog":return"story:"+e.assetid;case"video":case"video-playlist":return"video:"+e.assetid;
default:return}},rebuildAdUnit:function(){if(this.options.adAccountId&&this.options.adAccountName&&"preroll_video"!==this.options.adPlacement)this.options.adUnit=this.options.adAccountId+"/"+this.options.adAccountName+"/"+this.options.adPlacement;else{var e=this.options.adUnit.split("/");this.options.adAccountId&&(e[0]=this.options.adAccountId),this.options.adAccountName&&(e[1]=this.options.adAccountName),"preroll_video"!==this.options.adPlacement&&(e[2]=this.options.adPlacement),this.options.adUnit=e.join("/")}},setupAdEventListeners:function(){this.hasListeners=!0,this.vjsAdEvents={"ads-ad-ended":this.onAdEnded,"ads-ad-started":this.onAdsAdStarted,"ads-allpods-completed":this.onAdsAllpodsCompleted,"ads-click":this.onAdsClick,"ads-pause":this.onAdPause,"ads-play":this.onAdPlay,"ads-volumechange":this.onAdVolumeChange,"ima3-ad-error":this.ima3AdError,"ima3-ready":this.onIma3Ready,"ads-load":this.onAdsLoad},t.each(this.vjsAdEvents,t.bind(function(e,i){this.vjsPlayer.on(i,t.bind(e,this))},this))},onAdsAllpodsCompleted:function(){this.skipAd()},onAdVolumeChange:function(e){this.options.onVolumeChange&&this.options.onVolumeChange(this.isAdMuted())},onIma3Ready:function(){this.vjsPlayer.ima3.adPlayer.on("adserror",t.bind(function(e){this.ima3AdError(e)},this))},onAdsLoad:function(){this.vjsPlayer.muted()||0===this.playerVolume?this.vjsPlayer.ima3.adPlayer.volume(0):this.vjsPlayer.ima3.adPlayer.volume(this.playerVolume)},makeAdRequest:function(e){e&&(this.options.videoData=e),this.prebidPromise?this.prebidPromise.then(t.bind(function(){this.vjsPlayer.ima3.adrequest(this.buildAdServerParam())},this)):this.vjsPlayer.ima3.adrequest(this.buildAdServerParam())},ima3AdError:function(t){if(s.getNested(this.options.placementData,"enableLogging")&&s.logAction){var i=e.extend(this.getImaErrorDetails(t),this.getAdVendorDetails(t));s.logAction(this.options.actionName,{type:"adError",details:i,adSystem:i.adSystem?i.adSystem:"",placement:s.getNested(this.options.placementData,"name"),domain:s.getNested(window.site_vars,"site_key"),siteCode:s.getNested(window.site_vars,"site_code"),videoId:this.options.videoData.id})}this.onAdEnded(),(!this.isIPad&&this.options.playVideo||"playlistfronthtml5"==this.options.placementData.name)&&this.options.playVideo()},getImaErrorDetails:function(e){var t={event:e.type};try{e.originalEvent&&e.originalEvent.getError&&(t.event=e.originalEvent.getError().toString())}catch(i){}return t},getAdVendorDetails:function(e){var t=null,i={};if(e.emitter&&e.emitter.getCurrentAd&&(t=e.emitter.getCurrentAd()),t)try{i={adSystem:t.getAdSystem(),adId:t.getAdId(),apiFramework:t.getApiFramework(),mediaUrl:t.getMediaUrl(),duration:t.getDuration(),creativeId:t.getCreativeId()}}catch(s){}return i},onAdsAdStarted:function(){this.currentAd=this.vjsPlayer.ima3.currentAd,this.blockFlash&&(this.currentAd.getContentType()||"").indexOf("flash")>-1&&this.skipAd(),this.isIOS||this.options.vjsPlayer.pause(),this.adControlBar(),this.onAdPlay(),this.isAndroid=/(android)/i.test(navigator.userAgent),(this.isAndroid||this.options.placementData.responsive)&&this.vjsPlayer.ima3.adsManager.resize(this.vjsPlayer.width(),this.vjsPlayer.height(),"normal"),this.$adContainer.removeClass("pluto-ad-visibility-hidden"),this.adHasSkip=this.adHasOwnSkip(),this.adHasSkip||this.isIPhone||(this.adOverlay(),window.setTimeout(t.bind(function(){this.$adOverlayContainer.removeClass("pluto-ad-hide")},this),500)),this.$(".vjs-video-title span").html("Sponsor Message")},onAdEnded:function(){this.options.onAdEnd&&this.options.onAdEnd(),this.adOverlayReset()},onAdPlay:function(){this.options.onAdPlay&&this.options.onAdPlay()},onAdPause:function(){this.options.onAdPause&&this.options.onAdPause()},onAdsClick:function(){this.vjsPlayer.ima3.adPlayer.pause()},adControlBar:function(){var e=".vjs-control-bar.vjs-ad-control-bar";this.$(e+" .vjs-video-title")[0]||this.$(e).append('<div class="vjs-video-title"><span></span></div>')},adOverlay:function(){this.renderAdCounter(),this.adCounter=setInterval(this.renderAdCounter,500)},adHasOwnSkip:function(){var e;try{e=this.currentAd.isSkippable()||!t.isEmpty(s.getNested(JSON.parse(this.currentAd.getTraffickingParametersString()||"{}"),"capabilities","skipButton"))}catch(i){e=!1}return e},adState:function(e){return this.vjsPlayer.ads.state===e},renderAdCounter:function(){var e=this.vjsPlayer.ima3,t=e.adPlayer.duration(),i=this.ima3Settings.secondsBeforeSkip,s=t>=this.ima3Settings.requiredSkipAdLength,n=e.adPlayer.currentTime(),o=e.adsManager?e.adsManager.getRemainingTime():0,a=0!==n&&0!==t?t-n:o,r=i>n&&s,l=r?Math.round(i-n):Math.round(a);this.adState("ad-playback")?n>0&&a>0&&t>this.minumumAdLength?(this.$adOverlayContainer.removeClass("pluto-ad-visibility-hidden"),r&&l>0?(this.$adOverlayMsg.removeClass("pluto-ad-hide"),this.$adOverlayMsg.html(this.msgSkip+l)):s&&(this.$adOverlaySkip.removeClass("pluto-ad-hide"),this.$adOverlayMsg.addClass("pluto-ad-hide"))):this.$adOverlayContainer.addClass("pluto-ad-visibility-hidden"):this.adState("content-playback")&&this.adOverlayReset()},adOverlayReset:function(){this.$adContainer.addClass("pluto-ad-visibility-hidden"),this.$adOverlayMsg.html(""),this.$adOverlayContainer.addClass("pluto-ad-hide"),this.$adOverlaySkip.addClass("pluto-ad-hide"),this.$(".vjs-video-title span").html(this.options.videoData.title),clearInterval(this.adCounter)},skipAd:function(e){(this.adState("ad-playback")||this.adHasSkip&&this.adState("content-playback"))&&(e&&e.preventDefault(),this.vjsPlayer.ima3.adPlayer.pause(),this.vjsPlayer.ads.endLinearAdMode(),this.vjsPlayer.ima3.adsManager.destroy(),this.adOverlayReset(),this.options.onAdEnd&&this.options.onAdEnd())},showAdControlBar:function(){this.adState("ad-playback")&&this.vjsPlayer.userActive(!0)},pauseAd:function(){this.vjsPlayer.ima3.adPlayer.pause()},playAd:function(){this.vjsPlayer.ima3.adPlayer.play()},isAdPlaying:function(){return!this.vjsPlayer.ima3.adPlayer.paused()&&this.adState("ad-playback")},isAdInProgress:function(){return"ad-playback"===this.vjsPlayer.ads.state},setAdVolume:function(e){this.vjsPlayer.ima3.adPlayer.volume(e)},getAdVolume:function(){return this.vjsPlayer.ima3.adPlayer.volume()},isAdMuted:function(){return 0===this.getAdVolume()},getAdRunTime:function(){var e=this.vjsPlayer.ima3.adPlayer.duration(),t=Math.floor(e/60),i=e-60*t;return t+":"+Math.round(i)},isSafari:function(){return navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")},isDockedPlayer:function(){return s.getNested(this.options.placementData,"scrollingplayer")&&s.getNested(window.site_vars,"html5video","scrollingPlayer","docked")},destroy:function(){this.adOverlayReset(),i.prototype.destroy.apply(this,arguments)}});return n}),define("modules/videos/pluto/pluto-share",["jquery","underscore","baseview","utils"],function(e,t,i,s){"use strict";return i.extend({events:{"click .pluto-share-button":"shareVideo","click .close-share-overlay":"closeShareOverlay","click .close-360-share":"hideShareBar"},initialize:function(t){t=e.extend({analytics:null,analyticsEnabled:null,controlBarSelector:null,exitFullScreen:null,isVideoPlaying:null,layout:null,onShare:null,onClose:null,playVideo:null,pauseVideo:null,placementName:null,siteDisplayName:null,twitterAccount:null,videoData:null},t),i.prototype.initialize.call(this,t),this.enabled=!0,this.open=!1,this.$overlay=this.$(".pluto-share-overlay"),this.onLoadedMetaData(this.options.controlBarSelector),this.updateShareMetadata(),this.layout=this.options.layout||"full"},onLoadedMetaData:function(e){e&&this.$(e).append('<div class="pluto-share-button js-pluto-share vjs-control" role="button"><span class="vjs-control-text"></span></div>')},updateShareMetadata:function(){var e=this.options.videoData.short_url||this.options.videoData.full_url,t=encodeURI(this.options.videoData.title),i=this.options.twitterAccount||s.getNested(window.site_vars,"twitter","default_account"),n=this.options.siteDisplayName||s.getNested(window.site_vars,"display_name"),o="https://www.facebook.com/sharer/sharer.php?u="+e,a="https://twitter.com/intent/tweet?url="+e+"&text="+t+"&via="+i,r="//plus.google.com/share?url="+e,l="mailto:?subject="+t+"&body=Check out this video on "+n+": "+e;this.$overlay.find(".share-overlay-direct-link").val(e),this.$overlay.find(".pluto-share-facebook-link").attr("href",o),this.$overlay.find(".pluto-share-twitter-link").attr("href",a),this.$overlay.find(".pluto-share-google-plus-link").attr("href",r),this.$overlay.find(".pluto-share-mail-link").attr("href",l)},shareVideo:function(t){t.preventDefault(),this.enabled&&!this.open&&(this.resumePlay=this.options.isVideoPlaying?this.options.isVideoPlaying():!1,this.showShareOverlay(),this.options.onShare&&this.options.onShare(),this.options.analyticsEnabled&&("full"===this.layout?this.options.analytics.trackVideoEvents(e(t.target).hasClass("js-pvb-share")?"ScrollingPlayerShare":"HTML5PlayerShare"):this.options.analytics.trackVideoEvents("360PlayerShare")),this.options.pauseVideo&&this.options.pauseVideo(),this.options.exitFullScreen&&this.options.exitFullScreen())},showShareOverlay:function(){this.open=!0,"minimal"===this.layout&&this.$(".pluto-share-button").addClass("close-360-share"),this.$overlay.show().css("visibility","visible")},hideShareOverlay:function(){this.open=!1,this.$overlay.hide()},disableShare:function(){this.enabled=!1},enableShare:function(){this.enabled=!0},hideShareBar:function(){this.open=!1,this.$overlay.css("visibility","hidden"),this.$(".pluto-share-button").removeClass("close-360-share")},closeShareOverlay:function(e){e.preventDefault(),this.hideShareOverlay(),this.resumePlay&&this.options.playVideo&&this.options.playVideo(),this.options.onClose&&this.options.onClose()},destroy:function(){this.hideShareOverlay(),i.prototype.destroy.apply(this,arguments)}})}),define("modules/videos/pluto/pluto-utils",["jquery","underscore"],function(e,t){"use strict";var i=function(){};return i.prototype={buildData:function(e){var t=e.html()||{};return"string"==typeof t&&(t=JSON.parse(t)),t},setPostMessage:function(e,t,i,s){if(e&&t){var n=s?s:"*";t.postMessage(i,n)}},getPostMessage:function(e,t){e&&window.addEventListener("message",t,!1)},postMessageEvent:function(e,t){var i=t.data[0],s=t.data[1]||"";"function"==typeof e[i]&&e[i](s)},removeListener:function(e){window.removeEventListener("message",e,!1)}},new i}),define("modules/videos/pluto/pluto-analytics",["jquery","underscore","pubsub","utils","fwinfo"],function(e,t,i,s,n){"use strict";var o=function(){};return o.prototype={initAnalytics:function(i){if(this.isAnalyticsLoaded=e.Deferred(),this.comscoreEnabled=s.getNested(window.site_vars,"flags","comscore_video"),i){if(window.tealium_url){var n=window.tealium_url;s.loadScript(n,"utag").done(t.bind(function(){window.utag.data.noinitialanalytics="True",this.isAnalyticsLoaded.resolve(this)},this)).fail(t.bind(function(){this.isAnalyticsLoaded.reject()},this))}}else this.isAnalyticsLoaded.resolve(this),this.FullAnalytics=!0;return this.isAnalyticsLoaded},trackVideoOnload:function(e,s,n){this.isAnalyticsLoaded.done(t.bind(function(){this.FullAnalytics?i.trigger("video:load",this.getVideoEventAnalyticsData(e,s,n)):this.liteVideo_load(this.getVideoEventAnalyticsData(e,s,n))},this))},trackVideoEvents:function(e){this.isAnalyticsLoaded.done(t.bind(function(){this.FullAnalytics?i.trigger("uotrack",e):this.liteUotrack(e)},this))},trackVideoProgression:function(e,s){this.isAnalyticsLoaded.done(t.bind(function(){this.FullAnalytics?i.trigger("vitrack",{percentage:e,video_url:s}):this.liteVitrack({percentage:e,video_url:s})},this))},getVideoEventAnalyticsData:function(e,i,s){var n=i.mediainfo||i.video,o=n.duration,a={assetid:e.id||n.reference_id,byline:this.buildCredit(e.credit),videoOrigin:e.origin,completion:"0%",contentid:e.brightcove_id||n.id,contenttype:e.type||"video",create_date:e.create_date||"",cst:e.cst||n.custom_fields.gdp_cst,eventtype:"video:load",keywords:e.keywords||n.custom_fields.gdp_tags,miliseconds:Math.round(1e3*o),ssts:e.ssts_string||n.custom_fields.gdp_ssts,url:e.full_url,videocontentprovider:e.videocontentprovider||n.custom_fields.gannetttracking+"|"+n.name,videoFulllengthUrl:i.src(),videoName:e.title||n.custom_fields.liveVideoSubject||n.name,videoplayername:s};return 0>o?a.videoDuration="":120>o?a.videoDuration="less than 2 min":a.videoDuration="greater than 2 min",e.url&&(a.pathName=e.url.replace(/^.*\/\/[^\/]+/,"")),t.isEmpty(e)?a.section="":a.section=e.ssts.section?e.ssts.section:e.ssts_string.split("/")[0],a},buildCredit:function(e){return e&&e.length?"video|"+e:"video|author unavailable"},getComscoreOptions:function(){var e=s.getNested(window.site_vars,"THIRDPARTYAPI","COMSCORE"),t=e.site?e.site:s.getNested(window.site_vars,"site_key");return{customerC2:e.customerC2,site:t,script_url:e.script_url}},stopComscoreTracking:function(){this.myStreamingTag&&this.comscoreEnabled&&this.myStreamingTag.stop()},comscoreContentPlayback:function(e,i,s){this.comscoreEnabled&&this.requireComscore().done(t.bind(function(){var t=this.getVideoEventAnalyticsData(e,i,s),n="360video"===(t||{}).contenttype?t.contenttype:t.section,o={c3:this.getComscoreOptions().site,c4:n,c6:"*null",c7:t.url,c8:t.videoName,ns_st_ce:"*null",ns_st_ci:t.assetid,ns_st_cl:t.miliseconds,ns_st_ddt:t.create_date,ns_st_ge:t.section,ns_st_ia:"*null",ns_st_tdt:"*null",ns_st_ti:"*null"};this.myStreamingTag.playVideoContentPart(o,window.ns_.StreamingTag.ContentType.LongFormOnDemand)},this))},resetMyStreamingTag:function(){this.comscoreEnabled&&this.myStreamingTag&&(this.myStreamingTag=!1)},comscoreAdPlayback:function(e,i){this.comscoreEnabled&&this.requireComscore().done(t.bind(function(){this.myStreamingTag.playVideoAdvertisement({ns_st_cl:i,ns_st_ci:e},window.ns_.StreamingTag.AdType.LinearOnDemandPreRoll)},this))},requireComscore:function(){var i=e.Deferred(),s=require.config({paths:{comscore:this.getComscoreOptions().script_url}});return s(["comscore"],t.bind(function(){this.myStreamingTag||(this.myStreamingTag=new window.ns_.StreamingTag({customerC2:this.getComscoreOptions().customerC2})),i.resolve()},this)),i},liteVideo_load:function(e){var t={},i=location.hash.match(/\bht=([^&]*)/)&&RegExp.$1;t.byline=e.byline||"",t.origin=e.origin||"",t.clickName=i||n.getandclearsessionvalue("clickName"),t.clickPage=n.getandclearsessionvalue("clickPage"),t.category=e.category||"",t.cst=e.cst||"",t.assetid=e.assetid||"",t.published_date=e.publishedDate||"",t.refreshed="",t.section=e.section||"",t.ssts=e.ssts||"",t.subcategory=e.subcategory||"",t.subsection=e.subsection||"",t.topic=e.topic||"",t.videoPlayerName=e.videoplayername||"",t.prevpath=n.getandclearsessionvalue("prevpath"),t.completion=e.completion||"",t.keywords=e.keywords||"",t.taxonomykeywords=e.keywords||"",t.contenttype=e.contenttype||"",t.videoName=e.videoName||"",t.videoDuration=e.videoDuration||"",t.eventtype=e.eventtype||"",t.pathName=e.pathName||"",t.videoContentID=e.contentid||"",t.viralVideoDomain=e.viralVideoDomain||"",t.videoContentProvider=e.videocontentprovider||"",t.templatetype=e.templatetype||"",t.noinitialanalytics=!1,t.videoincluded="yes",t.videoFulllengthUrl=e.videoFulllengthUrl||"",t.milestonetrack=e.milestonetrack||"",t.videotranscript=e.videotranscript||"",window.utag.track("view",t),n.setsessionvalue("prevpath",document.location.pathname)},liteVitrack:function(e){"object"!=typeof e&&(console.error("vitrack has been given a non-object event argument",e),e=(e||{}).prop9||"somethingbad");var t={milestonetrack:e.percentage,eventtype:"vitrack",linkTrackEvents:"None",linkTrackVars:"prop9",video_url:e.video_url};window.utag.track("link",t)},liteUotrack:function(e){"string"!=typeof e&&(console.error("uotrack has been given a non-string event argument",e),e=(e||{}).prop41||"somethingbad");var t={clickName:e,clickPage:location.href,eventtype:"uotrack",linkTrackEvents:"None",linkTrackVars:"prop41,prop64"};window.utag.track("link",t)}},new o}),define("modules/videos/pluto/pluto-embed",["jquery","underscore","baseview","utils"],function(e,t,i,s){"use strict";var n=i.extend({events:{"click .js-pluto-embed":"showOverlay","click .js-close-embed-overlay":"closeOverlay","click .js-embed-autoplay":"onAutoplayCheck"},initialize:function(t){t=e.extend({addEmbedBtn:null,analytics:null,baseUrl:null,onEmbedClose:null,onEmbedShow:null,placementName:null,siteDisplayName:null,videoId:null},t),i.prototype.initialize.call(this,t),this.updateVideoId(t.videoId),t.addEmbedBtn?this.updateControlBar():this.$(".js-pluto-embed").css("display","inline-block")},closeOverlay:function(e){e.preventDefault(),this.hideOverlay(),this.options.onEmbedClose&&this.options.onEmbedClose()},onAutoplayCheck:function(t){var i=e(t.currentTarget).is(":checked");this.options.analytics.trackVideoEvents(i?"360EmbedCheckAutoplay":"360EmbedUncheckAutoplay"),this.setIframeCode(i).selectCode()},hideOverlay:function(){this.$$(".pluto-embed-overlay").hide()},updateVideoId:function(e){e&&(this.videoId=e)},showOverlay:function(e){e.preventDefault(),this.options.onEmbedShow&&this.options.onEmbedShow(),this.$$(".pluto-embed-overlay").show().css("visibility","visible"),this.options.analytics.trackVideoEvents("HTML5PlayerEmbed"),this.setIframeCode(!1).selectCode()},selectCode:function(){this.el.querySelector(".embed-overlay-direct-link").select()},setIframeCode:function(e){var t,i=this.options.baseUrl||s.getNested(window.site_vars,"base_url"),n=this.options.siteDisplayName||s.getNested(window.site_vars,"display_name");-1===i.indexOf("www.")&&(i="www."+i),t="//"+i+"/videos/embed/"+this.videoId+"/?fullsite=true",e&&(t+="&autoplay=true"),this.options.placementName&&(t+="&placement="+this.options.placementName);var o='<iframe title="'+n.toUpperCase()+' - Embed Player" width="540" height="304" frameborder="0" scrolling="no" allowfullscreen="true" marginheight="0" marginwidth="0" src='+t+"></iframe>";return this.$(".embed-overlay-direct-link").val(o),this},updateControlBar:function(){this.$(".vjs-control-bar").append('<div class="embed-button js-pluto-embed vjs-control" role="button"><span class="vjs-control-text"></span></div>')},destroy:function(){this.hideOverlay(),i.prototype.destroy.call(this)}});return n}),define("modules/videos/pluto/pluto-video",["jquery","underscore","baseview","utils","pubsub","admanager","modules/videos/pluto/pluto-ads","modules/videos/pluto/pluto-share","modules/videos/pluto/pluto-utils","modules/videos/pluto/pluto-analytics","modules/videos/pluto/pluto-embed"],function(e,t,i,s,n,o,a,r,l,h,d){"use strict";var c=i.extend({events:{"click .js-pluto-title-overlay-play":"playVideo"},initialize:function(n){n=e.extend({accountId:s.getNested(window.site_vars,"html5video","accountId"),actionName:"plutoVideoReport",baseUrl:null,checkBrowserTabInactivity:s.getNested(window.site_vars,"html5video","checkBrowserTabInactivity"),inactivityTimeout:s.getNested(window.site_vars,"html5video","userInactivityTimeout"),isRecommended:null,liteAnalytics:null,onAdEnd:null,onAdPlay:null,onAdVolumeChange:null,onFullScreenChange:null,onPlayback:null,onVideoPause:null,onVideoPlay:null,onVolumeChange:null,pageInfo:null,playerId:s.getNested(window.site_vars,"html5video","playerId"),videoStart:this.options.videoStart,isFirstPlaylistVideoMuted:this.options.isFirstPlaylistVideoMuted},n),this.pubSub={"plutovideo:play":t.bind(this.videoIsPlaying,this),apsBidsBack:t.bind(this.apsBidsBack,this)},i.prototype.initialize.call(this,n),t.bindAll(this,"changeVideo","onEmbedClose","exitFullScreen","getPlutoAnalytics","getVideoCurrentTime","isPlaying","onAdEnd","onAdPause","onAdPlay","onAdVolumeChange","onContentPlayback","onFullScreenChange","onLoadStart","onTimeupdate","pauseVideo","playVideo","resetVideoState","shouldIncludeRecommendation","startAutoPlay","onEmbedShow","toggleVolume"),this.sv={},this.video=l.buildData(this.$(".ui-video-data")),this.placement=l.buildData(this.$(".ui-video-placement-data")),this.uwIframes=e(".uw-iframe"),this.initPromise=e.Deferred(),this.adCallMade=!1,this.comscoreAdCallMade=!1,this.pauseOnLoad=!1,this.buffering=!0,this.irisEnabled=s.getNested(window.site_vars,"THIRDPARTYAPI","Iris","enabled"),this.options.accountId&&this.options.playerId&&(h.initAnalytics(this.options.liteAnalytics),this.createVideoTag(),window.vjsBc?(window.vjsBc(this.$("video")[0]),this.setupPlayer()):this.requireBc())},apsBidsBack:function(e){if(e&&window.videoA9Slots&&this.placement.apsEnabled)for(var i=t.filter(window.videoA9Slots,t.bind(function(e){return parseInt(e.videoID)===parseInt(this.video.id)},this))[0],s=0;s<e.length;s++)if(e[s].slotID===i.slotID){this.bidSlot=e[s],this.sv.ads&&this.sv.ads.setBid(this.bidSlot);break}},createVideoTag:function(){var t=e("<video />",{id:"vjs_"+e.now(),"data-account":this.options.accountId,"data-player":this.options.playerId,"data-video-id":this.video.id?"ref:"+this.video.id:this.video.brightcove_id,"data-embed":"default","class":"video-js pluto-video",poster:this.$(".ui-pluto-still img").attr("src")||""});this.$el.prepend(t)},requireBc:function(){var e=require.config({paths:{bc:"//players.brightcove.net/"+this.options.accountId+"/"+this.options.playerId+"_default/index.min"},timeout:30});e(["bc"],t.bind(function(e){window.vjsBc=e,this.setupPlayer()},this))},setupPlayer:function(){var i,s=e(this.$("video")[0]);i=s.hasClass("vjs-tech")?s.parent()[0].id:s.id,window.videojs.IS_IPAD&&(this.placement.gannett_continuous_endslate=!1),this.vjsPlayer=window.videojs(i).preload("metadata"),this.options.videoStart||(this.options.videoStart=this.placement.autoplay?"auto-first":"user"),(this.placement.mutedAutoplay&&-1===this.placement.name.indexOf("playlist")||this.options.isFirstPlaylistVideoMuted)&&this.vjsPlayer.muted(!0),this.placement.ads&&this.initAds(),this.vjsPlayer.ready(t.bind(function(){this.hasListeners||this.setupEventListeners(this.vjsEvents),this.$(".vjs-control-bar").append('<div class="vjs-video-title js-video-title"><span class="vjs-video-title-span">'+this.video.title+"</span></div>")},this)),this.$el.addClass("pluto-video-ready"),this.vjsPlayer.options().inactivityTimeout=this.options.inactivityTimeout,this.videoViewCalled=!1,this.fiftyPercent=!1,this.ninetyFivePercent=!1,this.placement.embed&&(this.subviews.embed=new d({el:this.$el,addEmbedBtn:!0,analytics:h,baseUrl:this.options.baseUrl,onEmbedClose:this.onEmbedClose,onEmbedShow:this.onEmbedShow,siteDisplayName:this.options.siteDisplayName,videoId:this.video.id})),this.placement.share&&(this.video.short_url||this.video.full_url)&&(this.sv.share=this.subviews.plutoshare=this.initShare(this.$el,null,null))},onEmbedShow:function(){this.resumePlay=this.isPlaying(),this.exitFullScreen(),this.pauseVideo(),this.embedOpen=!0},onEmbedClose:function(){this.resumePlay&&this.playVideo(),this.embedOpen=!1},initAds:function(){this.sv.ads=this.subviews.plutoads=new a({adAccountId:s.getUrlParam("adaccountid"),adAccountName:s.getUrlParam("adaccountname"),adLabel:s.getUrlParam("adlabel"),adPlacement:s.getUrlParam("adplacement")||"preroll_video",adUnit:this.options.adUnit,cstObj:this.cstToObj(),el:this.el,ima3:s.getNested(window.site_vars,"html5video","ima3")||this.options.ima3,minimumAdLength:s.getNested(window.site_vars,"html5video","ima3","minimumAdLength"),onAdEnd:this.onAdEnd,onAdPause:this.onAdPause,onAdPlay:this.onAdPlay,onVolumeChange:this.onAdVolumeChange,pageInfo:this.options.pageInfo,placementData:this.placement,playVideo:this.playVideo,sstsObj:this.sstsToObj(),videoData:this.video,videoStart:this.options.videoStart,vjsPlayer:this.vjsPlayer,bidSlot:this.bidSlot})},initShare:function(e,t,i){return new r({analyticsEnabled:this.placement.analyticsEnabled,analytics:h,controlBarSelector:".vjs-control-bar",el:e,exitFullScreen:this.exitFullScreen,getPlutoAnalytics:this.getPlutoAnalytics,isVideoPlaying:this.isPlaying,onClose:i,onShare:t,pauseVideo:this.pauseVideo,placementName:this.placement.name,playVideo:this.playVideo,siteDisplayName:this.options.siteDisplayName,twitterAccount:this.options.twitterAccount,videoData:this.video})},getPlutoAnalytics:function(){return h||{}},getTitle:function(){return this.video.title},setupEventListeners:function(){this.hasListeners=!0,this.vjsEvents={contentplayback:this.onContentPlayback,fullscreenchange:this.onFullScreenChange,loadedmetadata:this.onLoadedMetadata,loadstart:this.onLoadStart,ended:this.onEnded,error:this.onPlaybackError,pause:this.onPause,play:this.onPlay,timeupdate:this.onTimeupdate,volumechange:this.onVolumeChange},t.each(this.vjsEvents,t.bind(function(e,i){this.vjsPlayer.on(i,t.bind(e,this))},this))},cstToObj:function(){var e=s.getNested(this.video,"cst")||"",t=e.split("/");return{section:t[0]||"",subsection:t[1]||"",topic:t[2]||""}},sstsToObj:function(){var e=s.getNested(this.video,"ssts")||"";if("string"==typeof e){var t=e.split("/");return{section:t[0]||"",subsection:t[1]||"",topic:t[2]||"",subtopic:t[3]||""}}return e},onFullScreenChange:function(){this.options.onFullScreenChange&&this.options.onFullScreenChange(),this.isFullScreen()&&!window.videoIsScrolling&&h&&h.trackVideoEvents("HTML5PlayerFullScreen")},onContentPlayback:function(){this.sv.ads&&this.sv.ads.adOverlayReset()},onLoadedMetadata:function(){this.textTracks=s.getNested(this.vjsPlayer,"mediainfo","textTracks")||[],this.textTracks.length?this.$(".vjs-captions-button").show():this.$(".vjs-captions-button").hide(),this.initPromise.resolve(this.vjsPlayer)},onLoadStart:function(){this.continuousPlay&&this.startAutoPlay()},callForAd:function(){this.shouldGetAd()?(this.adCallMade=!0,this.sv.ads.makeAdRequest(this.video)):this.buffering=!1},shouldGetAd:function(){return this.sv.ads&&this.isValidLocation()&&this.video.adsenabled&&!this.adCallMade&&window.noAds!==!0},isValidLocation:function(){return!(s.checkForEmail(document.referrer)||s.checkForEmail(window.location.href))},removeEventListeners:function(e){t.each(e,t.bind(function(e,t){this.vjsPlayer.off(t)},this))},onPlay:function(e){if(this.isAdPlaying()&&this.pauseVideo(),n.trigger("plutovideo:play",this.cid),(this.isPlaying()||!this.buffering)&&this.$el.removeClass("ui-pluto-reset"),window.videojs.IS_IPAD){var t=this.$el.children();t[0].classList.length||(t[0].style.display="none")}this.$(".pluto-video").show(),this.callForAd(),this.options.onVideoPlay&&this.options.onVideoPlay(),this.options.onGalleryPlay&&this.options.onGalleryPlay(),h.comscoreContentPlayback(this.video,this.vjsPlayer,this.placement.name)},onPlaybackError:function(){this.log(this.getVideoInfo(),"videoError")},getVideoInfo:function(){var e=this.vjsPlayer.options(),t={};try{t={account:e["data-account"],videoId:e["data-video-id"],playerId:e["data-player"],techOrder:e.techOrder.toString(),type:this.vjsPlayer.currentType(),src:this.vjsPlayer.currentSrc(),videoProgress:this.vjsPlayer.currentTime()}}catch(i){}return t},videoIsPlaying:function(e){e!==this.cid&&(this.sv.ads&&this.sv.ads.isAdInProgress()?this.sv.ads.pauseAd():this.pauseVideo(),h.stopComscoreTracking()),this.uwIframes.length&&t.each(this.uwIframes,t.bind(function(e,t){l.setPostMessage(!0,this.uwIframes[t].contentWindow,"universal-web-video-pause")},this))},onPause:function(){this.options.onPause&&this.options.onPause(),h.stopComscoreTracking()},onVolumeChange:function(e){this.options.onVolumeChange&&this.options.onVolumeChange(this.vjsPlayer.muted())},onAdVolumeChange:function(e){this.vjsPlayer.muted(e),this.options.onAdVolumeChange&&this.options.onAdVolumeChange(e)},onTimeupdate:function(e){var t,i=this.vjsPlayer.currentTime(),s=this.vjsPlayer.duration(),o=Math.round(i/s*100);this.pauseOnLoad&&(this.pauseVideo(),this.buffering=!1,this.resetPauseFlag()),this.isPlaying()&&!this.timeUpdateCalled&&(this.onAdEnd(),this.timeUpdateCalled=!0),!this.videoViewCalled&&o>=2&&(this.videoViewCalled=!0,t=window.videoIsScrolling?"scrollinghtml5":window.videoIsDocked?"dockedplayerhtml5":this.placement.name,this&&h&&h.trackVideoOnload(this.video,this.vjsPlayer,t)),!this.fiftyPercent&&o>=50&&95>o&&(this.fiftyPercent=!0,this&&h&&h.trackVideoProgression("50%",this.video.url)),!this.ninetyFivePercent&&o>=95&&99>=o&&(this&&h&&h.trackVideoProgression("95%",this.video.url),this.ninetyFivePercent=!0,this.placement.gannett_continuous_endslate&&this.options.isRecommended&&this.shouldIncludeRecommendation&&(this.placement.apsEnabled&&this.bidSlot&&n.trigger("nextVideoPlay",[{slotID:this.bidSlot.slotID,mediaType:"video"}]),this.options.getNextVideo())),100===o&&this.onEnded()},onEnded:t.debounce(function(){this.onEndedFired||(this.exitFullScreen(),this.placement.gannett_continuous_endslate&&this.options.isRecommended?(this.shouldIncludeRecommendation()&&(this.buffering=!0,this.irisEnabled||this.options.playNextVideo()),this.comscoreAdCallMade=!1):this.resetVideoState(),this.options.onEnded&&this.options.onEnded(),h.stopComscoreTracking(),this.onEndedFired=!0)},550),exitFullScreen:function(){this.isFullScreen()&&this.vjsPlayer.exitFullscreen()},isFullScreen:function(){return this.vjsPlayer.isFullscreen()},shouldIncludeRecommendation:function(){return"sponsor-story"!=this.options.pageInfo.section_name&&"sponsor-story"!=s.getNested(this.video,"ssts","section")},getVideoData:function(){return this.video},getPlacementData:function(){return this.placement},seekVideo:function(e){this.vjsPlayer&&this.vjsPlayer.currentTime(e)},pause:function(){this.isAdPlaying()?this.sv.ads.pauseAd():this.pauseVideo()},pauseVideo:function(){this.vjsPlayer&&!this.vjsPlayer.paused()&&this.vjsPlayer.pause()},playVideo:function(){(this.options.checkBrowserTabInactivity?s.isDocumentHidden():0)||(this.options.onPlayback&&this.options.onPlayback(),this.vjsPlayer&&this.vjsPlayer.play())},changeVideo:function(i){if(i){var n="ref:"+i.id;this.videoViewCalled=!1,this.fiftyPercent=!1,this.ninetyFivePercent=!1,this.continuousPlay=!0,h.resetMyStreamingTag(),this.vjsPlayer.catalog.getVideo(n,t.bind(function(t,n){n?(window.pbjs&&(s.getNested(window.site_vars,"html5video","prebid","enabled")||s.getUrlParam("pb_video_id"))&&(this.sv.ads.prebidPromise=this._getPrebid(i.id)),this.onEndedFired=!1,this.adCallMade=!1,this.video=i,this.sv.ads.options.videoStart="auto-continuous",this.sv.ads.options.pageInfo.series=i.series||"",this.sv.ads.options.pageInfo.topic=i.topic||"",this.initPromise=e.Deferred(),0===this.playerVolume?(this.vjsPlayer.muted(!0),this.sv.ads.playerVolume=0):(this.vjsPlayer.volume(this.playerVolume),this.sv.ads.playerVolume=this.playerVolume),this.vjsPlayer.catalog.load(n),this.sv.share&&(this.sv.share.options.videoData=i,this.sv.share.updateShareMetadata()),this.subviews.embed&&(this.subviews.embed.setIframeCode(!1),this.subviews.embed.updateVideoId(i.id))):(this.log(t,"continuousPlayError"),this.resetVideoState())},this))}},_getPrebid:function(i){var n=e.Deferred(),o="video-"+i;return window.pbjs.addAdUnits([{code:o,sizes:s.getNested(window.site_vars,"html5video","prebid","size")||[920,508],mediaType:"video",bids:[{bidder:"appnexusAst",params:{placementId:s.getUrlParam("pb_video_id")||s.getNested(window.site_vars,"ADS","prebid","appNexus","videoPlacementId")}}]}]),window.pbjs.requestBids({timeout:s.getNested(window.site_vars,"ADS","prebid","timeout")||800,adUnitCodes:[o],bidsBackHandler:t.bind(function(e){window.videoPrebidBids=window.videoPrebidBids||{},window.videoPrebidBids[o]=e[o],n.resolve()},this)}),n},getAd:function(){return this.sv.ads},onAdPlay:function(){if(this.buffering=!1,window.setTimeout(t.bind(function(){this.pauseOnLoad&&(this.pauseAd(),this.resetPauseFlag())},this),150),this.options.onAdPlay&&this.options.onAdPlay(),n.trigger("plutovideo:play",this.cid),!this.comscoreAdCallMade){var e=1e3*this.vjsPlayer.ima3.adPlayer.duration(),i=this.video.id||this.vjsPlayer.mediainfo.reference_id;h.stopComscoreTracking(),h.comscoreAdPlayback(i,e),this.comscoreAdCallMade=!0}},onAdEnd:function(){this.buffering=!1,this.getVideoProgressBar().show(),this.options.onAdEnd&&this.options.onAdEnd(),h.stopComscoreTracking(),this.vjsPlayer.paused()||h.comscoreContentPlayback(this.video,this.vjsPlayer,this.placement.name)},onAdPause:function(){this.options.onPause&&this.options.onPause();
},pauseAd:function(){this.sv.ads&&this.sv.ads.pauseAd()},startAutoPlay:function(){return this.initPromise.done(t.bind(function(){this.playVideo()},this))},toggleVolume:function(){this.vjsPlayer.muted(!this.vjsPlayer.muted())},resetVideoState:function(){this.vjsPlayer.pause().currentTime(0),this.$el.addClass("ui-pluto-reset"),this.onEndedFired=!1,this.videoViewCalled=!1,this.fiftyPercent=!1,this.ninetyFivePercent=!1,this.adCallMade=!1,h.stopComscoreTracking()},resetPauseFlag:function(){this.pauseOnLoad=!1},isPlaying:function(){return!this.vjsPlayer.paused()||this.isAdPlaying()},isAdPlaying:function(){return this.sv.ads&&this.sv.ads.isAdPlaying()},currentAd:function(){return this.sv.ads.currentAd},goFullscreen:function(){this.vjsPlayer.requestFullscreen()},getVideoProgressBar:function(){return this.$videoControlBar&&this.$videoProgressBar||(this.$videoControlBar=this.$(".vjs-control-bar:not(.vjs-ad-control-bar)"),this.$videoProgressBar=this.$videoControlBar.find(".vjs-progress-control")),this.$videoProgressBar},setVideoProgressBar:function(e){e.appendTo(this.$videoControlBar)},getAdProgressBar:function(){return this.$adControlBar&&this.$adProgressBar||(this.$adControlBar=this.$(".vjs-ad-control-bar"),this.$adProgressBar=this.$adControlBar.find(".vjs-progress-control")),this.$adProgressBar},setAdProgressBar:function(e){e.appendTo(this.$adControlBar)},dimVideo:function(e){var t=e?.5:1;this.$("#"+this.vjsPlayer.id()).css("opacity",t)},getVideoRunTime:function(){return this.video.length},getVideoCurrentTime:function(){var e;return e=this.sv.ads&&this.sv.ads.isAdInProgress()?this.vjsPlayer.ima3.adPlayer.currentTime():this.vjsPlayer.currentTime()},showShareOverlay:function(){this.sv.share&&this.sv.share.showShareOverlay()},isSeeking:function(){return this.vjsPlayer.seeking()},log:function(e,t){s.getNested(this.placement,"enableLogging")&&s.logAction&&s.logAction(this.options.actionName,{type:t,details:e,placement:this.placement.name,domain:s.getNested(window.site_vars,"site_key"),siteCode:s.getNested(window.site_vars,"site_code"),videoId:this.video.id})},destroy:function(){h.stopComscoreTracking(),h.resetMyStreamingTag(),this.hasListeners&&this.removeEventListeners(this.vjsEvents),window._cbv&&window._cbv.push(["removePlayer",this.vjsPlayer]),this.vjsPlayer&&this.vjsPlayer.dispose(),i.prototype.destroy.apply(this,arguments),this.sv={}}});return c}),define("modules/videos/pluto/pluto-video-bar",["jquery","underscore","baseview","state","pubsub","utils","template-utils","modules/videos/pluto/pluto-analytics"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({el:".js-pvb",minHeight:0,maxHeight:116,maxHeightWithBn:186,animateSpeed:250,breakingBarSpeed:200,breakingBarHeight:70,sponsorMessage:"Sponsor Message",analytics:{close:"scrolllingplayerclose",open:"scrollingplayeropen"},events:{"click .js-pvb-volume":"onVolumeToggle","click .js-play-control":"onPlayToggle","click .js-pvb-close":"onClose","click .js-pvb-fullscreen":"onFullScreen"},initialize:function(s){s=e.extend({plutoVideo:null},s),t.bindAll(this,"onBreakingBarOpen","onBreakingBarClose","onShare","onShareClose","resetVideoBar"),this.sv={},this.settings=o.getNested(window.site_vars,"html5video","scrollingPlayer"),this.$title=this.$(".js-pvb-title"),this.$playControl=this.$(".js-play-control"),this.$volumeControl=this.$(".js-pvb-volume"),this.$shareControl=this.$(".js-pvb-share"),this.$scrubber=this.$(".js-pvb-scrubber"),this.$siteNav=e(".site-nav-module"),this.$utilShareControls=e(".util-bar-primary-modules"),this.ad=this.options.plutoVideo.getAd(),this.options.plutoVideo.placement.share||this.$shareControl.hide(),this.setupNextVideo(),window.videojs.IS_IPAD&&this.$volumeControl.hide(),this.pubSub={"breakingbar:opening":this.onBreakingBarOpen,"breakingbar:closing":this.onBreakingBarClose},i.prototype.initialize.call(this,s),this.sv.share=this.subviews.share=this.options.plutoVideo.initShare(this.$el,this.onShare,this.onShareClose)},expand:function(){n.trigger("video:expandBar"),this.open=!0,this.showPauseButton();var e=this.ad.isAdInProgress();this.setupProgressBar(!e),this.adjustRunTime(!e),this.$siteNav.addClass("site-nav-item-dim"),this.$el.animate({height:this.maxHeight},this.animateSpeed,function(){n.trigger("video:after:expandBar")}),this.$(".bnm-container").height()?(this.onBreakingBarOpen(this.breakingBarSpeed),this.getUtilBar().css({top:"226px"})):this.getUtilBar().css({top:"156px"}),this.trackEvent(this.analytics.open)},collapse:function(){n.trigger("video:collapseBar"),this.open=!1,this.resetProgressBars(),this.options.plutoVideo.dimVideo(!1),this.sv.share&&this.sv.share.open&&(this.options.plutoVideo.showShareOverlay(),this.sv.share.hideShareOverlay()),this.$siteNav.removeClass("site-nav-item-dim"),this.getUtilBar().css({top:"auto"}),this.$el.animate({height:this.minHeight},this.animateSpeed),this.setParentMargin(this.minHeight)},getUtilBar:function(){return this.utilBar||(this.utilBar=e(".util-bar-primary-modules")),this.utilBar},setParentMargin:function(e){this.$el.parent().css("margin-top",e)},setTitle:function(e){e!==this.sponsorMessage&&(this.title=e),this.$title.text(this.truncateText(e,o.getNested(this.settings,"videoTitleLength")))},onVolumeToggle:function(){if(this.ad.isAdInProgress()){var e=this.ad.isAdMuted()?1:0;this.ad.setAdVolume(e),this.onVolumeChange(!e)}else this.options.plutoVideo.toggleVolume()},resetProgressBars:function(){(this.$videoProgressBar||this.$adProgressBar)&&(this.$videoProgressBar.removeClass("pvb-video-progress-bar"),this.options.plutoVideo.setAdProgressBar(this.$adProgressBar),this.options.plutoVideo.setVideoProgressBar(this.$videoProgressBar))},onPlayToggle:function(){this.ad.isAdInProgress()?this.toggleAdPlay():this.toggleVideoPlay()},toggleAdPlay:function(){this.ad.isAdPlaying()?(this.showPlayButton(),this.ad.pauseAd()):(this.showPauseButton(),this.ad.playAd())},toggleVideoPlay:function(){this.options.plutoVideo.isPlaying()?(this.showPlayButton(),this.options.plutoVideo.pauseVideo()):(this.showPauseButton(),this.options.plutoVideo.playVideo())},showPlayButton:function(){this.$playControl.removeClass("pvb-video-pause").addClass("pvb-video-play")},showPauseButton:function(){this.$playControl.removeClass("pvb-video-play").addClass("pvb-video-pause")},onVolumeChange:function(e){e?this.$volumeControl.removeClass("pvb-volume-on").addClass("pvb-volume-off"):this.$volumeControl.removeClass("pvb-volume-off").addClass("pvb-volume-on")},onClose:function(){this.trackEvent(this.analytics.close),this.options.onClose&&this.options.onClose(!0)},onFullScreen:function(){this.trackEvent("ScrollingPlayerFullScreen"),this.options.plutoVideo.goFullscreen()},setupNextVideo:function(){var i=s.getActivePageInfo().ssts.split("/");e.get("/videos/get_next_video/",{section:i[0]}).done(t.bind(function(e){if(e)try{this.$(".js-pvb-next-video-text").text(this.truncateText(e.title,o.getNested(this.settings,"nextVideoTitleLength"))),this.$(".js-pvb-next-video").attr("href",e._links.longUrl.href)}catch(t){this.hideNextVideo()}else this.hideNextVideo()},this))},hideNextVideo:function(){this.$(".js-pvb-next-video-container").css("visibility","hidden")},onBreakingBarOpen:function(e){this.breakingBar=!0,this.maxHeight<this.maxHeightWithBn&&(this.maxHeight+=this.breakingBarHeight),this.breakingBarSpeed=e,this.open&&this.$el.animate({height:this.maxHeight},this.breakingBarSpeed)},onBreakingBarClose:function(e){this.breakingBar=!0,this.maxHeight===this.maxHeightWithBn&&(this.maxHeight-=this.breakingBarHeight),this.breakingBarSpeed=e,this.open&&this.$el.animate({height:this.maxHeight},this.breakingBarSpeed)},onShare:function(){this.options.plutoVideo.dimVideo(!0)},onShareClose:function(){this.options.plutoVideo.dimVideo(!1),this.options.plutoVideo.isPlaying()&&this.showPauseButton()},adjustRunTime:function(e){var t;t=e?this.options.plutoVideo.getVideoRunTime():this.ad.getAdRunTime(),this.$(".js-pvb-video-time").text(t)},setupProgressBar:function(e){this.$adProgressBar&&this.$videoProgressBar||(this.$adProgressBar=this.options.plutoVideo.getAdProgressBar(),this.$videoProgressBar=this.options.plutoVideo.getVideoProgressBar()),this.$videoProgressBar.addClass("pvb-video-progress-bar"),this.$scrubber.append(this.$adProgressBar,this.$videoProgressBar),e||!this.ad.isAdInProgress()?(this.$adProgressBar.hide(),this.$videoProgressBar.show()):(this.$videoProgressBar.hide(),this.$adProgressBar.show())},onAdChange:function(e){this.adjustRunTime(e),this.open&&this.setupProgressBar(e),this.toggleShare(e),this.setSponsorMessage(e),this.showPauseButton(),this.sv.share&&(this.sv.share.options.videoData=this.options.plutoVideo.video,this.sv.share.updateShareMetadata())},toggleShare:function(e){this.sv.share&&(e?(this.$shareControl.removeClass("pvb-share-disabled"),this.sv.share.enableShare()):(this.sv.share.disableShare(),this.$shareControl.addClass("pvb-share-disabled")))},updateShare:function(){this.sv.share=this.subviews.share=this.options.plutoVideo.initShare(this.$el,this.onShare,this.onShareClose)},setSponsorMessage:function(e){e?this.setTitle(this.title):this.getCurrentTitleText()!==this.sponsorMessage&&this.setTitle(this.sponsorMessage)},getCurrentTitleText:function(){return this.$title.text()},trackEvent:function(e){r.trackVideoEvents(e)},truncateText:function(e,t){return a.smartTruncate(e,t,"...")},resetVideoBar:function(e){this.$adProgressBar=null,this.$adControlBar=null,this.$videoProgressBar=null,this.options.plutoVideo=e,this.ad=this.options.plutoVideo.getAd();var t=this.ad.isAdInProgress();this.open&&this.setupProgressBar(t),this.sv.share.updateShareMetadata(e.video)},destroy:function(){this.collapse(),i.prototype.destroy.apply(this,arguments),this.sv={}}});return l}),define("modules/videos/pluto/pluto-scroll",["jquery","underscore","baseview","utils","modules/videos/pluto/pluto-video-bar","modules/videos/pluto/pluto-analytics"],function(e,t,i,s,n,o){"use strict";var a=i.extend({initialize:function(o){o=e.extend({videoPlayer:null,videoData:null,toggleVolume:null,plutoVideo:null,placementData:null},o),i.prototype.initialize.call(this,o),this.$win=s.get("win"),this.vidHeight=this.$el.height(),this.scrollBreakpoint=this.vidHeight*parseFloat(s.getNested(window.site_vars,"html5video","scrollingPlayer","scrollBreakpoint"))-40,this.adBlacklist=s.getNested(window.site_vars,"html5video","scrollingPlayer","adBlacklist"),this.playerIsScrolling=!1,this.scrollListenerAttached=!1,this.$transitionWrap=e(".transition-wrap"),this.$videoPlacement=e(".js-pvb-video"),this.$siteWrap=e(".site-header-inner-wrap"),this.$breakingNews=e(".bnm-container"),this.$alertsManager=e(".alerts-manager-container"),this.$pvb=e(".js-pvb"),this.attachListeners(),this.subviews.videoBar=new n({plutoVideo:this.options.plutoVideo,onClose:t.bind(this.slideVideoIn,this)}),this.setupControls()},attachListeners:function(){this.scrollListenerAttached||(this.$win.on("scroll."+this.cid,t.bind(t.throttle(this.onScroll,100),this)),this.$win.on("resize."+this.cid,t.bind(t.throttle(this.handleResize,50),this)),this.scrollListenerAttached=!0)},blackListed:function(){var t=!1;if(this.options.plutoVideo.isAdPlaying()){var i=this.options.plutoVideo.currentAd();i&&i.id&&(t=e.inArray(i.id,this.adBlacklist)>-1)}return t},onScroll:function(){var e=this.$win.scrollTop();e>this.$el.offset().top+this.scrollBreakpoint?this.playerIsScrolling||!this.options.plutoVideo.isPlaying()||this.blackListed()||this.options.plutoVideo.pauseOnLoad||(this.slideVideoOut(),window.videoIsScrolling=!0):this.playerIsScrolling&&(o.trackVideoEvents("scrollingplayercollapse"),this.slideVideoIn(!1),window.videoIsScrolling=!1)},slideVideoOut:function(){this.animatePromise=e.Deferred(),this.getVideoElement(),this.playerIsScrolling=!0,this.toggleControls(!1);var i=this.$videoPlacement.position();this.$video.addClass("pvb-video-docked").css({left:i.left,height:0}).animate({height:96},250,t.bind(function(){this.animatePromise.resolve()},this)),this.options.videoPlayer.dimensions(170,96),this.moveBreakingBar(),this.movePrivacyPolicy(),this.subviews.videoBar.open||this.subviews.videoBar.expand()},slideVideoIn:function(e){this.animatePromise.done(t.bind(function(){this.getVideoElement(),this.playerIsScrolling=!1;var t=this.$el.css(["height","width"]);this.toggleControls(!0),this.$video.removeClass("pvb-video-docked").css({top:"",left:""}),this.options.videoPlayer.dimensions(t.width,t.height),this.subviews.videoBar.collapse(),this.revertBreakingBar(),this.revertPrivacyPolicy(),e&&(this.options.plutoVideo.buffering?this.options.plutoVideo.pauseOnLoad=!0:this.options.plutoVideo.isAdPlaying()?this.options.plutoVideo.pauseAd():this.options.plutoVideo.pauseVideo())},this))},updateVideoBar:function(e){this.subviews.videoBar.options.plutoVideo=e,this.$video=null,this.setElement(e.el),this.subviews.videoBar.resetVideoBar(e)},setupControls:function(){this.subviews.videoBar.setTitle(this.options.videoData.title)},toggleControls:function(e){this.options.videoPlayer.controls(e)},getVideoElement:function(){this.$video||(this.$video=this.$(".video-js"))},handleResize:function(){this.getVideoElement(),this.playerIsScrolling&&this.$video.css({left:this.$videoPlacement.position().left})},updateVideoBarTitle:function(e){this.subviews.videoBar.setTitle(e)},onVolumeChange:function(e){this.subviews.videoBar.onVolumeChange(e)},moveBreakingBar:function(){this.$breakingNews.appendTo(this.$pvb)},revertBreakingBar:function(){this.$breakingNews.appendTo(this.$siteWrap)},movePrivacyPolicy:function(){this.$pvb.after(this.$alertsManager)},revertPrivacyPolicy:function(){this.$alertsManager.appendTo(this.$siteWrap)},onAdPlay:function(){this.subviews.videoBar.onAdChange(!1)},onAdEnd:function(){this.subviews.videoBar.onAdChange(!0)},onPause:function(){this.options.plutoVideo.isSeeking()||this.subviews.videoBar.showPlayButton()},onVideoPlay:function(){this.options.plutoVideo.isPlaying()&&this.subviews.videoBar.showPauseButton()},onFullScreenChange:function(){this.playerIsScrolling&&this.toggleControls(this.options.plutoVideo.isFullScreen()),(this.options.plutoVideo.sv.share&&this.subviews.videoBar.sv.share&&this.options.plutoVideo.sv.share.open||this.options.plutoVideo.embedOpen)&&this.slideVideoIn()},destroy:function(){this.revertBreakingBar(),this.revertPrivacyPolicy(),delete window.videoIsScrolling,this.$win.off("."+this.cid),i.prototype.destroy.apply(this,arguments)}});return a}),define("modules/videos/pluto/pluto-endslate",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({el:".js-pluto-endslate",visible:!1,initialize:function(t){t=e.extend({contentUrl:"/videos/get_endslate/"},t),i.prototype.initialize.call(this,t),this.setupEndslate()},show:function(){this.visible=!0,this.$el.show()},close:function(){this.visible=!1,this.$el.hide()},setupEndslate:function(){e.get(this.options.contentUrl,t.bind(this.fillEndslate,this))},fillEndslate:function(t){if(t)try{this.$$(".js-360-endslate-link").each(function(i){t[i]&&(e(this).find(".js-360-endslate-anchor").attr({href:t[i].url}),e(this).find(".js-360-endslate-img").attr({src:t[i].image,alt:t[i].title}),e(this).find(".js-360-endslate-title").html(t[i].title))})}catch(i){}}});return s}),define("modules/videos/pluto/pluto-360",["jquery","underscore","baseview","utils","pubsub","modules/videos/pluto/pluto-share","modules/videos/pluto/pluto-utils","modules/videos/pluto/pluto-endslate","modules/videos/pluto/pluto-embed","modules/videos/pluto/pluto-analytics"],function(e,t,i,s,n,o,a,r,l,h){"use strict";var d=i.extend({isiPad:function(){return this.isApple},isSafari:function(){return navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")},isIE:function(){return navigator.userAgent.indexOf("MSIE")>-1||navigator.appVersion.indexOf("Trident/")>-1},supportsWebgl:function(){var e=!1;try{var t=document.createElement("canvas");e=window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))?!0:!1}catch(i){e=!1}return e},supports360:function(){return this.supported||(this.supported=this.supportsWebgl()&&!this.isiPad()&&!this.isSafari()&&!this.isIE()),this.supported},events:function(){return this.getEvents(!1)},getEvents:function(e){var t;return t=this.supports360()?e?{"click .js-360-replay":"replay","click .js-pluto-360-share":"onEndslateShare"}:{"click .js-360-play, .js-big-play-360":"onPlay","click .js-360-pause":"pause","click .js-fullscreen-control":"fullscreen","click .js-360-volume-toggle":"toggleVolume","click .js-360-volume-max":"changeVolume","click .js-360-instructions":"showInstructions","click .js-360-close-instructions":"closeInstructions","click .js-360-progress-wrap":"onSeek","click .js-pluto-share-link":"onShare","click .js-pluto-still":"onPlay",mouseenter:"onVideoFocus",mouseleave:"onVideoBlur",mousedown:"onMouseDown"}:{}},onShare:function(){this.pause()},initialize:function(n){if(n=e.extend(s.getNested(window.site_vars,"html5video","three60"),n),!this.supports360())return void this.showAppPromo();t.bindAll(this,"onEmbedClose","onEmbedShow","onEnd","onFullscreenChange","onMouseDown","onMouseMove","onMouseUp","postMessageEvent","replay","getAnalytics"),this.pubSub={"plutovideo:play":t.bind(this.videoIsPlaying,this)},i.prototype.initialize.call(this,n),window.pluto360Asset=!0,this.setConstants(),this.cacheElements(),this.setupPlayer(),this.addEventListeners(),this.stillImg=this.$(".js-pluto-still"),(this.placement.enableStaticEndslate||!this.placement.enableLoop)&&(this.subviews.endslate=this.createEndslate());var o={el:this.$el,addEmbedBtn:!1,baseUrl:this.options.baseUrl,onEmbedClose:this.onEmbedClose,onEmbedShow:this.onEmbedShow,siteDisplayName:this.options.siteDisplayName,videoId:this.video.id};this.placement.analyticsEnabled?(this.Analytics=this.getAnalytics(),this.Analytics.initAnalytics(this.options.liteAnalytics).done(t.bind(function(e){this.placement.embed&&(o.analytics=e,this.subviews.embed=new l(o)),this.placement.share&&(this.subviews.plutoshare=this.initShare(this.$el,e))},this))):(this.placement.embed&&(this.subviews.embed=new l(o)),this.placement.share&&(this.subviews.plutoshare=this.initShare(this.$el,null)))},getAnalytics:function(){return h},setConstants:function(){this.video=a.buildData(this.$(".ui-video-data")),this.placement=a.buildData(this.$(".ui-video-placement-data")),this.controlAnimateSpeed=500,this.dragging=!1,this.controlsVisible=!1,this.inactiveTimer=this.options.inactiveTimer,this.controlCollapseDelay=this.options.controlCollapseDelay,this.responsive=this.placement.responsive||!1,this.enablePostMessage=this.placement.enablePostMessage||!1,this.enableInstructions="undefined"!=typeof this.placement.enableInstructions?this.placement.enableInstructions:!0,this.enableInactiveTimer="undefined"!=typeof this.placement.enableInactiveTimer?this.placement.enableInactiveTimer:!0,this.muteOnStart=this.placement.muteOnStart||!1,this.firstPlay=!0},cacheElements:function(){this.$currentTimeSlot=this.$(".js-pluto-360-current-time"),this.$playProgress=this.$(".js-360-progress"),this.$controls=this.$(".js-pluto-360-controls"),this.$dockedMouse=this.$(".js-360-docked-mouse")},setupPlayer:function(){this.requirePlayer().done(t.bind(function(e,t){this.player=this.initPlayer(e,t),this.player.render(),this.player.on("ended",this.onEnd),this.player.on("fullscreenchange",this.onFullscreenChange),this.muteOnStart&&this.mute(),this.autoplay()&&this.play(!0)},this))},postMessageEvent:function(e){a.postMessageEvent(this,e)},addEventListeners:function(){this.$doc=s.get("document"),this.$doc.on("mousemove."+this.cid,this.onMouseMove),this.$doc.on("mouseup."+this.cid,this.onMouseUp),a.getPostMessage(this.enablePostMessage,this.postMessageEvent),this.responsive&&e(window).resize(t.throttle(t.bind(function(){this.player.size(window.innerWidth,window.innerHeight)},this),250))},createEndslate:function(){return new r({contentUrl:"/videos/get_endslate/"})},autoplay:function(){return s.getUrlParam("autoplay")||this.placement.autoplay},generateSrc:function(){return s.getUrlParam("src")||this.video.highest_rendition||this.video.preview_url},onEmbedShow:function(){this.resumePlay=this.player.state.isPlaying,this.pause(),this.player.state.isFullscreen&&this.fullscreen()},onEmbedClose:function(){this.resumePlay&&this.play(!1)},replay:function(){this.onLoadViewCalled=!1,this.placement.analyticsEnabled&&this.Analytics.trackVideoEvents("360Replay"),this.twentyFivePercentCalled=!1,this.fiftyPercentCalled=!1,this.seventyFivePercentCalled=!1,this.ninetyFivePercent=!1,this.interactionCalled=!1,this.$$(".pluto-360-control").css("opacity",1),this.subviews.endslate&&this.subviews.endslate.close(),this.onEndslateShare(),this.delegateEvents(this.getEvents(!1)),this.play(!1),this.firstPlay=!1,this.placement.enableLoop||a.setPostMessage(this.enablePostMessage,parent,"replay")},showAppPromo:function(){this.$(".js-360-app-promo").show()},initPlayer:function(e,t){var i={autoplay:!1,crossorigin:!0,fov:this.options.fov,height:this.responsive?window.innerHeight:this.placement.height,isClickable:!1,loop:!1,muted:!1,preload:!0,resizable:this.responsive,src:this.generateSrc(),volume:.5,width:this.responsive?window.innerWidth:this.placement.width};return this.hlsIncluded&&t&&(i.loader=this.loader(t)),new e(this.$(".js-pluto-360")[0],i)},loader:function(e){return function(t,i,s){var n=new e;n.loadSource(i),n.attachMedia(s),n.on(e.Events.MANIFEST_PARSED,function(e,i){n.loadLevel=i.levels.length-1,t.texture&&(t.texture.needsUpdate=!0)})}},requirePlayer:function(){var i=["player"],n=e.Deferred(),o=require.config({paths:{player:this.options.playerUrl,hls:this.options.hlsSupport}});return"hls"===s.getUrlParam("format")&&(this.hlsIncluded=!0,i.push("hls")),o(i,t.bind(function(){var e=arguments[0],t=arguments[1]||null;n.resolve(e,t)},this)),n},initShare:function(e,t){return new o({analytics:t,analyticsEnabled:this.placement.analyticsEnabled,controlBarSelector:".js-pluto-360-share",el:e,layout:"minimal",placementName:this.placement.name,siteDisplayName:this.options.siteDisplayName,twitterAccount:this.options.twitterAccount,videoData:this.video})},onMouseDown:function(e){this.mouseDown=!0},onMouseMove:function(e){this.mouseDown&&(this.interactionCalled||(this.interactionCalled=!0,this.placement.analyticsEnabled&&this.Analytics.trackVideoEvents("360Interaction"),a.setPostMessage(this.enablePostMessage,parent,"interaction360")),this.dragging=!0,e.preventDefault(),this.subviews.endslate&&!this.subviews.endslate.visible&&this.$dockedMouse.addClass("pluto-360-mouse-nav-hidden"))},onMouseUp:function(e){e.preventDefault(),this.mouseDown&&this.dragging&&(this.dragging=!1,this.inactivityTimeout&&clearTimeout(this.inactivityTimeout),this.startInactiveTimer()),this.mouseDown=!1},startInactiveTimer:function(){this.mouseShown||(this.inactivityTimeout&&clearTimeout(this.inactivityTimeout),this.inactivityTimeout=setTimeout(t.bind(function(){this.mouseShown=!0,this.$dockedMouse.removeClass("pluto-360-mouse-nav-hidden")},this),this.inactiveTimer))},onPlay:function(){this.stillImg.hide(),this.play(!0)},play:function(e){a.setPostMessage(this.enablePostMessage,parent,"play"),this.fireViewCall(),this.togglePlayControls(!0),this.placement.analyticsEnabled&&this.Analytics.comscoreContentPlayback(this.video,this.player,this.placement.name),this.enableInstructions&&e&&!this.instructionsAlreadyViewed()?this.showEdOverlay(!0):this.startPlayback()},fireViewCall:function(){this.onLoadViewCalled||(this.onLoadViewCalled=!0,this.placement.analyticsEnabled&&this.Analytics.trackVideoOnload(this.video,this.player,this.placement.name))},startPlayback:function(){n.trigger("plutovideo:play",this.cid),this.player.play(),this.firstPlay&&(this.startInactiveTimer(),this.firstPlay=!1),this.startProgressInterval()},onEnd:function(){this.player.state.isFullscreen&&this.fullscreen(),this.clearControlCollapseDelay(),this.delegateEvents(this.getEvents(!0)),this.player.seek(0),this.subviews.endslate?this.subviews.endslate.show():(this.stillImg.show(),this.$$(".js-big-play-360").show()),this.onEndslateShare(),this.$$(".pluto-360-control").css("opacity",".25"),this.togglePlayControls(null),this.expandControls(0),this.placement.analyticsEnabled&&this.Analytics.stopComscoreTracking(),this.placement.enableLoop&&this.replay()},showEdOverlay:function(e){this.$dockedMouse.addClass("pluto-360-mouse-nav-hidden"),this.$$(".js-360-instructions-overlay").fadeIn(500,t.bind(function(){this.instructionsViewed(),e&&setTimeout(t.bind(function(){this.resumePlay=!0,this.closeInstructions()},this),this.options.userEdDisplayDuration)},this))},pause:function(){this.clearProgressInterval(),this.player.pause(),this.togglePlayControls(!1),a.setPostMessage(this.enablePostMessage,parent,"pause"),this.placement.analyticsEnabled&&this.Analytics.stopComscoreTracking()},startProgressInterval:function(){this.updateCurrentTime(this.player.video.currentTime),this.updateProgressBar(this.player.video.currentTime),this.timeUpdateInterval=setInterval(t.bind(function(){this.updateCurrentTime(this.player.video.currentTime),this.updateProgressBar(this.player.video.currentTime);var e=Math.round(this.player.video.currentTime/this.player.video.duration*100);!this.twentyFivePercentCalled&&e>=25&&50>e?(this.twentyFivePercentCalled=!0,this.fireProgressAnalytic("25%",this.player.src()),a.setPostMessage(this.enablePostMessage,parent,"25")):!this.fiftyPercentCalled&&e>=50&&75>e?(this.fiftyPercentCalled=!0,this.fireProgressAnalytic("50%",this.player.src()),a.setPostMessage(this.enablePostMessage,parent,"50")):!this.seventyFivePercentCalled&&e>=75&&95>e?(this.seventyFivePercentCalled=!0,this.fireProgressAnalytic("75%",this.player.src()),a.setPostMessage(this.enablePostMessage,parent,"75")):!this.ninetyFivePercent&&e>=95&&99>e&&(this.ninetyFivePercent=!0,this.fireProgressAnalytic("95%",this.player.src()),a.setPostMessage(this.enablePostMessage,parent,"95"))},this),500)},fireProgressAnalytic:function(e,t){this.placement.analyticsEnabled&&this.Analytics.trackVideoProgression(e,t)},clearProgressInterval:function(){this.timeUpdateInterval&&clearInterval(this.timeUpdateInterval)},onSeek:function(t){this.clearProgressInterval(),this.player.seek(this.getClickOffset(t)/e(t.currentTarget).innerWidth()*this.player.video.duration,!0),this.startProgressInterval()},getClickOffset:function(e){return void 0===e.offsetX?e.originalEvent.layerX:e.offsetX},togglePlayControls:function(e){return this.subviews.endslate&&this.subviews.endslate.visible?(this.$$(".js-360-play").hide(),this.$$(".js-360-pause").hide(),void this.$$(".js-360-replay").show()):void(e?(this.$$(".js-360-play").hide(),this.$$(".js-big-play-360").hide(),this.$$(".js-360-pause").show(),this.$$(".js-360-replay").hide()):(this.$$(".js-360-pause").hide(),this.$$(".js-360-play").show(),this.$$(".js-360-replay").hide()))},updateCurrentTime:function(e){var t=Math.floor(e/60),i=parseInt(e%60),s=t+":"+(10>i?"0":"")+i;this.$currentTimeSlot.html(s)},updateProgressBar:function(e){var t=e/this.player.video.duration*100,i=Math.round(100*t)/100;this.$playProgress.css("width",i+"%")},fullscreen:function(){this.placement.analyticsEnabled&&this.Analytics.trackVideoEvents(this.player.state.isFullscreen?"360CloseFullscreen":"360Fullscreen"),this.player.fullscreen(this.player.state.isFullscreen?!1:this.el)},onFullscreenChange:function(){this.player.state.isFullscreen?this.$el.addClass("pluto-360-fullscreen"):this.$el.removeClass("pluto-360-fullscreen")},toggleVolume:function(){this.player.video.muted?this.unMute():this.mute()},mute:function(){this.player.mute(!0),this.$$(".js-360-mute").show(),this.$$(".js-360-volume").hide(),this.$$(".js-360-volume-active").hide(),this.player.state.isPlaying&&a.setPostMessage(this.enablePostMessage,parent,"mute")},unMute:function(){this.player.mute(!1),this.$$(".js-360-mute").hide(),this.$$(".js-360-volume").show(),this.$$(".js-360-volume-active").show(),a.setPostMessage(this.enablePostMessage,parent,"unmute")},changeVolume:function(e){this.player.video.muted&&this.toggleVolume();var t=this.getClickOffset(e);this.$$(".js-360-volume-active").css("width",t),this.setVolume(t/this.$$(".js-360-volume-max").innerWidth())},setVolume:function(e){this.player.volume(e)},showInstructions:function(){this.placement.analyticsEnabled&&this.Analytics.trackVideoEvents("360Instructions"),this.subviews.plutoshare&&this.subviews.plutoshare.hideShareBar(),this.resumePlay=this.player.state.isPlaying,this.pause(),this.showEdOverlay(!1)},closeInstructions:function(){this.placement.analyticsEnabled&&this.Analytics.trackVideoEvents("360CloseInstructions"),this.hideInstructions().done(t.bind(function(){this.$$(".js-360-mouse").removeClass("pluto-360-mouse-navigation-docked"),this.resumePlay&&this.play(!1)},this))},hideInstructions:function(){return this.$$(".js-360-mouse").addClass("pluto-360-mouse-navigation-docked"),this.$dockedMouse.removeClass("pluto-360-mouse-nav-hidden"),this.$$(".js-360-instructions-overlay").fadeOut(500).promise()},instructionsAlreadyViewed:function(){return s.getSessionData("360VideoInstructionsViewed",!1)},instructionsViewed:function(){s.setSessionData("360VideoInstructionsViewed",!0)},onVideoFocus:function(e){this.clearControlCollapseDelay(),this.controlsVisible||(this.controlsVisible=!0,this.controlAnimationPromise?this.controlAnimationPromise.done(t.bind(function(){this.expandControls(this.controlAnimateSpeed)},this)):this.expandControls(this.controlAnimateSpeed))},onVideoBlur:function(e){this.clearControlCollapseDelay(),this.subviews.endslate&&!this.subviews.endslate.visible&&(this.collapseControlTimeout=setTimeout(t.bind(function(){this.collapseControls()},this),this.controlCollapseDelay))},clearControlCollapseDelay:function(){this.collapseControlTimeout&&clearTimeout(this.collapseControlTimeout)},expandControls:function(e){this.$controls.stop().show().animate({height:"33px"},e),this.$$(".pluto-360-progress-wrap-docked").css("opacity",0),this.$dockedMouse.css({bottom:"43px"})},collapseControls:function(){this.controlsVisible=!1,this.controlAnimationPromise=e.Deferred(),this.$dockedMouse.css({bottom:"14px"}),this.$$(".pluto-360-progress-wrap-docked").css("opacity",1),this.$controls.animate({height:"0"},this.controlAnimateSpeed,t.bind(function(){this.$controls.hide(),this.controlAnimationPromise.resolve()},this))},onEndslateShare:function(){this.placement.share&&(this.subviews.plutoshare.open&&this.subviews.endslate.visible?this.$$(".js-pluto-360-share").css("background","rgba(0,0,0,.55)"):this.$$(".js-pluto-360-share").css("background","initial"))},videoIsPlaying:function(e){e!==this.cid&&this.pause()},destroy:function(){this.placement.analyticsEnabled&&(this.Analytics.stopComscoreTracking(),this.Analytics.resetMyStreamingTag()),this.supports360()&&(this.$doc.off("."+this.cid),this.player&&this.player.destroy(),clearInterval(this.timeUpdateInterval)),delete window.pluto360Asset,i.prototype.destroy.apply(this,arguments)}});return d}),define("modules/videos/pluto/pluto-title-bar",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({events:{"click .js-ptb-close":"close"},initialize:function(t){t=e.extend({titleLength:42,onClose:null,title:"",adText:"Sponsor Message"},t),i.prototype.initialize.call(this,t),this.setTitle(t.title)},close:function(){this.collapse(),this.options.onClose&&this.options.onClose()},collapse:function(){this.$el.css("top","0px")},setEl:function(e){this.setElement(e)},setTitle:function(e){this.$$(".pluto-title-bar-text").text(this.truncate(e))},show:function(){this.$el.stop().animate({top:"-26px"},200)},showAdText:function(){this.setTitle(this.options.adText)},truncate:function(e){return e.length>this.options.titleLength?e.substring(0,this.options.titleLength)+"...":e}});return s}),define("modules/videos/pluto/pluto-sp",["jquery","underscore","baseview","utils","pubsub","modules/videos/pluto/pluto-title-bar"],function(e,t,i,s,n,o){"use strict";var a=i.extend({events:{},initialize:function(n){n=e.extend({plutoVideo:null,analytics:{clickedClose:"dockedplayerclosed",collapsedOnScroll:"dockedplayercollapsed",
open:"dockedplayeropen"}},n),i.prototype.initialize.call(this,n),s.getNested(window.site_vars,"html5video","scrollingPlayer","titleBar")&&(this.subviews.tb=new o({el:this.$(".js-ptb"),onClose:t.bind(this.onClose,this),title:this.options.plutoVideo.getTitle()})),this.$win=s.get("win"),this.vidHeight=this.$el.height(),this.vidWidth=this.$el.width(),this.dockedHeight=s.getNested(window.site_vars,"html5video","scrollingPlayer","dockedHeight"),this.dockedWidth=s.getNested(window.site_vars,"html5video","scrollingPlayer","dockedWidth"),this.$placeholder=this.$el.prev(".js-video-placeholder"),this["break"]=parseFloat(s.getNested(window.site_vars,"html5video","scrollingPlayer","scrollBreakpoint")),this.nav=e(".site-header-inner-wrap"),this.scrollBreakpoint=this.vidHeight*this["break"],this.adBlacklist=s.getNested(window.site_vars,"html5video","scrollingPlayer","adBlacklist"),this.playerIsScrolling=!1,this.attachListeners()},attachListeners:function(){this.$win.on("scroll."+this.cid,t.bind(t.throttle(this.onScroll,100),this))},onClose:function(){n.trigger("uotrack",this.options.analytics.clickedClose),this.playerIsScrolling=!1,this.updateScrollingClass(!1),this.resizePlayer(this.vidWidth,this.vidHeight),this.options.plutoVideo.pause(),this.options.plutoVideo.buffering&&(this.options.plutoVideo.pauseOnLoad=!0),this.reset()},onScroll:function(){var t=this.$win.scrollTop();this.navOffset=this.nav.position().top+this.nav.height(),t>this.$el.parent().offset().top+this.scrollBreakpoint-this.navOffset?this.playerIsScrolling||!this.options.plutoVideo.isPlaying()||this.options.plutoVideo.pauseOnLoad||this.slideVideoOut():(this.slidingIn&&this.$el.css("bottom",e(window).height()-(this.$placeholder.offset().top+this.vidHeight)+e(window).scrollTop()-10),this.playerIsScrolling&&this.slideVideoIn(!1))},reset:function(){this.updateScrollingClass(!1),this.$el.css({position:"relative",top:"",left:"",right:"",bottom:"",height:this.vidHeight+"px",width:this.vidWidth+"px","margin-bottom":"","z-index":""})},resizePlayer:function(e,t){this.options.plutoVideo.vjsPlayer.dimensions(e,t)},sendOut:function(){this.resizePlayer(this.dockedWidth,this.dockedHeight),this.$el.css({bottom:0,height:this.dockedHeight,"margin-bottom":0,position:"fixed",right:0,width:this.dockedWidth,"z-index":99999})},showAdText:function(){this.subviews.tb&&this.subviews.tb.showAdText()},slideVideoOut:function(){this.slideInPromise?this.slideInPromise.done(t.bind(function(){this.moveItOut()},this)):this.moveItOut()},slideVideoIn:function(){this.slideInPromise=e.Deferred(),this.slideOutPromise.done(t.bind(function(){this.subviews.tb&&this.subviews.tb.collapse(),this.playerIsScrolling=!1,this.slidingIn=!0,this.$el.css({bottom:e(window).height()-(this.$placeholder.offset().top+this.vidHeight)+e(window).scrollTop()-10,right:e(window).width()-(this.$placeholder.offset().left+this.vidWidth),height:this.vidHeight,width:this.vidWidth,margin:""}),this.resizePlayer(this.vidWidth,this.vidHeight),this.$el.one(this.getTransitionEndListener(),t.bind(function(){this.slidingIn=!1,this.reset(),this.$el.off(this.getTransitionEndListener()),window.videoIsDocked=!1,n.trigger("uotrack",this.options.analytics.collapsedOnScroll),this.slideInPromise.resolve()},this))},this))},moveItOut:function(){this.playerIsScrolling=!0,this.slideOutPromise=e.Deferred();var i=e(window).height()-this.vidHeight+(this.vidHeight-this.scrollBreakpoint)+this.navOffset;this.$el.css({bottom:i,"margin-bottom":0,position:"fixed","z-index":99999,right:e(window).width()-(this.$el.offset().left+this.vidWidth)}),this.subviews.tb&&this.subviews.tb.show(),this.updateScrollingClass(!0),this.resizePlayer(this.dockedWidth,this.dockedHeight),this.$el.css({right:0,bottom:0,width:this.dockedWidth,height:this.dockedHeight}),this.$el.one(this.getTransitionEndListener(),t.bind(function(){this.$el.off(this.getTransitionEndListener()),window.videoIsDocked=!0,n.trigger("uotrack",this.options.analytics.open),this.slideOutPromise.resolve()},this))},updateScrollingClass:function(e){e&&this.playerIsScrolling?this.$el.parent().addClass("playerIsScrolling"):this.$el.parent().removeClass("playerIsScrolling")},updateTitle:function(e){this.subviews.tb&&this.subviews.tb.setTitle(e)},updateVideo:function(t){this.reset(),this.options=e.extend(this.options,{el:t.el,plutoVideo:t}),this.setElement(t.el),this.subviews.tb&&this.subviews.tb.setEl(this.$(".js-ptb")),this.updateTitle(t.getTitle()),this.$placeholder=this.$el.prev(".js-video-placeholder"),this.playerIsScrolling&&(this.sendOut(),this.subviews.tb&&this.subviews.tb.show(),this.updateScrollingClass(this.playerIsScrolling))},getTransitionEndListener:function(){if(this.transitionType)return this.transitionType;this.transitionType="transitionend";var e={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",MozTransition:"transitionend",transition:"transitionend"};for(var t in e)if(void 0!==this.el.style[t]){this.transitionType=e[t];break}return this.transitionType},destroy:function(){this.reset(),i.prototype.destroy.call(this)}});return a}),define("modules/videos/pluto/iris-recommendation",["jquery","underscore","baseview","fwinfo","managers/routemanager","state","utils"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({initialize:function(s){s=e.extend({id:null,placementName:null,playRecommendedVideo:null,resetVideoState:null,videoId:null,vjsPlayer:null},s),i.prototype.initialize.call(this,s),t.bindAll(this,"currentDuration","currentTime","playNext"),this.irisOptions={settings:{client_token:a.getNested(window.site_vars,"THIRDPARTYAPI","Iris","client_token"),number:a.getNested(window.site_vars,"THIRDPARTYAPI","Iris","number"),platform:"Brightcove",platform_id:this.options.videoId,player_id:this.options.id,ssl:!0},iris_buttons:{thumbs_up:a.getNested(window.site_vars,"THIRDPARTYAPI","Iris","thumbs_up"),thumbs_down:a.getNested(window.site_vars,"THIRDPARTYAPI","Iris","thumbs_down"),skip_forward:a.getNested(window.site_vars,"THIRDPARTYAPI","Iris","skip_forward"),skip_back:a.getNested(window.site_vars,"THIRDPARTYAPI","Iris","skip_back")}},this.texttype=o.getActivePageInfo().texttype||"story",this.pageType=o.getActivePageInfo().basePageType||"",this.initPlugin()},currentDuration:function(){return this.options.vjsPlayer.duration()||0},currentTime:function(){try{return this.options.vjsPlayer.currentTime()}catch(e){return console.log(e),0}},initPlugin:function(){this.requireScript().done(t.bind(function(){this.irisEngine=window.initializeIrisPlugin(this.irisOptions),this.irisEngine.registerFunction("currentDuration",this.currentDuration),this.irisEngine.registerFunction("currentTime",this.currentTime),this.irisEngine.registerFunction("onAdEnd",this.onAdEnd()),this.irisEngine.registerFunction("onAdPlay",this.onAdPlay()),this.irisEngine.registerFunction("play",this.playNext)},this))},logError:function(e,t){a.logAction&&a.logAction("IrisRecommendation",{type:"recommendationError",details:e,placement:this.options.placementName,domain:a.getNested(window.site_vars,"site_key"),siteCode:a.getNested(window.site_vars,"site_code"),videoId:t?t:""})},onAdEnd:function(){this.irisEngine.emit("AD_END",!0),this.$$(".ib-ctrl").css("display","block")},onAdPlay:function(){this.irisEngine.emit("AD_START")},playNext:function(e){var i="";this.response={},e&&e.referenceId?o.fetchData("/videos/services/"+e.referenceId).done(t.bind(function(t){this.response=t,this.response&&(s.setsessionvalue("clickName","iris-autoplay"),"video-cinematic"===this.pageType||-1!==["video","video-playlist","brightcove-video-playlist"].indexOf(this.texttype)?(i="video-cinematic"===this.pageType?"/media/cinematic/video/"+e.referenceId:t.url.replace(/^.*\/\/[^\/]+/,""),n.goTo(i)):this.options.playRecommendedVideo(this.response))},this)).fail(t.bind(function(){this.logError("Fetch data error",e.referenceId)},this)):(this.logError("Empty recommendation"),this.options.resetVideoState())},requireScript:function(){var i=e.Deferred(),s=require.config({paths:{irisRecommendation:a.getNested(window.site_vars,"THIRDPARTYAPI","Iris","script_url")}});return s(["irisRecommendation"],t.bind(function(){i.resolve()},this)),i}});return r}),define("modules/videos/pluto/pluto-wrapper",["jquery","underscore","baseview","state","modules/stories/taboola-recommendations","managers/autoplay","pubsub","modules/videos/pluto/pluto-video","modules/videos/pluto/pluto-scroll","modules/videos/pluto/pluto-360","modules/videos/pluto/pluto-sp","modules/videos/pluto/iris-recommendation","admanager","utils"],function(e,t,i,s,n,o,a,r,l,h,d,c,u,p){"use strict";var f=i.extend({initialize:function(n){return n=e.extend({isRecommended:!0,initializeScroll:!0},n),i.prototype.initialize.call(this,n),this.$(".js-pluto-360-container").length>0?void(this.subviews.pluto360=new h({el:this.$(".js-pluto-360-container"),siteDisplayName:p.getNested(window.site_vars,"display_name"),twitterAccount:p.getNested(window.site_vars,"twitter","default_account")})):(t.bindAll(this,"getNextRecommendation","onAdEnd","onAdPlay","onAdVolumeChange","onEnded","onFullScreenChange","onPause","onVideoPlay","onVolumeChange","playNextRecommendation","playRecommendedVideo","startAutoPlay","onPlayback"),this.sv={},this.sv.video=this.subviews.plutovideo=new r({adUnit:u.buildAdUnit("preroll_video"),el:this.$el,getNextVideo:this.getNextRecommendation,isRecommended:this.options.isRecommended,pageInfo:s.getActivePageInfo(),playNextVideo:this.playNextRecommendation,onAdEnd:this.onAdEnd,onAdPlay:this.onAdPlay,onAdVolumeChange:this.onAdVolumeChange,onEnded:this.onEnded,onFullScreenChange:this.onFullScreenChange,onGalleryPlay:this.options.onGalleryPlay,onPause:this.onPause,onPlayback:this.onPlayback,onVideoPlay:this.onVideoPlay,onVolumeChange:this.onVolumeChange,siteDisplayName:p.getNested(window.site_vars,"display_name"),twitterAccount:p.getNested(window.site_vars,"twitter","default_account"),videoStart:this.options.videoStart,isFirstPlaylistVideoMuted:this.options.isFirstPlaylistVideoMuted}),this.options.initializeScroll&&this.sv.video.placement.scrollingplayer&&(p.getNested(window.site_vars,"html5video","scrollingPlayer","docked")?this.sv.video.initPromise.done(t.bind(function(){this.sv.sp=this.subviews.sp=new d({el:this.$el,plutoVideo:this.sv.video})},this)):this.sv.video.initPromise.done(t.bind(function(e){this.sv.scroll=this.subviews.plutoScroll=new l({el:this.$el,placementData:this.sv.video.placement,plutoVideo:this.sv.video,videoData:this.sv.video.video,videoPlayer:e})},this))),this.pubSub={"pause:videos":this.sv.video.onPause},a.attach(this.pubSub,this),this.sv.video.placement.autoplay&&!this.isApple&&o.register("pluto-video",this.startAutoPlay),this.irisEnabled=p.getNested(window.site_vars,"THIRDPARTYAPI","Iris","enabled"),this.irisSectionEnabled=p.getNested(window.site_vars,"THIRDPARTYAPI","Iris","enable_by_section"),this.irisSection=p.getNested(window.site_vars,"THIRDPARTYAPI","Iris","section"),this.pageSection=s.getActivePageInfo().section_name,this.texttype=s.getActivePageInfo().texttype,this.showIrisRecommendation=this.irisEnabled||this.irisSectionEnabled&&this.pageSection===this.irisSection&&("blog"==this.texttype||"story"==this.texttype),void 0)},onEnded:function(){s.startRefreshTimer(),this.options.onEnded&&this.options.onEnded()},onVolumeChange:function(e){this.options.onVolumeChange?this.options.onVolumeChange(e):this.sv.scroll&&this.sv.scroll.onVolumeChange(e)},onAdVolumeChange:function(e){this.options.onAdVolumeChange?this.options.onAdVolumeChange(e):this.sv.scroll&&this.sv.scroll.onVolumeChange(e)},onAdPlay:function(){this.onPlayback(),this.sv.iris&&this.sv.iris.onAdPlay(),this.options.onAdPlay?this.options.onAdPlay():this.sv.scroll&&this.sv.scroll.onAdPlay(),this.sv.sp&&this.sv.sp.showAdText()},onPlayback:function(){this.showIrisRecommendation&&!this.sv.iris&&"video-playlist"!==this.sv.video.video.type&&(this.sv.iris=this.subviews.iris=new c({id:this.sv.video.vjsPlayer.id(),placementName:this.sv.video.placement.name,playRecommendedVideo:this.playRecommendedVideo,resetVideoState:this.sv.video.resetVideoState,videoId:this.sv.video.video.id,vjsPlayer:this.sv.video.vjsPlayer})),s.stopRefreshTimer()},onAdEnd:function(){this.options.onAdEnd?this.options.onAdEnd():this.sv.scroll&&this.sv.scroll.onAdEnd(),this.sv.iris&&this.sv.iris.onAdEnd(),this.sv.sp&&this.sv.sp.updateTitle(this.sv.video.getTitle())},onPause:function(){this.options.onPause?this.options.onPause():this.sv.scroll&&this.sv.scroll.onPause()},onVideoPlay:function(){this.onPlayback(),this.options.onVideoPlay?this.options.onVideoPlay():this.sv.scroll&&this.sv.scroll.onVideoPlay(),this.sv.sp&&this.sv.sp.updateTitle(this.sv.video.getTitle())},playVideo:function(){this.sv.video.playVideo()},startAutoPlay:function(){return this.sv.video.startAutoPlay(),!0},getNextRecommendation:function(){this.showIrisRecommendation||(this.sv.recommend||(this.sv.recommend=this.subviews.TaboolaOutbrain=new n({playRecommendedVideo:this.playRecommendedVideo,isContinuousEndslate:!0})),this.sv.recommend.renderEndslate(this.sv.video.video.url,this.sv.video.video.id))},playRecommendedVideo:function(e){this.updateSimpleTarget(e.description),this.sv.video.vjsPlayer.muted()?this.sv.video.playerVolume=0:this.sv.video.playerVolume=this.sv.video.vjsPlayer.volume(),this.sv.video.vjsPlayer.reset(),this.sv.video.changeVideo(e),this.$el.parent().find(".video-desc").html(e.description+"<span class=credit>"+e.credit+"</span>"),this.sv.scroll&&this.sv.scroll.updateVideoBarTitle(e.title)},updateSimpleTarget:function(e){var i=p.getNested(window.site_vars,"ADS","simple_categories");i&&(window.simpleExclusion=window.simpleExclusion||[],window.simpleTarget=window.simpleTarget||[],t.each(i,function(i){var s=i.keywords,n=i.type,o=i.tag;t.each(s,function(t){-1!==e.indexOf(t)&&("exclude"==n?window.simpleExclusion.push(o):"target"==n&&window.simpleTarget.push(o))})}),a.trigger("simpletarget:update"))},playNextRecommendation:function(){this.sv.recommend&&!e.isEmptyObject(this.sv.recommend.videoResponse)?this.sv.recommend.playNextRecommendation(this.sv.video.placement.mediatemplate):this.subviews.plutovideo.resetVideoState()},onFullScreenChange:function(){this.options.onFullScreenChange?this.options.onFullScreenChange():this.sv.scroll&&this.sv.scroll.onFullScreenChange()},destroy:function(){s.startRefreshTimer(),this.sv={},i.prototype.destroy.apply(this,arguments)}});return f}),define("modules/videos/pluto/pluto-video-gallery",["jquery","underscore","baseview","utils","modules/carousel/gallery","modules/videos/pluto/pluto-wrapper","modules/carousel/thumbs","ui/tooltip","modules/videos/pluto/pluto-analytics","modules/videos/pluto/pluto-scroll","modules/videos/pluto/pluto-utils","modules/videos/pluto/pluto-sp"],function(e,t,i,s,n,o,a,r,l,h,d,c){"use strict";var u=i.extend({events:{"click .js-pvg-prev":"onClickPrevArrow","click .js-pvg-next":"onClickNextArrow","mouseleave .js-pluto-gallery-viewport":"galleryMouseOut","mouseenter .js-pluto-gallery-viewport":"galleryMouseIn","click .js-pluto-title-overlay-play, .ui-pluto-still":"onClickPlayCarousel"},initialize:function(s){s=e.extend({activeSelector:".vgm-thumb-item.active",frontCarousel:!1,galleryAutoPlay:!0,hoverTransition:0,initializeThumbs:!0,initScroll:!0,scrollerColor:"light",slidesContainerSelector:".gallery-slides",slidesSelector:".gallery-slide",thumbsSelector:".vgm-thumbs",titleOverlay:!1,tooltipOptions:null,viewportSelector:".gallery-viewport"},s),t.bindAll(this,"_getOnEndedMethod","_transitionSlides","goToNextVideo","initPlutoVideo","initSubView","isRecommended","onAdEnd","onAdPlay","onAdVolumeChange","onEnded","onFullScreenChange","onGalleryPlay","onPause","onVideoPlay","onVolumeChange","slideInterval","updateScrollView"),this.$viewport=this.$(s.viewportSelector),this.$slidesContainer=this.$viewport.find(s.slidesContainerSelector),this.$slides=this.$slidesContainer.find(s.slidesSelector),this.$arrows=this.$(".js-pvg-prev, .js-pvg-next"),this.$title=this.$(".video-gallery-page-title"),this.subviewPrefix="galleryItem",this.$active=this.$(s.activeSelector),this.sv={};var o=e.extend(s,{animations:{useCSSTransitions:!1}});i.prototype.initialize.call(this,o),this.index=this.$active.index(),this.autoplayNext=!1,this.subviews.gallery=new n({el:this.$el,slideTransition:200,ads:!1,index:0,lookAheadAmount:3,transitionSlides:this._transitionSlides}),this.options.initializeThumbs&&(this._initializeThumbs(s.hoverTransition,s.scrollerColor,s.thumbsSelector),this._initializeTooltips(this.$(".vgm-thumb-box"))),this.goTo(this.index),this.slideChangeInterval||this.slideInterval(!0)},_initializeThumbs:function(e,t,i){this.subviews.thumbs=new a({el:i?this.$(i):this.$el,carousel:this,hoverTransition:e,index:this.index,scrollerColor:t})},_initializeTooltips:function(i){t.each(i,function(t,i){this._setupTooltipView(t,e(t).data("duration"),i)},this)},_setupTooltipView:function(t,i,s){var n=e.extend({el:t,customContainerClass:"vgm-ui-tooltip",position:"bottom",text:i},this.options.tooltipOptions),o=this.subviewPrefix+s;this.subviews[o]||(this.subviews[o]=new r(n))},_getOnEndedMethod:function(e){return t.bind(function(){this.onEnded(e)},this)},onEnded:function(e){this.videoStart="auto-continuous";var t=this.getActiveSlideIndex(),i=t+1,s=this.$slides.length,n=s-1,o=n>=i,a=this.getPlacementData(e).galleryLoop,r=a&&i===s;this.getActiveSlideIndex()!==e&&this.enterBackgroundState(e),(o||r)&&(this.goToNextVideo(),r&&this.slideInterval(!0)),a&&(this.autoplayNext=o)},onClickPrevArrow:function(e){e.preventDefault(),this.autoplayNext=!1;var t=this.getActiveSlideIndex()-1,i="videoplaylist|prev";this.goToIndex(t,i)},onClickNextArrow:function(e){e.preventDefault(),this.autoplayNext=!1;var t=this.getActiveSlideIndex()+1,i="videoplaylist|next";this.goToIndex(t,i)},switchSlide:function(e){var t=this.getActiveSlideIndex();t!==e&&this.goToIndex(e,"videoplaylist"+(e+1))},goToIndex:function(e,i){this.videoStart="user",this.getPlutoVideo(e-1)&&this.getPlutoVideo(e-1).pauseVideo(),this.getPlacementData().galleryLoop&&e===this.$slides.length&&"videoplaylist|next"===i&&(e=0),this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e),l.trackVideoEvents(i)},this))},startVideo:function(e,i){var s=this.getPlacementData(e),n=this.getPlutoVideo(e),o=s.galleryAutoPlay,a=i&&"click"===i.type;(o||this.autoplayNext||a)&&(0!==e||a||(this.videoStart="auto-first"),this.slideInterval(),n||this.initSubView(e,i),this.getPlutoVideo(e).initPromise.done(t.bind(function(){this.getPlutoVideo(e).playVideo()},this)))},enterBackgroundState:function(e){var t=this.getPlayerSubview(e);t&&(t.destroy(),delete this.subviews["video"+e])},goTo:function(i){var s,n,o=this.getActiveSlideIndex();if(0!==i&&!this.options.frontCarousel&&this.getPlayerSubview(o)){var a=this.getPlayerSubview(o).sv.video.vjsPlayer;s=a.volume(),n=a.muted()}if(this._activeSlide=i,this.initPlutoVideo(i),0!==i&&!this.options.frontCarousel&&"undefined"!=typeof o&&o!==this._activeSlide){var r=this.getPlayerSubview(this._activeSlide).sv.video.vjsPlayer;n?r.muted(!0):r.volume(s)}return this.updateArrows(i),this.$titleOverlay=this.$(".js-pluto-title-overlay")[i],this.$playButton=this.$(".js-pluto-title-overlay-play")[i],this.options.frontCarousel&&(this.$slides.removeClass("active"),this.$slides.eq(i).addClass("active")),this.subviews.gallery.goToSlide(i).done(t.bind(function(){void 0!==o&&(this.enterBackgroundState(o),this.$titleOverlay&&e(this.$titleOverlay).show(),this.$playButton&&e(this.$playButton).show())},this))},initSubView:function(e,t){this.isFirstPlaylistVideoMuted=0===e&&this.getPlacementData(e).mutedAutoplay,this.subviews["video"+e]=new o({el:this.$(".ui-pluto-video")[e],videoStart:this.videoStart,initializeScroll:!1,isRecommended:this.isRecommended(),onAdEnd:this.onAdEnd,onAdPlay:this.onAdPlay,onAdVolumeChange:this.onAdVolumeChange,onEnded:this._getOnEndedMethod(e),onFullScreenChange:this.onFullScreenChange,onGalleryPlay:this.onGalleryPlay,onPause:this.onPause,onPlayback:this.onPlayback,onVideoPlay:this.onVideoPlay,onVolumeChange:this.onVolumeChange,userPlayed:t&&"click"===t.type,isFirstPlaylistVideoMuted:this.isFirstPlaylistVideoMuted})},initPlutoVideo:function(e){var i=this.subviews["video"+e],n=this.$slides.eq(e).find(".ui-pluto-video"),o=this.getPlacementData(e);if(this.options.frontCarousel&&l.initAnalytics(),o.galleryAutoPlay&&!i&&void 0!==e&&n.length){this.initSubView(e);var a=this.getPlutoVideo(e),r=this.getVideoData(e);this.options.initScroll&&o.scrollingplayer?(s.getNested(window.site_vars,"html5video","scrollingPlayer","docked")?this.sv.sp=this.subviews.sp=new c({el:n,plutoVideo:a}):a.initPromise.done(t.bind(function(e){return this.subviews.plutoScroll=new h({el:n,placementData:o,plutoVideo:a,videoData:r,videoPlayer:e}),this.sv.scroll=this.subviews.plutoScroll,this.sv.scroll},this)),this.options.initScroll=!1):a&&a.initPromise.done(t.bind(function(t){return this.sv.scroll?(this.updateScrollView(e,t),window.videoIsScrolling&&this.sv.scroll.slideVideoOut(),this.sv.scroll):void(this.sv.sp&&this.updateSpView(e))},this))}else this.$(".ui-pluto-video").eq(e).addClass("ui-pluto-reset")},updateScrollView:function(e,t){var i=this.subviews["video"+e].sv.video;this.sv.scroll.options={el:this.$slides.eq(e).find(".ui-pluto-video"),plutoVideo:i,videoData:i.video,videoPlayer:t},this.sv.scroll.subviews.videoBar.sv.share.undelegateEvents(),this.sv.scroll.updateVideoBar(i),this.sv.scroll.updateVideoBarTitle(i.video.title),this.sv.scroll.subviews.videoBar.updateShare()},updateSpView:function(e){this.sv.sp.updateVideo(this.subviews["video"+e].sv.video)},onVolumeChange:function(e){this.sv.scroll&&this.sv.scroll.onVolumeChange(e)},onAdVolumeChange:function(e){this.sv.scroll&&this.sv.scroll.onVolumeChange(e)},onAdPlay:function(){this.sv.scroll?this.sv.scroll.onAdPlay():this.sv.sp&&this.sv.sp.showAdText()},onAdEnd:function(){this.sv.scroll?this.sv.scroll.onAdEnd():this.sv.sp&&this.sv.sp.updateTitle(this.getPlutoVideo(this.getActiveSlideIndex()).getTitle())},onFullScreenChange:function(){this.sv.scroll&&this.sv.scroll.onFullScreenChange()},onPause:function(){this.sv.scroll&&this.sv.scroll.onPause(),this.autoplayNext=!1},onVideoPlay:function(){this.sv.scroll?this.sv.scroll.onVideoPlay():this.sv.sp&&this.sv.sp.updateTitle(this.getPlutoVideo(this.getActiveSlideIndex()).getTitle())},isRecommended:function(){var e=this.getActiveSlideIndex(),t=e+1,i=this.$slides.length-1;return t>i},onGalleryPlay:function(){this.$titleOverlay&&e(this.$titleOverlay).hide(),this.$playButton&&e(this.$playButton).hide(),this.slideInterval()},goToNextVideo:function(){var e=this.getActiveSlideIndex()+1,i=this.getPlacementData(),s=i.galleryLoop;s&&e===this.$slides.length&&(e=0),this.goTo(e).done(t.bind(function(){this.startVideo(e),this.triggerEvent("goToSlide",e)},this))},_transitionSlides:function(e){var t=this.$viewport.outerWidth(),i=t*e*-1,s=this.$slidesContainer;return this.animate(s,"left",i+"px",250,"easeInOutQuad")},getPlayerSubview:function(e){return e=e||0===e?e:this.getActiveSlideIndex(),this.subviews["video"+e]},getVideoData:function(t){return t=t?t:this.getActiveSlideIndex(),d.buildData(e(this.$slides[t]).find(".ui-video-data"))},getPlacementData:function(t){return t=t?t:this.getActiveSlideIndex(),d.buildData(e(this.$slides[t]).find(".ui-video-placement-data"))},getPlutoVideo:function(e){var t=this.getPlayerSubview(e),i=t?t.sv.video:!1;return i},onClickPlayVideo:function(e,t){this.startVideo(t)},onClickPlayCarousel:function(e){var t=this.getActiveSlideIndex();this.startVideo(t,e)},getActiveSlideIndex:function(){return this._activeSlide},updateArrows:function(e){var t,i="gallery-nav-active",s=this.getPlacementData(),n=s.galleryLoop?s.galleryLoop:!1;this.$slides.length<=1||(this.$arrows.addClass(i),0===e?t="prev":e===this.$slides.length-1&&(t="next"),this.$arrows.filter(".js-pvg-"+t).removeClass(i),n&&"next"==t&&this.$arrows.filter(".js-pvg-"+t).addClass(i))},showPlayOverlay:function(){this.getPlacementData().titleOverlay&&this.$titleOverlay&&e(this.$titleOverlay).show(),this.$playButton&&e(this.$playButton).show()},slideInterval:function(e){var t=this.getPlacementData().galleryAutoAdvanceTime;t&&(e?this.slideChangeInterval=setInterval(this.goToNextVideo,t):(clearInterval(this.slideChangeInterval),this.slideChangeInterval=!1))},galleryMouseIn:function(e){this.slideInterval()},galleryMouseOut:function(e){var t=this.getActiveSlideIndex(),i=this.getPlutoVideo(t),s=this.getPlayerSubview(t)?this.getPlayerSubview(t).options.userPlayed:!1;s||i&&(i.isPlaying||i.vjsPlayer.paused())?this.slideInterval():this.slideInterval(!0)},destroy:function(){this.slideInterval(),this.showPlayOverlay(),i.prototype.destroy.apply(this,arguments),this.sv={}}});return u}),define("modules/global/video-carousel",["jquery","underscore","baseview","pubsub","state","modules/global/brightcove-video"],function(e,t,i,s,n,o){"use strict";var a=i.extend({events:{"click .carousel-nav":"onCarouselNavClick","mouseleave .video-carousel-viewport":"carouselMouseOut","mouseenter .video-carousel-viewport":"carouselMouseIn"},initialize:function(s){this.$carouselContainer=this.$(".video-carousel-series"),this.moveMe=this.$carouselContainer,this.viewport=this.moveMe.parent(),this.$slides=this.$carouselContainer.find(".video-carousel-item"),this.totalSlides=this.$slides.length,this.index=this.$(".video-carousel-item-wrap.active").index(),this.subviews={},this.subviews.video=[],this.autoplay=!1,t.bindAll(this,"goToNextVideo"),this.totalSlides>1?this.slideChangeInterval=setInterval(this.goToNextVideo,5e3):this.$(".carousel-nav").hide();var n=this;t.bindAll(this,"bcPlayerLoaded"),e.each(this.$slides.find(".video"),function(){var e=new o({el:this,onVideoComplete:n.goToNextVideo,onVideoLoaded:n.bcPlayerLoaded,autostart:!1});n.subviews.video.push(e)}),this.$el.hasClass("autoplay")&&(this.subviews.video[0].$(".videoStillPlay").click(),clearInterval(this.slideChangeInterval)),i.prototype.initialize.call(this,s)},bcPlayerLoaded:function(e){this.autoplay=!0},onCarouselNavClick:function(t){if(t.preventDefault(),this.totalSlides>1){var i=e(t.currentTarget),s=i.hasClass("prev"),n=this.$(".video-carousel-item-wrap.active").index();this.index=n,this.autoplay=!1,s?n--:n++,this.goTo(n)}},goTo:function(e){e>=this.totalSlides?e=0:0>e&&(e=this.totalSlides-1);var t=this.viewport.outerWidth(),i=t*e*-1;this.subviews.video[this.index].player&&this.subviews.video[this.index].resetVideoState(),this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),this.autoplay&&(s.trigger("uotrack","videocarousel|nextauto"),this.subviews.video[e].player||this.subviews.video[e].$(".videoStillPlay").click()),this.updateDom(e)},updateDom:function(e){this.updateNextPrevArrows(e),this.$(".video-carousel-item-wrap").eq(this.index).removeClass("active"),this.$(".video-carousel-item-wrap").eq(e).addClass("active"),this.index=e},goToNextVideo:function(){var e=this.$(".video-carousel-item-wrap.active").index()+1;this.subviews.video[this.index].modVP?this.subviews.video[this.index].modVP.getIsPlaying(t.bind(function(t){t||this.goTo(e)},this)):this.goTo(e)},carouselMouseIn:function(e){this.slideChangeInterval&&(clearInterval(this.slideChangeInterval),this.slideChangeInterval=!1)},carouselMouseOut:function(e){this.totalSlides>1&&(this.autoplay||this.slideChangeInterval||(this.slideChangeInterval=setInterval(this.goToNextVideo,5e3)))},updateNextPrevArrows:function(e){var t=this.$(".carousel-prev");this.$(".carousel-next");0===e?t.hide():t.show()},destroy:function(e){clearInterval(this.slideChangeInterval),i.prototype.destroy.call(this,e)}});return a}),define("modules/videos/uw/uw-sp",["jquery","underscore","baseview","utils","pubsub","modules/videos/pluto/pluto-title-bar"],function(e,t,i,s,n,o){"use strict";var a=i.extend({events:{},initialize:function(n){n=e.extend({video:null,analytics:{autoPause:"uw-dockedautopause",clickedClose:"uw-dockedplayerclosed",collapsedOnScroll:"uw-dockedplayercollapsed",open:"uw-dockedplayeropen"},dockedStatus:null,pause:null,placement:null},n),i.prototype.initialize.call(this,n),s.getNested(window.site_vars,"html5video","scrollingPlayer","titleBar")&&(this.subviews.tb=new o({el:this.$(".js-ptb"),onClose:t.bind(this.onClose,this)})),this.$win=s.get("win"),this.vidHeight=this.$el.height(),this.vidWidth=this.$el.width(),this.dockedHeight=s.getNested(window.site_vars,"html5video","scrollingPlayer","dockedHeight"),this.dockedWidth=s.getNested(window.site_vars,"html5video","scrollingPlayer","dockedWidth"),this.$placeholder=this.$el.prev(".js-video-placeholder"),this["break"]=parseFloat(s.getNested(window.site_vars,"html5video","scrollingPlayer","scrollBreakpoint")),this.nav=e(".site-header-inner-wrap"),this.scrollBreakpoint=this.vidHeight*this["break"],this.adBlacklist=s.getNested(window.site_vars,"html5video","scrollingPlayer","adBlacklist"),this.playerIsScrolling=!1,this.attachListeners()},attachListeners:function(){this.$win.on("scroll."+this.cid,t.bind(t.throttle(this.onScroll,100),this))},onClose:function(){n.trigger("uotrack",this.options.analytics.clickedClose),this.playerIsScrolling=!1,this.updateScrollingClass(!1),this.options.pause&&this.options.pause(),this.reset()},onScroll:function(){var t=this.$win.scrollTop();this.navOffset=this.nav.position().top+this.nav.height(),t>this.$el.parent().offset().top+this.scrollBreakpoint-this.navOffset?!this.playerIsScrolling&&this.isPlaying&&this.slideVideoOut():(this.slidingIn&&this.$el.css("bottom",e(window).height()-(this.$placeholder.offset().top+this.vidHeight)+e(window).scrollTop()-10),this.playerIsScrolling&&this.slideVideoIn(!1))},reset:function(){this.updateScrollingClass(!1),this.$el.css({position:"relative",top:"",left:"",right:"",bottom:"",height:this.vidHeight+"px",width:this.vidWidth+"px","margin-bottom":"","z-index":""})},sendOut:function(){this.$el.css({bottom:0,height:this.dockedHeight,"margin-bottom":0,position:"fixed",right:0,width:this.dockedWidth,"z-index":99999})},slideVideoOut:function(){this.options.pause&&this.options.placement.enableUwPauseOnScroll&&(n.trigger("uotrack",this.options.analytics.autoPause),this.autopausedCalled=!0,this.options.pause()),this.slideInPromise?this.slideInPromise.done(t.bind(function(){this.moveItOut()},this)):this.moveItOut()},slideVideoIn:function(){this.slideInPromise=e.Deferred(),this.slideOutPromise.done(t.bind(function(){this.subviews.tb&&this.subviews.tb.collapse(),this.playerIsScrolling=!1,this.slidingIn=!0,this.$el.css({bottom:e(window).height()-(this.$placeholder.offset().top+this.vidHeight)+e(window).scrollTop()-10,right:e(window).width()-(this.$placeholder.offset().left+this.vidWidth),height:this.vidHeight,width:this.vidWidth,margin:""}),this.$el.one(this.getTransitionEndListener(),t.bind(function(){this.slidingIn=!1,this.reset(),this.$el.off(this.getTransitionEndListener()),window.videoIsDocked=!1,n.trigger("uotrack",this.options.analytics.collapsedOnScroll),this.slideInPromise.resolve(),this.options.dockedStatus&&this.options.dockedStatus(this.playerIsScrolling)},this))},this))},moveItOut:function(){this.playerIsScrolling=!0,this.slideOutPromise=e.Deferred();var i=e(window).height()-this.vidHeight+(this.vidHeight-this.scrollBreakpoint)+this.navOffset;this.$el.css({bottom:i,"margin-bottom":0,position:"fixed","z-index":99999,right:e(window).width()-(this.$el.offset().left+this.vidWidth)}),this.subviews.tb&&this.subviews.tb.show(),this.updateScrollingClass(!0),this.$el.css({right:0,bottom:0,width:this.dockedWidth,height:this.dockedHeight}),this.$el.one(this.getTransitionEndListener(),t.bind(function(){this.$el.off(this.getTransitionEndListener()),window.videoIsDocked=!0,n.trigger("uotrack",this.options.analytics.open),this.slideOutPromise.resolve(),this.options.dockedStatus&&this.options.dockedStatus(this.playerIsScrolling)},this))},updateScrollingClass:function(e){e&&this.playerIsScrolling?this.$el.parent().addClass("playerIsScrolling"):this.$el.parent().removeClass("playerIsScrolling")},updateVideo:function(){this.reset(),this.subviews.tb&&this.subviews.tb.setEl(this.$(".js-ptb")),this.$placeholder=this.$el.prev(".js-video-placeholder"),
this.playerIsScrolling&&(this.sendOut(),this.subviews.tb&&this.subviews.tb.show(),this.updateScrollingClass(this.playerIsScrolling))},getTransitionEndListener:function(){if(this.transitionType)return this.transitionType;this.transitionType="transitionend";var e={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",MozTransition:"transitionend",transition:"transitionend"};for(var t in e)if(void 0!==this.el.style[t]){this.transitionType=e[t];break}return this.transitionType},_onPlay:function(){this.isPlaying=!0},_onPause:function(){this.isPlaying=!1},_onEnd:function(){this.isPlaying=!1},destroy:function(){this.reset(),i.prototype.destroy.call(this)}});return a}),define("modules/videos/uw/uw-wrapper",["jquery","underscore","baseview","managers/routemanager","modules/videos/uw/uw-sp","modules/videos/pluto/pluto-utils","managers/autoplay","utils","pubsub","state"],function(e,t,i,s,n,o,a,r,l,h){"use strict";var d=i.extend({initialize:function(s){if(i.prototype.initialize.call(this,s),this.video=o.buildData(this.$(".ui-video-data")),this.placement=o.buildData(this.$(".ui-video-placement-data")),this.uwIframe=this.$(".uw-iframe")[0],this.playerReady=e.Deferred(),this.fullScreenEnabled=!1,this.placement.extraAnalyticsEnabled&&l.trigger("uotrack","videopageload"),this.messages={docked:"universal-web-player-docked",notDocked:"universal-web-player-not-docked",pause:"universal-web-video-pause",start:"universal-web-video-start",play:"universal-web-video-play",isUwKickOffReady:"universal-web-ready-for-kickoff"},t.bindAll(this,"onPostMessage","startAutoPlay","isUwIframeLoaded"),this.setupUwListeners(),this.placement.uwAutoplay&&a.register("pluto-video",this.startAutoPlay),this.placement.scrollingplayer&&r.getNested(window.site_vars,"html5video","scrollingPlayer","docked")&&(this.sp=new n({el:this.$el,video:this.video,pause:t.bind(this.pause,this),dockedStatus:t.bind(this.dockedStatus,this),placement:this.placement})),this.uwIframeLoaded=setInterval(this.isUwIframeLoaded,250),window._sf_async_config){var h=r.getNested(window.site_vars,"html5video","uwIframe","baseUrl"),d=r.getNested(window.site_vars,"base_url");window._sf_async_config.playerdomain=h+"."+d||""}},isUwIframeLoaded:function(){this.messageUwPlayer(this.messages.isUwKickOffReady)},startAutoPlay:function(){return this.playerReady.done(t.bind(function(){return this.messageUwPlayer(this.messages.start),!0},this))},setupUwListeners:function(){o.getPostMessage(!0,this.onPostMessage)},removeUwListeners:function(){o.removeListener(this.onPostMessage)},pause:function(){this.messageUwPlayer(this.messages.pause)},onPostMessage:function(e){if(-1!==this.uwIframe.src.indexOf(e.origin))if("string"==typeof e.data&&-1!==e.data.indexOf("universal-web")){var t=e.data.split("/"),i=t[0],s=t[1];switch(s){case"universal-web-kickoff-ready":this.playerReady.resolve(),clearInterval(this.uwIframeLoaded);break;case"universal-web-video-complete":this.isThisVideo(i)&&this.onEnd();break;case"universal-web-video-play":case"universal-web-ad-play":this.isPlaylistFront()&&h.stopRefreshTimer(),this.placement.enableUwPauseOnScroll&&(l.trigger("uotrack","uw-userplay"),this.sp.autopausedCalled&&this.sp.playerIsScrolling&&(this.sp.autopausedCalled=!1,l.trigger("uotrack","uw-dockedplayafterautopause"))),this.onPlay(i);break;case"universal-web-ad-complete":case"universal-web-ad-started":this.onPlay(i);break;case"universal-web-video-paused":case"universal-web-ad-paused":this.isPlaylistFront()&&h.startRefreshTimer(),this.placement.enableUwPauseOnScroll&&l.trigger("uotrack","uw-userpause"),this.isThisVideo(i)&&this.onPause();break;case"universal-web-enter-fullscreen":this._onFullScreenEnter();break;case"universal-web-exit-fullscreen":this._onFullScreenExit()}}else"object"==typeof e.data&&(this.nextVideo=e.data)},isThisVideo:function(e){return this.video&&e===this.video.id.toString()},onEnd:function(){if(!this.isPlaylist()&&(this.sp&&this.sp._onEnd(),this.nextVideo))if("videoassetplayerhtml5"===this.placement.name&&this.nextVideo.canonicalUrl){this.nextVideo.url=this.nextVideo.canonicalUrl.replace(/^.*\/\/[^\/]+/,"");var e=r.getNested(window.site_vars,"html5video","uwIframe","taboolaTimeout");window.setTimeout(t.bind(function(){s.goTo(this.nextVideo.url)},this),e)}else("smallarticleattophtml5"===this.placement.name||"smallarticleinlinehtml5"===this.placement.name)&&this.$el.parent().find(".video-desc").html(this.nextVideo.description+"<span class=credit>"+this.nextVideo.author+"</span>")},isPlaylist:function(){return this.$$(".uw-playlist-iframe").length},isPlaylistFront:function(){return this.isPlaylist()&&"front"===this.video.type},onPlay:function(e){this.isPlaylist()||(this.isThisVideo(e)?this.sp&&this.sp._onPlay():this.pause())},onPause:function(){this.isPlaylist()||this.sp&&this.sp._onPause()},dockedStatus:function(e){e?this.messageUwPlayer(this.messages.docked):this.messageUwPlayer(this.messages.notDocked)},_onFullScreenEnter:function(){this.fullScreenEnabled=!0,this.onFullScreenEnter()},_onFullScreenExit:function(){this.fullScreenEnabled=!1,this.onFullScreenExit()},onFullScreenEnter:function(){},onFullScreenExit:function(){},messageUwPlayer:function(e){this.uwIframe.contentWindow||(this.uwIframe=this.$(".uw-iframe")[0]),o.setPostMessage(!0,this.uwIframe.contentWindow,e)},destroy:function(){this.removeUwListeners(),clearInterval(this.uwIframeLoaded),this.isPlaylistFront()&&h.startRefreshTimer(),i.prototype.destroy.apply(this,arguments)}});return d}),define("modules/videos/video-playlist-init",["jquery","underscore","baseview","utils","modules/videos/video-gallery","modules/videos/pluto/pluto-video-gallery","modules/global/video-carousel","modules/videos/uw/uw-wrapper"],function(e,t,i,s,n,o,a,r){var l=i.extend({initialize:function(e){this.pubSub={"entered:view:videoCarousel":this.onEnterView},i.prototype.initialize.call(this,e),s.flag("ll_video_carousel")&&this.$(".js-pluto-video-carousel")[0]||this.initSubviews()},onEnterView:function(t){e.contains(this.el,t)&&this.initSubviews()},initSubviews:function(){this.$el.hasClass("uw-playlist")||this.$(".uw-playlist-wrap").length?this.subviews.videoview=new r({el:this.$el}):this.$el.hasClass("pluto-video-gallery")?this.subviews.videoplaylist=new o({el:this.$el}):this.$el.hasClass("video-gallery")?this.subviews.videoplaylist=new n({el:this.$el}):this.$(".js-pluto-video-carousel")[0]?this.subviews.videocarousel=new o({activeSelector:".video-carousel-item-wrap.active",el:this.$(".js-pluto-video-carousel")[0],frontCarousel:!0,initializeThumbs:!1,slidesContainerSelector:".video-carousel-series",slidesSelector:".video-carousel-item-wrap",viewportSelector:".video-carousel-viewport"}):this.$(".js-carousel")[0]&&(this.subviews.videocarousel=new a({el:this.$el}))}});return l}),define("modules/rentals-listing-row",["jquery","baseview","state","directAdPosition"],function(e,t,i,s){var n=t.extend({events:{"click .js-rlpm-more-apts":"scrollDownToMoreApartments"},initialize:function(){t.prototype.initialize.call(this);var e=this.$(".js-rlpm-ad-pos")[0],i=this.$(".js-rlpm-ad-pos")[1];e&&(this.subviews.adPositionOne=this.createAdPosition(e)),i&&(this.subviews.adPositionTwo=this.createAdPosition(i))},scrollDownToMoreApartments:function(){e("html, body").animate({scrollTop:this.$el.offset().top+this.$el.outerHeight(!0)+300},500)},handleCardSizeChange:function(e){e.sidebarOpen===!0?this.$(".js-rlpm-more-apts").addClass("rlpm-more-apts-hide"):this.$(".js-rlpm-more-apts").removeClass("rlpm-more-apts-hide")},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)},createAdPosition:function(t){return new s({el:e(t),adSizes:[330,330],adPlacement:e(t).data("adtag"),pageInfo:i.getActivePageInfo()})}});return n}),define("modules/topics/topics-videos",["jquery","underscore","baseview","utils"],function(e,t,i,s){var n=i.extend({events:{"click .tpasvm-more-link":"onClickMore"},initialize:function(e){this.$moreLink=this.$(".tpasvm-more-link"),this.$moreWrap=this.$(".tpasvm-items-more"),i.prototype.initialize.call(this,e)},onClickMore:function(){if(this.$moreWrap.is(":visible"))this.$moreWrap.slideUp(),this.$moreLink.text("More Videos");else{this.$moreWrap.slideDown(),this.$moreLink.text("Less Videos");var e=this.$moreWrap.find(".tpavm-image");s.lazyLoadImage(e,"data-src",!0)}}});return n}),define("modules/fronts/sidebar-poster-ad",["jquery","underscore","baseview","pubsub","utils","state","sharedAdPosition","directAdPosition"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({initialize:function(s){t.bindAll(this,"onSidebarAdReady");var n=this.$el;this.layoutType=this._getLayoutType(),s=e.extend({adType:n.attr("data-ad-type")||"sidebar",adPlacement:n.attr("data-ad-placement")||"poster_front",adSizes:n.attr("data-ad-sizes")||"mediumrectangle,halfpage"},s),this.pubSub={"entered:view:sidebarPosterAd":this.onAdEnterView,"exited:view:sidebarPosterAd":this.onAdExitView},i.prototype.initialize.call(this,s)},_initAds:function(){var e=this.options,t=e.adSizes;t&&(t=t.split(","));var i={el:this.$el,adPlacement:e.adPlacement,pageInfo:o.getActivePageInfo(),adSizes:t,onAdReady:this.onSidebarAdReady,adType:e.adType};this.subviews.sidebarAd||(this.subviews.sidebarAd=new r(i))},onAdEnterView:function(e){if(n.flag("scroll_destroy_sidebar_ad")&&e.gannett.intersectionCount>1){setTimeout(t.bind(function(){e.gannett.isIntersecting&&this._initAds()},this),1e3)}},onAdExitView:function(e){n.flag("scroll_destroy_sidebar_ad")&&this.destroyAd(e)},destroyAd:function(e){this.subviews.sidebarAd&&e===this.el&&(this.subviews.sidebarAd.destroy(),delete this.subviews.sidebarAd)},_getLayoutType:function(){var e=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?e="primary":"sidebar"===this.options.layoutType&&(e="sidebar")),e},onSidebarAdReady:function(){this.subviews.sidebarAd.showAd(),this.refreshSidebar()},refreshSidebar:function(){o.getActiveApp().triggerEvent("refreshSidebarScroll")},_onHideSidebarAd:function(){this.subviews.sidebarAd&&"sidebar"===this.layoutType&&(this.hide(),this.$(".sidebar-wrapper").css("top",0),this.refreshSidebar())},showHidePosterAds:function(e){e.belowHeroAd&&"primary"===this.layoutType&&"poster_front"==this.options.adPlacement&&this._initAds(),e.belowTheFoldAd&&"primary"===this.layoutType&&"poster_front_btf"==this.options.adPlacement&&this._initAds(),e.sidebarAds&&"sidebar"===this.layoutType?(this.show(),this._initAds()):this._onHideSidebarAd()},onCardWidthChange:function(e){this.showHidePosterAds(e)},renderCardInfo:function(e){this.showHidePosterAds(e)}});return l}),define("modules/travel/travel-guides",["jquery","underscore","baseview","state","utils","ui/generic-paginator","ui/dropdown"],function(e,t,i,s,n,o,a){var r=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){s=e.extend({transition:{interval:15e3}},s),t.bindAll(this,"automate","goTo"),this.subviews={},this.moveMe=e(this.$el).find(".travel-gdc-wrapper"),this.viewport=this.moveMe.parent(),this.slides=e(this.$el).find(".travel-gdc-slide"),this.moveMe.width(this.moveMe.width()*this.moveMe.children().length),this.subviews.dropdown=new a({el:this.$(".travel-gdc-list")}),this.slides.length>1&&(this.subviews.paginator=new o({el:e(this.$el).find(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer())),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e;this.animate(this.moveMe,"left","-"+(i+1)+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return r}),define("modules/fronts/featured-content",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,s,n){var o=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){t.bindAll(this,"automate","goTo"),s=e.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".fcpm-items-wrap"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1;this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),s.lazyLoadImage(this.moveMe.find("img"))},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return o}),define("modules/fronts/blog-promo",["jquery","underscore","baseview","state","utils","ui/generic-paginator","modules/fronts/featured-content"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({el:".blog-promo-module",events:{"click .blogs-show-all":"showAll","click .close-all-blogs":"showAll"},initialize:function(t){t=e.extend({transition:{interval:15e3},displayNum:4},t),i.prototype.initialize.call(this,t),this.$numberBlogs=this.$(".blog-promo-content-wrap").length,this.$numberBlogs>0?(this.$seeAllBtnWrap=this.$(".blogs-show-all-wrap"),this.$closeAllBtn=this.$(".promo-button-container"),this.$allBlogsContainer=this.$(".show-all-blogs"),this.$blogChangeContainerHeight=this.$(".inner-show-all-blogs").height()+80,this.subviews.featuredcontent=new a(t)):this.hide()},showAll:function(){0===this.$allBlogsContainer.height()?(this.animate(this.$allBlogsContainer,"height",this.$blogChangeContainerHeight,350,"ease-in-out").done(t.bind(function(){this.$closeAllBtn.show()},this)),this.$seeAllBtnWrap.addClass("active")):(this.$closeAllBtn.hide(),this.animate(this.$allBlogsContainer,"height",0,350,"ease-in-out"),this.$seeAllBtnWrap.removeClass("active"))}});return r}),define("modules/fronts/election-results-map",["jquery","underscore","baseview","state","managers/routemanager"],function(e,t,i,s,n){var o=i.extend({el:".elections-results-map",initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"_handleMouseOver","_handleMouseMove","_handleMouseOut"),this.loadData(),this.tooltip=this.$("#map-tooltip")[0],this.tooltipOffset={x:5,y:15};var s=this.$("svg#map a");if(s)for(var n=0;n<s.length;n++){var o=s[n];o.addEventListener("mouseover",this._handleMouseOver,!1),o.addEventListener("mousemove",this._handleMouseMove,!1),o.addEventListener("mouseout",this._handleMouseOut,!1)}},loadData:function(){var i=e("use");this.stateMapping=[];for(var n=0;n<i.length;n++)this.stateMapping.push(i[n].id);var o="https://sslapi.gannett-cdn.com/elections/v1/2016-election/results/p/national?apiKey=57646bc6bca4811fea00000158f0635f9879400a6bbc296c010e0778";s.fetchData(o,{dataType:"jsonp"}).done(t.bind(function(e){e&&(this.races=e.races)},this))},_handleMouseOver:function(e){var t=e.target.id.replace("_"," ").replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),i=this.races[this.stateMapping.indexOf(e.target.id)].reportingUnits[0];this.tooltip.style.display="block",i?this.tooltip.innerHTML="<div class='stateName'>"+t+" ("+i.electTotal+")</div><div class='reporting'>"+i.precinctsReportingPct+"% reporting</div>":this.tooltip.innerHTML=t},_handleMouseMove:function(e){this.tooltip.style.left=e.clientX+this.tooltipOffset.x+"px",this.tooltip.style.top=e.clientY+this.tooltipOffset.y+"px"},_handleMouseOut:function(){this.tooltip.style.display="none"}});return o}),define("modules/sports/sports-countdown",["jquery","underscore","backbone","baseview"],function(e,t,i,s){var n=s.extend({initialize:function(){this.$countdown=this.$(".sports-countdown"),this.secondsInMinute=60,this.secondsInHour=60*this.secondsInMinute,this.secondsInDay=24*this.secondsInHour,this.startDate=this.$countdown.data("startdate")?new Date(this.$countdown.data("startdate")):new Date,this.endDate=this.$countdown.data("enddate")?new Date(this.$countdown.data("enddate")):this.startDate,this.endDate<this.startDate&&(this.endDate=this.startDate),this.dateDiffInSeconds=Math.ceil(.001*(this.endDate-this.startDate)),this.dateDiffInSeconds>0&&this.startCountdown()},startCountdown:function(){this.timer=setInterval(e.proxy(function(){this.dateDiffInSeconds=this.dateDiffInSeconds-1;var e=Math.floor(this.dateDiffInSeconds/this.secondsInDay),t=this.dateDiffInSeconds%this.secondsInDay,i=Math.floor(t/this.secondsInHour),s=t%this.secondsInHour,n=Math.floor(s/this.secondsInMinute),o=Math.ceil(s%this.secondsInMinute);return this.$countdown.find("#days").text(10>e?"0"+e:e),this.$countdown.find("#hours").text(10>i?"0"+i:i),this.$countdown.find("#minutes").text(10>n?"0"+n:n),this.$countdown.find("#seconds").text(10>o?"0"+o:o),this.dateDiffInSeconds<=0?void clearInterval(this.timer):void 0},this),1e3)}});return n}),define("modules/stories/expandable-photo",["jquery","underscore","baseview","utils","modules/myCapture/myCapture"],function(e,t,i,s,n){var o=i.extend({events:{"click .expandable-collapsed":"expandPhoto","click .expandable-open":"collapsePhoto"},sized:!1,parentHeight:!1,expandPhoto:function(t){var i=this.$(".single-photo"),o=this.$(".image-credit-wrap"),a=e(".story-highlights");this.parentHeight=this.$el.parent().height(),s.getNested(window.site_vars,"THIRDPARTYAPI","MYCAPTURE","ENABLED")&&!this.subviews.mycapture&&(this.subviews.mycapture=new n({el:this.$el})),this.subviews.mycapture&&i.find(".js-mycapture-btn-small").length&&this.subviews.mycapture.switchMyCaptureBtn(this),this.$el.parent().height(this.parentHeight),a.fadeTo(200,0),o.hide(),i.animate({width:"540px"},350,function(){o.fadeIn(250),i.removeClass("expandable-collapsed").addClass("expandable-open")})},collapsePhoto:function(i){if(!e(i.target).is(".js-mycapture-btn")){var s=this.$(".single-photo"),n=this.$(".image-credit-wrap"),o=e(".story-highlights");this.subviews.mycapture&&n.find(".js-mycapture-btn").length&&this.subviews.mycapture.switchMyCaptureBtn(this),n.hide(),s.animate({width:"180px"},350,t.bind(function(){n.fadeIn(),o.fadeTo(500,1),s.removeClass("expandable-open").addClass("expandable-collapsed")},this))}}});return o}),define("modules/stories/bounce-exchange",["jquery","underscore","baseview","utils","managers/autoplay"],function(e,t,i,s,n){var o=i.extend({initialize:function(e){this.bxEnabled=s.getNested(window.site_vars,"THIRDPARTYAPI","BX","autoplayEnabled")||!1,window.bxHaltLoad=!1,this.bxEnabled&&(window.bxHaltLoad=!0,n.register("bounce-exchange",this.autoplay))},autoplay:function(){return window.bxAutoplayEnable(),!0},destroy:function(){delete window.bxHaltLoad,i.prototype.destroy.call(this)}});return o}),define("modules/partner/sponsor-logo-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){var s=this.$el;t=e.extend({adType:s.attr("data-ad-type")||"sponsor_logo_module",adPlacement:s.attr("data-ad-placement")||"sponsor_logo_module",adSizes:s.attr("data-ad-sizes")||"sponsor_logo_medium"},t),i.prototype.initialize.call(this,t),this._initAds()}});return s}),define("modules/travel/travel-dest-nav",["jquery","baseview","ui/dropdown"],function(e,t,i){"use strict";var s=t.extend({initialize:function(e){t.prototype.initialize.call(this,e),this.subviews.dropdown=new i({el:this.$(".tdn-list")})}});return s}),define("modules/home-finder/home-carousel",["jquery","underscore","baseview","utils","ui/generic-paginator"],function(e,t,i,s,n){"use strict";var o=i.extend({events:{"click .mpa-hf-ft-next-btn":"nextHouse","click .mpa-hf-ft-previous-btn":"previousHouse"},initialize:function(s){s=e.extend({auto:!0,time:5e3},s),this.$featuredHouses=this.$(".mpa-hf-wrap"),this.$houses=this.$featuredHouses.find(".mpa-hf-ft-block"),this.totalHouses=this.$houses.length,this.$paginatorBullets=this.$(".paginator-indicator-bullet"),this.$activePaginator=this.$(".paginator-indicator-target"),this.subviews={},this.indexSelector=0,this.homesPerSlide=3,this.carousel={houses:[],width:[0]},t.bindAll(this,"goTo","goToNextHome"),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),this.createCarousel(this.$houses),this.controlsCarousel(),i.prototype.initialize.call(this,s)},nextHouse:function(){this._getSlideIn(),this._fadeInSlide()},previousHouse:function(){this._getSlideOut(),this._fadeInSlide()},createCarousel:function(t){var i=this,s=0;e.each(t,function(t){i.carousel.houses.push(this),s+=i._getWidth(e(this)),(parseInt(t)+1)%i.homesPerSlide===0&&i.carousel.width.push(s)})},resetAutoRotate:function(){clearInterval(this.slideChangeInterval),this.slideChangeInterval=setInterval(this.goToNextHome,this.options.time)},goToNextHome:function(){this.indexSelector++,this.goTo(this.indexSelector)},goTo:function(e){e>=this.totalHouses/this.homesPerSlide?e=0:0>e&&(e=this.totalHouses-1),this.indexSelector=e,this.$paginatorBullets.removeClass("active"),this.$(".paginator-indicator-bullet").eq(this.indexSelector).addClass("active"),this.controlsCarousel(),this.animate(this.$featuredHouses,"right",this.carousel.width[e],200,"ease-in-out")},_fadeInSlide:function(){this.goTo(this.indexSelector)},controlsCarousel:function(){var t=e(".mpa-hf-ft-previous-btn"),i=e(".mpa-hf-ft-next-btn");t.toggleClass("mpa-closed",0===this.indexSelector),i.toggleClass("mpa-closed",this.indexSelector==this.$activePaginator.length-1),this.$houses.length>this.homesPerSlide&&this.resetAutoRotate()},_getSlideIn:function(){this.indexSelector=this.$paginatorBullets.filter(".active").parent().next().index()},_getSlideOut:function(){this.indexSelector=this.$paginatorBullets.filter(".active").parent().prev().index()},_getWidth:function(e){return e.outerWidth()},destroy:function(e){clearInterval(this.slideChangeInterval),i.prototype.destroy.call(this,e)}});return o}),define("modules/longform/longform-inline-share",["jquery","baseview","pubsub"],function(e,t,i){"use strict";var s=t.extend({events:{"click .lf-share-item":"onSocialButtonClick"},onSocialButtonClick:function(t){e(t.target).hasClass("lf-share-comments")?(i.trigger("onClickShare","comments"),t.preventDefault()):(e(t.target).hasClass("lf-share-email")||e(t.target).hasClass("js-lf2-share-email"))&&(i.trigger("onClickShare","email"),t.preventDefault())}});return s}),define("modules/stories/piano",["jquery","underscore","baseview","utils","managers/autoplay","state"],function(e,t,i,s,n,o){var a=i.extend({initialize:function(i){this.pianoEnabled=s.getNested(window.site_vars,"THIRDPARTYAPI","PIANO","enabled"),this.pianoEnabled&&!this.isVideo()&&(this.pianoAutoplayPromise=e.Deferred(),t.bindAll(this,"autoplay","isVideo"),n.register("piano",this.autoplay),window.pianoComplete=t.bind(function(){this.pianoAutoplayPromise.resolve()},this))},isVideo:function(){var e=o.getActivePageInfo().texttype;return-1!==["video","video-playlist","brightcove-video-playlist"].indexOf(e)},autoplay:function(){return this.pianoAutoplayPromise},destroy:function(){delete window.pianoComplete,i.prototype.destroy.call(this)}});return a}),define("modules/home-finder/home-search",["jquery","underscore","baseview","utils"],function(e,t,i,s){"use strict";var n=i.extend({events:{"focus .mpa-hf-form-price-input":"inputFocus","click .mpa-hf-form-label":"generalDropdown","click .mpa-hf-form-price-options .mpa-hf-form-option":"priceClick","change .mpa-hf-form-price-input":"inputChange","click .mpa-hf-filter-option":"criteriaClick","click .mpa-hf-btn":"searchHomeFinder"},initialize:function(i){this.actionHomeFinder=["",""],this.$priceFilterPane=this.$(".mpa-hf-price-filter-pane"),this.$priceOptions=this.$(".mpa-hf-form-price-options"),this.$priceLabel=this.$(".mpa-hf-form-price-label"),this.$container=this.$(".mpa-hf-filter-pane"),e("body").on("mouseup."+this.cid,t.bind(function(t){var i=this.$(".mpa-hf-form-label"),s=this.$(".mpa-hf-form-option"),n=this.$(".mpa-hf-form-price-input"),o=this.$(".mpa-hf-input-area");i.is(t.target)||s.is(t.target)||n.is(t.target)||o.is(t.target)||!this.$container.is(":visible")||i.is(e(t.target).parent())||this.$container.toggleClass("mpa-closed",this.$container.is(":visible"))},this))},searchHomeFinder:function(){var e=this.$(".mpa-hf-input-area").val().toLowerCase();if(e.match(/(\d{5}(?:-\d{4})?)/))this.actionHomeFinder[0]="zip-code/",this.actionHomeFinder[1]=e.match(/(\d{5}(?:-\d{4})?)/)[1]+"/";else if(e.trim().match(/^([^,]+),\s*(\w{2})$/)){var i=e.trim().match(/^([^,]+),\s*(\w{2})$/);this.actionHomeFinder[0]=i[2].toUpperCase()+"/",this.actionHomeFinder[1]=(i[1].charAt(0).toUpperCase()+i[1].slice(1)).replace(/\s/,"-")+"/"}else this.isInt(e)?(this.actionHomeFinder[0]="zip-code/",this.actionHomeFinder[1]=e+"/"):0===e.length?(this.actionHomeFinder[0]="search/",this.actionHomeFinder[1]=""):(this.actionHomeFinder[0]="search/?area=",this.actionHomeFinder[1]=e);var s=t.reduce(this.actionHomeFinder,function(e,t){return e+t});this.$(".seach-form").attr("action","//www.homefinder.com/"+s)},changeSearchAttribut:function(e,t){if(!isNaN(e))switch(t){case"bed":this.actionHomeFinder[2]="min-bed-"+e+"/";break;case"bath":this.actionHomeFinder[3]="min-bath-"+e+"/";break;case"min_price":this.actionHomeFinder[4]="min-price-"+e+"/";break;case"max_price":this.actionHomeFinder[5]="max-price-"+e+"/"}},generalDropdown:function(t){this.$container.not(".mpa-closed").is(t.currentTarget.nextElementSibling)||this.$container.not(".mpa-closed").addClass("mpa-closed"),e(t.currentTarget.nextElementSibling).toggleClass("mpa-closed"),e(t.currentTarget).hasClass("mpa-hf-form-price-label")&&(this.$(".mpa-hf-form-dropdown-menu[data-price='max']").hasClass("mpa-closed")||this.$(".mpa-hf-form-payment-min").focus())},inputFocus:function(t){var i=e(t.currentTarget),s=i.attr("placeholder").toLowerCase();this.$(".mpa-hf-form-dropdown-menu[data-price='"+s+"']").parent().is(":visible")||this.$priceOptions.toggleClass("mpa-closed")},priceClick:function(t){var i=e(t.currentTarget),s=i.parent(),n=s.parent(),o=n.data("price"),a=s.data("value").replace(/,/g,"");this.priceLabelDisplay(o,a),this.changeSearchAttribut(a,o+"_price"),this.$(".mpa-hf-form-payment-"+o).val(s.data("value")),e(".mpa-hf-form-payment-min").val().length>0&&e(".mpa-hf-form-payment-max").val().length>0&&this.$container.toggleClass("mpa-closed",this.$container.is(":visible"))},criteriaClick:function(t){var i=e(t.currentTarget),s=i.parent(),n=s.parent(),o=n.data("criteria");e(".mpa-hf-"+o+"-select").html(s.text()),this.$container.toggleClass("mpa-closed",this.$container.is(":visible")),this.changeSearchAttribut(s.data("value"),o)},inputChange:function(t){var i=e(t.currentTarget),s=i.val().replace(/,/g,""),n=i.attr("placeholder").toLowerCase();this.priceLabelDisplay(n,s),this.changeSearchAttribut(s,n+"_price")},priceLabelDisplay:function(t,i){var s="";this.$(".mpa-hf-form-price").data(t,i),0!==this.$(".mpa-hf-form-price").data("min")&&0!==this.$(".mpa-hf-form-price").data("max")?(this.$(".mpa-hf-form-price-prepend, .mpa-hf-form-price-append").hide(),s=this.priceConvert(e(".mpa-hf-form-price").data("min"))+" - "+this.priceConvert(e(".mpa-hf-form-price").data("max"))):(s=this.priceConvert(e(".mpa-hf-form-price").data(t)),0===e(".mpa-hf-form-price").data("min")?e(".mpa-hf-form-price-prepend").html("Up to "):e(".mpa-hf-form-price-append").html(" +")),e(".mpa-hf-form-price").html(s)},priceConvert:function(e){var t="$";return t+=e>=1e3?e.match(/^(\d.*)\d{3}$/)[1]+"K":e},isInt:function(e){if(isNaN(e))return!1;var t=parseFloat(e);return(0|t)===t},destroy:function(t){e("body").off("."+this.cid),i.prototype.destroy.call(this,t)}});return n}),define("ui/loader",["jquery","underscore","baseview","pubsub","utils"],function(e,t,i,s,n){"use strict";var o=i.extend({initialize:function(t){this.options=e.extend({msg:""},t),this.win=n.get("win"),this.body=n.get("body"),this.el=e(this.options.el),this.msg=this.options.msg,this.render()},render:function(){var t=e("<div>").addClass("loading-icon");this.$loader=e("<div>").addClass("ui-loader"),this.$target=this.$el,this.$target.append(this.$loader.append(t).append(e("<span>").html(this.msg))),this.$el=this.$loader},destroy:function(e){this.hide(),i.prototype.destroy.apply(this,arguments)},show:function(){this.$loader.addClass("active")},hide:function(){this.$loader.removeClass("active")}});return o}),define("touchswipe",["jquery"],function(e){function t(t){return!t||void 0!==t.allowPageScroll||void 0===t.swipe&&void 0===t.swipeStatus||(t.allowPageScroll=h),t||(t={}),t=e.extend({},e.fn.swipe.defaults,t),this.each(function(){var s=e(this),n=s.data(y);n||(n=new i(this,t),s.data(y,n))})}function i(t,i){function w(t){if(!(B()||e(t.target).closest(i.excludedElements,ee).length>0)){t=t.originalEvent;var s,n=b?t.touches[0]:t;return te=f,b?ie=t.touches.length:t.preventDefault(),G=0,Y=null,Q=null,X=0,Z=0,J=0,K=1,se=z(),!b||ie===i.fingers||i.fingers===p||O()?(se[0].start.x=se[0].end.x=n.pageX,se[0].start.y=se[0].end.y=n.pageY,ne=N(),2==ie&&(se[1].start.x=se[1].end.x=t.touches[1].pageX,se[1].start.y=se[1].end.y=t.touches[1].pageY,Z=J=P(se[0].start,se[1].start)),(i.swipeStatus||i.pinchStatus)&&(s=x(t,te))):(S(t),s=!1),s===!1?(te=v,x(t,te),s):(j(!0),ee.bind(U,_),ee.bind(W,C),void 0)}}function _(e){if(e=e.originalEvent,te!==m&&te!==v){var t,s=b?e.touches[0]:e;if(se[0].end.x=b?e.touches[0].pageX:s.pageX,se[0].end.y=b?e.touches[0].pageY:s.pageY,oe=N(),Y=L(se[0].start,se[0].end),b&&(ie=e.touches.length),te=g,2==ie&&(0==Z?(se[1].start.x=e.touches[1].pageX,se[1].start.y=e.touches[1].pageY,Z=J=P(se[0].start,se[1].start)):(se[1].end.x=e.touches[1].pageX,se[1].end.y=e.touches[1].pageY,J=P(se[0].end,se[1].end),Q=I(se[0].end,se[1].end)),K=D(Z,J)),ie!==i.fingers&&i.fingers!==p&&b)te=v,x(e,te);else if($(e,Y),G=M(se[0].start,se[0].end),X=A(se[0].start,se[0].end),(i.swipeStatus||i.pinchStatus)&&(t=x(e,te)),!i.triggerOnTouchEnd){var n=!T();k()===!0?(te=m,t=x(e,te)):n&&(te=v,x(e,te))}t===!1&&(te=v,x(e,te))}}function C(e){if(e=e.originalEvent,e.touches&&e.touches.length>0)return!0;if(e.preventDefault(),oe=N(),0!=Z&&(J=P(se[0].end,se[1].end),K=D(Z,J),Q=I(se[0].end,se[1].end)),G=M(se[0].start,se[0].end),Y=L(se[0].start,se[0].end),X=A(),i.triggerOnTouchEnd||i.triggerOnTouchEnd===!1&&te===g){te=m;var t=R()||!O(),s=ie===i.fingers||i.fingers===p||!b,n=0!==se[0].end.x,o=s&&n&&t;if(o){var a=T(),r=k();r!==!0&&null!==r||!a?a&&r!==!1||(te=v,x(e,te)):x(e,te)}else te=v,x(e,te)}else te===g&&(te=v,x(e,te));ee.unbind(U,_,!1),ee.unbind(W,C,!1),j(!1)}function S(){ie=0,oe=0,ne=0,Z=0,J=0,K=1,j(!1)}function x(e,t){var h=void 0;if(i.swipeStatus&&(h=i.swipeStatus.call(ee,e,t,Y||null,G||0,X||0,ie)),i.pinchStatus&&R()&&(h=i.pinchStatus.call(ee,e,t,Q||null,J||0,X||0,ie,K)),t===v&&(!i.click||1!==ie&&b||!isNaN(G)&&0!==G||(h=i.click.call(ee,e,e.target))),t==m){switch(i.swipe&&(h=i.swipe.call(ee,e,Y,G,X,ie,i)),Y){case s:i.swipeLeft&&(h=i.swipeLeft.call(ee,e,Y,G,X,ie,i));break;case n:i.swipeRight&&(h=i.swipeRight.call(ee,e,Y,G,X,ie,i));break;case o:i.swipeUp&&(h=i.swipeUp.call(ee,e,Y,G,X,ie,i));break;case a:i.swipeDown&&(h=i.swipeDown.call(ee,e,Y,G,X,ie,i))}switch(Q){case r:i.pinchIn&&(h=i.pinchIn.call(ee,e,Q||null,J||0,X||0,ie,K));break;case l:i.pinchOut&&(h=i.pinchOut.call(ee,e,Q||null,J||0,X||0,ie,K))}}return(t===v||t===m)&&S(e),h}function k(){return null!==i.threshold?G>=i.threshold:null}function T(){var e;return e=i.maxTimeThreshold&&X>=i.maxTimeThreshold?!1:!0}function $(e,t){if(i.allowPageScroll===h||O())e.preventDefault();else{var r=i.allowPageScroll===d;switch(t){case s:(i.swipeLeft&&r||!r&&i.allowPageScroll!=c)&&e.preventDefault();break;case n:(i.swipeRight&&r||!r&&i.allowPageScroll!=c)&&e.preventDefault();break;case o:(i.swipeUp&&r||!r&&i.allowPageScroll!=u)&&e.preventDefault();break;case a:(i.swipeDown&&r||!r&&i.allowPageScroll!=u)&&e.preventDefault();
}}}function A(){return oe-ne}function P(e,t){var i=Math.abs(e.x-t.x),s=Math.abs(e.y-t.y);return Math.round(Math.sqrt(i*i+s*s))}function D(e,t){var i=t/e*1;return i.toFixed(2)}function I(){return 1>K?l:r}function M(e,t){return Math.round(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)))}function E(e,t){var i=e.x-t.x,s=t.y-e.y,n=Math.atan2(s,i),o=Math.round(180*n/Math.PI);return 0>o&&(o=360-Math.abs(o)),o}function L(e,t){var i=E(e,t);return 45>=i&&i>=0?s:360>=i&&i>=315?s:i>=135&&225>=i?n:i>45&&135>i?a:o}function N(){var e=new Date;return e.getTime()}function F(){ee.unbind(V,w),ee.unbind(q,S),ee.unbind(U,_),ee.unbind(W,C),j(!1)}function O(){return i.pinchStatus||i.pinchIn||i.pinchOut}function R(){return Q&&O()}function B(){return ee.data(y+"_intouch")===!0?!0:!1}function j(e){e=e===!0?!0:!1,ee.data(y+"_intouch",e)}function z(){for(var e=[],t=0;5>=t;t++)e.push({start:{x:0,y:0},end:{x:0,y:0},delta:{x:0,y:0}});return e}var H=b||!i.fallbackToMouseEvents,V=H?"touchstart":"mousedown",U=H?"touchmove":"mousemove",W=H?"touchend":"mouseup",q="touchcancel",G=0,Y=null,X=0,Z=0,J=0,K=1,Q=0,ee=e(t),te="start",ie=0,se=null,ne=0,oe=0;try{ee.bind(V,w),ee.bind(q,S)}catch(ae){e.error("events not supported "+V+","+q+" on jQuery.swipe")}this.enable=function(){return ee.bind(V,w),ee.bind(q,S),ee},this.disable=function(){return F(),ee},this.destroy=function(){return F(),ee.data(y,null),ee}}var s="left",n="right",o="up",a="down",r="in",l="out",h="none",d="auto",c="horizontal",u="vertical",p="all",f="start",g="move",m="end",v="cancel",b="ontouchstart"in window,y="TouchSwipe",w={fingers:1,threshold:75,maxTimeThreshold:null,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,triggerOnTouchEnd:!0,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};e.fn.swipe=function(i){var s=e(this),n=s.data(y);if(n&&"string"==typeof i){if(n[i])return n[i].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+i+" does not exist on jQuery.swipe")}else if(!(n||"object"!=typeof i&&i))return t.apply(this,arguments);return s},e.fn.swipe.defaults=w,e.fn.swipe.phases={PHASE_START:f,PHASE_MOVE:g,PHASE_END:m,PHASE_CANCEL:v},e.fn.swipe.directions={LEFT:s,RIGHT:n,UP:o,DOWN:a,IN:r,OUT:l},e.fn.swipe.pageScroll={NONE:h,HORIZONTAL:c,VERTICAL:u,AUTO:d},e.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:p}}),define("modules/interactives/interactive-ads",["jquery","underscore","backbone","pubsub","utils","baseview","directAdPosition"],function(e,t,i,s,n,o,a){var r=o.extend({initialize:function(e){o.prototype.initialize.call(this,e),this.$el.length>0&&this.setupAds()},setupAds:function(){var e=this.$el.data(),t={title:e.seoTitle,series:e.series,sitePage:"usat/"+(e.ssts||"").replace(/\/\/*$/,""),topic:e.topic};this.subviews.sponsorshipAd=new a({el:this.$el,adPlacement:"sponsor_logo/interactive",adSizes:["sponsor_logo"],targeting:t})}});return r}),define("modules/interactives/interactive-templates",["jquery","underscore","state","pubsub","utils","baseview","ui/loader","modules/global/brightcove-video","modules/videos/pluto/pluto-wrapper","ui/generic-paginator","touchswipe","meteredAdPosition","adLogger","modules/interactives/interactive-ads"],function(e,t,i,s,n,o,a,r,l,h,d,c,u,p){var f=o.extend({el:".interactive",events:{"click .slide-nav.prev, .slide-nav.next":"onArrowClick","click .navigation li":"onNavClick"},initialize:function(i){t.bindAll(this,"beforePaginatorClick","goTo"),i=e.extend({ads:!1,adSponsor:!1,adTransition:!1,ignoreFirstNav:!1,interactiveType:"",isFramed:!1,standAlone:!1},i),this.$leftArrow=this.$(".slide-nav.prev"),this.$rightArrow=this.$(".slide-nav.next"),this.$viewport=this.$(".viewport"),this.$slideContainer=this.$viewport.find(".slides"),this.$slides=this.$slideContainer.find(".slide"),this.$navigation=this.$(".navigation"),this.$navigationItems=this.$navigation.find("li"),this.slideNum=this.$slides.length,e(this.$slides[this.$slides.length-1]).hasClass("partner-slide-ad")&&(this.slideNum-=1),this.slideWidth=this.$slides.outerWidth(),this.slideHeight=this.$slides.outerHeight(),this.slideWidthPad="sequencer"===this.options.interactiveType?this.$(".stage").outerWidth()-this.slideWidth:0,this.maxSlides=this.slideNum,this.$slideContainer.width(this.maxSlides*this.slideWidth),this.currentSlideIndex=0,this.subviews={},this.setupSwipes(),this.$viewport.hasClass("slide")&&this.$slides.css({display:"inline-block"}),o.prototype.initialize.call(this,i),this.subviews.video=[],this.subviews.paginator=new h({onBeforePaginator:this.beforePaginatorClick,el:this.$(".paginator"),onGoTo:this.goTo}),this.setupAds()},beforePaginatorClick:function(e,t){var i=e<this.currentSlideIndex?"left":"right";return!this.showingAd&&this.shouldShowAd()?(this.showAd(i),!1):(this.options.isFramed!==!0&&this.trackPageView(),!0)},goTo:function(e){this._switchSlides(this._getSlideIn(e),this._getSlideOut())},onArrowClick:function(t){var i=e(t.currentTarget).is(this.$leftArrow)?"left":"right";return"chronology"!==this.options.interactiveType&&"beforeandafter"!==this.options.interactiveType||this.options.isFramed===!0||this.trackPageView(),!this.showingAd&&this.shouldShowAd()?(this.showAd(i),!1):this.showingAd&&this.showingAd.index()===this.currentSlideIndex?("left"===i?this.subviews.paginator.goToPage(this.currentSlideIndex-1):this.subviews.paginator.goToPage(this.currentSlideIndex),!1):("left"===i?this.previousSlide():this.nextSlide(),!1)},onNavClick:function(t){var i=e(t.currentTarget),s=i.parent().find("li"),n=s.index(i);return 0===n&&this.options.ignoreFirstNav?!1:(this.options.ignoreFirstNav&&n--,this.goTo(n),!1)},onSwipeSlide:function(e,t,i,s,n,o){"right"===t||"down"===t?o.self.previousSlide():o.self.nextSlide()},previousSlide:function(){if(this.subviews.paginator.$el.length<1){var e=this.currentSlideIndex>0?this.currentSlideIndex-1:this.slideNum-1;this.goTo(e)}else this.subviews.paginator.goToPrevPage(this.currentSlideIndex)},nextSlide:function(){if(this.subviews.paginator.$el.length<1){var e=this.currentSlideIndex<this.slideNum-1?this.currentSlideIndex+1:0;this.goTo(e)}else this.subviews.paginator.goToNextPage(this.currentSlideIndex)},setupAds:function(){if(this.options.ads){this.subviews.interactiveAds=new p({el:this.$(".interactive-sponsor")});var e=this.$el.data(),t={title:e.seoTitle,series:e.series,sitePage:"usat/"+(e.ssts||"").replace(/\/\/*$/,""),topic:e.topic},i=this.$viewport.width(),s=this.$viewport.height();450>s||600>i?u.logWarn("Advertisement viewport is too small: "+i+"x"+s):(this.$adSlide=this.$(".partner-slide-ad"),this.$adSlide.length>0&&(this.options.adTransition=!0,this.$adContents=this.$adSlide.find(".interactive-ad"),this.subviews.ad=new c({el:this.$adContents,adPlacement:"transition_interactive/"+e.cst,adSizes:["elastic"],meterThreshold:"transition_interactive",rateMeterId:"asset_"+e.interactiveId,targeting:t})))}},setupSwipes:function(){if(Modernizr.touch&&"beforeandafter"!==this.options.interactiveType&&"timeline"!==this.options.interactiveType){var e=this;this.$slideContainer.swipe({self:e,swipe:e.onSwipeSlide})}},shouldShowAd:function(){return!this.showingAd&&this.options.ads&&this.subviews.ad&&this.subviews.ad.shouldShowAd()?!0:!1},showAd:function(e){var i=this._getSlideOut();if(this.showingAd=this.$adSlide,this.$adContents.show(),i[0]!==this.showingAd[0]){var s=this.showingAd.detach();"left"===e?s.insertBefore(i):"right"===e&&s.insertAfter(i),this.$slides=this.$slideContainer.find(".slide"),this._switchSlides(this.showingAd,i,e).done(t.bind(function(){this.$slides.removeClass("active"),this.subviews.ad.playAd()},this))}},trackClick:function(e){this.trackFirstClick(),s.trigger("uotrack",e)},trackFirstClick:function(){this.firstClick||(s.trigger("uotrack",this.options.interactiveType+"firstclick"),this.firstClick=!0)},trackPageView:function(){this.trackFirstClick();var t={contenttype:this.$el.data("contenttype"),pathName:this.trackPathName("")},n=i.getActivePageInfo();t=e.extend(n,t),s.trigger("analytics:pageload",t)},trackPathName:function(e){var t;return t=this.options.standAlone===!0?document.location.pathname:"/interactive/"+this.$el.data("interactive-id")+"/",t=this.options.interactiveType+t+this.$el.data("seoTitle")+"/"+e},_getSlideOut:function(){var e;return e=this.showingAd&&this.showingAd.length>0?this.showingAd:this.$slides.eq(this.currentSlideIndex)},_getSlideIn:function(e){this.options.adTransition&&this.$adSlide.index()<=e&&(e+=1);var t=this.$slides.eq(e);return t},_switchSlides:function(i,s){var n,o=s.index(),a=i.index(),h=this.slideWidth*a,d=this.slideHeight*a,c=this.options.adTransition&&this.$adSlide.index()<this.maxSlides?!0:!1;s===this.showingAd&&this.subviews.ad.stopAd(),0===a?(this.$leftArrow.addClass("invisible"),this.$rightArrow.removeClass("invisible")):a===this.maxSlides-1&&!c||a===this.maxSlides&&c?(this.$leftArrow.removeClass("invisible"),this.$rightArrow.addClass("invisible")):(this.$leftArrow.removeClass("invisible"),this.$rightArrow.removeClass("invisible")),t.each(this.subviews.video,function(e){e.destroy()}),this.subviews.video=[];var u=a;if(this.options.ignoreFirstNav&&u++,this.$navigationItems.removeClass("active").eq(u).addClass("active"),this.$viewport.hasClass("slide")||this.$viewport.hasClass("slide-transition"))n=this.animate(this.$slideContainer,"left",-1*h+this.slideWidthPad+"px",400,"ease-in-out",0).done(t.bind(function(){this.showingAd&&s[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("vslide-transition"))n=this.animate(this.$slideContainer,"top",-1*d+"px",400,"ease-in-out",0).done(t.bind(function(){this.showingAd&&s[0]===this.showingAd[0]&&(this.subviews.ad.refreshPosition(),"none"!==this.$adContents.css("display")&&this.$adContents.hide(),this.showingAd=null)},this));else if(this.$viewport.hasClass("fade")||this.$viewport.hasClass("fade-transition")){var p=this.$slides.eq(a),f=this.$slides.eq(o);a!==o?(f.css({"z-index":1}),p.css({"z-index":2,opacity:0,display:"block"}),n=this.animate(p,"opacity",1,400,"linear").done(function(){f.css({opacity:0,display:"none"})})):(p.css({opacity:0,display:"block"}),n=this.animate(p,"opacity",1,400,"linear"))}return e.each(this.$slides.eq(a).find(".ui-video-wrapper"),t.bind(function(t,i){this.options.interactiveType&&"chronology"===this.options.interactiveType&&(this.currentSlideIndex=a),this.currentSlideIndex===a&&(this.video_container=this.$(".ui-video-wrapper"),this.plutoVideo=new l({el:e(i).find(".ui-pluto-video:eq(0)")}),this.videoPlacement=this.plutoVideo.subviews.plutovideo,this.subviews.video.push(this.plutoVideo),this.videoPlacement.placement.autoplay&&this.videoPlacement.playVideo())},this)),e.each(this.$slides.eq(a).find(".video"),t.bind(function(t,i){var s=new r({el:e(i).find(".video"),autostart:!0});this.subviews.video.push(s)},this)),this.$slides.removeClass("active").eq(a).addClass("active"),this.currentSlideIndex=a,n}});return f}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/core",["jquery"],e):e(jQuery)}(function(e){function t(t,s){var n,o,a,r=t.nodeName.toLowerCase();return"area"===r?(n=t.parentNode,o=n.name,t.href&&o&&"map"===n.nodeName.toLowerCase()?(a=e("img[usemap='#"+o+"']")[0],!!a&&i(a)):!1):(/input|select|textarea|button|object/.test(r)?!t.disabled:"a"===r?t.href||s:s)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.1",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function(t){var i=this.css("position"),s="absolute"===i,n=t?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var t=e(this);return s&&"static"===t.css("position")?!1:n.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,s){return!!e.data(t,s[3])},focusable:function(i){return t(i,!isNaN(e.attr(i,"tabindex")))},tabbable:function(i){var s=e.attr(i,"tabindex"),n=isNaN(s);return(n||s>=0)&&t(i,!n)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function s(t,i,s,o){return e.each(n,function(){i-=parseFloat(e.css(t,"padding"+this))||0,s&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),o&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?a["inner"+i].call(this):this.each(function(){e(this).css(o,s(this,t)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(o,s(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(i,s){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),s&&s.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,s,n=e(this[0]);n.length&&n[0]!==document;){if(i=n.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(s=parseInt(n.css("zIndex"),10),!isNaN(s)&&0!==s))return s;n=n.parent()}return 0}}),e.ui.plugin={add:function(t,i,s){var n,o=e.ui[t].prototype;for(n in s)o.plugins[n]=o.plugins[n]||[],o.plugins[n].push([i,s[n]])},call:function(e,t,i,s){var n,o=e.plugins[t];if(o&&(s||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(n=0;n<o.length;n++)e.options[o[n][0]]&&o[n][1].apply(e.element,i)}}}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/widget",["jquery"],e):e(jQuery)}(function(e){var t=0,i=Array.prototype.slice;return e.cleanData=function(t){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{s=e._data(n,"events"),s&&s.remove&&e(n).triggerHandler("remove")}catch(a){}t(i)}}(e.cleanData),e.widget=function(t,i,s){var n,o,a,r,l={},h=t.split(".")[0];return t=t.split(".")[1],n=h+"-"+t,s||(s=i,i=e.Widget),e.expr[":"][n.toLowerCase()]=function(t){return!!e.data(t,n)},e[h]=e[h]||{},o=e[h][t],a=e[h][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,o,{version:s.version,_proto:e.extend({},s),_childConstructors:[]}),r=new i,r.options=e.widget.extend({},r.options),e.each(s,function(t,s){return e.isFunction(s)?void(l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},n=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,o=this._superApply;return this._super=e,this._superApply=n,t=s.apply(this,arguments),this._super=i,this._superApply=o,t}}()):void(l[t]=s)}),a.prototype=e.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix||t:t},l,{constructor:a,namespace:h,widgetName:t,widgetFullName:n}),o?(e.each(o._childConstructors,function(t,i){var s=i.prototype;e.widget(s.namespace+"."+s.widgetName,a,i._proto)}),delete o._childConstructors):i._childConstructors.push(a),e.widget.bridge(t,a),a},e.widget.extend=function(t){for(var s,n,o=i.call(arguments,1),a=0,r=o.length;r>a;a++)for(s in o[a])n=o[a][s],o[a].hasOwnProperty(s)&&void 0!==n&&(e.isPlainObject(n)?t[s]=e.isPlainObject(t[s])?e.widget.extend({},t[s],n):e.widget.extend({},n):t[s]=n);return t},e.widget.bridge=function(t,s){var n=s.prototype.widgetFullName||t;e.fn[t]=function(o){var a="string"==typeof o,r=i.call(arguments,1),l=this;return o=!a&&r.length?e.widget.extend.apply(null,[o].concat(r)):o,a?this.each(function(){var i,s=e.data(this,n);return"instance"===o?(l=s,!1):s?e.isFunction(s[o])&&"_"!==o.charAt(0)?(i=s[o].apply(s,r),i!==s&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,n);t?(t.option(o||{}),t._init&&t._init()):e.data(this,n,new s(o,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,s){s=e(s||this.defaultElement||this)[0],this.element=e(s),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),i),this.bindings=e(),this.hoverable=e(),this.focusable=e(),s!==this&&(e.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===s&&this.destroy()}}),this.document=e(s.style?s.ownerDocument:s.document||s),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var s,n,o,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},s=t.split("."),t=s.shift(),s.length){for(n=a[t]=e.widget.extend({},this.options[t]),o=0;o<s.length-1;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(t=s.pop(),1===arguments.length)return void 0===n[t]?null:n[t];n[t]=i}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,i,s){var n,o=this;"boolean"!=typeof t&&(s=i,i=t,t=!1),s?(i=n=e(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),e.each(s,function(s,a){function r(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||e.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,d=l[2];d?n.delegate(d,h,r):i.bind(h,r)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?s[e]:e).apply(s,arguments)}var s=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,s){var n,o,a=this.options[t];if(s=s||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(e.isFunction(a)&&a.apply(this.element[0],[i].concat(s))===!1||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?n===!0||"number"==typeof n?i:n.effect||i:t;n=n||{},"number"==typeof n&&(n={duration:n}),a=!e.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&e.effects&&e.effects.effect[r]?s[t](n):r!==t&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){e(this)[t](),o&&o.call(s[0]),i()})}}),e.widget}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/mouse",["jquery","./widget"],e):e(jQuery)}(function(e){var t=!1;return e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.11.1",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(i){return!0===e.data(i.target,t.widgetName+".preventClickEvent")?(e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var s=this,n=1===i.which,o="string"==typeof this.options.cancel&&i.target.nodeName?e(i.target).closest(this.options.cancel).length:!1;return n&&!o&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===e.data(i.target,this.widgetName+".preventClickEvent")&&e.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return s._mouseMove(e)},this._mouseUpDelegate=function(e){return s._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(i){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&e.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),t=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/draggable",["jquery","./core","./mouse","./widget"],e):e(jQuery)}(function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"1.11.1",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var i=this.document[0],s=this.options;try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&e(i.activeElement).blur()}catch(n){}return this.helper||s.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(s.iframeFix===!0?"iframe":s.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var i=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();if(this._trigger("drag",t,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var i=this,s=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(s=e.ui.ddmanager.drop(this,t)),this.dropped&&(s=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!s||"valid"===this.options.revert&&s||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,s)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",t)!==!1&&i._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(t){var i=this.options,s=e.isFunction(i.helper)?e(i.helper.apply(this.element[0],[t])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,i,s,n=this.options,o=this.document[0];return this.relativeContainer=null,n.containment?"window"===n.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===n.containment?void(this.containment=[0,0,e(o).width()-this.helperProportions.width-this.margins.left,(e(o).height()||o.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):n.containment.constructor===Array?void(this.containment=n.containment):("parent"===n.containment&&(n.containment=this.helper[0].parentNode),
i=e(n.containment),s=i[0],void(s&&(t="hidden"!==i.css("overflow"),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var i="absolute"===e?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:t.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},_generatePosition:function(e,t){var i,s,n,o,a=this.options,r=this._isRootNode(this.scrollParent[0]),l=e.pageX,h=e.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relativeContainer?(s=this.relativeContainer.offset(),i=[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):i=this.containment,e.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),e.pageY-this.offset.click.top<i[1]&&(h=i[1]+this.offset.click.top),e.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),e.pageY-this.offset.click.top>i[3]&&(h=i[3]+this.offset.click.top)),a.grid&&(n=a.grid[1]?this.originalPageY+Math.round((h-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,h=i?n-this.offset.click.top>=i[1]||n-this.offset.click.top>i[3]?n:n-this.offset.click.top>=i[1]?n-a.grid[1]:n+a.grid[1]:n,o=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?o-this.offset.click.left>=i[0]||o-this.offset.click.left>i[2]?o:o-this.offset.click.left>=i[0]?o-a.grid[0]:o+a.grid[0]:o),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(h=this.originalPageY)),{top:h-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,i,s){return s=s||this._uiHash(),e.ui.plugin.call(this,t,[i,s,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,i,s)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,i,s){var n=s.options,o=e.extend({},i,{item:s.element});s.sortables=[],e(n.connectToSortable).each(function(){var i=e(this).sortable("instance");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,o))})},stop:function(t,i,s){var n=e.extend({},i,{item:s.element});e.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,n))})},drag:function(t,i,s){var n=this;e.each(s.sortables,function(){var o=!1,a=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(a.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(n).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",t),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",t),s.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,i,s){var n=e("body"),o=s.options;n.css("cursor")&&(o._cursor=n.css("cursor")),n.css("cursor",o.cursor)},stop:function(t,i,s){var n=s.options;n._cursor&&e("body").css("cursor",n._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,i,s){var n=e(i.helper),o=s.options;n.css("opacity")&&(o._opacity=n.css("opacity")),n.css("opacity",o.opacity)},stop:function(t,i,s){var n=s.options;n._opacity&&e(i.helper).css("opacity",n._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,i,s){var n=s.options,o=!1,a=s.scrollParentNotHidden[0],r=s.document[0];a!==r&&"HTML"!==a.tagName?(n.axis&&"x"===n.axis||(s.overflowOffset.top+a.offsetHeight-t.pageY<n.scrollSensitivity?a.scrollTop=o=a.scrollTop+n.scrollSpeed:t.pageY-s.overflowOffset.top<n.scrollSensitivity&&(a.scrollTop=o=a.scrollTop-n.scrollSpeed)),n.axis&&"y"===n.axis||(s.overflowOffset.left+a.offsetWidth-t.pageX<n.scrollSensitivity?a.scrollLeft=o=a.scrollLeft+n.scrollSpeed:t.pageX-s.overflowOffset.left<n.scrollSensitivity&&(a.scrollLeft=o=a.scrollLeft-n.scrollSpeed))):(n.axis&&"x"===n.axis||(t.pageY-e(r).scrollTop()<n.scrollSensitivity?o=e(r).scrollTop(e(r).scrollTop()-n.scrollSpeed):e(window).height()-(t.pageY-e(r).scrollTop())<n.scrollSensitivity&&(o=e(r).scrollTop(e(r).scrollTop()+n.scrollSpeed))),n.axis&&"y"===n.axis||(t.pageX-e(r).scrollLeft()<n.scrollSensitivity?o=e(r).scrollLeft(e(r).scrollLeft()-n.scrollSpeed):e(window).width()-(t.pageX-e(r).scrollLeft())<n.scrollSensitivity&&(o=e(r).scrollLeft(e(r).scrollLeft()+n.scrollSpeed)))),o!==!1&&e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,i,s){var n=s.options;s.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var t=e(this),i=t.offset();this!==s.element[0]&&s.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:i.top,left:i.left})})},drag:function(t,i,s){var n,o,a,r,l,h,d,c,u,p,f=s.options,g=f.snapTolerance,m=i.offset.left,v=m+s.helperProportions.width,b=i.offset.top,y=b+s.helperProportions.height;for(u=s.snapElements.length-1;u>=0;u--)l=s.snapElements[u].left,h=l+s.snapElements[u].width,d=s.snapElements[u].top,c=d+s.snapElements[u].height,l-g>v||m>h+g||d-g>y||b>c+g||!e.contains(s.snapElements[u].item.ownerDocument,s.snapElements[u].item)?(s.snapElements[u].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[u].item})),s.snapElements[u].snapping=!1):("inner"!==f.snapMode&&(n=Math.abs(d-y)<=g,o=Math.abs(c-b)<=g,a=Math.abs(l-v)<=g,r=Math.abs(h-m)<=g,n&&(i.position.top=s._convertPositionTo("relative",{top:d-s.helperProportions.height,left:0}).top-s.margins.top),o&&(i.position.top=s._convertPositionTo("relative",{top:c,left:0}).top-s.margins.top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l-s.helperProportions.width}).left-s.margins.left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h}).left-s.margins.left)),p=n||o||a||r,"outer"!==f.snapMode&&(n=Math.abs(d-b)<=g,o=Math.abs(c-y)<=g,a=Math.abs(l-m)<=g,r=Math.abs(h-v)<=g,n&&(i.position.top=s._convertPositionTo("relative",{top:d,left:0}).top-s.margins.top),o&&(i.position.top=s._convertPositionTo("relative",{top:c-s.helperProportions.height,left:0}).top-s.margins.top),a&&(i.position.left=s._convertPositionTo("relative",{top:0,left:l}).left-s.margins.left),r&&(i.position.left=s._convertPositionTo("relative",{top:0,left:h-s.helperProportions.width}).left-s.margins.left)),!s.snapElements[u].snapping&&(n||o||a||r||p)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,t,e.extend(s._uiHash(),{snapItem:s.snapElements[u].item})),s.snapElements[u].snapping=n||o||a||r||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,i,s){var n,o=s.options,a=e.makeArray(e(o.stack)).sort(function(t,i){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(i).css("zIndex"),10)||0)});a.length&&(n=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each(function(t){e(this).css("zIndex",n+t)}),this.css("zIndex",n+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,i,s){var n=e(i.helper),o=s.options;n.css("zIndex")&&(o._zIndex=n.css("zIndex")),n.css("zIndex",o.zIndex)},stop:function(t,i,s){var n=s.options;n._zIndex&&e(i.helper).css("zIndex",n._zIndex)}}),e.ui.draggable}),define("modules/interactives/before-after",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable"],function(e,t,i,s,n,o){var a=n.extend({events:function(){var e={"click .image-container":"handleClick"};return e[(Modernizr.touch?"touchstart":"click")+" .before-after-caption-toggle"]="toggleCaption",e},initialize:function(i){i=e.extend({animateIntro:!0,introDelay:1e3,introDuration:1500,introPosition:.5,cursor:"e-resize"},i),n.prototype.initialize.call(this,i),this.$el.length&&(this.subviews.template=new o({el:this.$el,interactiveType:"beforeandafter",isFramed:i.isFramed,standAlone:i.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),Modernizr.touch?require(["touchpunch"],t.bind(this._setup,this)):this._setup())},destroy:function(){this.$(".before-after-drag-handle").draggable("destroy"),n.prototype.destroy.apply(this,arguments)},_setup:function(){this.destroyed||t.each(this.$(".image-container"),function(t,i){this._setupBeforeAfter(e(t),i)},this)},toggleCaption:function(t){var i=e(t.currentTarget),s=i.closest(".slide").find(".meta"),n=s.is(":visible");s.fadeToggle(function(){i.text(n?"Show Caption":"Hide Caption")}),this.options.isFramed||this.subviews.template.trackClick(n?"beforeandafter_caption_off":"beforeandafter_caption_on")},handleClick:function(t){var i=e(t.currentTarget),s=e(".before-after-drag-handle",i),n=s.width()/2;this.subviews.template.trackFirstClick();var o=t.pageX-i.offset().left;e(".before-after-drag-handle",i).stop().css("left",o-n+"px"),e(".before-after-before-wrapper",i).stop().width(o+"px")},_setupBeforeAfter:function(t,i){function s(){h.width(parseInt(e(this).css("left"),10)+r/2)}var n=t,o=this.options,a=e(".before-after-draw-handle-image",n),r=a.width(),l=e(".before-after-drag-handle",n),h=e(".before-after-before-wrapper",n),d=h.width(),c=h.height(),u=d*o.introPosition;a.css({cursor:o.cursor,top:c/2-a.height()/2+"px"}),l.draggable({containment:n,drag:s,stop:s,axis:"x"}),o.animateIntro&&0===i?this.animateIntro(h,l,d,u):(l.css({left:u-r/2+"px"}),h.width(u))},animateIntro:function(e,t,i,s){var n=this.options,o=t.width()/2;t.css("left",i-o+"px"),setTimeout(function(){t.animate({left:s-o+"px"},n.introDuration),e.animate({width:s+"px"},n.introDuration)},n.introDelay)}});return a}),define("modules/fronts/assigned-content-nav",["jquery","underscore","baseview","ui/generic-paginator"],function(e,t,i,s){var n=i.extend({events:{"click .acnpm-filter":"filterItems"},initialize:function(e){t.bindAll(this,"goTo"),this.subviews={},this.$itemsContainer=this.$(".acnpm-items-container"),this.$items=this.$(".acnpm-item"),this.itemsPerRow=this.$el.hasClass("six-across")?6:8,this.$pageElements=this.$(".paginator-indicator-target"),this.subviews.paginator=new s({el:this.$(".paginator"),onGoTo:this.goTo}),i.prototype.initialize.call(this,e)},filterItems:function(e){e.preventDefault();var t,i,s=e.currentTarget.id;this.$(".acnpm-filter").removeClass("selected").filter(e.currentTarget).addClass("selected"),this.$pageElements.eq(0).trigger("click"),this.$items.show(),"all"!=s&&this.$items.not("."+s).hide(),t=this.$items.filter(":visible").length,i=Math.floor(t/this.itemsPerRow),0===i?this.$(".acnpm-container").addClass("nopagination"):(this.$(".acnpm-container").removeClass("nopagination"),this.$pageElements.show().filter(":gt("+i+")").hide())},goTo:function(e){this.animate(this.$itemsContainer,"left",696*-e+"px",450,"ease-in-out")}});return n}),!function(e){var t={},s={mode:"horizontal",slideSelector:"",infiniteLoop:!0,hideControlOnEnd:!1,speed:500,easing:null,slideMargin:0,startSlide:0,randomStart:!1,captions:!1,ticker:!1,tickerHover:!1,adaptiveHeight:!1,adaptiveHeightSpeed:500,video:!1,useCSS:!0,preloadImages:"visible",responsive:!0,touchEnabled:!0,swipeThreshold:50,oneToOneTouch:!0,preventDefaultSwipeX:!0,preventDefaultSwipeY:!1,pager:!0,pagerType:"full",pagerShortSeparator:" / ",pagerSelector:null,buildPager:null,pagerCustom:null,controls:!0,nextText:"Next",prevText:"Prev",nextSelector:null,prevSelector:null,autoControls:!1,startText:"Start",stopText:"Stop",autoControlsCombine:!1,autoControlsSelector:null,auto:!1,pause:4e3,autoStart:!0,autoDirection:"next",autoHover:!1,autoDelay:0,minSlides:1,maxSlides:1,moveSlides:0,slideWidth:0,onSliderLoad:function(){},onSlideBefore:function(){},onSlideAfter:function(){},onSlideNext:function(){},onSlidePrev:function(){}};e.fn.bxSlider=function(n){if(0==this.length)return this;if(this.length>1)return this.each(function(){e(this).bxSlider(n)}),this;var o={},a=this;t.el=this;var r=e(window).width(),l=e(window).height(),h=function(){o.settings=e.extend({},s,n),o.settings.slideWidth=parseInt(o.settings.slideWidth),o.children=a.children(o.settings.slideSelector),o.children.length<o.settings.minSlides&&(o.settings.minSlides=o.children.length),o.children.length<o.settings.maxSlides&&(o.settings.maxSlides=o.children.length),o.settings.randomStart&&(o.settings.startSlide=Math.floor(Math.random()*o.children.length)),o.active={index:o.settings.startSlide},o.carousel=o.settings.minSlides>1||o.settings.maxSlides>1,o.carousel&&(o.settings.preloadImages="all"),o.minThreshold=o.settings.minSlides*o.settings.slideWidth+(o.settings.minSlides-1)*o.settings.slideMargin,o.maxThreshold=o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin,o.working=!1,o.controls={},o.interval=null,o.animProp="vertical"==o.settings.mode?"top":"left",o.usingCSS=o.settings.useCSS&&"fade"!=o.settings.mode&&function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var i in t)if(void 0!==e.style[t[i]])return o.cssPrefix=t[i].replace("Perspective","").toLowerCase(),o.animProp="-"+o.cssPrefix+"-transform",!0;return!1}(),"vertical"==o.settings.mode&&(o.settings.maxSlides=o.settings.minSlides),a.data("origStyle",a.attr("style")),a.children(o.settings.slideSelector).each(function(){e(this).data("origStyle",e(this).attr("style"))}),d()},d=function(){a.wrap('<div class="bx-wrapper"><div class="bx-viewport"></div></div>'),o.viewport=a.parent(),o.loader=e('<div class="bx-loading" />'),o.viewport.prepend(o.loader),a.css({width:"horizontal"==o.settings.mode?100*o.children.length+215+"%":"auto",position:"relative"}),o.usingCSS&&o.settings.easing?a.css("-"+o.cssPrefix+"-transition-timing-function",o.settings.easing):o.settings.easing||(o.settings.easing="swing"),m(),o.viewport.css({width:"100%",overflow:"hidden",position:"relative"}),o.viewport.parent().css({maxWidth:f()}),o.settings.pager||o.viewport.parent().css({margin:"0 auto 0px"}),o.children.css({"float":"horizontal"==o.settings.mode?"left":"none",listStyle:"none",position:"relative"}),o.children.css("width",g()),"horizontal"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginRight",o.settings.slideMargin),"vertical"==o.settings.mode&&o.settings.slideMargin>0&&o.children.css("marginBottom",o.settings.slideMargin),"fade"==o.settings.mode&&(o.children.css({position:"absolute",zIndex:0,display:"none"}),o.children.eq(o.settings.startSlide).css({zIndex:50,display:"block"})),o.controls.el=e('<div class="bx-controls" />'),o.settings.captions&&k(),o.active.last=o.settings.startSlide==v()-1,o.settings.video&&a.fitVids();var t=o.children.eq(o.settings.startSlide);"all"==o.settings.preloadImages&&(t=o.children),o.settings.ticker?o.settings.pager=!1:(o.settings.pager&&C(),o.settings.controls&&S(),o.settings.auto&&o.settings.autoControls&&x(),(o.settings.controls||o.settings.autoControls||o.settings.pager)&&o.viewport.after(o.controls.el)),c(t,u)},c=function(t,i){var s=t.find("img, iframe").length;if(0==s)return void i();var n=0;t.find("img, iframe").each(function(){e(this).is("img")&&e(this).attr("src",e(this).attr("src")+"?timestamp="+(new Date).getTime()),e(this).load(function(){setTimeout(function(){++n==s&&i()},0)})})},u=function(){if(o.settings.infiniteLoop&&"fade"!=o.settings.mode&&!o.settings.ticker){var t="vertical"==o.settings.mode?o.settings.minSlides:o.settings.maxSlides,i=o.children.slice(0,t).clone().addClass("bx-clone"),s=o.children.slice(-t).clone().addClass("bx-clone");a.append(i).prepend(s)}o.loader.remove(),y(),"vertical"==o.settings.mode&&(o.settings.adaptiveHeight=!0),o.viewport.height(p()),a.redrawSlider(),o.settings.onSliderLoad(o.active.index),o.initialized=!0,o.settings.responsive&&e(window).bind("resize",H),o.settings.auto&&o.settings.autoStart&&N(),o.settings.ticker&&F(),o.settings.pager&&I(o.settings.startSlide),o.settings.controls&&L(),o.settings.touchEnabled&&!o.settings.ticker&&R()},p=function(){var t=0,s=e();if("vertical"==o.settings.mode||o.settings.adaptiveHeight)if(o.carousel){var n=1==o.settings.moveSlides?o.active.index:o.active.index*b();for(s=o.children.eq(n),i=1;i<=o.settings.maxSlides-1;i++)s=n+i>=o.children.length?s.add(o.children.eq(i-1)):s.add(o.children.eq(n+i))}else s=o.children.eq(o.active.index);else s=o.children;return"vertical"==o.settings.mode?(s.each(function(){t+=e(this).outerHeight()}),o.settings.slideMargin>0&&(t+=o.settings.slideMargin*(o.settings.minSlides-1))):t=Math.max.apply(Math,s.map(function(){return e(this).outerHeight(!1)}).get()),t},f=function(){var e="100%";return o.settings.slideWidth>0&&(e="horizontal"==o.settings.mode?o.settings.maxSlides*o.settings.slideWidth+(o.settings.maxSlides-1)*o.settings.slideMargin:o.settings.slideWidth),e},g=function(){var e=o.settings.slideWidth,t=o.viewport.width();return 0==o.settings.slideWidth||o.settings.slideWidth>t&&!o.carousel||"vertical"==o.settings.mode?e=t:o.settings.maxSlides>1&&"horizontal"==o.settings.mode&&(t>o.maxThreshold||t<o.minThreshold&&(e=(t-o.settings.slideMargin*(o.settings.minSlides-1))/o.settings.minSlides)),e},m=function(){var e=1;if("horizontal"==o.settings.mode&&o.settings.slideWidth>0)if(o.viewport.width()<o.minThreshold)e=o.settings.minSlides;else if(o.viewport.width()>o.maxThreshold)e=o.settings.maxSlides;else{var t=o.children.first().width();e=Math.floor(o.viewport.width()/t)}else"vertical"==o.settings.mode&&(e=o.settings.minSlides);return e},v=function(){var e=0;if(o.settings.moveSlides>0)if(o.settings.infiniteLoop)e=o.children.length/b();else for(var t=0,i=0;t<o.children.length;)++e,t=i+m(),i+=o.settings.moveSlides<=m()?o.settings.moveSlides:m();else e=Math.ceil(o.children.length/m());return e},b=function(){return o.settings.moveSlides>0&&o.settings.moveSlides<=m()?o.settings.moveSlides:m()},y=function(){if(o.children.length>o.settings.maxSlides&&o.active.last&&!o.settings.infiniteLoop){if("horizontal"==o.settings.mode){var e=o.children.last(),t=e.position();w(-(t.left-(o.viewport.width()-e.width())),"reset",0)}else if("vertical"==o.settings.mode){var i=o.children.length-o.settings.minSlides,t=o.children.eq(i).position();w(-t.top,"reset",0)}}else{var t=o.children.eq(o.active.index*b()).position();o.active.index==v()-1&&(o.active.last=!0),void 0!=t&&("horizontal"==o.settings.mode?w(-t.left,"reset",0):"vertical"==o.settings.mode&&w(-t.top,"reset",0))}},w=function(e,t,i,s){if(o.usingCSS){var n="vertical"==o.settings.mode?"translate3d(0, "+e+"px, 0)":"translate3d("+e+"px, 0, 0)";a.css("-"+o.cssPrefix+"-transition-duration",i/1e3+"s"),"slide"==t?(a.css(o.animProp,n),a.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){a.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),M()})):"reset"==t?a.css(o.animProp,n):"ticker"==t&&(a.css("-"+o.cssPrefix+"-transition-timing-function","linear"),a.css(o.animProp,n),a.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){a.unbind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd"),w(s.resetValue,"reset",0),O()}))}else{var r={};r[o.animProp]=e,"slide"==t?a.animate(r,i,o.settings.easing,function(){M()}):"reset"==t?a.css(o.animProp,e):"ticker"==t&&a.animate(r,speed,"linear",function(){w(s.resetValue,"reset",0),O()})}},_=function(){for(var t="",i=v(),s=0;i>s;s++){var n="";o.settings.buildPager&&e.isFunction(o.settings.buildPager)?(n=o.settings.buildPager(s),o.pagerEl.addClass("bx-custom-pager")):(n=s+1,o.pagerEl.addClass("bx-default-pager")),t+='<div class="bx-pager-item"><a href="" data-slide-index="'+s+'" class="bx-pager-link">'+n+"</a></div>"}o.pagerEl.html(t)},C=function(){o.settings.pagerCustom?o.pagerEl=e(o.settings.pagerCustom):(o.pagerEl=e('<div class="bx-pager" />'),o.settings.pagerSelector?e(o.settings.pagerSelector).html(o.pagerEl):o.controls.el.addClass("bx-has-pager").append(o.pagerEl),_()),o.pagerEl.delegate("a","click",D)},S=function(){o.controls.next=e('<a class="bx-next" href="">'+o.settings.nextText+"</a>"),o.controls.prev=e('<a class="bx-prev" href="">'+o.settings.prevText+"</a>"),o.controls.next.bind("click",T),o.controls.prev.bind("click",$),o.settings.nextSelector&&e(o.settings.nextSelector).append(o.controls.next),o.settings.prevSelector&&e(o.settings.prevSelector).append(o.controls.prev),o.settings.nextSelector||o.settings.prevSelector||(o.controls.directionEl=e('<div class="bx-controls-direction" />'),o.controls.directionEl.append(o.controls.prev).append(o.controls.next),o.controls.el.addClass("bx-has-controls-direction").append(o.controls.directionEl))},x=function(){o.controls.start=e('<div class="bx-controls-auto-item"><a class="bx-start" href="">'+o.settings.startText+"</a></div>"),o.controls.stop=e('<div class="bx-controls-auto-item"><a class="bx-stop" href="">'+o.settings.stopText+"</a></div>"),o.controls.autoEl=e('<div class="bx-controls-auto" />'),o.controls.autoEl.delegate(".bx-start","click",A),o.controls.autoEl.delegate(".bx-stop","click",P),o.settings.autoControlsCombine?o.controls.autoEl.append(o.controls.start):o.controls.autoEl.append(o.controls.start).append(o.controls.stop),o.settings.autoControlsSelector?e(o.settings.autoControlsSelector).html(o.controls.autoEl):o.controls.el.addClass("bx-has-controls-auto").append(o.controls.autoEl),E(o.settings.autoStart?"stop":"start")},k=function(){o.children.each(function(){var t=e(this).find("img:first").attr("title");void 0!=t&&(""+t).length&&e(this).append('<div class="bx-caption"><span>'+t+"</span></div>")})},T=function(e){o.settings.auto&&a.stopAuto(),a.goToNextSlide(),e.preventDefault()},$=function(e){o.settings.auto&&a.stopAuto(),a.goToPrevSlide(),e.preventDefault()},A=function(e){a.startAuto(),e.preventDefault()},P=function(e){a.stopAuto(),e.preventDefault()},D=function(t){o.settings.auto&&a.stopAuto();var i=e(t.currentTarget),s=parseInt(i.attr("data-slide-index"));s!=o.active.index&&a.goToSlide(s),t.preventDefault()},I=function(t){var i=o.children.length;return"short"==o.settings.pagerType?(o.settings.maxSlides>1&&(i=Math.ceil(o.children.length/o.settings.maxSlides)),void o.pagerEl.html(t+1+o.settings.pagerShortSeparator+i)):(o.pagerEl.find("a").removeClass("active"),void o.pagerEl.each(function(i,s){e(s).find("a").eq(t).addClass("active")}))},M=function(){if(o.settings.infiniteLoop){var e="";0==o.active.index?e=o.children.eq(0).position():o.active.index==v()-1&&o.carousel?e=o.children.eq((v()-1)*b()).position():o.active.index==o.children.length-1&&(e=o.children.eq(o.children.length-1).position()),"horizontal"==o.settings.mode?w(-e.left,"reset",0):"vertical"==o.settings.mode&&w(-e.top,"reset",0)}o.working=!1,o.settings.onSlideAfter(o.children.eq(o.active.index),o.oldIndex,o.active.index)},E=function(e){o.settings.autoControlsCombine?o.controls.autoEl.html(o.controls[e]):(o.controls.autoEl.find("a").removeClass("active"),o.controls.autoEl.find("a:not(.bx-"+e+")").addClass("active"))},L=function(){1==v()?(o.controls.prev.addClass("disabled"),o.controls.next.addClass("disabled")):!o.settings.infiniteLoop&&o.settings.hideControlOnEnd&&(0==o.active.index?(o.controls.prev.addClass("disabled"),o.controls.next.removeClass("disabled")):o.active.index==v()-1?(o.controls.next.addClass("disabled"),o.controls.prev.removeClass("disabled")):(o.controls.prev.removeClass("disabled"),o.controls.next.removeClass("disabled")))},N=function(){o.settings.autoDelay>0?setTimeout(a.startAuto,o.settings.autoDelay):a.startAuto(),o.settings.autoHover&&a.hover(function(){o.interval&&(a.stopAuto(!0),o.autoPaused=!0)},function(){o.autoPaused&&(a.startAuto(!0),o.autoPaused=null)})},F=function(){var t=0;if("next"==o.settings.autoDirection)a.append(o.children.clone().addClass("bx-clone"));else{a.prepend(o.children.clone().addClass("bx-clone"));var i=o.children.first().position();t="horizontal"==o.settings.mode?-i.left:-i.top}w(t,"reset",0),o.settings.pager=!1,o.settings.controls=!1,o.settings.autoControls=!1,o.settings.tickerHover&&!o.usingCSS&&o.viewport.hover(function(){a.stop()},function(){var t=0;o.children.each(function(){t+="horizontal"==o.settings.mode?e(this).outerWidth(!0):e(this).outerHeight(!0)});var i=o.settings.speed/t,s="horizontal"==o.settings.mode?"left":"top",n=i*(t-Math.abs(parseInt(a.css(s))));O(n)}),O()},O=function(e){speed=e?e:o.settings.speed;var t={left:0,top:0},i={left:0,top:0};"next"==o.settings.autoDirection?t=a.find(".bx-clone").first().position():i=o.children.first().position();var s="horizontal"==o.settings.mode?-t.left:-t.top,n="horizontal"==o.settings.mode?-i.left:-i.top,r={resetValue:n};w(s,"ticker",speed,r)},R=function(){o.touch={start:{x:0,y:0},end:{x:0,y:0}},o.viewport.bind("touchstart",B)},B=function(e){if(o.working)e.preventDefault();else{o.touch.originalPos=a.position();var t=e.originalEvent;o.touch.start.x=t.changedTouches[0].pageX,o.touch.start.y=t.changedTouches[0].pageY,o.viewport.bind("touchmove",j),o.viewport.bind("touchend",z)}},j=function(e){var t=e.originalEvent,i=Math.abs(t.changedTouches[0].pageX-o.touch.start.x),s=Math.abs(t.changedTouches[0].pageY-o.touch.start.y);if(3*i>s&&o.settings.preventDefaultSwipeX?e.preventDefault():3*s>i&&o.settings.preventDefaultSwipeY&&e.preventDefault(),"fade"!=o.settings.mode&&o.settings.oneToOneTouch){var n=0;if("horizontal"==o.settings.mode){var a=t.changedTouches[0].pageX-o.touch.start.x;n=o.touch.originalPos.left+a}else{var a=t.changedTouches[0].pageY-o.touch.start.y;n=o.touch.originalPos.top+a}w(n,"reset",0)}},z=function(e){o.viewport.unbind("touchmove",j);var t=e.originalEvent,i=0;if(o.touch.end.x=t.changedTouches[0].pageX,o.touch.end.y=t.changedTouches[0].pageY,"fade"==o.settings.mode){var s=Math.abs(o.touch.start.x-o.touch.end.x);s>=o.settings.swipeThreshold&&(o.touch.start.x>o.touch.end.x?a.goToNextSlide():a.goToPrevSlide(),a.stopAuto())}else{var s=0;"horizontal"==o.settings.mode?(s=o.touch.end.x-o.touch.start.x,i=o.touch.originalPos.left):(s=o.touch.end.y-o.touch.start.y,i=o.touch.originalPos.top),!o.settings.infiniteLoop&&(0==o.active.index&&s>0||o.active.last&&0>s)?w(i,"reset",200):Math.abs(s)>=o.settings.swipeThreshold?(0>s?a.goToNextSlide():a.goToPrevSlide(),a.stopAuto()):w(i,"reset",200)}o.viewport.unbind("touchend",z)},H=function(){var t=e(window).width(),i=e(window).height();(r!=t||l!=i)&&(r=t,l=i,a.redrawSlider())};return a.goToSlide=function(t,i){if(!o.working&&o.active.index!=t)if(o.working=!0,o.oldIndex=o.active.index,o.active.index=0>t?v()-1:t>=v()?0:t,o.settings.onSlideBefore(o.children.eq(o.active.index),o.oldIndex,o.active.index),"next"==i?o.settings.onSlideNext(o.children.eq(o.active.index),o.oldIndex,o.active.index):"prev"==i&&o.settings.onSlidePrev(o.children.eq(o.active.index),o.oldIndex,o.active.index),o.active.last=o.active.index>=v()-1,o.settings.pager&&I(o.active.index),o.settings.controls&&L(),"fade"==o.settings.mode)o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed),o.children.filter(":visible").fadeOut(o.settings.speed).css({zIndex:0}),o.children.eq(o.active.index).css("zIndex",51).fadeIn(o.settings.speed,function(){e(this).css("zIndex",50),M()});else{o.settings.adaptiveHeight&&o.viewport.height()!=p()&&o.viewport.animate({height:p()},o.settings.adaptiveHeightSpeed);var s=0,n={left:0,top:0};if(!o.settings.infiniteLoop&&o.carousel&&o.active.last)if("horizontal"==o.settings.mode){var r=o.children.eq(o.children.length-1);n=r.position(),s=o.viewport.width()-r.outerWidth()}else{var l=o.children.length-o.settings.minSlides;n=o.children.eq(l).position()}else if(o.carousel&&o.active.last&&"prev"==i){var h=1==o.settings.moveSlides?o.settings.maxSlides-b():(v()-1)*b()-(o.children.length-o.settings.maxSlides),r=a.children(".bx-clone").eq(h);n=r.position()}else if("next"==i&&0==o.active.index)n=a.find("> .bx-clone").eq(o.settings.maxSlides).position(),o.active.last=!1;else if(t>=0){var d=t*b();n=o.children.eq(d).position()}if("undefined"!=typeof n){var c="horizontal"==o.settings.mode?-(n.left-s):-n.top;w(c,"slide",o.settings.speed)}}},a.goToNextSlide=function(){if(o.settings.infiniteLoop||!o.active.last){var e=parseInt(o.active.index)+1;a.goToSlide(e,"next")}},a.goToPrevSlide=function(){if(o.settings.infiniteLoop||0!=o.active.index){var e=parseInt(o.active.index)-1;a.goToSlide(e,"prev")}},a.startAuto=function(e){o.interval||(o.interval=setInterval(function(){"next"==o.settings.autoDirection?a.goToNextSlide():a.goToPrevSlide()},o.settings.pause),o.settings.autoControls&&1!=e&&E("stop"))},a.stopAuto=function(e){o.interval&&(clearInterval(o.interval),o.interval=null,o.settings.autoControls&&1!=e&&E("start"))},a.getCurrentSlide=function(){return o.active.index},a.getSlideCount=function(){return o.children.length;
},a.redrawSlider=function(){o.children.add(a.find(".bx-clone")).outerWidth(g()),o.viewport.css("height",p()),o.settings.ticker||y(),o.active.last&&(o.active.index=v()-1),o.active.index>=v()&&(o.active.last=!0),o.settings.pager&&!o.settings.pagerCustom&&(_(),I(o.active.index))},a.destroySlider=function(){o.initialized&&(o.initialized=!1,e(".bx-clone",this).remove(),o.children.each(function(){void 0!=e(this).data("origStyle")?e(this).attr("style",e(this).data("origStyle")):e(this).removeAttr("style")}),void 0!=e(this).data("origStyle")?this.attr("style",e(this).data("origStyle")):e(this).removeAttr("style"),e(this).unwrap().unwrap(),o.controls.el&&o.controls.el.remove(),o.controls.next&&o.controls.next.remove(),o.controls.prev&&o.controls.prev.remove(),o.pagerEl&&o.pagerEl.remove(),e(".bx-caption",this).remove(),o.controls.autoEl&&o.controls.autoEl.remove(),clearInterval(o.interval),o.settings.responsive&&e(window).unbind("resize",H))},a.reloadSlider=function(e){void 0!=e&&(n=e),a.destroySlider(),h()},h(),this}}(jQuery),define("bxslider",function(){}),define("modules/sports/sports-more-teams-college",["jquery","underscore","backbone","baseview","bxslider"],function(e,t,i,s){var n=s.extend({initialize:function(){s.prototype.initialize.call(this,this.options),t.bindAll(this,"setup","update"),this.setup()},setup:function(){var t={startSlide:0,slideWidth:150,maxSlides:7,minSlides:4,nextSelector:".sp-more-teams-next-arrow-college",prevSelector:".sp-more-teams-prev-arrow-college",nextText:"next",prevText:"prev",infiniteLoop:!1,hideControlOnEnd:!0,pager:!1};e("#sp-more-teams-slider").data("options")&&(t=e("#sp-more-teams-slider").data("options"),t&&e.each(t,function(e,i){"true"===t[e]?t[e]=!0:"false"===t[e]?t[e]=!1:isNaN(t[e])||(t[e]=parseInt(t[e],10))})),e("#sp-more-teams-slider").bxSlider(t)},update:function(){this.setup()},destroy:function(){s.prototype.destroy.apply(this,arguments)}});return n}),define("modules/sports/sports-scores-suspender",["jquery","underscore","backbone","pubsub","state","baseview","modules/scroller/sidebar-scroll","chosen","animatecolors"],function(e,t,i,s,n,o,a){var r=o.extend({events:{"mouseover .top-wrapper, .bottom-wrapper, .magicscroll, .game":"stopRotation","touchstart .top-wrapper, .bottom-wrapper, .magicscroll, .game":"stopRotation",change:"onChangeLeague","click .game":"gameClicked"},initialize:function(i){e.extend(i,{rotateInterval:5e3,refreshInterval:3e4,leagueFailLimit:3}),o.prototype.initialize.call(this,i),t.bindAll(this,"onScoresLoaded","rotateToNextScore","onUpdateLoaded","scoresSuspenderRefresher"),this.$scroller=this.$(".suspender-scroll-content"),this.$pairings=this.$("#pairings"),this.$noScores=this.$pairings.find(".league.none"),this.padding=parseInt(this.$pairings.css("paddingTop"),10),this.canSlideUp=!0,this.yp=0,this.leagues={},this.scoreType="schedule",this.continueRotate=!0,this.continueRefresh=!0,this.refreshStarted=!1,this.failLeague=null,this.leagueFailCount=1;var s=this.$(".magicscroll").outerHeight(),n=this.$(".bottom-wrapper").outerHeight()+23,a=this.$(".top-wrapper").outerHeight();this.viewport=s-(n+a),this.chosenSelector=this.$(".filter"),this.chosenSelector.chosen({disable_search_threshold:30}),this.startIndex=this.$(".chzn-results .result-selected").index(),this.oldHbox=this.$(".hoverGameFunction"),this.onChangeLeague(),this.addscrollBar()},gameClicked:function(t){this.oldHbox.css("display","none");for(var i=t.target||t.srcElement;i&&!i.id;)i=i.parentNode;var s=e(i).next();s.css("display","block"),this.oldHbox=s},scoresSuspenderRefresher:function(){this.refreshStarted=!0;var e;e="/sports/services/scores-suspender/"+this.league+"/",void 0!==this.$scroller.data("max-count")&&(e+="?count="+this.$scroller.data("max-count")),this.fetchData(e,this.onUpdateLoaded,!0)},stopRefresh:function(){this.continueRefresh=!1,this.refreshID&&clearTimeout(this.refreshID)},stopRotation:function(){this.continueRotate=!1,this.rotateID&&(this.rotateID=clearInterval(this.rotateID)),this.continueRefresh&&!this.refreshStarted&&(this.refreshStarted=!0,this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval))},rotateToNextScore:function(){var e=this.$(".chzn-results .result-selected").next();0===e.length&&(e=this.$(".chzn-results").children(":first")),e.index()===this.startIndex&&this.stopRotation(),e.mouseup()},fetchData:function(e,i,s){s?n.fetchHtml(e).done(i).fail(t.bind(function(){console.log("ERROR: Scores Suspender AJAX load failed!"),this.failLeague==this.league&&(this.leagueFailCount+=1),this.failLeague=this.league,i()},this)):(this.$el.addClass("loading"),n.fetchHtml(e).done(i).fail(t.bind(function(){this.$noScores.show(),i()},this)).always(t.bind(function(){this.$el.removeClass("loading")},this)))},onChangeLeague:function(e){if(this.refreshScrollBar(),this.$(".league").hide(),this.league=this.$(".filter").val(),void 0===this.league&&(this.league=this.$el.closest(".card").data("league-id")),void 0===this.league&&(this.league=this.$el.closest(".card").data("subsection-id")),void 0===this.league)return void this.$noScores.show();if(this.leagues[this.league])this.updateDisplay(this.leagues[this.league]);else{var t;t="SMG"===this.$scroller.data("sub-section-name")?"/sports/services/scores-suspender/desktop/"+this.league+"/":"/sports/services/scores-suspender/"+this.league+"/",void 0!==this.$scroller.data("max-count")&&(t+="?count="+this.$scroller.data("max-count")),this.fetchData(t,this.onScoresLoaded)}},onUpdateLoaded:function(i){if(i){var s=this.$("#pairings ."+this.league),n=e(i);s.find(".game").each(t.bind(function(t,i){var s=e(i),o=s.attr("id"),a=n.find("#"+o),r=a.find(".suspender_score"),l=s.find(".suspender_score");this.markChangedScores(r,l)},this)),s.html(i),this.addScoreHighlight(s.find(".scoreChangeFont"),"rgb(164, 23, 18)",1500),this.continueRefresh&&this.leagueFailCount<this.options.leagueFailLimit&&(this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval))}},markChangedScores:function(i,s){i.each(t.bind(function(t,i){var n=e(i);n.html()!==s.eq(t).html()&&n.addClass("scoreChangeFont")},this))},onScoresLoaded:function(t){var i=this.leagues[this.league]=e(t);i.find(".gameBox").length?(this.$pairings.append(i),this.scoreType="scores",this.updateDisplay(i),this.continueRotate&&location.href.search("sports/$")>0?this.rotateID=setTimeout(this.rotateToNextScore,this.options.rotateInterval):this.refreshID=setTimeout(this.scoresSuspenderRefresher,this.options.refreshInterval)):(console.log("FAILED: Scores Suspender AJAX retrieved BAD data!"),this.$noScores.show())},updateDisplay:function(e){this.$games=e.find(".game"),this.index=0,this.total=this.$games.length,this.total?e.show():this.$noScores.show();var t=this.$(".all-scores-link");t[0].innerHTML=e.data("text"),t.attr("href",e.data("link")),t.attr("target",e.data("target")),this.refreshScrollBar()},showLeague:function(e){this.$(".league").hide();var t=this.$(".filter").val(),i=this.$("."+t);i.show(),this.$games=i.find(".game"),this.index=0,this.total=this.$games.length},addScoreHighlight:function(e,t,i){var s=t||"#FFFF9C",n=i||1e3,o=e.css("color");e.stop().css("color",s).animate({color:o},n).animate({color:s},n).animate({color:o},n)},addscrollBar:function(){this.scrollbar=new a({el:this.$(".suspender-scroll-content"),color:"dark",padding:2,lockPageScroll:!1,delayScroll:!1,fadeout:!0})},refreshScrollBar:function(){this.scrollbar&&(this.scrollbar.refresh(),this.scrollbar.moveDraggerToPosition(0,0))},destroy:function(){this.scrollbar.destroy(),this.stopRefresh(),this.stopRotation(),o.prototype.destroy.call(this)}});return r}),define("modules/sports/sports-datatables",["jquery","underscore","backbone","utils","baseview","pubsub","libs/jquery/plugins/jquery.dataTables"],function(e,t,i,s,n,o){var a=n.extend({el:"#section_sports",events:{"click .show-more":"showMore","click .button-add-content.stats":"showMoreRows","click .sorting_asc, .sorting_desc":"removeDefault","click .sp-stats-view-all":"scrollToSection"},initialize:function(){n.prototype.initialize.apply(this,arguments),this.scrollEl=s.get("scrollEl"),e.extend(e.fn.dataTableExt.oSort,{"title-numeric-pre":function(e){var t=e.match(/data-value="*(-?[0-9\.]+)/);return null!==t&&2==t.length?parseFloat(t[1]):0},"title-numeric-asc":function(e,t){return t>e?-1:e>t?1:0},"title-numeric-desc":function(e,t){return t>e?1:e>t?-1:0},"formatted-num-pre":function(e){return e="-"===e?0:"--"===e?-1:e.replace(/[^\d\-\.]/g,""),parseFloat(e)},"formatted-num-asc":function(e,t){return e-t},"formatted-num-desc":function(e,t){return t-e},"currency-pre":function(e){return e="$"===e?0:e.replace(/[^\d\.]/g,""),parseFloat(e)},"currency-asc":function(e,t){return e-t},"currency-desc":function(e,t){return t-e},"height-pre":function(e){var t=e.split("-");return e=t[1]<10?t[0]+"0"+t[1]:t[0]+t[1],parseInt(e,10)},"height-asc":function(e,t){return e-t},"height-desc":function(e,t){return t-e}});var t=[];e("th.sort-header").each(function(){("asc,desc"==e(this).data("sort")||"asc"==e(this).data("sort"))&&t.push(this.innerHTML)});var i={bAutoWidth:!1,bFilter:!1,bDestroy:!0,bPaginate:!1,bInfo:!1,aoColumnDefs:[{sType:"formatted-num",aTargets:["_all"]}],aaSorting:[]},o={fnDrawCallback:function(i){this.$showMore=e('.show-more[data-category="'+this.attr("data-category")+'"]'),this.$showMore.hasClass("active")||this.$showMore.trigger("click");var s=this;if(i.bSorted){var n=e(this).find(".sorting_asc"),o=e(this).find(".sorting_desc"),a="desc",r=["ERA","XYZ"];t.length>0&&(r=t);var l="opposite";e.each(r,function(e,t){(n.text()===t||o.text()===t)&&(l="same")}),a=0!==n.length?"asc":"desc";var h="";n.length>0&&(h=n.attr("data-filter")),o.length>0&&(h=o.attr("data-filter"));var d,c,u=1;"asc"===a&&"same"===l||"desc"===a&&"opposite"===l?h?this.$("tr."+h,{filter:"applied"}).each(function(t){d=c,c=e(this).find(".sorting_1").html(),void 0!==d&&void 0!==c&&(d===c?u-=1:u=1),s.fnUpdate(t+u,this,0,!1,!1)}):this.$("tr.page",{filter:"applied"}).each(function(t){d=c,c=e(this).find(".sorting_1").html(),void 0!==d&&void 0!==c&&(d===c?u-=1:u=1),s.fnUpdate(t+u,this,0,!1,!1)}):(e.fn.reverse=[].reverse,h?this.$("tr."+h,{filter:"applied"}).reverse().each(function(t){d=c,c=e(this).find(".sorting_1").html(),void 0!==d&&void 0!==c&&(d===c?u-=1:u=1),s.fnUpdate(t+u,this,0,!1,!1)}):this.$("tr.page",{filter:"applied"}).reverse().each(function(t){d=c,c=e(this).find(".sorting_1").html(),void 0!==d&&void 0!==c&&(d===c?u-=1:u=1),s.fnUpdate(t+u,this,0,!1,!1)}));var p=this.$("tr.page").data("items-per-page"),f=this.$("tr.active").length;if(0===f?f=p?p:25:f%p>0&&(f=p*(parseInt(f/p)+1)),f>1){this.$("tr.page").removeClass("active").addClass("inactive");var g="";h&&(g="."+h),this.$("tr.page"+g).each(function(t){f>t&&e(this).removeClass("inactive").addClass("active")})}!h&&this.$("tr.inactive").length>0&&e(".button-add-content.stats").removeClass("inactive")}},aoColumnDefs:[{bSortable:!1,aTargets:[0]},{sType:"formatted-num",aTargets:["_all"]}]};this.$(".sort").each(function(){var t,s=[],n=e(this);n.hasClass("custom-sort")?(n.find("thead tr > th.sort-header").each(function(t){e(this).attr("data-sort")&&e(this).attr("data-stype")?s[t]={sType:e(this).attr("data-stype"),asSorting:e(this).attr("data-sort").split(",")}:e(this).attr("data-stype")?s[t]={sType:e(this).attr("data-stype")}:s[t]="STRK"===this.innerHTML||"DIFF"===this.innerHTML?{sType:"title-numeric"}:null}),t=n.hasClass("no-autorank")?e.extend(!0,t,i,{aoColumns:s}):e.extend(!0,t,i,o,{aoColumns:s})):(n.find("thead tr > th.header").each(function(e){s[e]="STRK"===this.innerHTML||"DIFF"===this.innerHTML?{sType:"title-numeric"}:null}),t=n.hasClass("no-autorank")?e.extend(!0,t,i):e.extend(!0,t,i,o)),n.dataTable(t);var a=n.attr("data-sort");if(a&&(e.isNumeric(a)||(a=a.toLowerCase(),n.find("th.sort-header").each(function(t){e(this).data("name")&&e(this).data("name").toLowerCase()===a?a=t:e(this).text().toLowerCase()===a&&(a=t)})),e.isNumeric(a))){var r=n.find("th:eq("+a+")").attr("data-sort").split(",")[0];n.dataTable().fnSort([[a,r]])}})},showMore:function(t){var i=t.currentTarget,s=e(i).attr("data-category"),n=e("table."+s),o="All"==e(i).find("span.text").text()?"Less":"All";return n.find("tr.hide").toggle(),e(i).find("span.text").text(o),e(i).hasClass("active")?e(i).removeClass("active"):e(i).addClass("active"),!1},showMoreRows:function(t){if(e(t.target).hasClass("inactive"))return!1;this.$button=e(t.currentTarget),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.$table=this.$button.attr("data-table");var i=this.$("table."+this.$table+" .page.active:last").next();i||(i=this.$("table."+this.$table+" .page:first"));var n=i.attr("data-itemnum"),a=i.attr("data-items-per-page"),r=Math.round(n+a);o.trigger("uotrack",s.getSectionPath(window.location.pathname)+"moredatatablerows"+r),this.transitionMoreRows(i,a),t.preventDefault()},transitionMoreRows:function(t,i){var s="";this.$("table."+this.$table+" th.sort-header").each(function(t){(e(this).hasClass("sorting_desc")||e(this).hasClass("sorting_asc"))&&(s=e(this).attr("data-filter"))});for(var n=0;i>n;n++){if(s)for(;!t.hasClass(s)&&t.hasClass("page");)t=t.next();if(!t.attr("data-itemnum")){this.$button.addClass("inactive");break}this.displayNextRow(t),t=t.next()}this.$(".page.inactive").length<=0&&this.$button.addClass("inactive"),this.$button.removeClass("loading").text(this.$button.attr("data-default")),o.trigger("showmore:datatablerows")},displayNextRow:function(t){Modernizr.csstransitions?t.removeClass("inactive").addClass("active"):t.animate({"max-height":"5000px"},200,function(){e(this).removeClass("inactive").addClass("active").css("max-height","")})},removeDefault:function(t){e(t.currentTarget).closest("table").find(".sp-stats-default-sort").removeClass("sp-stats-default-sort"),e("tr.playoff_cut").removeClass("playoff_cut")},scrollToSection:function(t){var i,s=e(t.currentTarget),n=this.$("table"),o=s.attr("data-table"),a=s.attr("data-column"),r=s.attr("data-sort");"string"==typeof a&&(a=a.toLowerCase()),n.each(function(t){e(this).attr("data-category")===o&&(o=t)});var l=s,h=e(".panel-header h2");if(e(".panel-header h2").length>1&&(h=h.eq(o)),l=h.offset().top,this.scrollEl.animate({scrollTop:l-50},700),i=n.length>1?n.eq(o):n,i.find(".sp-stats-default-sort").removeClass("sp-stats-default-sort"),i.find("th.header").each(function(t){e(this).data("name")&&e(this).data("name").toLowerCase()===a?a=t:e(this).text().toLowerCase()===a&&(a=t)}),i.hasClass("dataTable")){var d=i.dataTable();"asc"===r?d.fnSort([[a,"asc"]]):d.fnSort([[a,"desc"]])}else i.find("tr").each(function(){e(this).find("td").eq(a).addClass("sp-stats-default-sort")});return!1}});return a}),define("modules/feedback-opinionlabs/feedback-opinionlabs",["jquery","underscore","utils","pubsub","third-party-apis/opinionlabs","baseview"],function(e,t,i,s,n,o){"use strict";var a=o.extend({events:{"click .fbol-link":"launchOpinionLabModal"},initialize:function(i){t.bindAll(this,"launchOpinionLabModal"),this.$feedabcklink=e(".fbol-link").data("analytics"),o.prototype.initialize.call(this,i)},launchOpinionLabModal:function(e){s.trigger("track",{label:this.$feedabcklink}),n.launchModal(e)}});return a}),define("modules/partner/leaderboard-ad",["jquery","underscore","utils","modules/partner/simple-ad","state"],function(e,t,i,s,n){"use strict";var o=s.extend({initialize:function(t){var o=this.$el,a=n.getActivePageInfo();return(a.series||a.sponsored_series||a.sponsor_story)&&!i.getNested(window.site_vars,"ADS","leaderboard_on_sponsored")?!1:(t=e.extend({adType:o.attr("data-ad-type")||"leaderboard",adPlacement:o.attr("data-ad-placement")||"leaderboard_btf",adSizes:o.attr("data-ad-sizes")||"leaderboard"},t),s.prototype.initialize.call(this,t),void this._initAds())}});return o}),define("form/base-form-element",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({getFormElement:function(){return this.$el},getUIElement:function(){return this.$el},getType:function(){return""},reset:function(){},isRequired:function(){var e=this.getFormElement().attr("required");return"required"===e||e}});return s}),define("form/dropdown",["jquery","underscore","form/base-form-element","ui/dropdown"],function(e,t,i,s){"use strict";var n=i.extend({events:{change:"onChange"},initialize:function(n){n=e.extend({onSelect:null,dropdownContentClass:null},n),t.bindAll(this,"refresh","onDivDropdownSelect"),this.$el.hide(),this.selectOptionItems=this.$("option"),this.dropdownDiv=this._buildDropdownHtml(this.selectOptionItems),this.$el.attr("tabindex","-1"),this.dropdownDiv.insertAfter(this.$el),i.prototype.initialize.call(this,n),this.subviews.dropdown=new s({el:this.dropdownDiv,onSelect:this.onDivDropdownSelect})},_buildDropdownHtml:function(t){var i=e('<div class="'+this.$el.attr("class")+'"></div>');this.options.dropdownContentClass&&i.addClass(this.options.dropdownContentClass);var s=e('<div class="ui-dropdown-value ui-btn"></div>'),n=e('<div class="ui-dropdown-content"></div>'),o=this._buildDropdownHtmlItems(t);return i.attr("class",this.$el.attr("class")),i.attr("tabindex",this.$el.attr("tabindex")||0),i.append(s).append(n),n.append(o),i},_buildDropdownHtmlItems:function(i){var s=e('<ul class="ui-dropdown-items-container"></ul>');return i.each(t.bind(function(t,i){var n=e(i),o=n.val(),a=n.html(),r=e('<li class="ui-dropdown-item" data-value="'+o+'">'+a+"</li>");n.is(":selected")&&r.attr("data-selected","selected"),s.append(r)},this)),s},refresh:function(t){var i=this._buildDropdownHtmlItems(e(t));this.subviews.dropdown.refresh(i.html()),this.$el.html(t)},getUIElement:function(){return this.dropdownDiv},getType:function(){return"dropdown"},reset:function(){this.subviews.dropdown.reset(),this.$el.val("")},onDivDropdownSelect:function(e,t,i){this.$el.val(e),this.options.onSelect&&this.options.onSelect(e,t,i)},onChange:function(){this.subviews.dropdown.setValue(this.$el.val())},destroy:function(e){this.dropdownDiv.remove(),i.prototype.destroy.call(this,e)}});return n}),define("modules/stories/assigned-content",["jquery","underscore","baseview","form/dropdown","ui/generic-paginator"],function(e,t,i,s,n){var o=i.extend({initialize:function(e){t.bindAll(this,"goTo","onFilterDropdownSelect"),this.subviews={},this.$itemsContainer=this.$(".acnsb-items-container"),this.$items=this.$(".acnsb-item"),this.$pageElements=this.$(".paginator-indicator-target"),this.subviews.dropdown=new s({el:this.$(".acnsb-dropdown"),onSelect:this.onFilterDropdownSelect}),this.subviews.paginator=new n({el:this.$(".paginator"),onGoTo:this.goTo}),i.prototype.initialize.call(this,e)},onFilterDropdownSelect:function(e){var t,i;this.$pageElements.eq(0).trigger("click"),this.$items.show(),"all"!=e&&this.$items.not("."+e).hide(),t=this.$items.filter(":visible").length,8>=t?this.$(".acnsb-container").addClass("nopagination"):(this.$(".acnsb-container").removeClass("nopagination"),i=Math.floor(t/8),this.$pageElements.show().filter(":gt("+i+")").hide())},goTo:function(e){this.animate(this.$itemsContainer,"top",270*-e+"px",450,"ease-in-out")}});return o}),define("form/input-field",["jquery","underscore","form/base-form-element"],function(e,t,i){"use strict";var s=i.extend({events:{focus:"onInputFocus",blur:"onInputBlur",keyup:"onKeyPress"},initialize:function(t){t=e.extend({onValueChange:null},t),i.prototype.initialize.call(this,t),this.isInputField="input"===(this.$el.prop("tagName")||"").toLowerCase()?!0:!1,this.hasPlaceHolderNativeSupport=Modernizr.input.placeholder?!0:!1,this.placeholder=this.$el.attr("placeholder"),this.setup()},setup:function(){this.placeholder&&this.showPlaceHolder(),this.$el.data("clearable")&&this.isInputField&&this._setupClearButton()},showPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.setInputValue(this.placeholder),this.$el.addClass("ui-text-input-placeholder"))},clearPlaceHolder:function(){this.hasPlaceHolderNativeSupport||(this.clearInputValue(),this.$el.removeClass("ui-text-input-placeholder"))},getInputValue:function(){var e=this.$el.val();return e===this.placeholder&&(e=""),e},clearInputValue:function(){var e=this.getInputValue();this.$el.val(""),e&&this._triggerValueChange()},setInputValue:function(e){this.$el.val(e),this._triggerValueChange()},_setupClearButton:function(){this.clearButton=e('<div class="ui-text-input-clear-btn" style="display:none"></div>'),this.$el.parent().append(this.clearButton),this.clearButton.on("mousedown."+this.cid,t.bind(function(e){this.onClearButtonClick(e)},this))},onInputFocus:function(e){var t=this.getInputValue();t?this.clearButton&&this.clearButton.show():this.clearPlaceHolder()},onInputBlur:function(e){this.getInputValue()||this.reset(),this.clearButton&&this.clearButton.hide()},_triggerValueChange:function(){var e=this.getInputValue();this.clearButton&&(e?this.clearButton.show():this.clearButton.hide()),this.options.onValueChange&&this.options.onValueChange(e)},resetInput:function(){this.reset()},reset:function(){this.clearInputValue(),this.placeholder&&this.showPlaceHolder(),this.clearButton&&this.clearButton.hide()},onKeyPress:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(t.bind(function(){this._triggerValueChange()},this),1)},getType:function(){return"input"},onClearButtonClick:function(e){e.preventDefault(),this.clearInputValue(),this.clearButton.hide(),this.$el.focus()},destroy:function(e){this.clearButton&&(this.clearButton.off("."+this.cid),this.clearButton.remove()),i.prototype.destroy.call(this,e)}});return s}),define("form/autocomplete",["jquery","underscore","form/base-form-element","state","form/input-field"],function(e,t,i,s,n){"use strict";var o=i.extend({events:{"keydown .ui-text-input":"onKeyDown","paste .ui-text-input":"updateResults",focusout:"onInputBlur","mousedown .ui-autocomplete-result-item":"onMouseDownResultItem","mouseenter .ui-autocomplete-result-item":"onResultMouseEnterLeave","mousedown .ui-text-input-clear-btn":"onClearButtonClick"},initialize:function(s){s=e.extend({url:this.$el.data("autocomplete-url"),ajaxOptions:null,ajaxQueryKey:"query",resultDisplayTemplate:null,resultValueTemplate:null,onError:null,onSelect:null,maxResults:4,onShowResults:null,onParseResults:null,onValueChange:null},s),this.inputField=this.$el,this.setElement(this.$el.parent(),!1),this.autoCompleteResultsContainer=e('<ul class="ui-autocomplete-result-container"></ul>'),this.autoCompleteContent=e('<div class="ui-autocomplete-content"></div>'),this.autoCompleteContent.append(this.autoCompleteResultsContainer),this.$el.append(this.autoCompleteContent),t.bindAll(this,"updateResults","showResult","clearResults"),i.prototype.initialize.call(this,s),this.subviews.inputField=new n({el:this.inputField,onValueChange:this.options.onValueChange})},updateAjaxOptions:function(t){e.extend(!0,this.options.ajaxOptions,t)},updateResults:function(){clearTimeout(this.keyPressDelay),this.keyPressDelay=setTimeout(t.bind(function(){var e=this.inputField.val();this.fetcher&&this.fetcher.abort(),e.length?this.fetcher=this._fetchResults(e):this.clearResults()},this),1)},onResultMouseEnterLeave:function(t){var i=e(t.target);i.hasClass("hover")||(this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item").removeClass("hover"),i.addClass("hover"))},onInputBlur:function(){this.clearResults(),this.fetcher&&this.fetcher.abort()},onMouseDownResultItem:function(t){3!==t.which&&this._processSelectedItem(e(t.currentTarget))},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which,i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item"),s=i.filter(".ui-autocomplete-result-hover");9!==t&&(38===t||40===t?(e.preventDefault(),i.length&&this.onResultItemUpDownArrowKeyPress(t,s)):13===t?s.length?(e.preventDefault(),this._processSelectedItem(s)):this.clearResults():32===t&&s.length?this._processSelectedItem(s):this.updateResults())},onResultItemUpDownArrowKeyPress:function(e,t){var i=this.autoCompleteResultsContainer.find(".ui-autocomplete-result-item");i.removeClass("ui-autocomplete-result-hover"),38===e?t.length&&this.inputField.val()!==this.currentInputFieldValue?t.prev().length?this.hoverResultItem(t.prev()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.last()):t.length?t&&t.next().length?this.hoverResultItem(t.next()):this.inputField.val(this.currentInputFieldValue):this.hoverResultItem(i.first())},hoverResultItem:function(e){e.addClass("ui-autocomplete-result-hover"),this.inputField.val(e.text())},getUIElement:function(){return this.inputField},getFormElement:function(){return this.inputField},reset:function(){this.clearResults(),this.subviews.inputField.reset()},resetInput:function(){this.reset()},showResult:function(t,i,s){var n=e('<li class="ui-autocomplete-result-item"></li>');n.text(t),n.data("value",i),s&&n.data("result",s),this.autoCompleteResultsContainer.append(n)},clearResults:function(){this.autoCompleteResultsContainer.empty()},onClearButtonClick:function(e){this.clearResults()},_processSelectedItem:function(e){var t=e.data("value")||e.text(),i=e.data("result");this.inputField.val(t),this.clearResults(),this.options.onSelect&&this.options.onSelect(t,i)},_getFetchAjaxOptions:function(i){var s=e.extend(!0,{},this.options.ajaxOptions),n={},o=s.url||this.options.url;return-1!==o.indexOf("<%=")?s.url=t.template(o,{query:i}):(n[this.options.ajaxQueryKey]=i,s=e.extend(!0,{url:o,data:n},s)),s},_fetchResults:function(i){var n=this._getFetchAjaxOptions(i);return s.fetchData(null,n).done(t.bind(function(t){var i=t;this.options.onParseResults&&(i=this.options.onParseResults(t)),this.autoCompleteResultsContainer.empty(),e.isArray(i)&&i.length>0&&(i=i.slice(0,this.options.maxResults),this._parseResults(i),this.options.onShowResults&&this.options.onShowResults(i),this.currentInputFieldValue=this.inputField.val())},this)).fail(t.bind(function(e){this.options.onError&&this.options.onError(e)},this))},_parseResults:function(i){e.map(i,t.bind(function(e){var i,s;this.options.resultDisplayTemplate&&(s=t.template(this.options.resultDisplayTemplate,e)),this.options.resultValueTemplate&&(i=t.template(this.options.resultValueTemplate,e)),this.showResult(s,i,e)},this))},getType:function(){return"autocomplete"},destroy:function(e){this.autoCompleteContent.remove(),i.prototype.destroy.call(this,e)}});return o}),define("form/checkbox",["jquery","underscore","form/base-form-element"],function(e,t,i){"use strict";var s=i.extend({events:{click:"onCheckboxInputClick"},initialize:function(s){s=e.extend({onClick:null},s),i.prototype.initialize.call(this,s),t.bindAll(this,"onCheckboxClick"),this.checkboxDiv=this._buildDivCheckbox(this.$el),this.isCheckedByDefault=this.$el.is(":checked")},_buildDivCheckbox:function(i){var s=e('<div class="'+i.attr("class")+'" data-name="'+i.attr("name")+'" data-value="'+i.val()+'"></div>'),n=this.$el.closest("form").find('label[for="'+i.attr("id")+'"]');i.is(":checked")&&s.addClass("ui-checkbox-checked"),i.is(":disabled")&&s.addClass("ui-checkbox-disabled"),s.on("keydown."+this.cid+" click."+this.cid,t.bind(function(e){"keydown"===e.type?this.onKeyDown(e):this.onCheckboxClick(e)},this));var o=i.attr("tabindex");i.attr("tabindex","-1"),o?s.attr("tabindex",o):s.attr("tabindex","0");var a=this._buildDivCheckboxLabel(n);return s.append(a),n.hide(),s.insertAfter(i),s},_buildDivCheckboxLabel:function(t){var i=e('<span class="ui-checkbox-label"></span>');return t.length?i.text(t.text()):i.text(this.$el.val()),i},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;(32===t||13===t)&&(e.preventDefault(),this.onCheckboxClick(e))},check:function(){this.checkboxDiv.addClass("ui-checkbox-checked"),this.$el.prop("checked",!0)},unCheck:function(){this.checkboxDiv.removeClass("ui-checkbox-checked"),this.$el.prop("checked",!1)},onCheckboxClick:function(e){var t;this.checkboxDiv.hasClass("ui-checkbox-checked")?(this.unCheck(),t=!1):(this.check(),t=!0),this.options.onClick&&this.options.onClick(this.checkboxDiv,t)},getUIElement:function(){return this.checkboxDiv},getType:function(){return"checkbox"},reset:function(){this.isCheckedByDefault?this.check():this.unCheck()},onCheckboxInputClick:function(e){this.onCheckboxClick(e)},destroy:function(e){this.checkboxDiv.off("."+this.cid),this.checkboxDiv.remove(),i.prototype.destroy.call(this,e)}});return s}),define("form/radio-button",["jquery","underscore","form/base-form-element"],function(e,t,i){"use strict";var s=i.extend({events:{click:"onRadioInputClick"},initialize:function(t){t=e.extend({onClick:null},t),i.prototype.initialize.call(this,t),this.radioDiv=this._buildDivRadio(this.$el)},_buildDivRadio:function(i){var s=e('<div class="'+i.attr("class")+'" data-name="'+i.attr("name")+'" data-value="'+i.val()+'"></div>'),n=this.$el.closest("form").find('label[for="'+i.attr("id")+'"]');i.is(":checked")&&s.addClass("ui-radio-selected"),i.is("disabled")&&s.addClass("ui-radio-disabled"),s.on("keydown."+this.cid+" click."+this.cid,t.bind(function(e){"keydown"===e.type?this.onKeyDown(e):this.onRadioClick(e)},this));var o=i.attr("tabindex");i.attr("tabindex","-1"),o?s.attr("tabindex",o):s.attr("tabindex","0");var a=this._buildDivRadioLabel(n);return s.append(a),n.hide(),s.insertAfter(i),s},_buildDivRadioLabel:function(t){var i=e('<span class="ui-radio-label"></span>');return t.length?i.text(t.text()):i.text(this.$el.val()),i},select:function(){this.radioDivs||(this.radioDivs=this.$el.closest("form").find("div.ui-radio[data-name="+this.$el.attr("name")+"]")),this.radioDivs.removeClass("ui-radio-selected"),this.radioDiv.addClass("ui-radio-selected"),this.options.onClick&&this.options.onClick(this.radioDiv)},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;(32===t||13===t)&&(e.preventDefault(),this.onRadioClick(e))},onRadioClick:function(e){e.preventDefault(),this.radioDiv.hasClass("ui-radio-selected")||(this.select(),this.$el.prop("checked",!0))},onRadioInputClick:function(e){this.onRadioClick(e)},getUIElement:function(){return this.radioDiv},getType:function(){return"radio"},destroy:function(e){this.radioDiv.off("."+this.cid),this.radioDiv.remove(),i.prototype.destroy.call(this,e)}});return s}),function(e){"function"==typeof define&&define.amd?define("libs/jqueryui/datepicker",["jquery","./core"],e):e(jQuery)}(function(e){function t(e){for(var t,i;e.length&&e[0]!==document;){if(t=e.css("position"),("absolute"===t||"relative"===t||"fixed"===t)&&(i=parseInt(e.css("zIndex"),10),!isNaN(i)&&0!==i))return i;e=e.parent()}return 0}function i(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,
onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.regional.en=e.extend(!0,{},this.regional[""]),this.regional["en-US"]=e.extend(!0,{},this.regional.en),this.dpDiv=s(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function s(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",n)}function n(){e.datepicker._isDisabledDatepicker(a.inline?a.dpDiv.parent()[0]:a.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))}function o(t,i){e.extend(t,i);for(var s in i)null==i[s]&&(t[s]=i[s]);return t}e.extend(e.ui,{datepicker:{version:"1.11.1"}});var a;return e.extend(i.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return o(this._defaults,e||{}),this},_attachDatepicker:function(t,i){var s,n,o;s=t.nodeName.toLowerCase(),n="div"===s||"span"===s,t.id||(this.uuid+=1,t.id="dp"+this.uuid),o=this._newInst(e(t),n),o.settings=e.extend({},i||{}),"input"===s?this._connectDatepicker(t,o):n&&this._inlineDatepicker(t,o)},_newInst:function(t,i){var n=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:n,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?s(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,i){var s=e(t);i.append=e([]),i.trigger=e([]),s.hasClass(this.markerClassName)||(this._attachments(s,i),s.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(i),e.data(t,"datepicker",i),i.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var s,n,o,a=this._get(i,"appendText"),r=this._get(i,"isRTL");i.append&&i.append.remove(),a&&(i.append=e("<span class='"+this._appendClass+"'>"+a+"</span>"),t[r?"before":"after"](i.append)),t.unbind("focus",this._showDatepicker),i.trigger&&i.trigger.remove(),s=this._get(i,"showOn"),("focus"===s||"both"===s)&&t.focus(this._showDatepicker),("button"===s||"both"===s)&&(n=this._get(i,"buttonText"),o=this._get(i,"buttonImage"),i.trigger=e(this._get(i,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:o,alt:n,title:n}):e("<button type='button'></button>").addClass(this._triggerClass).html(o?e("<img/>").attr({src:o,alt:n,title:n}):n)),t[r?"before":"after"](i.trigger),i.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,i,s,n,o=new Date(2009,11,20),a=this._get(e,"dateFormat");a.match(/[DM]/)&&(t=function(e){for(i=0,s=0,n=0;n<e.length;n++)e[n].length>i&&(i=e[n].length,s=n);return s},o.setMonth(t(this._get(e,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(t(this._get(e,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),e.input.attr("size",this._formatDate(e,o).length)}},_inlineDatepicker:function(t,i){var s=e(t);s.hasClass(this.markerClassName)||(s.addClass(this.markerClassName).append(i.dpDiv),e.data(t,"datepicker",i),this._setDate(i,this._getDefaultDate(i),!0),this._updateDatepicker(i),this._updateAlternate(i),i.settings.disabled&&this._disableDatepicker(t),i.dpDiv.css("display","block"))},_dialogDatepicker:function(t,i,s,n,a){var r,l,h,d,c,u=this._dialogInst;return u||(this.uuid+=1,r="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+r+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),u=this._dialogInst=this._newInst(this._dialogInput,!1),u.settings={},e.data(this._dialogInput[0],"datepicker",u)),o(u.settings,n||{}),i=i&&i.constructor===Date?this._formatDate(u,i):i,this._dialogInput.val(i),this._pos=a?a.length?a:[a.pageX,a.pageY]:null,this._pos||(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight,d=document.documentElement.scrollLeft||document.body.scrollLeft,c=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[l/2-100+d,h/2-150+c]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),u.settings.onSelect=s,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],"datepicker",u),this},_destroyDatepicker:function(t){var i,s=e(t),n=e.data(t,"datepicker");s.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),e.removeData(t,"datepicker"),"input"===i?(n.append.remove(),n.trigger.remove(),s.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===i||"span"===i)&&s.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var i,s,n=e(t),o=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!1,o.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var i,s,n=e(t),o=e.data(t,"datepicker");n.hasClass(this.markerClassName)&&(i=t.nodeName.toLowerCase(),"input"===i?(t.disabled=!0,o.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===i||"span"===i)&&(s=n.children("."+this._inlineClass),s.children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,"datepicker")}catch(i){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,i,s){var n,a,r,l,h=this._getInst(t);return 2===arguments.length&&"string"==typeof i?"defaults"===i?e.extend({},e.datepicker._defaults):h?"all"===i?e.extend({},h.settings):this._get(h,i):null:(n=i||{},"string"==typeof i&&(n={},n[i]=s),void(h&&(this._curInst===h&&this._hideDatepicker(),a=this._getDateDatepicker(t,!0),r=this._getMinMaxDate(h,"min"),l=this._getMinMaxDate(h,"max"),o(h.settings,n),null!==r&&void 0!==n.dateFormat&&void 0===n.minDate&&(h.settings.minDate=this._formatDate(h,r)),null!==l&&void 0!==n.dateFormat&&void 0===n.maxDate&&(h.settings.maxDate=this._formatDate(h,l)),"disabled"in n&&(n.disabled?this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(e(t),h),this._autoSize(h),this._setDate(h,a),this._updateAlternate(h),this._updateDatepicker(h))))},_changeDatepicker:function(e,t,i){this._optionDatepicker(e,t,i)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var i=this._getInst(e);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(e,t){var i=this._getInst(e);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var i,s,n,o=e.datepicker._getInst(t.target),a=!0,r=o.dpDiv.is(".ui-datepicker-rtl");if(o._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),a=!1;break;case 13:return n=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",o.dpDiv),n[0]&&e.datepicker._selectDay(t.target,o.selectedMonth,o.selectedYear,n[0]),i=e.datepicker._get(o,"onSelect"),i?(s=e.datepicker._formatDate(o),i.apply(o.input?o.input[0]:null,[s,o])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),a=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),a=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?1:-1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(o,"stepBigMonths"):-e.datepicker._get(o,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),a=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,r?-1:1,"D"),a=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(o,"stepBigMonths"):+e.datepicker._get(o,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),a=t.ctrlKey||t.metaKey;break;default:a=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):a=!1;a&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,s,n=e.datepicker._getInst(t.target);return e.datepicker._get(n,"constrainInput")?(i=e.datepicker._possibleChars(e.datepicker._get(n,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||" ">s||!i||i.indexOf(s)>-1):void 0},_doKeyUp:function(t){var i,s=e.datepicker._getInst(t.target);if(s.input.val()!==s.lastVal)try{i=e.datepicker.parseDate(e.datepicker._get(s,"dateFormat"),s.input?s.input.val():null,e.datepicker._getFormatConfig(s)),i&&(e.datepicker._setDateFromField(s),e.datepicker._updateAlternate(s),e.datepicker._updateDatepicker(s))}catch(n){}return!0},_showDatepicker:function(i){if(i=i.target||i,"input"!==i.nodeName.toLowerCase()&&(i=e("input",i.parentNode)[0]),!e.datepicker._isDisabledDatepicker(i)&&e.datepicker._lastInput!==i){var s,n,a,r,l,h,d;s=e.datepicker._getInst(i),e.datepicker._curInst&&e.datepicker._curInst!==s&&(e.datepicker._curInst.dpDiv.stop(!0,!0),s&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),n=e.datepicker._get(s,"beforeShow"),a=n?n.apply(i,[i,s]):{},a!==!1&&(o(s.settings,a),s.lastVal=null,e.datepicker._lastInput=i,e.datepicker._setDateFromField(s),e.datepicker._inDialog&&(i.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(i),e.datepicker._pos[1]+=i.offsetHeight),r=!1,e(i).parents().each(function(){return r|="fixed"===e(this).css("position"),!r}),l={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,s.dpDiv.empty(),s.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(s),l=e.datepicker._checkOffset(s,l,r),s.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":r?"fixed":"absolute",display:"none",left:l.left+"px",top:l.top+"px"}),s.inline||(h=e.datepicker._get(s,"showAnim"),d=e.datepicker._get(s,"duration"),s.dpDiv.css("z-index",t(e(i))+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[h]?s.dpDiv.show(h,e.datepicker._get(s,"showOptions"),d):s.dpDiv[h||"show"](h?d:null),e.datepicker._shouldFocusInput(s)&&s.input.focus(),e.datepicker._curInst=s))}},_updateDatepicker:function(t){this.maxRows=4,a=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var i,s=this._getNumberOfMonths(t),o=s[1],r=17,l=t.dpDiv.find("."+this._dayOverClass+" a");l.length>0&&n.apply(l.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),o>1&&t.dpDiv.addClass("ui-datepicker-multi-"+o).css("width",r*o+"em"),t.dpDiv[(1!==s[0]||1!==s[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),i=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,i,s){var n=t.dpDiv.outerWidth(),o=t.dpDiv.outerHeight(),a=t.input?t.input.outerWidth():0,r=t.input?t.input.outerHeight():0,l=document.documentElement.clientWidth+(s?0:e(document).scrollLeft()),h=document.documentElement.clientHeight+(s?0:e(document).scrollTop());return i.left-=this._get(t,"isRTL")?n-a:0,i.left-=s&&i.left===t.input.offset().left?e(document).scrollLeft():0,i.top-=s&&i.top===t.input.offset().top+r?e(document).scrollTop():0,i.left-=Math.min(i.left,i.left+n>l&&l>n?Math.abs(i.left+n-l):0),i.top-=Math.min(i.top,i.top+o>h&&h>o?Math.abs(o+r):0),i},_findPos:function(t){for(var i,s=this._getInst(t),n=this._get(s,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[n?"previousSibling":"nextSibling"];return i=e(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var i,s,n,o,a=this._curInst;!a||t&&a!==e.data(t,"datepicker")||this._datepickerShowing&&(i=this._get(a,"showAnim"),s=this._get(a,"duration"),n=function(){e.datepicker._tidyDialog(a)},e.effects&&(e.effects.effect[i]||e.effects[i])?a.dpDiv.hide(i,e.datepicker._get(a,"showOptions"),s,n):a.dpDiv["slideDown"===i?"slideUp":"fadeIn"===i?"fadeOut":"hide"](i?s:null,n),i||n(),this._datepickerShowing=!1,o=this._get(a,"onClose"),o&&o.apply(a.input?a.input[0]:null,[a.input?a.input.val():"",a]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var i=e(t.target),s=e.datepicker._getInst(i[0]);(i[0].id!==e.datepicker._mainDivId&&0===i.parents("#"+e.datepicker._mainDivId).length&&!i.hasClass(e.datepicker.markerClassName)&&!i.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||i.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==s)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,i,s){var n=e(t),o=this._getInst(n[0]);this._isDisabledDatepicker(n[0])||(this._adjustInstDate(o,i+("M"===s?this._get(o,"showCurrentAtPos"):0),s),this._updateDatepicker(o))},_gotoToday:function(t){var i,s=e(t),n=this._getInst(s[0]);this._get(n,"gotoCurrent")&&n.currentDay?(n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear):(i=new Date,n.selectedDay=i.getDate(),n.drawMonth=n.selectedMonth=i.getMonth(),n.drawYear=n.selectedYear=i.getFullYear()),this._notifyChange(n),this._adjustDate(s)},_selectMonthYear:function(t,i,s){var n=e(t),o=this._getInst(n[0]);o["selected"+("M"===s?"Month":"Year")]=o["draw"+("M"===s?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10),this._notifyChange(o),this._adjustDate(n)},_selectDay:function(t,i,s,n){var o,a=e(t);e(n).hasClass(this._unselectableClass)||this._isDisabledDatepicker(a[0])||(o=this._getInst(a[0]),o.selectedDay=o.currentDay=e("a",n).html(),o.selectedMonth=o.currentMonth=i,o.selectedYear=o.currentYear=s,this._selectDate(t,this._formatDate(o,o.currentDay,o.currentMonth,o.currentYear)))},_clearDate:function(t){var i=e(t);this._selectDate(i,"")},_selectDate:function(t,i){var s,n=e(t),o=this._getInst(n[0]);i=null!=i?i:this._formatDate(o),o.input&&o.input.val(i),this._updateAlternate(o),s=this._get(o,"onSelect"),s?s.apply(o.input?o.input[0]:null,[i,o]):o.input&&o.input.trigger("change"),o.inline?this._updateDatepicker(o):(this._hideDatepicker(),this._lastInput=o.input[0],"object"!=typeof o.input[0]&&o.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,s,n,o=this._get(t,"altField");o&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t),n=this.formatDate(i,s,this._getFormatConfig(t)),e(o).each(function(){e(this).val(n)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,i=new Date(e.getTime());return i.setDate(i.getDate()+4-(i.getDay()||7)),t=i.getTime(),i.setMonth(0),i.setDate(1),Math.floor(Math.round((t-i)/864e5)/7)+1},parseDate:function(t,i,s){if(null==t||null==i)throw"Invalid arguments";if(i="object"==typeof i?i.toString():i+"",""===i)return null;var n,o,a,r,l=0,h=(s?s.shortYearCutoff:null)||this._defaults.shortYearCutoff,d="string"!=typeof h?h:(new Date).getFullYear()%100+parseInt(h,10),c=(s?s.dayNamesShort:null)||this._defaults.dayNamesShort,u=(s?s.dayNames:null)||this._defaults.dayNames,p=(s?s.monthNamesShort:null)||this._defaults.monthNamesShort,f=(s?s.monthNames:null)||this._defaults.monthNames,g=-1,m=-1,v=-1,b=-1,y=!1,w=function(e){var i=n+1<t.length&&t.charAt(n+1)===e;return i&&n++,i},_=function(e){var t=w(e),s="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,n="y"===e?s:1,o=new RegExp("^\\d{"+n+","+s+"}"),a=i.substring(l).match(o);if(!a)throw"Missing number at position "+l;return l+=a[0].length,parseInt(a[0],10)},C=function(t,s,n){var o=-1,a=e.map(w(t)?n:s,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(a,function(e,t){var s=t[1];return i.substr(l,s.length).toLowerCase()===s.toLowerCase()?(o=t[0],l+=s.length,!1):void 0}),-1!==o)return o+1;throw"Unknown name at position "+l},S=function(){if(i.charAt(l)!==t.charAt(n))throw"Unexpected literal at position "+l;l++};for(n=0;n<t.length;n++)if(y)"'"!==t.charAt(n)||w("'")?S():y=!1;else switch(t.charAt(n)){case"d":v=_("d");break;case"D":C("D",c,u);break;case"o":b=_("o");break;case"m":m=_("m");break;case"M":m=C("M",p,f);break;case"y":g=_("y");break;case"@":r=new Date(_("@")),g=r.getFullYear(),m=r.getMonth()+1,v=r.getDate();break;case"!":r=new Date((_("!")-this._ticksTo1970)/1e4),g=r.getFullYear(),m=r.getMonth()+1,v=r.getDate();break;case"'":w("'")?S():y=!0;break;default:S()}if(l<i.length&&(a=i.substr(l),!/^\s+/.test(a)))throw"Extra/unparsed characters found in date: "+a;if(-1===g?g=(new Date).getFullYear():100>g&&(g+=(new Date).getFullYear()-(new Date).getFullYear()%100+(d>=g?0:-100)),b>-1)for(m=1,v=b;;){if(o=this._getDaysInMonth(g,m-1),o>=v)break;m++,v-=o}if(r=this._daylightSavingAdjust(new Date(g,m-1,v)),r.getFullYear()!==g||r.getMonth()+1!==m||r.getDate()!==v)throw"Invalid date";return r},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*60*60*1e7,formatDate:function(e,t,i){if(!t)return"";var s,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,o=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,l=function(t){var i=s+1<e.length&&e.charAt(s+1)===t;return i&&s++,i},h=function(e,t,i){var s=""+t;if(l(e))for(;s.length<i;)s="0"+s;return s},d=function(e,t,i,s){return l(e)?s[t]:i[t]},c="",u=!1;if(t)for(s=0;s<e.length;s++)if(u)"'"!==e.charAt(s)||l("'")?c+=e.charAt(s):u=!1;else switch(e.charAt(s)){case"d":c+=h("d",t.getDate(),2);break;case"D":c+=d("D",t.getDay(),n,o);break;case"o":c+=h("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":c+=h("m",t.getMonth()+1,2);break;case"M":c+=d("M",t.getMonth(),a,r);break;case"y":c+=l("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":l("'")?c+="'":u=!0;break;default:c+=e.charAt(s)}return c},_possibleChars:function(e){var t,i="",s=!1,n=function(i){var s=t+1<e.length&&e.charAt(t+1)===i;return s&&t++,s};for(t=0;t<e.length;t++)if(s)"'"!==e.charAt(t)||n("'")?i+=e.charAt(t):s=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":n("'")?i+="'":s=!0;break;default:i+=e.charAt(t)}return i},_get:function(e,t){return void 0!==e.settings[t]?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var i=this._get(e,"dateFormat"),s=e.lastVal=e.input?e.input.val():null,n=this._getDefaultDate(e),o=n,a=this._getFormatConfig(e);try{o=this.parseDate(i,s,a)||n}catch(r){s=t?"":s}e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),e.currentDay=s?o.getDate():0,e.currentMonth=s?o.getMonth():0,e.currentYear=s?o.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,i,s){var n=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},o=function(i){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),i,e.datepicker._getFormatConfig(t))}catch(s){}for(var n=(i.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,o=n.getFullYear(),a=n.getMonth(),r=n.getDate(),l=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,h=l.exec(i);h;){switch(h[2]||"d"){case"d":case"D":r+=parseInt(h[1],10);break;case"w":case"W":r+=7*parseInt(h[1],10);break;case"m":case"M":a+=parseInt(h[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(o,a));break;case"y":case"Y":o+=parseInt(h[1],10),r=Math.min(r,e.datepicker._getDaysInMonth(o,a))}h=l.exec(i)}return new Date(o,a,r)},a=null==i||""===i?s:"string"==typeof i?o(i):"number"==typeof i?isNaN(i)?s:n(i):new Date(i.getTime());return a=a&&"Invalid Date"===a.toString()?s:a,a&&(a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0)),this._daylightSavingAdjust(a)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,i){var s=!t,n=e.selectedMonth,o=e.selectedYear,a=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=a.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=a.getMonth(),e.drawYear=e.selectedYear=e.currentYear=a.getFullYear(),n===e.selectedMonth&&o===e.selectedYear||i||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(s?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var i=this._get(t,"stepMonths"),s="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(s,-i,"M")},next:function(){e.datepicker._adjustDate(s,+i,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(s)},selectDay:function(){return e.datepicker._selectDay(s,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(s,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(s,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,i,s,n,o,a,r,l,h,d,c,u,p,f,g,m,v,b,y,w,_,C,S,x,k,T,$,A,P,D,I,M,E,L,N,F,O,R,B,j=new Date,z=this._daylightSavingAdjust(new Date(j.getFullYear(),j.getMonth(),j.getDate())),H=this._get(e,"isRTL"),V=this._get(e,"showButtonPanel"),U=this._get(e,"hideIfNoPrevNext"),W=this._get(e,"navigationAsDateFormat"),q=this._getNumberOfMonths(e),G=this._get(e,"showCurrentAtPos"),Y=this._get(e,"stepMonths"),X=1!==q[0]||1!==q[1],Z=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),J=this._getMinMaxDate(e,"min"),K=this._getMinMaxDate(e,"max"),Q=e.drawMonth-G,ee=e.drawYear;if(0>Q&&(Q+=12,ee--),K)for(t=this._daylightSavingAdjust(new Date(K.getFullYear(),K.getMonth()-q[0]*q[1]+1,K.getDate())),t=J&&J>t?J:t;this._daylightSavingAdjust(new Date(ee,Q,1))>t;)Q--,0>Q&&(Q=11,ee--);for(e.drawMonth=Q,e.drawYear=ee,i=this._get(e,"prevText"),i=W?this.formatDate(i,this._daylightSavingAdjust(new Date(ee,Q-Y,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,-1,ee,Q)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>":U?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"e":"w")+"'>"+i+"</span></a>",n=this._get(e,"nextText"),n=W?this.formatDate(n,this._daylightSavingAdjust(new Date(ee,Q+Y,1)),this._getFormatConfig(e)):n,o=this._canAdjustMonth(e,1,ee,Q)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+n+"</span></a>":U?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(H?"w":"e")+"'>"+n+"</span></a>",a=this._get(e,"currentText"),r=this._get(e,"gotoCurrent")&&e.currentDay?Z:z,a=W?this.formatDate(a,r,this._getFormatConfig(e)):a,l=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",h=V?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(H?l:"")+(this._isInRange(e,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+a+"</button>":"")+(H?"":l)+"</div>":"",d=parseInt(this._get(e,"firstDay"),10),d=isNaN(d)?0:d,c=this._get(e,"showWeek"),u=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),f=this._get(e,"monthNames"),g=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),v=this._get(e,"showOtherMonths"),b=this._get(e,"selectOtherMonths"),y=this._getDefaultDate(e),w="",C=0;C<q[0];C++){for(S="",this.maxRows=4,x=0;x<q[1];x++){if(k=this._daylightSavingAdjust(new Date(ee,Q,e.selectedDay)),T=" ui-corner-all",$="",X){if($+="<div class='ui-datepicker-group",q[1]>1)switch(x){case 0:$+=" ui-datepicker-group-first",T=" ui-corner-"+(H?"right":"left");break;case q[1]-1:$+=" ui-datepicker-group-last",T=" ui-corner-"+(H?"left":"right");break;default:$+=" ui-datepicker-group-middle",T=""}$+="'>"}for($+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+T+"'>"+(/all|left/.test(T)&&0===C?H?o:s:"")+(/all|right/.test(T)&&0===C?H?s:o:"")+this._generateMonthYearHeader(e,Q,ee,J,K,C>0||x>0,f,g)+"</div><table class='ui-datepicker-calendar'><thead><tr>",A=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",_=0;7>_;_++)P=(_+d)%7,A+="<th scope='col'"+((_+d+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+u[P]+"'>"+p[P]+"</span></th>";for($+=A+"</tr></thead><tbody>",D=this._getDaysInMonth(ee,Q),ee===e.selectedYear&&Q===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,D)),I=(this._getFirstDayOfMonth(ee,Q)-d+7)%7,M=Math.ceil((I+D)/7),E=X&&this.maxRows>M?this.maxRows:M,this.maxRows=E,L=this._daylightSavingAdjust(new Date(ee,Q,1-I)),N=0;E>N;N++){for($+="<tr>",F=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(L)+"</td>":"",_=0;7>_;_++)O=m?m.apply(e.input?e.input[0]:null,[L]):[!0,""],R=L.getMonth()!==Q,B=R&&!b||!O[0]||J&&J>L||K&&L>K,F+="<td class='"+((_+d+6)%7>=5?" ui-datepicker-week-end":"")+(R?" ui-datepicker-other-month":"")+(L.getTime()===k.getTime()&&Q===e.selectedMonth&&e._keyEvent||y.getTime()===L.getTime()&&y.getTime()===k.getTime()?" "+this._dayOverClass:"")+(B?" "+this._unselectableClass+" ui-state-disabled":"")+(R&&!v?"":" "+O[1]+(L.getTime()===Z.getTime()?" "+this._currentClass:"")+(L.getTime()===z.getTime()?" ui-datepicker-today":""))+"'"+(R&&!v||!O[2]?"":" title='"+O[2].replace(/'/g,"&#39;")+"'")+(B?"":" data-handler='selectDay' data-event='click' data-month='"+L.getMonth()+"' data-year='"+L.getFullYear()+"'")+">"+(R&&!v?"&#xa0;":B?"<span class='ui-state-default'>"+L.getDate()+"</span>":"<a class='ui-state-default"+(L.getTime()===z.getTime()?" ui-state-highlight":"")+(L.getTime()===Z.getTime()?" ui-state-active":"")+(R?" ui-priority-secondary":"")+"' href='#'>"+L.getDate()+"</a>")+"</td>",L.setDate(L.getDate()+1),L=this._daylightSavingAdjust(L);$+=F+"</tr>"}Q++,Q>11&&(Q=0,ee++),$+="</tbody></table>"+(X?"</div>"+(q[0]>0&&x===q[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),S+=$}w+=S}return w+=h,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,i,s,n,o,a,r){var l,h,d,c,u,p,f,g,m=this._get(e,"changeMonth"),v=this._get(e,"changeYear"),b=this._get(e,"showMonthAfterYear"),y="<div class='ui-datepicker-title'>",w="";if(o||!m)w+="<span class='ui-datepicker-month'>"+a[t]+"</span>";else{for(l=s&&s.getFullYear()===i,h=n&&n.getFullYear()===i,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",d=0;12>d;d++)(!l||d>=s.getMonth())&&(!h||d<=n.getMonth())&&(w+="<option value='"+d+"'"+(d===t?" selected='selected'":"")+">"+r[d]+"</option>");w+="</select>"}if(b||(y+=w+(!o&&m&&v?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",o||!v)y+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(c=this._get(e,"yearRange").split(":"),u=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?i+parseInt(e.substring(1),10):e.match(/[+\-].*/)?u+parseInt(e,10):parseInt(e,10);return isNaN(t)?u:t},f=p(c[0]),g=Math.max(f,p(c[1]||"")),f=s?Math.max(f,s.getFullYear()):f,g=n?Math.min(g,n.getFullYear()):g,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";g>=f;f++)e.yearshtml+="<option value='"+f+"'"+(f===i?" selected='selected'":"")+">"+f+"</option>";e.yearshtml+="</select>",y+=e.yearshtml,e.yearshtml=null}return y+=this._get(e,"yearSuffix"),b&&(y+=(!o&&m&&v?"":"&#xa0;")+w),y+="</div>"},_adjustInstDate:function(e,t,i){var s=e.drawYear+("Y"===i?t:0),n=e.drawMonth+("M"===i?t:0),o=Math.min(e.selectedDay,this._getDaysInMonth(s,n))+("D"===i?t:0),a=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(s,n,o)));e.selectedDay=a.getDate(),e.drawMonth=e.selectedMonth=a.getMonth(),e.drawYear=e.selectedYear=a.getFullYear(),("M"===i||"Y"===i)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),n=i&&i>t?i:t;return s&&n>s?s:n},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null);
},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return new Date(e,t,1).getDay()},_canAdjustMonth:function(e,t,i,s){var n=this._getNumberOfMonths(e),o=this._daylightSavingAdjust(new Date(i,s+(0>t?t:n[0]*n[1]),1));return 0>t&&o.setDate(this._getDaysInMonth(o.getFullYear(),o.getMonth())),this._isInRange(e,o)},_isInRange:function(e,t){var i,s,n=this._getMinMaxDate(e,"min"),o=this._getMinMaxDate(e,"max"),a=null,r=null,l=this._get(e,"yearRange");return l&&(i=l.split(":"),s=(new Date).getFullYear(),a=parseInt(i[0],10),r=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(a+=s),i[1].match(/[+\-].*/)&&(r+=s)),(!n||t.getTime()>=n.getTime())&&(!o||t.getTime()<=o.getTime())&&(!a||t.getFullYear()>=a)&&(!r||t.getFullYear()<=r)},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,i,s){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var n=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(s,i,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),n,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(i)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(i))},e.datepicker=new i,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.11.1",e.datepicker}),define("form/datepicker",["jquery","underscore","form/base-form-element","managers/routemanager","utils","libs/jqueryui/datepicker"],function(e,t,i,s,n){"use strict";var o=i.extend({el:".ui-date-picker",initialize:function(s){t.bindAll(this,"show","hide","onButtonClick","onCalendarDateSelect","setDate"),s.onSelect&&(s.customOnSelect=s.onSelect),s.onSelect=this.onCalendarDateSelect,this._setupDatePicker(this.$el,s),s=e.extend({calendarPanelClass:"ui-light",urlPath:this.$el.data("url-path")},s),s.buttonSelector&&(this.button=this._setupButton(s.buttonSelector)),this.body=n.get("body"),this.calendarPanel=this.body.find("#ui-datepicker-div"),this.calendarPanel.addClass(s.calendarPanelClass+" ui-date-picker-calendar-panel"),i.prototype.initialize.call(this,s)},onCalendarDateSelect:function(i,n){var o=this.options.urlPath,a=new Date(n.selectedYear,n.selectedMonth,n.selectedDay);if(o){if(-1!==o.indexOf("<%=")){var r=o.split("<%=");r.shift();for(var l={},h=0;h<r.length;h++){var d=r[h].match("[a-zA-Z]+")[0];l[d]=e.datepicker.formatDate(d,a)}o=t.template(o,l)}s.goTo(o)}this.options.customOnSelect&&this.options.customOnSelect(i,n)},setDate:function(t,i){t=i?e.datepicker.formatDate(i,t):e.datepicker.formatDate(this.options.dateFormat,t),this.$el.datepicker("setDate",t)},show:function(){this.$el.datepicker("show")},hide:function(){this.$el.datepicker("hide")},_setupDatePicker:function(e,t){e.datepicker(t)},_setupButton:function(i){var s=e(i);return s.on("click."+this.cid,t.bind(function(){this.onButtonClick()},this)),s},onButtonClick:function(){this.show(),this.options.onButtonClick&&this.options.onButtonClick(this.button,this.$el)},getType:function(){return"datepicker"},destroy:function(){this.button&&this.button.off("."+this.cid),this.$el.datepicker("destroy"),i.prototype.destroy.apply(this,arguments)}});return o}),define("form/base-form",["jquery","underscore","baseview","form/input-field","form/autocomplete","form/dropdown","form/checkbox","form/radio-button","form/datepicker"],function(e,t,i,s,n,o,a,r,l){"use strict";var h=i.extend({events:{submit:"onFormSubmit"},initialize:function(h){h=e.extend({formOptions:null},h),this.formNameMap={},i.prototype.initialize.call(this,h),this.$formItems=this.$(".ui-text-input, .ui-textarea, .ui-dropdown, .ui-radio, .ui-checkbox, .ui-date-picker"),this.$formItems.each(t.bind(function(t,i){var h,d=e(i);this.options.formOptions&&(h=this._getCustomOptions(d,this.options.formOptions)),!d.hasClass("ui-text-input")&&!d.hasClass("ui-textarea")||d.hasClass("ui-date-picker")?d.hasClass("ui-dropdown")?this._setupView(d,o,t,h):d.hasClass("ui-radio")?this._setupView(d,r,t,h):d.hasClass("ui-checkbox")?this._setupView(d,a,t,h):d.hasClass("ui-date-picker")&&this._setupView(d,l,t,h):d.data("autocomplete-url")||d.hasClass("ui-autocomplete")?this._setupView(d,n,t,h):this._setupView(d,s,t,h)},this)),this._setupRequiredFields()},_getCustomOptions:function(i,s){return e.isArray(s)||(s=[s]),t.filter(s,function(t){return i[0]===e(t.el)[0]?!0:!1})[0]},_setupRequiredFields:function(){t.each(this.subviews,function(e){e.isRequired()&&e.getUIElement().addClass("ui-form-field-required")})},getFormObjectsByName:function(e){return this.formNameMap[e]},_setupView:function(e,t,i,s){s||(s={el:e});var n="formItem"+i,o=e.attr("name");this.subviews[n]=new t(s),this.formNameMap[o]?this.formNameMap[o].push(this.subviews[n]):this.formNameMap[o]=[this.subviews[n]]},_handlePlaceholders:function(i){var s=[];e.each(i,function(t,i){var n=e(i),o=n.val();o===n.attr("placeholder")&&(s.push({field:n,value:o}),n.val(""))}),t.defer(function(){t.each(s,function(e){e.field.val(e.value)})})},onFormSubmit:function(e){if(!Modernizr.input.placeholder){var t=this.$('[placeholder*=""]');t&&this._handlePlaceholders(t)}},resetForm:function(){this.reset()},reset:function(){this.triggerEvent("reset")}});return h}),define("modules/rentalslite-search",["jquery","baseview","state","managers/routemanager","form/base-form","pubsub"],function(e,t,i,s,n,o){var a=t.extend({events:{"click .js-rls-search-btn":"aptAffWidget","submit .js-rls-form":"aptAffWidget"},initialize:function(e){t.prototype.initialize.call(this,e),this.form=this.$(".js-rls-form"),this.subviews.carSearchForm=new n({el:this.form,formOptions:[{el:this.$(".rls-form-state")},{el:this.$(".rls-form-minrent")},{el:this.$(".rls-form-maxrent")}]}),o.trigger("group_page_view","LDSN"),o.trigger("product_name","Rentals Front")},urlForBedsBaths:function(e,t,i){return isNaN(t)||(e+=0===t?"studio-beds":t+"-beds"),isNaN(t)||isNaN(i)?isNaN(i)||(e+=i+"-baths"):e+="-"+i+"-baths",e},urlForRent:function(e,t,i){return isNaN(t)||isNaN(i)?isNaN(t)?isNaN(i)||(e+="-under-"+i):e+="-over-"+t:e+="-"+t+"-to-"+i,e},urlForPets:function(e,t){return"pets"!==t&&(e+="all"!==t?"-pet-friendly-"+t:"-pet-friendly"),e},aptAffWidget:function(t){var i=this.$(".js-rls-form-city").val(),n=this.$(".js-rls-form-state").val(),o="https://www.apartments.com/";return i?"0"===n?e(".js-rls-form-state").focus():(o+=i+"-"+n+"/",o=this.urlForBedsBaths(o,parseInt(this.$(".js-rls-form-bedrooms").val()),parseInt(this.$(".js-rls-form-bathrooms").val())),o=this.urlForRent(o,parseInt(this.$(".js-rls-form-minrent").val()),parseInt(this.$(".js-rls-form-maxrent").val())),o=this.urlForPets(o,this.$(".js-rls-form-pets").val()),s.goTo(o)):e(".js-rls-form-city").focus(),!1}});return a}),define("modules/sports/sports-leader-rotate",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({initialize:function(s){e.extend(s,{fadeInterval:2e3,rotateInterval:7e3}),i.prototype.initialize.call(this,s),t.bindAll(this,"rotateLeaders"),this.leaderRotation=setInterval(this.rotateLeaders,this.options.rotateInterval)},rotateLeaders:function(){var e=this.options.fadeInterval,t=this.$(".sp-leader-group"),i=this.$(".sp-leader-group.active"),s=this.$(".sp-leader-group").length-1,n=i.next();i.index(".sp-leader-group")==s&&(n=t.first()),i.fadeOut(e,function(){n.fadeIn(e,function(){i.removeClass("active"),n.addClass("active")})})},destroy:function(){clearInterval(this.leaderRotation),i.prototype.destroy.call(this)}});return s}),define("modules/partner/taboola-poster-asset",["baseview"],function(e){"use strict";return e}),define("modules/ggm-jobs-search/ggm-jobs-search",["jquery","underscore","baseview","form/dropdown"],function(e,t,i,s){"use strict";var n=i.extend({events:{submit:"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new s({el:this.$(".ggmmtjm-select")})}});return n}),define("modules/stories/expand-faq",["jquery","baseview"],function(e,t){var i=t.extend({events:{"click a":"expandFaq"},expandFaq:function(t){var i=e(t.target),s=i.next();s.is(":visible")?(i.parent().removeClass("active"),s.slideUp(200)):(i.parent().addClass("active"),s.slideDown(200))}});return i}),define("apps/overlay/pages/olympics-widgets",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({events:{"click .schedule-norm":"reduceSchedule","click .schedule-wide":"expandSchedule","click .widget-switch-block":"switchWidget"},initialize:function(s){e.extend(s,{numberRetries:12,refreshInterval:5e3},s),i.prototype.initialize.call(this,s),t.bindAll(this,"checkWidgetResults"),this.$widget=this.$(".olympics-primary-widget"),this.$widget.length||(this.$widget=this.$(".olympics-sidebar-widget")),this.createWidget()},reduceSchedule:function(t){var i=e(t.currentTarget);i.hasClass("schedule-norm")&&(e(".card-primary-wrapper").css("width","840px"),e(".card-full-width .sidebar").show(),i.addClass("schedule-wide"),i.removeClass("schedule-norm"),i.html("Full Width Schedule"))},expandSchedule:function(t){var i=e(t.currentTarget);i.hasClass("schedule-wide")&&(e(".card-full-width .sidebar").hide(),e(".card-primary-wrapper").css("width","100%"),i.addClass("schedule-norm"),i.removeClass("schedule-wide"),i.html("Display Sidebar"))},createWidget:function(){var t=["athlete","country","day","discipline","event"],i=this.$widget;this.$widget.find(".widget-wrapper").each(function(){for(var s=e(this),n={el:"#"+s.attr("id"),highlight:"USA"},o=0;o<t.length;++o)s.data(t[o])?n[t[o]]=s.data(t[o]).toString():i.data(t[o])&&(n[t[o]]=i.data(t[o]).toString());switch(console.log(n),e(this).data("widget")){case"medals":n.sort="total",i.data("country")||i.data("discipline")?new Reuters.Olympics.View.MedalTable(n):new Reuters.Olympics.View.MedalCount(n);break;case"schedule":new Reuters.Olympics.View.Schedule(n);break;case"results":new Reuters.Olympics.View.Results(n)}}),this.numRetries=this.options.numberRetries},checkWidgetResults:function(){var t=this.$(".rightrail.widget");if(this.$(".olympics-primary-widget")){var i=!1,s=this.$(".olympics-primary-widget .widget-empty");this.$(".olympics-primary-widget .widget-wrapper").each(function(){var t=e(this);0===t.html().length||t.html().indexOf("error")>0||t.html().indexOf("no results")>0?t.hide():(t.show(),i=!0)}),i||this.numRetries>1?s.hide():s.show()}this.$(".olympics-sidebar-widget").each(function(){var i=e(this),s=!0,n=i.closest(".card-sidebar");i.find(".widget-wrapper").each(function(){var t=e(this);0===t.html().length||t.html().indexOf("error")>0||t.html().indexOf("no results")>0?t.hasClass("toggle")||t.hide():(t.hasClass("toggle")||t.show(),s=!1)}),s?(n.hide(),t.hide()):(n.show(),t.show());var o=i.data("max-rows"),a=i.data("max-labels");i.data("max-phases");o&&(e(this).find(".scheduleUnit").each(function(t){t>=o&&e(this).hide()}),e(this).find(".resultsTable").each(function(){e(this).find(".label").each(function(t){if(t>a){var i=e(this).closest("tr");i.hasClass("resultRow")||i.hide()}}),e(this).find(".resultRow").each(function(t){t>=o&&e(this).hide()})}))}),this.$(".reutersOlympicsWidget .widgetBody").removeClass("constrainHeight"),this.numRetries--,this.numRetries>0&&(this.widgetTimer=setTimeout(this.checkWidgetResults,this.options.refreshInterval))},switchWidget:function(t){var i=this.$(".widget-switch-results .widget-wrapper"),s=this.$(".widget-switch-block"),n=e(t.currentTarget),o=s.index(n);i.addClass("hide"),i.eq(o).removeClass("hide"),s.removeClass("selected"),n.addClass("selected")},destroy:function(){this.numRetries=0,this.widgetTimer&&clearTimeout(this.widgetTimer),i.prototype.destroy.call(this)}});return s}),define("modules/travel/flight-search",["jquery","underscore","pubsub","state","baseview","form/base-form","form/autocomplete"],function(e,t,i,s,n,o,a){"use strict";var r=n.extend({events:{"submit form":"flightSearchFormSubmit","click .flight-tracker-search-btn":"flightSearchButtonClick","click .expand-arrow":"expandDetailsClick","click .expand-view":"expandDetailsClick","blur .required":"requiredBlur"},initialize:function(i){i=e.extend(!0,{type:!1},i),this.statusi={A:"En Route",C:"Canceled",D:"Diverted",DN:"Data source needed",L:"Landed",NO:"Not Operational",R:"Redirected",S:"Scheduled",U:"Unknown"},this.searchResultsTemplate=e("#search-results-template");var s=new Date;s=s.getHours(),s%2!==0&&(s+=1),this.$("#flightTime").val(s),t.bindAll(this,"renderResults"),this.pubSub={"popup:click":this.flightStatsSearch},n.prototype.initialize.call(this,i);var r=!1;t.each(this.$("form"),function(i,s){var n=e(i);this.subviews["flightSearchForm"+s]=new o({el:n}),n.hasClass("flight-tracker-form-active")&&(r=n.data("search-type"));var l=s;t.each(n.find(".airport-code"),function(t,i){this.subviews["airportAutoComplete"+l+"-"+i]=new a({el:e(t),maxResults:6,resultDisplayTemplate:"<%= abbr %> - <%= name %>",resultValueTemplate:"<%= abbr %>",url:"/travel/flight-tracker/airports/search/<%=query%>/"})},this),t.each(n.find(".airline-code"),function(t,i){this.subviews["airlineAutoComplete"+l+"-"+i]=new a({el:e(t),maxResults:6,resultDisplayTemplate:"<%= abbr %> - <%= name %>",resultValueTemplate:"<%= abbr %>",url:"/travel/flight-tracker/airlines/search/<%=query%>/"})},this)},this),r&&(this.options.type=r),this.options.type||(this.options.type="flight"),this.currentSearchType=this.options.type,this.$(".flight-tracker-"+this.options.type+"-form-wrap").addClass("flight-tracker-form-active"),this.$(".flight-tracker-search-btn."+this.options.type).addClass("active")},flightSearchFormSubmit:function(s){var n=e(s.currentTarget),o=0;if(n.find(".required").each(function(){var t=e(this);""===t.val()&&(t.addClass("input-error"),o++)}),0!==o)return!1;if(!n.attr("action")){s.preventDefault();var a={};t.each(n.serializeArray(),function(e){a[e.name]=e.value},this),this.flightStatsSearch(this.currentSearchType,a)}i.trigger("uotrack","flighttrackermap")},getFlightSearchUrl:function(e,i){var s=this.$el.attr("data-fs-baseurl")+"flightstatus/rest/v2/jsonp/",n=this.$el.attr("data-fs-appid"),o=this.$el.attr("data-fs-appkey"),a=new Date,r=a.getFullYear(),l=a.getDate(),h=a.getMonth()+1,d=a.getHours(),c=r+"/"+h+"/"+l,u="?appId="+n+"&appKey="+o+"&extendedOptions=useInlinedReferences";return"flight"===e?s+="flight/status/"+i.airline_name+"/"+i.flight_number+"/dep/"+c+u:"route"===e?s+="route/status/"+i.origin_airport+"/"+i.dest_airport+"/dep/"+c+u+"&utc=false&maxFlights=100":"airport"===e?(t.isUndefined(i.flight_time)&&(i.flight_time=d),s+="airport/status/"+i.airport_code+"/"+i.flight_type+"/"+c+"/"+i.flight_time+u+"&numHours=2"):s="",s},flightStatsSearch:function(e,i){var n=this.getFlightSearchUrl(e,i);this.fetch&&this.fetch.abort(),this.fetch=s.fetchData(n,{dataType:"jsonp"}).done(t.bind(function(t){this.renderResults(t.flightStatuses,e,i)},this)).fail(t.bind(function(){this.$(".flight-tracker-results").html('<div class="error">There is no matching flight data.</div>')},this))},flightSearchButtonClick:function(t){var i=e(t.currentTarget),s=i.attr("data-search-type");this.currentSearchType!==s&&(this.$(".flight-tracker-search-btn").removeClass("active"),i.addClass("active"),this.$(".flight-tracker-"+this.currentSearchType+"-form-wrap").removeClass("flight-tracker-form-active"),this.$(".flight-tracker-"+s+"-form-wrap").addClass("flight-tracker-form-active"),this.currentSearchType=s)},requiredBlur:function(t){var i=e(t.currentTarget);""!==i.val()&&i.removeClass("input-error")},renderResults:function(e,i,s){var n=this.statusi;if(t.each(e,function(e){if(e.status=n[e.status],e.color="green",t.isUndefined(e.delays))e.delays="On-time";else{var i=0;t.each(e.delays,function(e){i+=e}),e.delays=i+" min",e.color="yellow"}"Canceled"===e.status&&(e.color="red"),t.isUndefined(e.departureAirport.stateCode)&&(e.departureAirport.stateCode=e.departureAirport.countryCode),t.isUndefined(e.arrivalAirport.stateCode)&&(e.arrivalAirport.stateCode=e.arrivalAirport.countryCode)}),e.length){e={results:e};var o=t.template(this.searchResultsTemplate.html(),e),a="Results for "+i+" search:";s.flight_type_full&&s.airport_name&&(a=s.flight_type_full+": "+s.airport_name),this.$(".flight-tracker-results").empty().append('<div class="search-title">'+a+"</div>").append(o)}else this.$(".flight-tracker-results").html('<div class="error">No matching flight data found.</div>')},expandDetailsClick:function(t){var i=e(t.target).attr("data-flightid"),s=this.$(".detail-view-"+i);s.hasClass("open")?(s.hide().removeClass("open"),e(t.target).removeClass("active")):(s.show().addClass("open"),e(t.target).addClass("active"))}});return r}),define("modules/fronts/front-list-video",["jquery","underscore","utils","modules/videos/uw/uw-wrapper"],function(e,t,i,s){"use strict";var n=s.extend({initialize:function(i){s.prototype.initialize.call(this,i),this.uwIframe=e([]),this.$videoContainer=this.$(".js-uw-iframe-video"),this.$iframeWrapper=this.$(".js-iframe-wrap"),this.options.videoId=this.$videoContainer.attr("data-video-id")||i.videoId,this.options.uwIframeSrc=this.$videoContainer.attr("data-iframe-src")||i.uwIframeSrc,this.options.videoId&&(this.uwIframe=e("<iframe></iframe>").attr({"class":"uw-iframe",src:this.options.uwIframeSrc,name:this.options.videoId,frameborder:0,allowfullscreen:"",scrolling:"no"}).ready(t.bind(function(){this.$iframeWrapper.show(),this.playerReady.resolve()},this)),this.$videoContainer.prepend(this.uwIframe),this.uwIframe=this.uwIframe[0])},destroy:function(){this.$iframeWrapper.hide(),this.uwIframe.remove(),s.prototype.destroy.apply(this,arguments)}});return n}),define("modules/fronts/front-list",["jquery","underscore","utils","state","baseview","directAdPosition","pubsub","modules/fronts/front-list-video"],function(e,t,i,s,n,o,a,r){"use strict";var l=n.extend({events:{"click .js-video-wrap":"_onVideoClick"},initialize:function(s){t.bindAll(this,"_onScroll","_onScrollDepthScroll","_checkScrollPositionAndCreateAd","_checkScrollPositionAndDestroyInlineVideoIframe","_onVideoClick");var o=this.$(".flm-module-wrap");s=e.extend({viewportBuffer:1e3,adConfigs:{leaderboard:{adType:"leaderboard",adSizes:["leaderboard"],adPlacement:"leaderboard_btf"},mediumrectangle:{adType:"poster",adSizes:["mediumrectangle"],adPlacement:"poster_front_btf"}},adType:o.attr("data-ad-type"),lazyLoadEnabled:o.hasClass("js-lazy-load"),adCleanupEnabled:o.hasClass("js-ad-cleanup"),scrollDepthTrackingMilestone:parseInt(this.$(".flm-module-wrap").attr("data-scroll-depth-tracking-milestone"))},s),this.$win=i.get("win"),this.subviews={},this.$adPositions=this.$adPositionsToCheckOnScroll=this.$$(".flm-ad-position"),this.$activeVideos=e([]),this.pubSub={"entered:view:flmad":this.onAdEnterView,"exited:view:flmad":this.onAdExitView,"exited:view:flmvideo":this.onInlineVideoExitView},n.prototype.initialize.call(this,s),this._initAds(),this._initScrollHandlers()},_onVideoClick:function(t){t.preventDefault();var i=e(t.currentTarget),n=i.find(".js-uw-iframe-video").attr("data-video-id"),o="flm-video-"+n;n&&!this.subviews[o]&&(a.trigger("track",{label:i.attr("data-track-label")}),this.$activeVideos=this.$activeVideos.add(i),this.subviews[o]=new r({el:i}),this.options.lazyLoadEnabled&&s.observer&&(i.addClass("js-llc js-llp").attr("data-name","flmvideo"),s.observer.observe(t.currentTarget)))},_initScrollHandlers:function(){this.options.lazyLoadEnabled||(s.registerScrollListener("front-list-"+this.cid,this._onScroll,1e3),this._onScroll()),this.options.scrollDepthTrackingMilestone&&this._initScrollDepthScrollHandler()},_initScrollDepthScrollHandler:function(){if(this.scrollDepthTrackingMilestones=[],this.scrollDepthAtInit=this.$win.scrollTop(),this.scrollDepthAtInit>0){var e=this._calculateScrollDepthMilestone();e>0&&this.scrollDepthTrackingMilestones.push(e)}s.registerScrollListener("front-list-scroll-depth-"+this.cid,this._onScrollDepthScroll,100),this._onScrollDepthScroll()},_calculateScrollDepthMilestone:function(){return Math.floor(this.$win.scrollTop()/this.options.scrollDepthTrackingMilestone)},_onScroll:function(){this.$activeVideos.each(this._checkScrollPositionAndDestroyInlineVideoIframe),this.$adPositionsToCheckOnScroll.each(this._checkScrollPositionAndCreateAd)},_onScrollDepthScroll:function(){this.options.scrollDepthTrackingMilestone&&this.$win.scrollTop()>this.scrollDepthAtInit&&this._checkScrollPositionAndTrackScrollDepth()},_checkScrollPositionAndTrackScrollDepth:function(){var e=this._calculateScrollDepthMilestone();e>0&&!t.contains(this.scrollDepthTrackingMilestones,e)&&(this.scrollDepthTrackingMilestones.push(e),a.trigger("track",{label:"scrollmilestone|"+e*this.options.scrollDepthTrackingMilestone}))},_checkScrollPositionAndCreateAd:function(t,i){this._isCloseEnoughToViewport(i)&&(this.$adPositionsToCheckOnScroll=this.$adPositionsToCheckOnScroll.not(e(i)),this.createAd(i))},_initAds:function(){this.$adPositionsToCheckOnScroll.filter(".js-init-ad").each(t.bind(function(e,t){this.createAd(t)},this))},createAd:function(t){var i,s=e(t),n=s.attr("data-item-index");this.subviews["ad-"+n]||(i=this.$adPositions.index(s)+1,i===this.$adPositions.length&&(i="last"),this.subviews["ad-"+n]=new o({el:s,adType:this.options.adConfigs[this.options.adType].adType,adSizes:this.options.adConfigs[this.options.adType].adSizes,adPlacement:this.options.adConfigs[this.options.adType].adPlacement,targeting:{adCount:i}}))},destroyAd:function(t){var i=e(t),s=i.attr("data-item-index");this.subviews["ad-"+s]&&(this.subviews["ad-"+s].destroy(),delete this.subviews["ad-"+s])},onAdEnterView:function(e){var i=e.gannett.intersectionCount>1&&this.options.adCleanupEnabled?1e3:0;setTimeout(t.bind(function(){e.gannett.isIntersecting&&this.createAd(e)},this),i)},onAdExitView:function(e){this.options.adCleanupEnabled&&this.destroyAd(e)},onInlineVideoExitView:function(e){this._destroyInlineVideoIframe(e)},_checkScrollPositionAndDestroyInlineVideoIframe:function(e,t){this._isCloseEnoughToViewport(t,300)||this._destroyInlineVideoIframe(t)},_destroyInlineVideoIframe:function(t){var i=e(t),n=i.find(".js-uw-iframe-video").attr("data-video-id"),o="flm-video-"+n;this.subviews[o]&&!this.subviews[o].fullScreenEnabled&&(this.$activeVideos=this.$activeVideos.not(i),this.subviews[o].destroy(),delete this.subviews[o],this.options.lazyLoadEnabled&&s.observer&&(i.removeClass("js-llc js-llp"),s.observer.unobserve(t)))},_isCloseEnoughToViewport:function(e,t){t=t||this.options.viewportBuffer;var i=e.getBoundingClientRect().top;return i>=-1*t&&i<=window.innerHeight+t},_removeScrollHandlers:function(){this.options.lazyLoadEnabled||s.unRegisterScrollListener("front-list-"+this.cid),this.options.scrollDepthTrackingMilestone&&s.unRegisterScrollListener("front-list-scroll-depth-"+this.cid)},destroy:function(e){this._removeScrollHandlers(),n.prototype.destroy.call(this,e)}});return l}),define("modules/stories/sponsored-series-topbar",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({animationTime:200,events:{"click .close-drawer":"closeDrawer","click nav ul li a":"toggleDrawer"},closeDrawer:function(){return this.$navAnchors.removeClass("open"),this.$drawer.slideUp(this.animationTime,t.bind(function(){this.$drawer.removeClass("open").removeAttr("style"),this.$openSection.removeClass("open").removeAttr("style"),this.$openSection=null},this)),!1},initialize:function(t){this.options=e.extend({},t),this.$navAnchors=this.$("nav ul li a"),this.$drawer=this.$(".drawer"),this.$sectionAbout=e(".sponsor-about",this.$drawer),this.$sectionResources=e(".sponsor-resources",this.$drawer),this.$sectionVideos=e(".sponsor-videos",this.$drawer)},toggleDrawer:function(i){var s=e(i.target);if(s.hasClass("open"))this.closeDrawer();else{this.$navAnchors.removeClass("open"),s.addClass("open");var n=null;switch(s.attr("href")){case"#sponsor-about":n=this.$sectionAbout;break;case"#sponsor-resources":n=this.$sectionResources;break;case"#sponsor-videos":n=this.$sectionVideos}this.$openSection?this.$openSection.slideUp(this.animationTime,t.bind(function(){this.$openSection.removeClass("open").removeAttr("style"),n.slideDown(this.animationTime,t.bind(function(){n.addClass("open").removeAttr("style")},this))},this)):(n.addClass("open").removeAttr("style"),this.$drawer.slideDown(this.animationTime,t.bind(function(){this.$drawer.addClass("open").removeAttr("style")},this))),this.$openSection=n}return!1}});return s}),function(e,t){var i,s;typeof exports!=t+""?i=exports:(s=e.L,i={},i.noConflict=function(){return e.L=s,this},e.L=i),i.version="0.4.4",i.Util={extend:function(e){for(var t,i=Array.prototype.slice.call(arguments,1),s=0,n=i.length;n>s;s++){t=i[s]||{};for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}return e},bind:function(e,t){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return e.apply(t,i||arguments)}},stamp:function(){var e=0,t="_leaflet_id";return function(i){return i[t]=i[t]||++e,i[t]}}(),limitExecByInterval:function(e,t,i){var s,n;return function o(){var a=arguments;return s?void(n=!0):(s=!0,setTimeout(function(){s=!1,n&&(o.apply(i,a),n=!1)},t),void e.apply(i,a))}},falseFn:function(){return!1},formatNum:function(e,t){var i=Math.pow(10,t||5);return Math.round(e*i)/i},splitWords:function(e){return e.replace(/^\s+|\s+$/g,"").split(/\s+/)},setOptions:function(e,t){return e.options=i.Util.extend({},e.options,t),e.options},getParamString:function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+"="+e[i]);return"?"+t.join("&")},template:function(e,t){return e.replace(/\{ *([\w_]+) *\}/g,function(e,i){var s=t[i];if(!t.hasOwnProperty(i))throw new Error("No value provided for variable "+e);return s})},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function t(t){var i,s,n=["webkit","moz","o","ms"];for(i=0;i<n.length&&!s;i++)s=e[n[i]+t];return s}function s(t){return e.setTimeout(t,1e3/60)}var n=e.requestAnimationFrame||t("RequestAnimationFrame")||s,o=e.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(t){e.clearTimeout(t)};i.Util.requestAnimFrame=function(t,o,a,r){return t=i.Util.bind(t,o),a&&n===s?void t():n.call(e,t,r)},i.Util.cancelAnimFrame=function(t){t&&o.call(e,t)}}(),i.Class=function(){},i.Class.extend=function(e){var t=function(){this.initialize&&this.initialize.apply(this,arguments)},s=function(){};s.prototype=this.prototype;var n=new s;n.constructor=t,t.prototype=n;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(t[o]=this[o]);return e.statics&&(i.Util.extend(t,e.statics),delete e.statics),e.includes&&(i.Util.extend.apply(null,[n].concat(e.includes)),delete e.includes),e.options&&n.options&&(e.options=i.Util.extend({},n.options,e.options)),i.Util.extend(n,e),t},i.Class.include=function(e){i.Util.extend(this.prototype,e)},i.Class.mergeOptions=function(e){i.Util.extend(this.prototype.options,e)};var n="_leaflet_events";i.Mixin={},i.Mixin.Events={addEventListener:function(e,t,s){var o,a,r,l=this[n]=this[n]||{};if("object"==typeof e){for(o in e)e.hasOwnProperty(o)&&this.addEventListener(o,e[o],t);return this}for(e=i.Util.splitWords(e),a=0,r=e.length;r>a;a++)l[e[a]]=l[e[a]]||[],l[e[a]].push({action:t,context:s||this});return this},hasEventListeners:function(e){return n in this&&e in this[n]&&this[n][e].length>0},removeEventListener:function(e,t,s){var o,a,r,l,h,d=this[n];if("object"==typeof e){for(o in e)e.hasOwnProperty(o)&&this.removeEventListener(o,e[o],t);return this}for(e=i.Util.splitWords(e),a=0,r=e.length;r>a;a++)if(this.hasEventListeners(e[a]))for(l=d[e[a]],h=l.length-1;h>=0;h--)t&&l[h].action!==t||s&&l[h].context!==s||l.splice(h,1);return this},fireEvent:function(e,t){if(!this.hasEventListeners(e))return this;for(var s=i.Util.extend({type:e,target:this},t),o=this[n][e].slice(),a=0,r=o.length;r>a;a++)o[a].action.call(o[a].context||this,s);return this}},i.Mixin.Events.on=i.Mixin.Events.addEventListener,i.Mixin.Events.off=i.Mixin.Events.removeEventListener,i.Mixin.Events.fire=i.Mixin.Events.fireEvent,function(){var s=navigator.userAgent.toLowerCase(),n=!!e.ActiveXObject,o=n&&!e.XMLHttpRequest,a=-1!==s.indexOf("webkit"),r=-1!==s.indexOf("gecko"),l=-1!==s.indexOf("chrome"),h=e.opera,d=-1!==s.indexOf("android"),c=-1!==s.search("android [23]"),u=typeof orientation!=t+""?!0:!1,p=document.documentElement,f=n&&"transition"in p.style,g=a&&"WebKitCSSMatrix"in e&&"m11"in new e.WebKitCSSMatrix,m=r&&"MozPerspective"in p.style,v=h&&"OTransition"in p.style,b=!e.L_NO_TOUCH&&function(){var e="ontouchstart";if(e in p)return!0;var t=document.createElement("div"),i=!1;return t.setAttribute?(t.setAttribute(e,"return;"),"function"==typeof t[e]&&(i=!0),t.removeAttribute(e),t=null,i):!1}(),y="devicePixelRatio"in e&&e.devicePixelRatio>1||"matchMedia"in e&&e.matchMedia("(min-resolution:144dpi)").matches;i.Browser={ua:s,ie:n,ie6:o,webkit:a,gecko:r,opera:h,android:d,android23:c,chrome:l,ie3d:f,webkit3d:g,gecko3d:m,opera3d:v,any3d:!e.L_DISABLE_3D&&(f||g||m||v),mobile:u,mobileWebkit:u&&a,mobileWebkit3d:u&&g,mobileOpera:u&&h,touch:b,retina:y}}(),i.Point=function(e,t,i){this.x=i?Math.round(e):e,this.y=i?Math.round(t):t},i.Point.prototype={add:function(e){return this.clone()._add(i.point(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(i.point(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e,t){return new i.Point(this.x/e,this.y/e,t)},multiplyBy:function(e,t){return new i.Point(this.x*e,this.y*e,t)},distanceTo:function(e){e=i.point(e);var t=e.x-this.x,s=e.y-this.y;return Math.sqrt(t*t+s*s)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},clone:function(){return new i.Point(this.x,this.y)},toString:function(){return"Point("+i.Util.formatNum(this.x)+", "+i.Util.formatNum(this.y)+")"}},i.point=function(e,t,s){return e instanceof i.Point?e:e instanceof Array?new i.Point(e[0],e[1]):isNaN(e)?e:new i.Point(e,t,s)},i.Bounds=i.Class.extend({initialize:function(e,t){if(e)for(var i=t?[e,t]:e,s=0,n=i.length;n>s;s++)this.extend(i[s])},extend:function(e){return e=i.point(e),this.min||this.max?(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(e.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(e.y,this.max.y)):(this.min=e.clone(),this.max=e.clone()),this},getCenter:function(e){return new i.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return new i.Point(this.min.x,this.max.y)},getTopRight:function(){return new i.Point(this.max.x,this.min.y)},contains:function(e){var t,s;return e="number"==typeof e[0]||e instanceof i.Point?i.point(e):i.bounds(e),e instanceof i.Bounds?(t=e.min,s=e.max):t=s=e,t.x>=this.min.x&&s.x<=this.max.x&&t.y>=this.min.y&&s.y<=this.max.y},intersects:function(e){e=i.bounds(e);var t=this.min,s=this.max,n=e.min,o=e.max,a=o.x>=t.x&&n.x<=s.x,r=o.y>=t.y&&n.y<=s.y;return a&&r}}),i.bounds=function(e,t){return!e||e instanceof i.Bounds?e:new i.Bounds(e,t);
},i.Transformation=i.Class.extend({initialize:function(e,t,i,s){this._a=e,this._b=t,this._c=i,this._d=s},transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new i.Point((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}}),i.DomUtil={get:function(e){return"string"==typeof e?document.getElementById(e):e},getStyle:function(e,t){var i=e.style[t];if(!i&&e.currentStyle&&(i=e.currentStyle[t]),!i||"auto"===i){var s=document.defaultView.getComputedStyle(e,null);i=s?s[t]:null}return"auto"===i?null:i},getViewportOffset:function(e){var t=0,s=0,n=e,o=document.body;do{if(t+=n.offsetTop||0,s+=n.offsetLeft||0,n.offsetParent===o&&"absolute"===i.DomUtil.getStyle(n,"position"))break;if("fixed"===i.DomUtil.getStyle(n,"position")){t+=o.scrollTop||0,s+=o.scrollLeft||0;break}n=n.offsetParent}while(n);n=e;do{if(n===o)break;t-=n.scrollTop||0,s-=n.scrollLeft||0,n=n.parentNode}while(n);return new i.Point(s,t)},create:function(e,t,i){var s=document.createElement(e);return s.className=t,i&&i.appendChild(s),s},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=i.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(e,t){return e.className.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){i.DomUtil.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){function i(e,i){return i===t?"":e}e.className=e.className.replace(/(\S+)\s*/g,i).replace(/(^\s+|\s+$)/,"")},setOpacity:function(e,t){"opacity"in e.style?e.style.opacity=t:i.Browser.ie&&(t=Math.round(100*t),e.style.filter="alpha(opacity="+t+")")},testProp:function(e){for(var t=document.documentElement.style,i=0;i<e.length;i++)if(e[i]in t)return e[i];return!1},getTranslateString:function(e){var t=i.Browser.webkit3d,s="translate"+(t?"3d":"")+"(",n=(t?",0":"")+")";return s+e.x+"px,"+e.y+"px"+n},getScaleString:function(e,t){var s=i.DomUtil.getTranslateString(t),n=" scale("+e+") ",o=i.DomUtil.getTranslateString(t.multiplyBy(-1));return s+n+o},setPosition:function(e,t,s){e._leaflet_pos=t,!s&&i.Browser.any3d?(e.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(t),i.Browser.mobileWebkit3d&&(e.style.WebkitBackfaceVisibility="hidden")):(e.style.left=t.x+"px",e.style.top=t.y+"px")},getPosition:function(e){return e._leaflet_pos}},i.Util.extend(i.DomUtil,{TRANSITION:i.DomUtil.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:i.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])}),i.LatLng=function(e,t,i){var s=parseFloat(e),n=parseFloat(t);if(isNaN(s)||isNaN(n))throw new Error("Invalid LatLng object: ("+e+", "+t+")");i!==!0&&(s=Math.max(Math.min(s,90),-90),n=(n+180)%360+(-180>n||180===n?180:-180)),this.lat=s,this.lng=n},i.Util.extend(i.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),i.LatLng.prototype={equals:function(e){if(!e)return!1;e=i.latLng(e);var t=Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng));return t<=i.LatLng.MAX_MARGIN},toString:function(){return"LatLng("+i.Util.formatNum(this.lat)+", "+i.Util.formatNum(this.lng)+")"},distanceTo:function(e){e=i.latLng(e);var t=6378137,s=i.LatLng.DEG_TO_RAD,n=(e.lat-this.lat)*s,o=(e.lng-this.lng)*s,a=this.lat*s,r=e.lat*s,l=Math.sin(n/2),h=Math.sin(o/2),d=l*l+h*h*Math.cos(a)*Math.cos(r);return 2*t*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))}},i.latLng=function(e,t,s){return e instanceof i.LatLng?e:e instanceof Array?new i.LatLng(e[0],e[1]):isNaN(e)?e:new i.LatLng(e,t,s)},i.LatLngBounds=i.Class.extend({initialize:function(e,t){if(e)for(var i=t?[e,t]:e,s=0,n=i.length;n>s;s++)this.extend(i[s])},extend:function(e){return e="number"==typeof e[0]||e instanceof i.LatLng?i.latLng(e):i.latLngBounds(e),e instanceof i.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(e.lat,this._southWest.lat),this._southWest.lng=Math.min(e.lng,this._southWest.lng),this._northEast.lat=Math.max(e.lat,this._northEast.lat),this._northEast.lng=Math.max(e.lng,this._northEast.lng)):(this._southWest=new i.LatLng(e.lat,e.lng,!0),this._northEast=new i.LatLng(e.lat,e.lng,!0)):e instanceof i.LatLngBounds&&(this.extend(e._southWest),this.extend(e._northEast)),this},pad:function(e){var t=this._southWest,s=this._northEast,n=Math.abs(t.lat-s.lat)*e,o=Math.abs(t.lng-s.lng)*e;return new i.LatLngBounds(new i.LatLng(t.lat-n,t.lng-o),new i.LatLng(s.lat+n,s.lng+o))},getCenter:function(){return new i.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new i.LatLng(this._northEast.lat,this._southWest.lng,!0)},getSouthEast:function(){return new i.LatLng(this._southWest.lat,this._northEast.lng,!0)},contains:function(e){e="number"==typeof e[0]||e instanceof i.LatLng?i.latLng(e):i.latLngBounds(e);var t,s,n=this._southWest,o=this._northEast;return e instanceof i.LatLngBounds?(t=e.getSouthWest(),s=e.getNorthEast()):t=s=e,t.lat>=n.lat&&s.lat<=o.lat&&t.lng>=n.lng&&s.lng<=o.lng},intersects:function(e){e=i.latLngBounds(e);var t=this._southWest,s=this._northEast,n=e.getSouthWest(),o=e.getNorthEast(),a=o.lat>=t.lat&&n.lat<=s.lat,r=o.lng>=t.lng&&n.lng<=s.lng;return a&&r},toBBoxString:function(){var e=this._southWest,t=this._northEast;return[e.lng,e.lat,t.lng,t.lat].join(",")},equals:function(e){return e?(e=i.latLngBounds(e),this._southWest.equals(e.getSouthWest())&&this._northEast.equals(e.getNorthEast())):!1}}),i.latLngBounds=function(e,t){return!e||e instanceof i.LatLngBounds?e:new i.LatLngBounds(e,t)},i.Projection={},i.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(e){var t=i.LatLng.DEG_TO_RAD,s=this.MAX_LATITUDE,n=Math.max(Math.min(s,e.lat),-s),o=e.lng*t,a=n*t;return a=Math.log(Math.tan(Math.PI/4+a/2)),new i.Point(o,a)},unproject:function(e){var t=i.LatLng.RAD_TO_DEG,s=e.x*t,n=(2*Math.atan(Math.exp(e.y))-Math.PI/2)*t;return new i.LatLng(n,s,!0)}},i.Projection.LonLat={project:function(e){return new i.Point(e.lng,e.lat)},unproject:function(e){return new i.LatLng(e.y,e.x,!0)}},i.CRS={latLngToPoint:function(e,t){var i=this.projection.project(e),s=this.scale(t);return this.transformation._transform(i,s)},pointToLatLng:function(e,t){var i=this.scale(t),s=this.transformation.untransform(e,i);return this.projection.unproject(s)},project:function(e){return this.projection.project(e)},scale:function(e){return 256*Math.pow(2,e)}},i.CRS.EPSG3857=i.Util.extend({},i.CRS,{code:"EPSG:3857",projection:i.Projection.SphericalMercator,transformation:new i.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(e){var t=this.projection.project(e),i=6378137;return t.multiplyBy(i)}}),i.CRS.EPSG900913=i.Util.extend({},i.CRS.EPSG3857,{code:"EPSG:900913"}),i.CRS.EPSG4326=i.Util.extend({},i.CRS,{code:"EPSG:4326",projection:i.Projection.LonLat,transformation:new i.Transformation(1/360,.5,-1/360,.5)}),i.Map=i.Class.extend({includes:i.Mixin.Events,options:{crs:i.CRS.EPSG3857,fadeAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23,trackResize:!0,markerZoomAnimation:i.DomUtil.TRANSITION&&i.Browser.any3d},initialize:function(e,s){s=i.Util.setOptions(this,s),this._initContainer(e),this._initLayout(),this._initHooks(),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.center&&s.zoom!==t&&this.setView(i.latLng(s.center),s.zoom,!0),this._initLayers(s.layers)},setView:function(e,t){return this._resetView(i.latLng(e),this._limitZoom(t)),this},setZoom:function(e){return this.setView(this.getCenter(),e)},zoomIn:function(){return this.setZoom(this._zoom+1)},zoomOut:function(){return this.setZoom(this._zoom-1)},fitBounds:function(e){var t=this.getBoundsZoom(e);return this.setView(i.latLngBounds(e).getCenter(),t)},fitWorld:function(){var e=new i.LatLng(-60,-170),t=new i.LatLng(85,179);return this.fitBounds(new i.LatLngBounds(e,t))},panTo:function(e){return this.setView(e,this._zoom)},panBy:function(e){return this.fire("movestart"),this._rawPanBy(i.point(e)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(e){if(e=i.latLngBounds(e),this.options.maxBounds=e,!e)return this._boundsMinZoom=null,this;var t=this.getBoundsZoom(e,!0);return this._boundsMinZoom=t,this._loaded&&(this._zoom<t?this.setView(e.getCenter(),t):this.panInsideBounds(e)),this},panInsideBounds:function(e){e=i.latLngBounds(e);var t=this.getBounds(),s=this.project(t.getSouthWest()),n=this.project(t.getNorthEast()),o=this.project(e.getSouthWest()),a=this.project(e.getNorthEast()),r=0,l=0;return n.y<a.y&&(l=a.y-n.y),n.x>a.x&&(r=a.x-n.x),s.y>o.y&&(l=o.y-s.y),s.x<o.x&&(r=o.x-s.x),this.panBy(new i.Point(r,l,!0))},addLayer:function(e){var t=i.Util.stamp(e);if(this._layers[t])return this;this._layers[t]=e,e.options&&!isNaN(e.options.maxZoom)&&(this._layersMaxZoom=Math.max(this._layersMaxZoom||0,e.options.maxZoom)),e.options&&!isNaN(e.options.minZoom)&&(this._layersMinZoom=Math.min(this._layersMinZoom||1/0,e.options.minZoom)),this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,e.on("load",this._onTileLayerLoad,this));var s=function(){e.onAdd(this),this.fire("layeradd",{layer:e})};return this._loaded?s.call(this):this.on("load",s,this),this},removeLayer:function(e){var t=i.Util.stamp(e);if(this._layers[t])return e.onRemove(this),delete this._layers[t],this.options.zoomAnimation&&i.TileLayer&&e instanceof i.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,e.off("load",this._onTileLayerLoad,this)),this.fire("layerremove",{layer:e})},hasLayer:function(e){var t=i.Util.stamp(e);return this._layers.hasOwnProperty(t)},invalidateSize:function(e){var t=this.getSize();if(this._sizeChanged=!0,this.options.maxBounds&&this.setMaxBounds(this.options.maxBounds),!this._loaded)return this;var s=t.subtract(this.getSize()).divideBy(2,!0);return e===!0?this.panBy(s):(this._rawPanBy(s),this.fire("move"),clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(i.Util.bind(this.fire,this,"moveend"),200)),this},addHandler:function(e,t){return t?(this[e]=new t(this),this.options[e]&&this[e].enable(),this):void 0},getCenter:function(){return this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds(),t=this.unproject(e.getBottomLeft()),s=this.unproject(e.getTopRight());return new i.LatLngBounds(t,s)},getMinZoom:function(){var e=this.options.minZoom||0,t=this._layersMinZoom||0,i=this._boundsMinZoom||0;return Math.max(e,t,i)},getMaxZoom:function(){var e=this.options.maxZoom===t?1/0:this.options.maxZoom,i=this._layersMaxZoom===t?1/0:this._layersMaxZoom;return Math.min(e,i)},getBoundsZoom:function(e,t){e=i.latLngBounds(e);var s,n,o,a=this.getSize(),r=this.options.minZoom||0,l=this.getMaxZoom(),h=e.getNorthEast(),d=e.getSouthWest(),c=!0;t&&r--;do r++,n=this.project(h,r),o=this.project(d,r),s=new i.Point(Math.abs(n.x-o.x),Math.abs(o.y-n.y)),c=t?s.x<a.x||s.y<a.y:s.x<=a.x&&s.y<=a.y;while(c&&l>=r);return c&&t?null:t?r:r-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new i.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size},getPixelBounds:function(){var e=this._getTopLeftPoint();return new i.Bounds(e,e.add(this.getSize()))},getPixelOrigin:function(){return this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e){var t=this.options.crs;return t.scale(e)/t.scale(this._zoom)},getScaleZoom:function(e){return this._zoom+Math.log(e)/Math.LN2},project:function(e,s){return s=s===t?this._zoom:s,this.options.crs.latLngToPoint(i.latLng(e),s)},unproject:function(e,s){return s=s===t?this._zoom:s,this.options.crs.pointToLatLng(i.point(e),s)},layerPointToLatLng:function(e){var t=i.point(e).add(this._initialTopLeftPoint);return this.unproject(t)},latLngToLayerPoint:function(e){var t=this.project(i.latLng(e))._round();return t._subtract(this._initialTopLeftPoint)},containerPointToLayerPoint:function(e){return i.point(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return i.point(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(i.point(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(i.latLng(e)))},mouseEventToContainerPoint:function(e){return i.DomEvent.getMousePosition(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=i.DomUtil.get(e);if(t._leaflet)throw new Error("Map container is already initialized.");t._leaflet=!0},_initLayout:function(){var e=this._container;e.innerHTML="",i.DomUtil.addClass(e,"leaflet-container"),i.Browser.touch&&i.DomUtil.addClass(e,"leaflet-touch"),this.options.fadeAnimation&&i.DomUtil.addClass(e,"leaflet-fade-anim");var t=i.DomUtil.getStyle(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._mapPane=e.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=e.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),this._objectsPane=e.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),e.shadowPane=this._createPane("leaflet-shadow-pane"),e.overlayPane=this._createPane("leaflet-overlay-pane"),e.markerPane=this._createPane("leaflet-marker-pane"),e.popupPane=this._createPane("leaflet-popup-pane");var t=" leaflet-zoom-hide";this.options.markerZoomAnimation||(i.DomUtil.addClass(e.markerPane,t),i.DomUtil.addClass(e.shadowPane,t),i.DomUtil.addClass(e.popupPane,t))},_createPane:function(e,t){return i.DomUtil.create("div",e,t||this._objectsPane)},_initializers:[],_initHooks:function(){var e,t;for(e=0,t=this._initializers.length;t>e;e++)this._initializers[e].call(this)},_initLayers:function(e){e=e?e instanceof Array?e:[e]:[],this._layers={},this._tileLayersNum=0;var t,i;for(t=0,i=e.length;i>t;t++)this.addLayer(e[t])},_resetView:function(e,t,s,n){var o=this._zoom!==t;n||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(e),s?this._initialTopLeftPoint._add(this._getMapPanePos()):i.DomUtil.setPosition(this._mapPane,new i.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum,this.fire("viewreset",{hard:!s}),this.fire("move"),(o||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!s}),this._loaded||(this._loaded=!0,this.fire("load"))},_rawPanBy:function(e){i.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(e))},_initEvents:function(){if(i.DomEvent){i.DomEvent.on(this._container,"click",this._onMouseClick,this);var t,s,n=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(t=0,s=n.length;s>t;t++)i.DomEvent.on(this._container,n[t],this._fireMouseEvent,this);this.options.trackResize&&i.DomEvent.on(e,"resize",this._onResize,this)}},_onResize:function(){i.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=i.Util.requestAnimFrame(this.invalidateSize,this,!1,this._container)},_onMouseClick:function(e){!this._loaded||this.dragging&&this.dragging.moved()||(this.fire("preclick"),this._fireMouseEvent(e))},_fireMouseEvent:function(e){if(this._loaded){var t=e.type;if(t="mouseenter"===t?"mouseover":"mouseleave"===t?"mouseout":t,this.hasEventListeners(t)){"contextmenu"===t&&i.DomEvent.preventDefault(e);var s=this.mouseEventToContainerPoint(e),n=this.containerPointToLayerPoint(s),o=this.layerPointToLatLng(n);this.fire(t,{latlng:o,layerPoint:n,containerPoint:s,originalEvent:e})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this._tileBg&&(clearTimeout(this._clearTileBgTimer),this._clearTileBgTimer=setTimeout(i.Util.bind(this._clearTileBg,this),500))},_getMapPanePos:function(){return i.DomUtil.getPosition(this._mapPane)},_getTopLeftPoint:function(){if(!this._loaded)throw new Error("Set map center and zoom first.");return this._initialTopLeftPoint.subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(e,t){var i=this.getSize().divideBy(2);return this.project(e,t)._subtract(i)._round()},_latLngToNewLayerPoint:function(e,t,i){var s=this._getNewTopLeftPoint(i,t).add(this._getMapPanePos());return this.project(e,t)._subtract(s)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize().divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitZoom:function(e){var t=this.getMinZoom(),i=this.getMaxZoom();return Math.max(t,Math.min(i,e))}}),i.Map.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),i="function"==typeof e?e:function(){this[e].apply(this,t)};this.prototype._initializers.push(i)},i.map=function(e,t){return new i.Map(e,t)},i.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.3142,R_MAJOR:6378137,project:function(e){var t=i.LatLng.DEG_TO_RAD,s=this.MAX_LATITUDE,n=Math.max(Math.min(s,e.lat),-s),o=this.R_MAJOR,a=this.R_MINOR,r=e.lng*t*o,l=n*t,h=a/o,d=Math.sqrt(1-h*h),c=d*Math.sin(l);c=Math.pow((1-c)/(1+c),.5*d);var u=Math.tan(.5*(.5*Math.PI-l))/c;return l=-a*Math.log(u),new i.Point(r,l)},unproject:function(e){for(var t,s=i.LatLng.RAD_TO_DEG,n=this.R_MAJOR,o=this.R_MINOR,a=e.x*s/n,r=o/n,l=Math.sqrt(1-r*r),h=Math.exp(-e.y/o),d=Math.PI/2-2*Math.atan(h),c=15,u=1e-7,p=c,f=.1;Math.abs(f)>u&&--p>0;)t=l*Math.sin(d),f=Math.PI/2-2*Math.atan(h*Math.pow((1-t)/(1+t),.5*l))-d,d+=f;return new i.LatLng(d*s,a,!0)}},i.CRS.EPSG3395=i.Util.extend({},i.CRS,{code:"EPSG:3395",projection:i.Projection.Mercator,transformation:function(){var e=i.Projection.Mercator,t=e.R_MAJOR,s=e.R_MINOR;return new i.Transformation(.5/(Math.PI*t),.5,-.5/(Math.PI*s),.5)}()}),i.TileLayer=i.Class.extend({includes:i.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:i.Browser.mobile,updateWhenIdle:i.Browser.mobile},initialize:function(e,t){t=i.Util.setOptions(this,t),t.detectRetina&&i.Browser.retina&&t.maxZoom>0&&(t.tileSize=Math.floor(t.tileSize/2),t.zoomOffset++,t.minZoom>0&&t.minZoom--,this.options.maxZoom--),this._url=e;var s=this.options.subdomains;"string"==typeof s&&(this.options.subdomains=s.split(""))},onAdd:function(e){this._map=e,this._initContainer(),this._createTileProto(),e.on({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||(this._limitedUpdate=i.Util.limitExecByInterval(this._update,150,this),e.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._panes.tilePane.removeChild(this._container),e.off({viewreset:this._resetCallback,moveend:this._update},this),this.options.updateWhenIdle||e.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var e=this._map._panes.tilePane;return this._container&&(e.appendChild(this._container),this._setAutoZIndex(e,Math.max)),this},bringToBack:function(){var e=this._map._panes.tilePane;return this._container&&(e.insertBefore(this._container,e.firstChild),this._setAutoZIndex(e,Math.min)),this},getAttribution:function(){return this.options.attribution},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},setUrl:function(e,t){return this._url=e,t||this.redraw(),this},redraw:function(){return this._map&&(this._map._panes.tilePane.empty=!1,this._reset(!0),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==t&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e,t){for(var i,s=e.getElementsByClassName("leaflet-layer"),n=-t(1/0,-(1/0)),o=0,a=s.length;a>o;o++)s[o]!==this._container&&(i=parseInt(s[o].style.zIndex,10),isNaN(i)||(n=t(n,i)));this._container.style.zIndex=isFinite(n)?n+t(1,-1):""},_updateOpacity:function(){i.DomUtil.setOpacity(this._container,this.options.opacity);var e,t=this._tiles;if(i.Browser.webkit)for(e in t)t.hasOwnProperty(e)&&(t[e].style.webkitTransform+=" translate(0,0)")},_initContainer:function(){var e=this._map._panes.tilePane;(!this._container||e.empty)&&(this._container=i.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),e.appendChild(this._container),this.options.opacity<1&&this._updateOpacity())},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){var t,i=this._tiles;for(t in i)i.hasOwnProperty(t)&&this.fire("tileunload",{tile:i[t]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),e&&this._container&&(this._container.innerHTML=""),this._initContainer()},_update:function(e){if(!this._map._panTransition||!this._map._panTransition._inProgress){var t=this._map.getPixelBounds(),s=this._map.getZoom(),n=this.options.tileSize;if(!(s>this.options.maxZoom||s<this.options.minZoom)){var o=new i.Point(Math.floor(t.min.x/n),Math.floor(t.min.y/n)),a=new i.Point(Math.floor(t.max.x/n),Math.floor(t.max.y/n)),r=new i.Bounds(o,a);this._addTilesFromCenterOut(r),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(r)}}},_addTilesFromCenterOut:function(e){var t,s,n,o=[],a=e.getCenter();for(t=e.min.y;t<=e.max.y;t++)for(s=e.min.x;s<=e.max.x;s++)n=new i.Point(s,t),this._tileShouldBeLoaded(n)&&o.push(n);var r=o.length;if(0!==r){o.sort(function(e,t){return e.distanceTo(a)-t.distanceTo(a)});var l=document.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=r,s=0;r>s;s++)this._addTile(o[s],l);this._container.appendChild(l)}},_tileShouldBeLoaded:function(e){if(e.x+":"+e.y in this._tiles)return!1;if(!this.options.continuousWorld){var t=this._getWrapTileNum();if(this.options.noWrap&&(e.x<0||e.x>=t)||e.y<0||e.y>=t)return!1}return!0},_removeOtherTiles:function(e){var t,i,s,n;for(n in this._tiles)this._tiles.hasOwnProperty(n)&&(t=n.split(":"),i=parseInt(t[0],10),s=parseInt(t[1],10),(i<e.min.x||i>e.max.x||s<e.min.y||s>e.max.y)&&this._removeTile(n))},_removeTile:function(e){var t=this._tiles[e];this.fire("tileunload",{tile:t,url:t.src}),this.options.reuseTiles?(i.DomUtil.removeClass(t,"leaflet-tile-loaded"),this._unusedTiles.push(t)):t.parentNode===this._container&&this._container.removeChild(t),i.Browser.android||(t.src=i.Util.emptyImageUrl),delete this._tiles[e]},_addTile:function(e,t){var s=this._getTilePos(e),n=this._getTile();i.DomUtil.setPosition(n,s,i.Browser.chrome||i.Browser.android23),this._tiles[e.x+":"+e.y]=n,this._loadTile(n,e),n.parentNode!==this._container&&t.appendChild(n)},_getZoomForUrl:function(){var e=this.options,t=this._map.getZoom();return e.zoomReverse&&(t=e.maxZoom-t),t+e.zoomOffset},_getTilePos:function(e){var t=this._map.getPixelOrigin(),i=this.options.tileSize;return e.multiplyBy(i).subtract(t)},getTileUrl:function(e){return this._adjustTilePoint(e),i.Util.template(this._url,i.Util.extend({s:this._getSubdomain(e),z:this._getZoomForUrl(),x:e.x,y:e.y},this.options))},_getWrapTileNum:function(){return Math.pow(2,this._getZoomForUrl())},_adjustTilePoint:function(e){var t=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(e.x=(e.x%t+t)%t),this.options.tms&&(e.y=t-e.y-1)},_getSubdomain:function(e){var t=(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_createTileProto:function(){var e=this._tileImg=i.DomUtil.create("img","leaflet-tile");e.galleryimg="no";var t=this.options.tileSize;e.style.width=t+"px",e.style.height=t+"px"},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var e=this._unusedTiles.pop();return this._resetTile(e),e}return this._createTile()},_resetTile:function(e){},_createTile:function(){var e=this._tileImg.cloneNode(!1);return e.onselectstart=e.onmousemove=i.Util.falseFn,e},_loadTile:function(e,t){e._layer=this,e.onload=this._tileOnLoad,e.onerror=this._tileOnError,e.src=this.getTileUrl(t)},_tileLoaded:function(){this._tilesToLoad--,this._tilesToLoad||this.fire("load")},_tileOnLoad:function(e){var t=this._layer;this.src!==i.Util.emptyImageUrl&&(i.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(e){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var i=t.options.errorTileUrl;i&&(this.src=i),t._tileLoaded()}}),i.tileLayer=function(e,t){return new i.TileLayer(e,t)},i.TileLayer.WMS=i.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(e,t){this._url=e;var s=i.Util.extend({},this.defaultWmsParams);t.detectRetina&&i.Browser.retina?s.width=s.height=2*this.options.tileSize:s.width=s.height=this.options.tileSize;for(var n in t)this.options.hasOwnProperty(n)||(s[n]=t[n]);this.wmsParams=s,i.Util.setOptions(this,t)},onAdd:function(e){var t=parseFloat(this.wmsParams.version)>=1.3?"crs":"srs";this.wmsParams[t]=e.options.crs.code,i.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e,t){var s=this._map,n=s.options.crs,o=this.options.tileSize,a=e.multiplyBy(o),r=a.add(new i.Point(o,o)),l=n.project(s.unproject(a,t)),h=n.project(s.unproject(r,t)),d=[l.x,h.y,h.x,l.y].join(","),c=i.Util.template(this._url,{s:this._getSubdomain(e)});return c+i.Util.getParamString(this.wmsParams)+"&bbox="+d},setParams:function(e,t){return i.Util.extend(this.wmsParams,e),t||this.redraw(),this}}),i.tileLayer.wms=function(e,t){return new i.TileLayer.WMS(e,t)},i.TileLayer.Canvas=i.TileLayer.extend({options:{async:!1},initialize:function(e){i.Util.setOptions(this,e)},redraw:function(){var e,t=this._tiles;for(e in t)t.hasOwnProperty(e)&&this._redrawTile(t[e])},_redrawTile:function(e){this.drawTile(e,e._tilePoint,e._zoom)},_createTileProto:function(){var e=this._canvasProto=i.DomUtil.create("canvas","leaflet-tile"),t=this.options.tileSize;e.width=t,e.height=t},_createTile:function(){var e=this._canvasProto.cloneNode(!1);return e.onselectstart=e.onmousemove=i.Util.falseFn,e},_loadTile:function(e,t,i){e._layer=this,e._tilePoint=t,e._zoom=i,this.drawTile(e,t,i),this.options.async||this.tileDrawn(e)},drawTile:function(e,t,i){},tileDrawn:function(e){this._tileOnLoad.call(e)}}),i.tileLayer.canvas=function(e){return new i.TileLayer.Canvas(e)},i.ImageOverlay=i.Class.extend({includes:i.Mixin.Events,options:{opacity:1},initialize:function(e,t,s){this._url=e,this._bounds=i.latLngBounds(t),i.Util.setOptions(this,s)},onAdd:function(e){this._map=e,this._image||this._initImage(),e._panes.overlayPane.appendChild(this._image),e.on("viewreset",this._reset,this),e.options.zoomAnimation&&i.Browser.any3d&&e.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(e){e.getPanes().overlayPane.removeChild(this._image),e.off("viewreset",this._reset,this),e.options.zoomAnimation&&e.off("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var e=this._map._panes.overlayPane;return this._image&&e.insertBefore(this._image,e.firstChild),this},_initImage:function(){this._image=i.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&i.Browser.any3d?i.DomUtil.addClass(this._image,"leaflet-zoom-animated"):i.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),i.Util.extend(this._image,{galleryimg:"no",onselectstart:i.Util.falseFn,onmousemove:i.Util.falseFn,onload:i.Util.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(e){var t=this._map,s=this._image,n=t.getZoomScale(e.zoom),o=this._bounds.getNorthWest(),a=this._bounds.getSouthEast(),r=t._latLngToNewLayerPoint(o,e.zoom,e.center),l=t._latLngToNewLayerPoint(a,e.zoom,e.center).subtract(r),h=t.latLngToLayerPoint(a).subtract(t.latLngToLayerPoint(o)),d=r.add(l.subtract(h).divideBy(2));s.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(d)+" scale("+n+") "},_reset:function(){var e=this._image,t=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),s=this._map.latLngToLayerPoint(this._bounds.getSouthEast()).subtract(t);i.DomUtil.setPosition(e,t),e.style.width=s.x+"px",e.style.height=s.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){i.DomUtil.setOpacity(this._image,this.options.opacity)}}),i.imageOverlay=function(e,t,s){return new i.ImageOverlay(e,t,s)},i.Icon=i.Class.extend({options:{className:""},initialize:function(e){i.Util.setOptions(this,e)},createIcon:function(){return this._createIcon("icon")},createShadow:function(){return this._createIcon("shadow")},_createIcon:function(e){var t=this._getIconUrl(e);if(!t){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(t);return this._setIconStyles(i,e),i},_setIconStyles:function(e,t){var s,n=this.options,o=i.point(n[t+"Size"]);s="shadow"===t?i.point(n.shadowAnchor||n.iconAnchor):i.point(n.iconAnchor),!s&&o&&(s=o.divideBy(2,!0)),e.className="leaflet-marker-"+t+" "+n.className,s&&(e.style.marginLeft=-s.x+"px",e.style.marginTop=-s.y+"px"),o&&(e.style.width=o.x+"px",e.style.height=o.y+"px")},_createImg:function(e){var t;return i.Browser.ie6?t=document.createElement("div"):(t=document.createElement("img"),t.src=e),t},_getIconUrl:function(e){return this.options[e+"Url"]}}),i.icon=function(e){return new i.Icon(e)},i.Icon.Default=i.Icon.extend({options:{iconSize:new i.Point(25,41),iconAnchor:new i.Point(13,41),popupAnchor:new i.Point(1,-34),shadowSize:new i.Point(41,41)},_getIconUrl:function(e){var t=e+"Url";if(this.options[t])return this.options[t];var s=i.Icon.Default.imagePath;if(!s)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return s+"/marker-"+e+".png"}}),i.Icon.Default.imagePath=function(){var e,t,i,s,n=document.getElementsByTagName("script"),o=/\/?leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(e=0,t=n.length;t>e;e++)if(i=n[e].src,s=i.match(o))return i.split(o)[0]+"/images"}(),i.Marker=i.Class.extend({includes:i.Mixin.Events,options:{icon:new i.Icon.Default,title:"",clickable:!0,draggable:!1,zIndexOffset:0,opacity:1},initialize:function(e,t){i.Util.setOptions(this,t),this._latlng=i.latLng(e)},onAdd:function(e){this._map=e,e.on("viewreset",this.update,this),this._initIcon(),this.update(),e.options.zoomAnimation&&e.options.markerZoomAnimation&&e.on("zoomanim",this._animateZoom,this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){this._removeIcon(),this.closePopup&&this.closePopup(),e.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(e){this._latlng=i.latLng(e),this.update(),this._popup&&this._popup.setLatLng(e)},setZIndexOffset:function(e){this.options.zIndexOffset=e,this.update()},setIcon:function(e){this._map&&this._removeIcon(),this.options.icon=e,this._map&&(this._initIcon(),this.update())},update:function(){if(this._icon){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}},_initIcon:function(){var e=this.options,t=this._map,s=t.options.zoomAnimation&&t.options.markerZoomAnimation,n=s?"leaflet-zoom-animated":"leaflet-zoom-hide",o=!1;
this._icon||(this._icon=e.icon.createIcon(),e.title&&(this._icon.title=e.title),this._initInteraction(),o=this.options.opacity<1,i.DomUtil.addClass(this._icon,n)),this._shadow||(this._shadow=e.icon.createShadow(),this._shadow&&(i.DomUtil.addClass(this._shadow,n),o=this.options.opacity<1)),o&&this._updateOpacity();var a=this._map._panes;a.markerPane.appendChild(this._icon),this._shadow&&a.shadowPane.appendChild(this._shadow)},_removeIcon:function(){var e=this._map._panes;e.markerPane.removeChild(this._icon),this._shadow&&e.shadowPane.removeChild(this._shadow),this._icon=this._shadow=null},_setPos:function(e){i.DomUtil.setPosition(this._icon,e),this._shadow&&i.DomUtil.setPosition(this._shadow,e),this._icon.style.zIndex=e.y+this.options.zIndexOffset},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPos(t)},_initInteraction:function(){if(this.options.clickable){var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout"];i.DomUtil.addClass(e,"leaflet-clickable"),i.DomEvent.on(e,"click",this._onMouseClick,this);for(var s=0;s<t.length;s++)i.DomEvent.on(e,t[s],this._fireMouseEvent,this);i.Handler.MarkerDrag&&(this.dragging=new i.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(e){i.DomEvent.stopPropagation(e),this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()||this.fire(e.type,{originalEvent:e})},_fireMouseEvent:function(e){this.fire(e.type,{originalEvent:e}),"mousedown"!==e.type&&i.DomEvent.stopPropagation(e)},setOpacity:function(e){this.options.opacity=e,this._map&&this._updateOpacity()},_updateOpacity:function(){i.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&i.DomUtil.setOpacity(this._shadow,this.options.opacity)}}),i.marker=function(e,t){return new i.Marker(e,t)},i.DivIcon=i.Icon.extend({options:{iconSize:new i.Point(12,12),className:"leaflet-div-icon"},createIcon:function(){var e=document.createElement("div"),t=this.options;return t.html&&(e.innerHTML=t.html),t.bgPos&&(e.style.backgroundPosition=-t.bgPos.x+"px "+-t.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),i.divIcon=function(e){return new i.DivIcon(e)},i.Map.mergeOptions({closePopupOnClick:!0}),i.Popup=i.Class.extend({includes:i.Mixin.Events,options:{minWidth:50,maxWidth:300,maxHeight:null,autoPan:!0,closeButton:!0,offset:new i.Point(0,6),autoPanPadding:new i.Point(5,5),className:""},initialize:function(e,t){i.Util.setOptions(this,e),this._source=t},onAdd:function(e){this._map=e,this._container||this._initLayout(),this._updateContent();var t=e.options.fadeAnimation;t&&i.DomUtil.setOpacity(this._container,0),e._panes.popupPane.appendChild(this._container),e.on("viewreset",this._updatePosition,this),i.Browser.any3d&&e.on("zoomanim",this._zoomAnimation,this),e.options.closePopupOnClick&&e.on("preclick",this._close,this),this._update(),t&&i.DomUtil.setOpacity(this._container,1)},addTo:function(e){return e.addLayer(this),this},openOn:function(e){return e.openPopup(this),this},onRemove:function(e){e._panes.popupPane.removeChild(this._container),i.Util.falseFn(this._container.offsetWidth),e.off({viewreset:this._updatePosition,preclick:this._close,zoomanim:this._zoomAnimation},this),e.options.fadeAnimation&&i.DomUtil.setOpacity(this._container,0),this._map=null},setLatLng:function(e){return this._latlng=i.latLng(e),this._update(),this},setContent:function(e){return this._content=e,this._update(),this},_close:function(){var e=this._map;e&&(e._popup=null,e.removeLayer(this).fire("popupclose",{popup:this}))},_initLayout:function(){var e,t="leaflet-popup",s=this._container=i.DomUtil.create("div",t+" "+this.options.className+" leaflet-zoom-animated");this.options.closeButton&&(e=this._closeButton=i.DomUtil.create("a",t+"-close-button",s),e.href="#close",e.innerHTML="&#215;",i.DomEvent.on(e,"click",this._onCloseButtonClick,this));var n=this._wrapper=i.DomUtil.create("div",t+"-content-wrapper",s);i.DomEvent.disableClickPropagation(n),this._contentNode=i.DomUtil.create("div",t+"-content",n),i.DomEvent.on(this._contentNode,"mousewheel",i.DomEvent.stopPropagation),this._tipContainer=i.DomUtil.create("div",t+"-tip-container",s),this._tip=i.DomUtil.create("div",t+"-tip",this._tipContainer)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var s=e.offsetWidth;s=Math.min(s,this.options.maxWidth),s=Math.max(s,this.options.minWidth),t.width=s+1+"px",t.whiteSpace="",t.height="";var n=e.offsetHeight,o=this.options.maxHeight,a="leaflet-popup-scrolled";o&&n>o?(t.height=o+"px",i.DomUtil.addClass(e,a)):i.DomUtil.removeClass(e,a),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng),t=i.Browser.any3d,s=this.options.offset;t&&i.DomUtil.setPosition(this._container,e),this._containerBottom=-s.y-(t?0:e.y),this._containerLeft=-Math.round(this._containerWidth/2)+s.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"},_zoomAnimation:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);i.DomUtil.setPosition(this._container,t)},_adjustPan:function(){if(this.options.autoPan){var e=this._map,t=this._container.offsetHeight,s=this._containerWidth,n=new i.Point(this._containerLeft,-t-this._containerBottom);i.Browser.any3d&&n._add(i.DomUtil.getPosition(this._container));var o=e.layerPointToContainerPoint(n),a=this.options.autoPanPadding,r=e.getSize(),l=0,h=0;o.x<0&&(l=o.x-a.x),o.x+s>r.x&&(l=o.x+s-r.x+a.x),o.y<0&&(h=o.y-a.y),o.y+t>r.y&&(h=o.y+t-r.y+a.y),(l||h)&&e.panBy(new i.Point(l,h))}},_onCloseButtonClick:function(e){this._close(),i.DomEvent.stop(e)}}),i.popup=function(e,t){return new i.Popup(e,t)},i.Marker.include({openPopup:function(){return this._popup&&this._map&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},bindPopup:function(e,t){var s=i.point(this.options.icon.options.popupAnchor)||new i.Point(0,0);return s=s.add(i.Popup.prototype.options.offset),t&&t.offset&&(s=s.add(t.offset)),t=i.Util.extend({offset:s},t),this._popup||this.on("click",this.openPopup,this),this._popup=new i.Popup(t,this).setContent(e),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.openPopup)),this}}),i.Map.include({openPopup:function(e){return this.closePopup(),this._popup=e,this.addLayer(e).fire("popupopen",{popup:this._popup})},closePopup:function(){return this._popup&&this._popup._close(),this}}),i.LayerGroup=i.Class.extend({initialize:function(e){this._layers={};var t,i;if(e)for(t=0,i=e.length;i>t;t++)this.addLayer(e[t])},addLayer:function(e){var t=i.Util.stamp(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=i.Util.stamp(e);return delete this._layers[t],this._map&&this._map.removeLayer(e),this},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(e){var t,i,s=Array.prototype.slice.call(arguments,1);for(t in this._layers)this._layers.hasOwnProperty(t)&&(i=this._layers[t],i[e]&&i[e].apply(i,s));return this},onAdd:function(e){this._map=e,this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e),this._map=null},addTo:function(e){return e.addLayer(this),this},eachLayer:function(e,t){for(var i in this._layers)this._layers.hasOwnProperty(i)&&e.call(t,this._layers[i])}}),i.layerGroup=function(e){return new i.LayerGroup(e)},i.FeatureGroup=i.LayerGroup.extend({includes:i.Mixin.Events,addLayer:function(e){return this._layers[i.Util.stamp(e)]?this:(e.on("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.addLayer.call(this,e),this._popupContent&&e.bindPopup&&e.bindPopup(this._popupContent),this)},removeLayer:function(e){return e.off("click dblclick mouseover mouseout mousemove contextmenu",this._propagateEvent,this),i.LayerGroup.prototype.removeLayer.call(this,e),this._popupContent?this.invoke("unbindPopup"):this},bindPopup:function(e){return this._popupContent=e,this.invoke("bindPopup",e)},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new i.LatLngBounds;return this.eachLayer(function(t){e.extend(t instanceof i.Marker?t.getLatLng():t.getBounds())},this),e},_propagateEvent:function(e){e.layer=e.target,e.target=this,this.fire(e.type,e)}}),i.featureGroup=function(e){return new i.FeatureGroup(e)},i.Path=i.Class.extend({includes:[i.Mixin.Events],statics:{CLIP_PADDING:i.Browser.mobile?Math.max(0,Math.min(.5,(1280/Math.max(e.innerWidth,e.innerHeight)-1)/2)):.5},options:{stroke:!0,color:"#0033ff",dashArray:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(e){i.Util.setOptions(this,e)},onAdd:function(e){this._map=e,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),e.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(e){return e.addLayer(this),this},onRemove:function(e){e._pathRoot.removeChild(this._container),this._map=null,i.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),e.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(e){return i.Util.setOptions(this,e),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),i.Map.include({_updatePathViewport:function(){var e=i.Path.CLIP_PADDING,t=this.getSize(),s=i.DomUtil.getPosition(this._mapPane),n=s.multiplyBy(-1)._subtract(t.multiplyBy(e)),o=n.add(t.multiplyBy(1+2*e));this._pathViewport=new i.Bounds(n,o)}}),i.Path.SVG_NS="http://www.w3.org/2000/svg",i.Browser.svg=!(!document.createElementNS||!document.createElementNS(i.Path.SVG_NS,"svg").createSVGRect),i.Path=i.Path.extend({statics:{SVG:i.Browser.svg},bringToFront:function(){return this._container&&this._map._pathRoot.appendChild(this._container),this},bringToBack:function(){if(this._container){var e=this._map._pathRoot;e.insertBefore(this._container,e.firstChild)}return this},getPathString:function(){},_createElement:function(e){return document.createElementNS(i.Path.SVG_NS,e)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray")):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var e=this.getPathString();e||(e="M0 0"),this._path.setAttribute("d",e)},_initEvents:function(){if(this.options.clickable){(i.Browser.svg||!i.Browser.vml)&&this._path.setAttribute("class","leaflet-clickable"),i.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var e=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],t=0;t<e.length;t++)i.DomEvent.on(this._container,e[t],this._fireMouseEvent,this)}},_onMouseClick:function(e){this._map.dragging&&this._map.dragging.moved()||(this._fireMouseEvent(e),i.DomEvent.stopPropagation(e))},_fireMouseEvent:function(e){if(this.hasEventListeners(e.type)){"contextmenu"===e.type&&i.DomEvent.preventDefault(e);var t=this._map,s=t.mouseEventToContainerPoint(e),n=t.containerPointToLayerPoint(s),o=t.layerPointToLatLng(n);this.fire(e.type,{latlng:o,layerPoint:n,containerPoint:s,originalEvent:e})}}}),i.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=i.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&i.Browser.any3d?(this._pathRoot.setAttribute("class"," leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):this._pathRoot.setAttribute("class"," leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(e){var t=this.getZoomScale(e.zoom),s=this._getCenterOffset(e.center).divideBy(1-1/t),n=this.containerPointToLayerPoint(this.getSize().multiplyBy(-i.Path.CLIP_PADDING)),o=n.add(s).round();this._pathRoot.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(o.multiplyBy(-1).add(i.DomUtil.getPosition(this._pathRoot)).multiplyBy(t).add(o))+" scale("+t+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,s=e.max,n=s.x-t.x,o=s.y-t.y,a=this._pathRoot,r=this._panes.overlayPane;i.Browser.mobileWebkit&&r.removeChild(a),i.DomUtil.setPosition(a,t),a.setAttribute("width",n),a.setAttribute("height",o),a.setAttribute("viewBox",[t.x,t.y,n,o].join(" ")),i.Browser.mobileWebkit&&r.appendChild(a)}}}),i.Path.include({bindPopup:function(e,t){return this._popup&&this._popup.options===t||(this._popup=new i.Popup(t,this)),this._popup.setContent(e),this._openPopupAdded||(this.on("click",this._openPopup,this),this._openPopupAdded=!0),this},openPopup:function(e){return this._popup&&(e=e||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:e})),this},_openPopup:function(e){this._popup.setLatLng(e.latlng),this._map.openPopup(this._popup)}}),i.Browser.vml=function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(i){return!1}}(),i.Path=i.Browser.svg||!i.Browser.vml?i.Path:i.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var e=this._container=this._createElement("shape");i.DomUtil.addClass(e,"leaflet-vml-shape"),this.options.clickable&&i.DomUtil.addClass(e,"leaflet-clickable"),e.coordsize="1 1",this._path=this._createElement("path"),e.appendChild(this._path),this._map._pathRoot.appendChild(e)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var e=this._stroke,t=this._fill,i=this.options,s=this._container;s.stroked=i.stroke,s.filled=i.fill,i.stroke?(e||(e=this._stroke=this._createElement("stroke"),e.endcap="round",s.appendChild(e)),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=i.dashArray.replace(/ *, */g," "):e.dashStyle=""):e&&(s.removeChild(e),this._stroke=null),i.fill?(t||(t=this._fill=this._createElement("fill"),s.appendChild(t)),t.color=i.fillColor||i.color,t.opacity=i.fillOpacity):t&&(s.removeChild(t),this._fill=null)},_updatePath:function(){var e=this._container.style;e.display="none",this._path.v=this.getPathString()+" ",e.display=""}}),i.Map.include(i.Browser.svg||!i.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var e=this._pathRoot=document.createElement("div");e.className="leaflet-vml-container",this._panes.overlayPane.appendChild(e),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),i.Browser.canvas=function(){return!!document.createElement("canvas").getContext}(),i.Path=i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?i.Path:i.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(e){return i.Util.setOptions(this,e),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(e){e.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this._requestUpdate(),this._map=null},_requestUpdate:function(){this._map&&(i.Util.cancelAnimFrame(this._fireMapMoveEnd),this._updateRequest=i.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var e=this.options;e.stroke&&(this._ctx.lineWidth=e.weight,this._ctx.strokeStyle=e.color),e.fill&&(this._ctx.fillStyle=e.fillColor||e.color)},_drawPath:function(){var e,t,s,n,o,a;for(this._ctx.beginPath(),e=0,s=this._parts.length;s>e;e++){for(t=0,n=this._parts[e].length;n>t;t++)o=this._parts[e][t],a=(0===t?"move":"line")+"To",this._ctx[a](o.x,o.y);this instanceof i.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var e=this._ctx,t=this.options;this._drawPath(),e.save(),this._updateStyle(),t.fill&&(t.fillOpacity<1&&(e.globalAlpha=t.fillOpacity),e.fill()),t.stroke&&(t.opacity<1&&(e.globalAlpha=t.opacity),e.stroke()),e.restore()}},_initEvents:function(){this.options.clickable&&this._map.on("click",this._onClick,this)},_onClick:function(e){this._containsPoint(e.layerPoint)&&this.fire("click",e)}}),i.Map.include(i.Path.SVG&&!e.L_PREFER_CANVAS||!i.Browser.canvas?{}:{_initPathRoot:function(){var e,t=this._pathRoot;t||(t=this._pathRoot=document.createElement("canvas"),t.style.position="absolute",e=this._canvasCtx=t.getContext("2d"),e.lineCap="round",e.lineJoin="round",this._panes.overlayPane.appendChild(t),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var e=this._pathViewport,t=e.min,s=e.max.subtract(t),n=this._pathRoot;i.DomUtil.setPosition(n,t),n.width=s.x,n.height=s.y,n.getContext("2d").translate(-t.x,-t.y)}}}),i.LineUtil={simplify:function(e,t){if(!t||!e.length)return e.slice();var i=t*t;return e=this._reducePoints(e,i),e=this._simplifyDP(e,i)},pointToSegmentDistance:function(e,t,i){return Math.sqrt(this._sqClosestPointOnSegment(e,t,i,!0))},closestPointOnSegment:function(e,t,i){return this._sqClosestPointOnSegment(e,t,i)},_simplifyDP:function(e,i){var s=e.length,n=typeof Uint8Array!=t+""?Uint8Array:Array,o=new n(s);o[0]=o[s-1]=1,this._simplifyDPStep(e,o,i,0,s-1);var a,r=[];for(a=0;s>a;a++)o[a]&&r.push(e[a]);return r},_simplifyDPStep:function(e,t,i,s,n){var o,a,r,l=0;for(a=s+1;n-1>=a;a++)r=this._sqClosestPointOnSegment(e[a],e[s],e[n],!0),r>l&&(o=a,l=r);l>i&&(t[o]=1,this._simplifyDPStep(e,t,i,s,o),this._simplifyDPStep(e,t,i,o,n))},_reducePoints:function(e,t){for(var i=[e[0]],s=1,n=0,o=e.length;o>s;s++)this._sqDist(e[s],e[n])>t&&(i.push(e[s]),n=s);return o-1>n&&i.push(e[o-1]),i},clipSegment:function(e,t,i,s){var n=(i.min,i.max,s?this._lastCode:this._getBitCode(e,i)),o=this._getBitCode(t,i);for(this._lastCode=o;;){if(!(n|o))return[e,t];if(n&o)return!1;var a=n||o,r=this._getEdgeIntersection(e,t,a,i),l=this._getBitCode(r,i);a===n?(e=r,n=l):(t=r,o=l)}},_getEdgeIntersection:function(e,t,s,n){var o=t.x-e.x,a=t.y-e.y,r=n.min,l=n.max;return 8&s?new i.Point(e.x+o*(l.y-e.y)/a,l.y):4&s?new i.Point(e.x+o*(r.y-e.y)/a,r.y):2&s?new i.Point(l.x,e.y+a*(l.x-e.x)/o):1&s?new i.Point(r.x,e.y+a*(r.x-e.x)/o):void 0},_getBitCode:function(e,t){var i=0;return e.x<t.min.x?i|=1:e.x>t.max.x&&(i|=2),e.y<t.min.y?i|=4:e.y>t.max.y&&(i|=8),i},_sqDist:function(e,t){var i=t.x-e.x,s=t.y-e.y;return i*i+s*s},_sqClosestPointOnSegment:function(e,t,s,n){var o,a=t.x,r=t.y,l=s.x-a,h=s.y-r,d=l*l+h*h;return d>0&&(o=((e.x-a)*l+(e.y-r)*h)/d,o>1?(a=s.x,r=s.y):o>0&&(a+=l*o,r+=h*o)),l=e.x-a,h=e.y-r,n?l*l+h*h:new i.Point(a,r)}},i.Polyline=i.Path.extend({initialize:function(e,t){i.Path.prototype.initialize.call(this,t),this._latlngs=this._convertLatLngs(e),i.Handler.PolyEdit&&(this.editing=new i.Handler.PolyEdit(this),this.options.editable&&this.editing.enable())},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var e=0,t=this._latlngs.length;t>e;e++)this._originalPoints[e]=this._map.latLngToLayerPoint(this._latlngs[e])},getPathString:function(){for(var e=0,t=this._parts.length,i="";t>e;e++)i+=this._getPathPartStr(this._parts[e]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._latlngs=this._convertLatLngs(e),this.redraw()},addLatLng:function(e){return this._latlngs.push(i.latLng(e)),this.redraw()},spliceLatLngs:function(e,t){var i=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs),this.redraw(),i},closestLayerPoint:function(e){for(var t,s,n=1/0,o=this._parts,a=null,r=0,l=o.length;l>r;r++)for(var h=o[r],d=1,c=h.length;c>d;d++){t=h[d-1],s=h[d];var u=i.LineUtil._sqClosestPointOnSegment(e,t,s,!0);n>u&&(n=u,a=i.LineUtil._sqClosestPointOnSegment(e,t,s))}return a&&(a.distance=Math.sqrt(n)),a},getBounds:function(){for(var e=new i.LatLngBounds,t=this.getLatLngs(),s=0,n=t.length;n>s;s++)e.extend(t[s]);return e},onAdd:function(e){i.Path.prototype.onAdd.call(this,e),this.editing&&this.editing.enabled()&&this.editing.addHooks()},onRemove:function(e){this.editing&&this.editing.enabled()&&this.editing.removeHooks(),i.Path.prototype.onRemove.call(this,e)},_convertLatLngs:function(e){var t,s;for(t=0,s=e.length;s>t;t++){if(e[t]instanceof Array&&"number"!=typeof e[t][0])return;e[t]=i.latLng(e[t])}return e},_initEvents:function(){i.Path.prototype._initEvents.call(this)},_getPathPartStr:function(e){for(var t,s=i.Path.VML,n=0,o=e.length,a="";o>n;n++)t=e[n],s&&t._round(),a+=(n?"L":"M")+t.x+" "+t.y;return a},_clipPoints:function(){var e,t,s,n=this._originalPoints,o=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var a=this._parts,r=this._map._pathViewport,l=i.LineUtil;for(e=0,t=0;o-1>e;e++)s=l.clipSegment(n[e],n[e+1],r,e),s&&(a[t]=a[t]||[],a[t].push(s[0]),(s[1]!==n[e+1]||e===o-2)&&(a[t].push(s[1]),t++))},_simplifyPoints:function(){for(var e=this._parts,t=i.LineUtil,s=0,n=e.length;n>s;s++)e[s]=t.simplify(e[s],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),i.Path.prototype._updatePath.call(this))}}),i.polyline=function(e,t){return new i.Polyline(e,t)},i.PolyUtil={},i.PolyUtil.clipPolygon=function(e,t){var s,n,o,a,r,l,h,d,c,u=(t.min,t.max,[1,4,2,8]),p=i.LineUtil;for(n=0,h=e.length;h>n;n++)e[n]._code=p._getBitCode(e[n],t);for(a=0;4>a;a++){for(d=u[a],s=[],n=0,h=e.length,o=h-1;h>n;o=n++)r=e[n],l=e[o],r._code&d?l._code&d||(c=p._getEdgeIntersection(l,r,d,t),c._code=p._getBitCode(c,t),s.push(c)):(l._code&d&&(c=p._getEdgeIntersection(l,r,d,t),c._code=p._getBitCode(c,t),s.push(c)),s.push(r));e=s}return e},i.Polygon=i.Polyline.extend({options:{fill:!0},initialize:function(e,t){i.Polyline.prototype.initialize.call(this,e,t),e&&e[0]instanceof Array&&"number"!=typeof e[0][0]&&(this._latlngs=this._convertLatLngs(e[0]),this._holes=e.slice(1))},projectLatlngs:function(){if(i.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes)for(var e=0,t=this._holes.length;t>e;e++){this._holePoints[e]=[];for(var s=0,n=this._holes[e].length;n>s;s++)this._holePoints[e][s]=this._map.latLngToLayerPoint(this._holes[e][s])}},_clipPoints:function(){var e=this._originalPoints,t=[];if(this._parts=[e].concat(this._holePoints),!this.options.noClip){for(var s=0,n=this._parts.length;n>s;s++){var o=i.PolyUtil.clipPolygon(this._parts[s],this._map._pathViewport);o.length&&t.push(o)}this._parts=t}},_getPathPartStr:function(e){var t=i.Polyline.prototype._getPathPartStr.call(this,e);return t+(i.Browser.svg?"z":"x")}}),i.polygon=function(e,t){return new i.Polygon(e,t)},function(){function e(e){return i.FeatureGroup.extend({initialize:function(e,t){this._layers={},this._options=t,this.setLatLngs(e)},setLatLngs:function(t){var i=0,s=t.length;for(this.eachLayer(function(e){s>i?e.setLatLngs(t[i++]):this.removeLayer(e)},this);s>i;)this.addLayer(new e(t[i++],this._options));return this}})}i.MultiPolyline=e(i.Polyline),i.MultiPolygon=e(i.Polygon),i.multiPolyline=function(e,t){return new i.MultiPolyline(e,t)},i.multiPolygon=function(e,t){return new i.MultiPolygon(e,t)}}(),i.Rectangle=i.Polygon.extend({initialize:function(e,t){i.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return e=i.latLngBounds(e),[e.getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast(),e.getSouthWest()]}}),i.rectangle=function(e,t){return new i.Rectangle(e,t)},i.Circle=i.Path.extend({initialize:function(e,t,s){i.Path.prototype.initialize.call(this,s),this._latlng=i.latLng(e),this._mRadius=t},options:{fill:!0},setLatLng:function(e){return this._latlng=i.latLng(e),this.redraw()},setRadius:function(e){return this._mRadius=e,this.redraw()},projectLatlngs:function(){var e=this._getLngRadius(),t=new i.LatLng(this._latlng.lat,this._latlng.lng-e,!0),s=this._map.latLngToLayerPoint(t);this._point=this._map.latLngToLayerPoint(this._latlng),this._radius=Math.max(Math.round(this._point.x-s.x),1)},getBounds:function(){var e=this._map,t=this._radius*Math.cos(Math.PI/4),s=e.project(this._latlng),n=new i.Point(s.x-t,s.y+t),o=new i.Point(s.x+t,s.y-t),a=e.unproject(n),r=e.unproject(o);return new i.LatLngBounds(a,r)},getLatLng:function(){return this._latlng},getPathString:function(){var e=this._point,t=this._radius;return this._checkIfEmpty()?"":i.Browser.svg?"M"+e.x+","+(e.y-t)+"A"+t+","+t+",0,1,1,"+(e.x-.1)+","+(e.y-t)+" z":(e._round(),t=Math.round(t),"AL "+e.x+","+e.y+" "+t+","+t+" 0,23592600")},getRadius:function(){return this._mRadius},_getLngRadius:function(){var e=40075017,t=e*Math.cos(i.LatLng.DEG_TO_RAD*this._latlng.lat);return this._mRadius/t*360},_checkIfEmpty:function(){if(!this._map)return!1;var e=this._map._pathViewport,t=this._radius,i=this._point;return i.x-t>e.max.x||i.y-t>e.max.y||i.x+t<e.min.x||i.y+t<e.min.y}}),i.circle=function(e,t,s){return new i.Circle(e,t,s)},i.CircleMarker=i.Circle.extend({options:{radius:10,weight:2},initialize:function(e,t){i.Circle.prototype.initialize.call(this,e,null,t),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setRadius:function(e){return this._radius=e,this.redraw()}}),i.circleMarker=function(e,t){return new i.CircleMarker(e,t)},i.Polyline.include(i.Path.CANVAS?{_containsPoint:function(e,t){var s,n,o,a,r,l,h,d=this.options.weight/2;for(i.Browser.touch&&(d+=10),s=0,a=this._parts.length;a>s;s++)for(h=this._parts[s],n=0,r=h.length,o=r-1;r>n;o=n++)if((t||0!==n)&&(l=i.LineUtil.pointToSegmentDistance(e,h[o],h[n]),d>=l))return!0;return!1}}:{}),i.Polygon.include(i.Path.CANVAS?{_containsPoint:function(e){var t,s,n,o,a,r,l,h,d=!1;if(i.Polyline.prototype._containsPoint.call(this,e,!0))return!0;for(o=0,l=this._parts.length;l>o;o++)for(t=this._parts[o],a=0,h=t.length,r=h-1;h>a;r=a++)s=t[a],n=t[r],s.y>e.y!=n.y>e.y&&e.x<(n.x-s.x)*(e.y-s.y)/(n.y-s.y)+s.x&&(d=!d);return d}}:{}),i.Circle.include(i.Path.CANVAS?{_drawPath:function(){var e=this._point;this._ctx.beginPath(),this._ctx.arc(e.x,e.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(e){var t=this._point,i=this.options.stroke?this.options.weight/2:0;return e.distanceTo(t)<=this._radius+i}}:{}),i.GeoJSON=i.FeatureGroup.extend({initialize:function(e,t){i.Util.setOptions(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,s,n=e instanceof Array?e:e.features;if(n){for(t=0,s=n.length;s>t;t++)this.addData(n[t]);return this}var o=this.options;if(!o.filter||o.filter(e)){var a=i.GeoJSON.geometryToLayer(e,o.pointToLayer);return a.feature=e,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(e,a),this.addLayer(a)}},resetStyle:function(e){var t=this.options.style;t&&this._setLayerStyle(e,t)},setStyle:function(e){this.eachLayer(function(t){this._setLayerStyle(t,e)},this)},_setLayerStyle:function(e,t){"function"==typeof t&&(t=t(e.feature)),e.setStyle&&e.setStyle(t)}}),i.Util.extend(i.GeoJSON,{geometryToLayer:function(e,t){var s,n,o,a,r,l="Feature"===e.type?e.geometry:e,h=l.coordinates,d=[];switch(l.type){case"Point":return s=this.coordsToLatLng(h),t?t(e,s):new i.Marker(s);case"MultiPoint":for(o=0,a=h.length;a>o;o++)s=this.coordsToLatLng(h[o]),r=t?t(e,s):new i.Marker(s),d.push(r);return new i.FeatureGroup(d);case"LineString":return n=this.coordsToLatLngs(h),new i.Polyline(n);case"Polygon":return n=this.coordsToLatLngs(h,1),new i.Polygon(n);case"MultiLineString":return n=this.coordsToLatLngs(h,1),new i.MultiPolyline(n);case"MultiPolygon":return n=this.coordsToLatLngs(h,2),new i.MultiPolygon(n);case"GeometryCollection":for(o=0,a=l.geometries.length;a>o;o++)r=this.geometryToLayer(l.geometries[o],t),d.push(r);return new i.FeatureGroup(d);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(e,t){var s=parseFloat(e[t?0:1]),n=parseFloat(e[t?1:0]);return new i.LatLng(s,n,!0)},coordsToLatLngs:function(e,t,i){var s,n,o,a=[];for(n=0,o=e.length;o>n;n++)s=t?this.coordsToLatLngs(e[n],t-1,i):this.coordsToLatLng(e[n],i),a.push(s);return a}}),i.geoJson=function(e,t){return new i.GeoJSON(e,t)},i.DomEvent={addListener:function(e,t,s,n){var o,a,r,l=i.Util.stamp(s),h="_leaflet_"+t+l;return e[h]?this:(o=function(t){return s.call(n||e,t||i.DomEvent._getEvent())},i.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener?this.addDoubleTapListener(e,o,l):("addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",o,!1),e.addEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?(a=o,r="mouseenter"===t?"mouseover":"mouseout",o=function(t){return i.DomEvent._checkMouse(e,t)?a(t):void 0},e.addEventListener(r,o,!1)):e.addEventListener(t,o,!1):"attachEvent"in e&&e.attachEvent("on"+t,o),e[h]=o,this))},removeListener:function(e,t,s){var n=i.Util.stamp(s),o="_leaflet_"+t+n,a=e[o];if(a)return i.Browser.touch&&"dblclick"===t&&this.removeDoubleTapListener?this.removeDoubleTapListener(e,n):"removeEventListener"in e?"mousewheel"===t?(e.removeEventListener("DOMMouseScroll",a,!1),e.removeEventListener(t,a,!1)):"mouseenter"===t||"mouseleave"===t?e.removeEventListener("mouseenter"===t?"mouseover":"mouseout",a,!1):e.removeEventListener(t,a,!1):"detachEvent"in e&&e.detachEvent("on"+t,a),e[o]=null,this},stopPropagation:function(e){return e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this},disableClickPropagation:function(e){var t=i.DomEvent.stopPropagation;return i.DomEvent.addListener(e,i.Draggable.START,t).addListener(e,"click",t).addListener(e,"dblclick",t)},preventDefault:function(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this},stop:function(e){return i.DomEvent.preventDefault(e).stopPropagation(e);
},getMousePosition:function(e,t){var s=document.body,n=document.documentElement,o=e.pageX?e.pageX:e.clientX+s.scrollLeft+n.scrollLeft,a=e.pageY?e.pageY:e.clientY+s.scrollTop+n.scrollTop,r=new i.Point(o,a);return t?r._subtract(i.DomUtil.getViewportOffset(t)):r},getWheelDelta:function(e){var t=0;return e.wheelDelta&&(t=e.wheelDelta/120),e.detail&&(t=-e.detail/3),t},_checkMouse:function(e,t){var i=t.relatedTarget;if(!i)return!0;try{for(;i&&i!==e;)i=i.parentNode}catch(s){return!1}return i!==e},_getEvent:function(){var t=e.event;if(!t)for(var i=arguments.callee.caller;i&&(t=i.arguments[0],!t||e.Event!==t.constructor);)i=i.caller;return t}},i.DomEvent.on=i.DomEvent.addListener,i.DomEvent.off=i.DomEvent.removeListener,i.Draggable=i.Class.extend({includes:i.Mixin.Events,statics:{START:i.Browser.touch?"touchstart":"mousedown",END:i.Browser.touch?"touchend":"mouseup",MOVE:i.Browser.touch?"touchmove":"mousemove",TAP_TOLERANCE:15},initialize:function(e,t){this._element=e,this._dragStartTarget=t||e},enable:function(){this._enabled||(i.DomEvent.on(this._dragStartTarget,i.Draggable.START,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(i.DomEvent.off(this._dragStartTarget,i.Draggable.START,this._onDown),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(!(!i.Browser.touch&&e.shiftKey||1!==e.which&&1!==e.button&&!e.touches)){if(this._simulateClick=!0,e.touches&&e.touches.length>1)return void(this._simulateClick=!1);var t=e.touches&&1===e.touches.length?e.touches[0]:e,s=t.target;i.DomEvent.preventDefault(e),i.Browser.touch&&"a"===s.tagName.toLowerCase()&&i.DomUtil.addClass(s,"leaflet-active"),this._moved=!1,this._moving||(this._startPos=this._newPos=i.DomUtil.getPosition(this._element),this._startPoint=new i.Point(t.clientX,t.clientY),i.DomEvent.on(document,i.Draggable.MOVE,this._onMove,this),i.DomEvent.on(document,i.Draggable.END,this._onUp,this))}},_onMove:function(e){if(!(e.touches&&e.touches.length>1)){var t=e.touches&&1===e.touches.length?e.touches[0]:e,s=new i.Point(t.clientX,t.clientY),n=s.subtract(this._startPoint);(n.x||n.y)&&(i.DomEvent.preventDefault(e),this._moved||(this.fire("dragstart"),this._moved=!0,i.Browser.touch||(i.DomUtil.disableTextSelection(),this._setMovingCursor())),this._newPos=this._startPos.add(n),this._moving=!0,i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget))}},_updatePosition:function(){this.fire("predrag"),i.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(e){if(this._simulateClick&&e.changedTouches){var t=e.changedTouches[0],s=t.target,n=this._newPos&&this._newPos.distanceTo(this._startPos)||0;"a"===s.tagName.toLowerCase()&&i.DomUtil.removeClass(s,"leaflet-active"),n<i.Draggable.TAP_TOLERANCE&&this._simulateEvent("click",t)}i.Browser.touch||(i.DomUtil.enableTextSelection(),this._restoreCursor()),i.DomEvent.off(document,i.Draggable.MOVE,this._onMove),i.DomEvent.off(document,i.Draggable.END,this._onUp),this._moved&&(i.Util.cancelAnimFrame(this._animRequest),this.fire("dragend")),this._moving=!1},_setMovingCursor:function(){i.DomUtil.addClass(document.body,"leaflet-dragging")},_restoreCursor:function(){i.DomUtil.removeClass(document.body,"leaflet-dragging")},_simulateEvent:function(t,i){var s=document.createEvent("MouseEvents");s.initMouseEvent(t,!0,!0,e,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(s)}}),i.Handler=i.Class.extend({initialize:function(e){this._map=e},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),i.Map.mergeOptions({dragging:!0,inertia:!i.Browser.android23,inertiaDeceleration:3e3,inertiaMaxSpeed:1500,inertiaThreshold:i.Browser.touch?32:14,worldCopyJump:!0}),i.Map.Drag=i.Handler.extend({addHooks:function(){if(!this._draggable){this._draggable=new i.Draggable(this._map._mapPane,this._map._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);var e=this._map.options;e.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),this._map.on("viewreset",this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var e=this._map;e.fire("movestart").fire("dragstart"),e._panTransition&&e._panTransition._onTransitionEnd(!0),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var e=this._lastTime=+new Date,t=this._lastPos=this._draggable._newPos;this._positions.push(t),this._times.push(e),e-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint(new i.LatLng(0,0));this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.project(new i.LatLng(0,180)).x},_onPreDrag:function(){var e=(this._map,this._worldWidth),t=Math.round(e/2),i=this._initialWorldOffset,s=this._draggable._newPos.x,n=(s-t+i)%e+t-i,o=(s+t+i)%e-t-i,a=Math.abs(n+i)<Math.abs(o+i)?n:o;this._draggable._newPos.x=a},_onDragEnd:function(){var e=this._map,s=e.options,n=+new Date-this._lastTime,o=!s.inertia||n>s.inertiaThreshold||this._positions[0]===t;if(o)e.fire("moveend");else{var a=this._lastPos.subtract(this._positions[0]),r=(this._lastTime+n-this._times[0])/1e3,l=a.multiplyBy(.58/r),h=l.distanceTo(new i.Point(0,0)),d=Math.min(s.inertiaMaxSpeed,h),c=l.multiplyBy(d/h),u=d/s.inertiaDeceleration,p=c.multiplyBy(-u/2).round(),f={duration:u,easing:"ease-out"};i.Util.requestAnimFrame(i.Util.bind(function(){this._map.panBy(p,f)},this))}e.fire("dragend"),s.maxBounds&&i.Util.requestAnimFrame(this._panInsideMaxBounds,e,!0,e._container)},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)}}),i.Map.addInitHook("addHandler","dragging",i.Map.Drag),i.Map.mergeOptions({doubleClickZoom:!0}),i.Map.DoubleClickZoom=i.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick)},_onDoubleClick:function(e){this.setView(e.latlng,this._zoom+1)}}),i.Map.addInitHook("addHandler","doubleClickZoom",i.Map.DoubleClickZoom),i.Map.mergeOptions({scrollWheelZoom:!i.Browser.touch}),i.Map.ScrollWheelZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){i.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll)},_onWheelScroll:function(e){var t=i.DomEvent.getWheelDelta(e);this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),clearTimeout(this._timer),this._timer=setTimeout(i.Util.bind(this._performZoom,this),40),i.DomEvent.preventDefault(e)},_performZoom:function(){var e=this._map,t=Math.round(this._delta),i=e.getZoom();if(t=Math.max(Math.min(t,4),-4),t=e._limitZoom(i+t)-i,this._delta=0,t){var s=i+t,n=this._getCenterForScrollWheelZoom(this._lastMousePos,s);e.setView(n,s)}},_getCenterForScrollWheelZoom:function(e,t){var i=this._map,s=i.getZoomScale(t),n=i.getSize().divideBy(2),o=e.subtract(n).multiplyBy(1-1/s),a=i._getTopLeftPoint().add(n).add(o);return i.unproject(a)}}),i.Map.addInitHook("addHandler","scrollWheelZoom",i.Map.ScrollWheelZoom),i.Util.extend(i.DomEvent,{addDoubleTapListener:function(e,t,i){function s(e){if(1===e.touches.length){var t=Date.now(),i=t-(o||t);a=e.touches[0],r=i>0&&l>=i,o=t}}function n(e){r&&(a.type="dblclick",t(a),o=null)}var o,a,r=!1,l=250,h="_leaflet_",d="touchstart",c="touchend";return e[h+d+i]=s,e[h+c+i]=n,e.addEventListener(d,s,!1),e.addEventListener(c,n,!1),this},removeDoubleTapListener:function(e,t){var i="_leaflet_";return e.removeEventListener(e,e[i+"touchstart"+t],!1),e.removeEventListener(e,e[i+"touchend"+t],!1),this}}),i.Map.mergeOptions({touchZoom:i.Browser.touch&&!i.Browser.android23}),i.Map.TouchZoom=i.Handler.extend({addHooks:function(){i.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){i.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var s=t.mouseEventToLayerPoint(e.touches[0]),n=t.mouseEventToLayerPoint(e.touches[1]),o=t._getCenterLayerPoint();this._startCenter=s.add(n).divideBy(2,!0),this._startDist=s.distanceTo(n),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),i.DomEvent.on(document,"touchmove",this._onTouchMove,this).on(document,"touchend",this._onTouchEnd,this),i.DomEvent.preventDefault(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length){var t=this._map,s=t.mouseEventToLayerPoint(e.touches[0]),n=t.mouseEventToLayerPoint(e.touches[1]);this._scale=s.distanceTo(n)/this._startDist,this._delta=s.add(n).divideBy(2,!0).subtract(this._startCenter),1!==this._scale&&(this._moved||(i.DomUtil.addClass(t._mapPane,"leaflet-zoom-anim leaflet-touching"),t.fire("movestart").fire("zoomstart")._prepareTileBg(),this._moved=!0),i.Util.cancelAnimFrame(this._animRequest),this._animRequest=i.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),i.DomEvent.preventDefault(e))}},_updateOnMove:function(){var e=this._map,t=this._getScaleOrigin(),s=e.layerPointToLatLng(t);e.fire("zoomanim",{center:s,zoom:e.getScaleZoom(this._scale)}),e._tileBg.style[i.DomUtil.TRANSFORM]=i.DomUtil.getTranslateString(this._delta)+" "+i.DomUtil.getScaleString(this._scale,this._startCenter)},_onTouchEnd:function(e){if(this._moved&&this._zooming){var t=this._map;this._zooming=!1,i.DomUtil.removeClass(t._mapPane,"leaflet-touching"),i.DomEvent.off(document,"touchmove",this._onTouchMove).off(document,"touchend",this._onTouchEnd);var s=this._getScaleOrigin(),n=t.layerPointToLatLng(s),o=t.getZoom(),a=t.getScaleZoom(this._scale)-o,r=a>0?Math.ceil(a):Math.floor(a),l=t._limitZoom(o+r);t.fire("zoomanim",{center:n,zoom:l}),t._runAnimation(n,l,t.getZoomScale(l)/this._scale,s,!0)}},_getScaleOrigin:function(){var e=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(e)}}),i.Map.addInitHook("addHandler","touchZoom",i.Map.TouchZoom),i.Map.mergeOptions({boxZoom:!0}),i.Map.BoxZoom=i.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){i.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){i.DomEvent.off(this._container,"mousedown",this._onMouseDown)},_onMouseDown:function(e){return!e.shiftKey||1!==e.which&&1!==e.button?!1:(i.DomUtil.disableTextSelection(),this._startLayerPoint=this._map.mouseEventToLayerPoint(e),this._box=i.DomUtil.create("div","leaflet-zoom-box",this._pane),i.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",i.DomEvent.on(document,"mousemove",this._onMouseMove,this).on(document,"mouseup",this._onMouseUp,this).preventDefault(e),void this._map.fire("boxzoomstart"))},_onMouseMove:function(e){var t=this._startLayerPoint,s=this._box,n=this._map.mouseEventToLayerPoint(e),o=n.subtract(t),a=new i.Point(Math.min(n.x,t.x),Math.min(n.y,t.y));i.DomUtil.setPosition(s,a),s.style.width=Math.abs(o.x)-4+"px",s.style.height=Math.abs(o.y)-4+"px"},_onMouseUp:function(e){this._pane.removeChild(this._box),this._container.style.cursor="",i.DomUtil.enableTextSelection(),i.DomEvent.off(document,"mousemove",this._onMouseMove).off(document,"mouseup",this._onMouseUp);var t=this._map,s=t.mouseEventToLayerPoint(e),n=new i.LatLngBounds(t.layerPointToLatLng(this._startLayerPoint),t.layerPointToLatLng(s));t.fitBounds(n),t.fire("boxzoomend",{boxZoomBounds:n})}}),i.Map.addInitHook("addHandler","boxZoom",i.Map.BoxZoom),i.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),i.Map.Keyboard=i.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61],zoomOut:[189,109]},initialize:function(e){this._map=e,this._setPanOffset(e.options.keyboardPanOffset),this._setZoomOffset(e.options.keyboardZoomOffset)},addHooks:function(){var e=this._map._container;-1===e.tabIndex&&(e.tabIndex="0"),i.DomEvent.addListener(e,"focus",this._onFocus,this).addListener(e,"blur",this._onBlur,this).addListener(e,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var e=this._map._container;i.DomEvent.removeListener(e,"focus",this._onFocus,this).removeListener(e,"blur",this._onBlur,this).removeListener(e,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){this._focused||this._map._container.focus()},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(e){var t,i,s=this._panKeys={},n=this.keyCodes;for(t=0,i=n.left.length;i>t;t++)s[n.left[t]]=[-1*e,0];for(t=0,i=n.right.length;i>t;t++)s[n.right[t]]=[e,0];for(t=0,i=n.down.length;i>t;t++)s[n.down[t]]=[0,e];for(t=0,i=n.up.length;i>t;t++)s[n.up[t]]=[0,-1*e]},_setZoomOffset:function(e){var t,i,s=this._zoomKeys={},n=this.keyCodes;for(t=0,i=n.zoomIn.length;i>t;t++)s[n.zoomIn[t]]=e;for(t=0,i=n.zoomOut.length;i>t;t++)s[n.zoomOut[t]]=-e},_addHooks:function(){i.DomEvent.addListener(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){i.DomEvent.removeListener(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){var t=e.keyCode;if(this._panKeys.hasOwnProperty(t))this._map.panBy(this._panKeys[t]);else{if(!this._zoomKeys.hasOwnProperty(t))return;this._map.setZoom(this._map.getZoom()+this._zoomKeys[t])}i.DomEvent.stop(e)}}),i.Map.addInitHook("addHandler","keyboard",i.Map.Keyboard),i.Handler.MarkerDrag=i.Handler.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new i.Draggable(e,e).on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this)),this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(e){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(e){var t=i.DomUtil.getPosition(this._marker._icon);this._marker._shadow&&i.DomUtil.setPosition(this._marker._shadow,t),this._marker._latlng=this._marker._map.layerPointToLatLng(t),this._marker.fire("move").fire("drag")},_onDragEnd:function(){this._marker.fire("moveend").fire("dragend")}}),i.Handler.PolyEdit=i.Handler.extend({options:{icon:new i.DivIcon({iconSize:new i.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(e,t){this._poly=e,i.Util.setOptions(this,t)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new i.LayerGroup),this._markers=[];var e,t,s,n,o=this._poly._latlngs;for(e=0,s=o.length;s>e;e++)n=this._createMarker(o[e],e),n.on("click",this._onMarkerClick,this),this._markers.push(n);var a,r;for(e=0,t=s-1;s>e;t=e++)(0!==e||i.Polygon&&this._poly instanceof i.Polygon)&&(a=this._markers[t],r=this._markers[e],this._createMiddleMarker(a,r),this._updatePrevNext(a,r))},_createMarker:function(e,t){var s=new i.Marker(e,{draggable:!0,icon:this.options.icon});return s._origLatLng=e,s._index=t,s.on("drag",this._onMarkerDrag,this),s.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(s),s},_fireEdit:function(){this._poly.fire("edit")},_onMarkerDrag:function(e){var t=e.target;i.Util.extend(t._origLatLng,t._latlng),t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly.redraw()},_onMarkerClick:function(e){if(!(this._poly._latlngs.length<3)){var t=e.target,i=t._index;t._prev&&t._next&&(this._createMiddleMarker(t._prev,t._next),this._updatePrevNext(t._prev,t._next)),this._markerGroup.removeLayer(t),t._middleLeft&&this._markerGroup.removeLayer(t._middleLeft),t._middleRight&&this._markerGroup.removeLayer(t._middleRight),this._markers.splice(i,1),this._poly.spliceLatLngs(i,1),this._updateIndexes(i,-1),this._poly.fire("edit")}},_updateIndexes:function(e,t){this._markerGroup.eachLayer(function(i){i._index>e&&(i._index+=t)})},_createMiddleMarker:function(e,t){var i,s,n,o=this._getMiddleLatLng(e,t),a=this._createMarker(o);a.setOpacity(.6),e._middleRight=t._middleLeft=a,s=function(){var s=t._index;a._index=s,a.off("click",i).on("click",this._onMarkerClick,this),o.lat=a.getLatLng().lat,o.lng=a.getLatLng().lng,this._poly.spliceLatLngs(s,0,o),this._markers.splice(s,0,a),a.setOpacity(1),this._updateIndexes(s,1),t._index++,this._updatePrevNext(e,a),this._updatePrevNext(a,t)},n=function(){a.off("dragstart",s,this),a.off("dragend",n,this),this._createMiddleMarker(e,a),this._createMiddleMarker(a,t)},i=function(){s.call(this),n.call(this),this._poly.fire("edit")},a.on("click",i,this).on("dragstart",s,this).on("dragend",n,this),this._markerGroup.addLayer(a)},_updatePrevNext:function(e,t){e._next=t,t._prev=e},_getMiddleLatLng:function(e,t){var i=this._poly._map,s=i.latLngToLayerPoint(e.getLatLng()),n=i.latLngToLayerPoint(t.getLatLng());return i.layerPointToLatLng(s._add(n).divideBy(2))}}),i.Control=i.Class.extend({options:{position:"topright"},initialize:function(e){i.Util.setOptions(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},addTo:function(e){this._map=e;var t=this._container=this.onAdd(e),s=this.getPosition(),n=e._controlCorners[s];return i.DomUtil.addClass(t,"leaflet-control"),-1!==s.indexOf("bottom")?n.insertBefore(t,n.firstChild):n.appendChild(t),this},removeFrom:function(e){var t=this.getPosition(),i=e._controlCorners[t];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(e),this}}),i.control=function(e){return new i.Control(e)},i.Map.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.removeFrom(this),this},_initControlPos:function(){function e(e,o){var a=s+e+" "+s+o;t[e+o]=i.DomUtil.create("div",a,n)}var t=this._controlCorners={},s="leaflet-",n=this._controlContainer=i.DomUtil.create("div",s+"control-container",this._container);e("top","left"),e("top","right"),e("bottom","left"),e("bottom","right")}}),i.Control.Zoom=i.Control.extend({options:{position:"topleft"},onAdd:function(e){var t="leaflet-control-zoom",s=i.DomUtil.create("div",t);return this._createButton("Zoom in",t+"-in",s,e.zoomIn,e),this._createButton("Zoom out",t+"-out",s,e.zoomOut,e),s},_createButton:function(e,t,s,n,o){var a=i.DomUtil.create("a",t,s);return a.href="#",a.title=e,i.DomEvent.on(a,"click",i.DomEvent.stopPropagation).on(a,"click",i.DomEvent.preventDefault).on(a,"click",n,o).on(a,"dblclick",i.DomEvent.stopPropagation),a}}),i.Map.mergeOptions({zoomControl:!0}),i.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new i.Control.Zoom,this.addControl(this.zoomControl))}),i.control.zoom=function(e){return new i.Control.Zoom(e)},i.Control.Attribution=i.Control.extend({options:{position:"bottomright",prefix:'Powered by <a href="http://leaflet.cloudmade.com">Leaflet</a>'},initialize:function(e){i.Util.setOptions(this,e),this._attributions={}},onAdd:function(e){return this._container=i.DomUtil.create("div","leaflet-control-attribution"),i.DomEvent.disableClickPropagation(this._container),e.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(e){e.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):void 0},removeAttribution:function(e){return e?(this._attributions[e]--,this._update(),this):void 0},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions.hasOwnProperty(t)&&this._attributions[t]&&e.push(t);var i=[];this.options.prefix&&i.push(this.options.prefix),e.length&&i.push(e.join(", ")),this._container.innerHTML=i.join(" &#8212; ")}},_onLayerAdd:function(e){e.layer.getAttribution&&this.addAttribution(e.layer.getAttribution())},_onLayerRemove:function(e){e.layer.getAttribution&&this.removeAttribution(e.layer.getAttribution())}}),i.Map.mergeOptions({attributionControl:!0}),i.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new i.Control.Attribution).addTo(this))}),i.control.attribution=function(e){return new i.Control.Attribution(e)},i.Control.Scale=i.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(e){this._map=e;var t="leaflet-control-scale",s=i.DomUtil.create("div",t),n=this.options;return this._addScales(n,t,s),e.on(n.updateWhenIdle?"moveend":"move",this._update,this),this._update(),s},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,s){e.metric&&(this._mScale=i.DomUtil.create("div",t+"-line",s)),e.imperial&&(this._iScale=i.DomUtil.create("div",t+"-line",s))},_update:function(){var e=this._map.getBounds(),t=e.getCenter().lat,i=6378137*Math.PI*Math.cos(t*Math.PI/180),s=i*(e.getNorthEast().lng-e.getSouthWest().lng)/180,n=this._map.getSize(),o=this.options,a=0;n.x>0&&(a=s*(o.maxWidth/n.x)),this._updateScales(o,a)},_updateScales:function(e,t){e.metric&&t&&this._updateMetric(t),e.imperial&&t&&this._updateImperial(t)},_updateMetric:function(e){var t=this._getRoundNum(e);this._mScale.style.width=this._getScaleWidth(t/e)+"px",this._mScale.innerHTML=1e3>t?t+" m":t/1e3+" km"},_updateImperial:function(e){var t,i,s,n=3.2808399*e,o=this._iScale;n>5280?(t=n/5280,i=this._getRoundNum(t),o.style.width=this._getScaleWidth(i/t)+"px",o.innerHTML=i+" mi"):(s=this._getRoundNum(n),o.style.width=this._getScaleWidth(s/n)+"px",o.innerHTML=s+" ft")},_getScaleWidth:function(e){return Math.round(this.options.maxWidth*e)-10},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),i=e/t;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,t*i}}),i.control.scale=function(e){return new i.Control.Scale(e)},i.Control.Layers=i.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(e,t,s){i.Util.setOptions(this,s),this._layers={},this._lastZIndex=0;for(var n in e)e.hasOwnProperty(n)&&this._addLayer(e[n],n);for(n in t)t.hasOwnProperty(n)&&this._addLayer(t[n],n,!0)},onAdd:function(e){return this._initLayout(),this._update(),this._container},addBaseLayer:function(e,t){return this._addLayer(e,t),this._update(),this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._update(),this},removeLayer:function(e){var t=i.Util.stamp(e);return delete this._layers[t],this._update(),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=i.DomUtil.create("div",e);i.Browser.touch?i.DomEvent.on(t,"click",i.DomEvent.stopPropagation):i.DomEvent.disableClickPropagation(t);var s=this._form=i.DomUtil.create("form",e+"-list");if(this.options.collapsed){i.DomEvent.on(t,"mouseover",this._expand,this).on(t,"mouseout",this._collapse,this);var n=this._layersLink=i.DomUtil.create("a",e+"-toggle",t);n.href="#",n.title="Layers",i.Browser.touch?i.DomEvent.on(n,"click",i.DomEvent.stopPropagation).on(n,"click",i.DomEvent.preventDefault).on(n,"click",this._expand,this):i.DomEvent.on(n,"focus",this._expand,this),this._map.on("movestart",this._collapse,this)}else this._expand();this._baseLayersList=i.DomUtil.create("div",e+"-base",s),this._separator=i.DomUtil.create("div",e+"-separator",s),this._overlaysList=i.DomUtil.create("div",e+"-overlays",s),t.appendChild(s)},_addLayer:function(e,t,s){var n=i.Util.stamp(e);this._layers[n]={layer:e,name:t,overlay:s},this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var e=!1,t=!1;for(var i in this._layers)if(this._layers.hasOwnProperty(i)){var s=this._layers[i];this._addItem(s),t=t||s.overlay,e=e||!s.overlay}this._separator.style.display=t&&e?"":"none"}},_createRadioElement:function(e,t){var i='<input type="radio" name="'+e+'"';t&&(i+=' checked="checked"'),i+="/>";var s=document.createElement("div");return s.innerHTML=i,s.firstChild},_addItem:function(e){var t,s=document.createElement("label"),n=this._map.hasLayer(e.layer);e.overlay?(t=document.createElement("input"),t.type="checkbox",t.defaultChecked=n):t=this._createRadioElement("leaflet-base-layers",n),t.layerId=i.Util.stamp(e.layer),i.DomEvent.on(t,"click",this._onInputClick,this);var o=document.createTextNode(" "+e.name);s.appendChild(t),s.appendChild(o);var a=e.overlay?this._overlaysList:this._baseLayersList;a.appendChild(s)},_onInputClick:function(){var e,t,i,s=this._form.getElementsByTagName("input"),n=s.length;for(e=0;n>e;e++)t=s[e],i=this._layers[t.layerId],t.checked?this._map.addLayer(i.layer,!i.overlay):this._map.removeLayer(i.layer)},_expand:function(){i.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),i.control.layers=function(e,t,s){return new i.Control.Layers(e,t,s)},i.Transition=i.Class.extend({includes:i.Mixin.Events,statics:{CUSTOM_PROPS_SETTERS:{position:i.DomUtil.setPosition},implemented:function(){return i.Transition.NATIVE||i.Transition.TIMER}},options:{easing:"ease",duration:.5},_setProperty:function(e,t){var s=i.Transition.CUSTOM_PROPS_SETTERS;e in s?s[e](this._el,t):this._el.style[e]=t}}),i.Transition=i.Transition.extend({statics:function(){var e=i.DomUtil.TRANSITION,t="webkitTransition"===e||"OTransition"===e?e+"End":"transitionend";return{NATIVE:!!e,TRANSITION:e,PROPERTY:e+"Property",DURATION:e+"Duration",EASING:e+"TimingFunction",END:t,CUSTOM_PROPS_PROPERTIES:{position:i.Browser.any3d?i.DomUtil.TRANSFORM:"top, left"}}}(),options:{fakeStepInterval:100},initialize:function(e,t){this._el=e,i.Util.setOptions(this,t),i.DomEvent.on(e,i.Transition.END,this._onTransitionEnd,this),this._onFakeStep=i.Util.bind(this._onFakeStep,this)},run:function(e){var t,s=[],n=i.Transition.CUSTOM_PROPS_PROPERTIES;for(t in e)e.hasOwnProperty(t)&&(t=n[t]?n[t]:t,t=this._dasherize(t),s.push(t));this._el.style[i.Transition.DURATION]=this.options.duration+"s",this._el.style[i.Transition.EASING]=this.options.easing,this._el.style[i.Transition.PROPERTY]="all";for(t in e)e.hasOwnProperty(t)&&this._setProperty(t,e[t]);i.Util.falseFn(this._el.offsetWidth),this._inProgress=!0,i.Browser.mobileWebkit&&(this.backupEventFire=setTimeout(i.Util.bind(this._onBackupFireEnd,this),1.2*this.options.duration*1e3)),i.Transition.NATIVE?(clearInterval(this._timer),this._timer=setInterval(this._onFakeStep,this.options.fakeStepInterval)):this._onTransitionEnd()},_dasherize:function(){function e(e){return"-"+e.toLowerCase()}var t=/([A-Z])/g;return function(i){return i.replace(t,e)}}(),_onFakeStep:function(){this.fire("step")},_onTransitionEnd:function(e){this._inProgress&&(this._inProgress=!1,clearInterval(this._timer),this._el.style[i.Transition.TRANSITION]="",clearTimeout(this.backupEventFire),delete this.backupEventFire,this.fire("step"),e&&e.type&&this.fire("end"))},_onBackupFireEnd:function(){var e=document.createEvent("Event");e.initEvent(i.Transition.END,!0,!1),this._el.dispatchEvent(e)}}),i.Transition=i.Transition.NATIVE?i.Transition:i.Transition.extend({statics:{getTime:Date.now||function(){return+new Date},TIMER:!0,EASINGS:{linear:function(e){return e},"ease-out":function(e){return e*(2-e)}},CUSTOM_PROPS_GETTERS:{position:i.DomUtil.getPosition},UNIT_RE:/^[\d\.]+(\D*)$/},options:{fps:50},initialize:function(e,t){this._el=e,i.Util.extend(this.options,t),this._easing=i.Transition.EASINGS[this.options.easing]||i.Transition.EASINGS["ease-out"],this._step=i.Util.bind(this._step,this),this._interval=Math.round(1e3/this.options.fps)},run:function(e){this._props={};var t=i.Transition.CUSTOM_PROPS_GETTERS,s=i.Transition.UNIT_RE;this.fire("start");for(var n in e)if(e.hasOwnProperty(n)){var o={};if(n in t)o.from=t[n](this._el);else{var a=this._el.style[n].match(s);o.from=parseFloat(a[0]),o.unit=a[1]}o.to=e[n],this._props[n]=o}clearInterval(this._timer),this._timer=setInterval(this._step,this._interval),this._startTime=i.Transition.getTime()},_step:function(){var e=i.Transition.getTime(),t=e-this._startTime,s=1e3*this.options.duration;s>t?this._runFrame(this._easing(t/s)):(this._runFrame(1),this._complete())},_runFrame:function(e){var t,s,n,o=i.Transition.CUSTOM_PROPS_SETTERS;for(t in this._props)this._props.hasOwnProperty(t)&&(s=this._props[t],t in o?(n=s.to.subtract(s.from).multiplyBy(e).add(s.from),o[t](this._el,n)):this._el.style[t]=(s.to-s.from)*e+s.from+s.unit);this.fire("step")},_complete:function(){clearInterval(this._timer),this.fire("end")}}),i.Map.include(i.Transition&&i.Transition.implemented()?{setView:function(e,t,i){t=this._limitZoom(t);var s=this._zoom!==t;if(this._loaded&&!i&&this._layers){var n=s?this._zoomToIfClose&&this._zoomToIfClose(e,t):this._panByIfClose(e);if(n)return clearTimeout(this._sizeTimer),this}return this._resetView(e,t),this},panBy:function(e,t){return e=i.point(e),e.x||e.y?(this._panTransition||(this._panTransition=new i.Transition(this._mapPane),this._panTransition.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),i.Util.setOptions(this._panTransition,i.Util.extend({duration:.25},t)),this.fire("movestart"),i.DomUtil.addClass(this._mapPane,"leaflet-pan-anim"),this._panTransition.run({position:i.DomUtil.getPosition(this._mapPane).subtract(e)}),this):this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){i.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_panByIfClose:function(e){var t=this._getCenterOffset(e)._floor();return this._offsetIsWithinView(t)?(this.panBy(t),!0):!1},_offsetIsWithinView:function(e,t){var i=t||1,s=this.getSize();return Math.abs(e.x)<=s.x*i&&Math.abs(e.y)<=s.y*i}}:{}),i.Map.mergeOptions({zoomAnimation:i.DomUtil.TRANSITION&&!i.Browser.android23&&!i.Browser.mobileOpera}),i.DomUtil.TRANSITION&&i.Map.addInitHook(function(){i.DomEvent.on(this._mapPane,i.Transition.END,this._catchTransitionEnd,this)}),i.Map.include(i.DomUtil.TRANSITION?{_zoomToIfClose:function(e,t){if(this._animatingZoom)return!0;if(!this.options.zoomAnimation)return!1;var s=this.getZoomScale(t),n=this._getCenterOffset(e).divideBy(1-1/s);if(!this._offsetIsWithinView(n,1))return!1;i.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this.fire("movestart").fire("zoomstart"),this.fire("zoomanim",{center:e,zoom:t});var o=this._getCenterLayerPoint().add(n);return this._prepareTileBg(),this._runAnimation(e,t,s,o),!0},_catchTransitionEnd:function(e){this._animatingZoom&&this._onZoomTransitionEnd()},_runAnimation:function(t,s,n,o,a){this._animateToCenter=t,this._animateToZoom=s,this._animatingZoom=!0;var r=i.DomUtil.TRANSFORM,l=this._tileBg;clearTimeout(this._clearTileBgTimer),(i.Browser.gecko||e.opera)&&(l.style[r]+=" translate(0,0)"),i.Util.falseFn(l.offsetWidth);var h=i.DomUtil.getScaleString(n,o),d=l.style[r];l.style[r]=a?d+" "+h:h+" "+d},_prepareTileBg:function(){
var e=this._tilePane,t=this._tileBg;if(t&&this._getLoadedTilesPercentage(t)>.5&&this._getLoadedTilesPercentage(e)<.5)return e.style.visibility="hidden",e.empty=!0,void this._stopLoadingImages(e);t||(t=this._tileBg=this._createPane("leaflet-tile-pane",this._mapPane),t.style.zIndex=1),t.style[i.DomUtil.TRANSFORM]="",t.style.visibility="hidden",t.empty=!0,e.empty=!1,this._tilePane=this._panes.tilePane=t;var s=this._tileBg=e;i.DomUtil.addClass(s,"leaflet-zoom-animated"),this._stopLoadingImages(s)},_getLoadedTilesPercentage:function(e){var t,i,s=e.getElementsByTagName("img"),n=0;for(t=0,i=s.length;i>t;t++)s[t].complete&&n++;return n/i},_stopLoadingImages:function(e){var t,s,n,o=Array.prototype.slice.call(e.getElementsByTagName("img"));for(t=0,s=o.length;s>t;t++)n=o[t],n.complete||(n.onload=i.Util.falseFn,n.onerror=i.Util.falseFn,n.src=i.Util.emptyImageUrl,n.parentNode.removeChild(n))},_onZoomTransitionEnd:function(){this._restoreTileFront(),i.Util.falseFn(this._tileBg.offsetWidth),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),i.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1},_restoreTileFront:function(){this._tilePane.innerHTML="",this._tilePane.style.visibility="",this._tilePane.style.zIndex=2,this._tileBg.style.zIndex=1},_clearTileBg:function(){this._animatingZoom||this.touchZoom._zooming||(this._tileBg.innerHTML="")}}:{}),i.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(e){if(e=this._locationOptions=i.Util.extend(this._defaultLocateOptions,e),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=i.Util.bind(this._handleGeolocationResponse,this),s=i.Util.bind(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,s,e):navigator.geolocation.getCurrentPosition(t,s,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this},_handleGeolocationError:function(e){var t=e.code,i=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locationOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(e){var t=180*e.coords.accuracy/4e7,s=2*t,n=e.coords.latitude,o=e.coords.longitude,a=new i.LatLng(n,o),r=new i.LatLng(n-t,o-s),l=new i.LatLng(n+t,o+s),h=new i.LatLngBounds(r,l),d=this._locationOptions;if(d.setView){var c=Math.min(this.getBoundsZoom(h),d.maxZoom);this.setView(a,c)}this.fire("locationfound",{latlng:a,bounds:h,accuracy:e.coords.accuracy})}})}(this),define("leaflet",function(){}),define("modules/map/map",["jquery","underscore","state","baseview","leaflet"],function(e,t,i,s){"use strict";var n=s.extend({initialize:function(i){i=e.extend(!0,{latitude:0,longitude:0,currentLocationMarker:!0,addMapLabel:!1,mapLabelClass:null,defaultZoom:null,mapUrl:null,mapOptions:{trackResize:!1,scrollWheelZoom:!1,zoomControl:!1,attributionControl:!1}},i),s.prototype.initialize.call(this,i),t.bindAll(this,"_onGetMapTilesSuccess"),this.createMap(i.latitude,i.longitude)},createMap:function(e,t){var i,s=this.$el.data()||{},n=s.attrMapurl||this.options.mapUrl,o=parseFloat(s.latitude)||e,a=parseFloat(s.longitude)||t;n&&(i=parseInt(s.attrZoom,10)||this.options.defaultZoom,"L"===s.attrSize&&(this.options.mapOptions.zoomControl=!0),this.map=this.buildMap(),this.setLocation(o,a,i),this.getMapTiles(n))},buildMap:function(){return this.$mapEl=e('<div class="standard-app-map"></div>'),this.$el.html(this.$mapEl),this.options.addMapLabel&&(this.$mapLabel=this.buildMapLabel(),this.$el.append(this.$mapLabel)),new L.Map(this.$mapEl[0],this.options.mapOptions)},buildMapLabel:function(){var t=e('<span class="standard-app-map-location-label">');return this.options.mapLabelClass&&t.addClass(this.options.mapLabelClass),t},setCurrentLocationMarker:function(e,t){if(this.options.currentLocationMarker){var i=new L.LatLng(e,t);if(this.currentLocationMarker)this.currentLocationMarker.setLatLng(i);else{var s=window.site_static_url,n=L.Icon.extend({options:{iconUrl:s+"/images/modules/maps/marker.png",shadowUrl:s+"/images/modules/maps/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[11,41],shadowAnchor:[11,41]}}),o=new n;this.currentLocationMarker=new L.Marker(i,{icon:o,zIndexOffset:1e3}),this.map.addLayer(this.currentLocationMarker)}}},removeCurrentLocationMarker:function(){this.currentLocationMarker&&(this.map.removeLayer(this.currentLocationMarker),this.currentLocationMarker=null)},setLocation:function(e,t,i){var s=new L.LatLng(e,t);i=i||this.map.getZoom(),this.map.setView(s,i,!0),this.setCurrentLocationMarker(e,t)},getMapTiles:function(e){i.fetchData(e,{dataType:"jsonp"}).done(this._onGetMapTilesSuccess)},_onGetMapTilesSuccess:function(e){var t=L.TileLayer.extend({initialize:function(e){e=e||{},e.minZoom=e.minzoom||0,e.maxZoom=e.maxzoom||22,L.TileLayer.prototype.initialize.call(this,e.tiles[0],e)}});this.tiles=new t(e),this.map.addLayer(this.tiles)},setMapLabel:function(e){this.$mapLabel&&this.$mapLabel.text(e)},destroy:function(e){this.tiles&&(this.map.removeLayer(this.tiles),this.tiles=null),this.$mapLabel&&this.$mapLabel.remove(),this.$mapEl&&this.$mapEl.remove(),this.map=null,s.prototype.destroy.call(this,e)}});return n}),define("modules/fronts/headline-list-blog",["jquery","underscore","backbone","baseview","state","pubsub","utils"],function(e,t,i,s,n,o,a){"use strict";var r=s.extend({events:{"click .button-add-content":"showMore"},initialize:function(e){this.$button=this.$(".button-add-content"),this.$(".headline-page.active").hasClass("placeholder")&&(this.load(),this.$(".headline-page").length<2&&this.$button.addClass("inactive").text("No More News"))},showMore:function(t){if(e(t.target).hasClass("inactive"))return!1;this.$button.addClass("loading").text(this.$button.attr("data-loading"));var i=this.$(".headline-page.active:last").next(),s=i.attr("data-itemnum"),n=i.attr("data-items-per-page"),r=Math.round(s/n);this.load(),o.trigger("uotrack",a.getSectionPath(window.location.pathname)+"morestories"+r),this.transitionMore(i),t.preventDefault()},transitionMore:function(t){Modernizr.csstransitions?t.removeClass("inactive").addClass("active"):t.animate({"max-height":"5000px"},200,function(){e(this).removeClass("inactive").addClass("active").css("max-height","")}),this.$(".headline-page.inactive").length<=0&&this.$button.addClass("inactive").text("No More News"),this.load(),this.$button.removeClass("loading").text(this.$button.attr("data-default")),o.trigger("showmore:headlines")},load:function(){var e=this.$(".headline-page.active");a.lazyLoadImage(e.find("img"),"data-src",!1),e.removeClass("placeholder")}});return r}),define("modules/book-reviews/books-three-up",["jquery","underscore","baseview","state","managers/routemanager","form/base-form","directAdPosition"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({events:{"submit #ListFilter":"submitBooklistSearchForm"},initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"booksThreeUpAdReady"),this.$searchForm=this.$("#ListFilter"),this.$searchTypes=this.$('input[name="search_type"]'),this.$searchField=this.$("#books-list-search"),this.searchBase=this.$searchForm.attr("action"),this.booklistBaseUrl="/life/books/best-selling/",this.subviews.baseform=new o({el:this.$("#ListFilter")})},renderCardInfo:function(e){if(this.booksThreeUpAd=this.$(".books-three-up-ad-module"),this.booksThreeUpAd.length)if(e.belowHeroAd){var t={el:this.booksThreeUpAd.find(".books-three-up-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"below_hero",onAdReady:this.booksThreeUpAdReady};this.subviews.booksThreeUpAd=new a(t)}else this.booksThreeUpAd.hide()},booksThreeUpAdReady:function(){this.$el.addClass("has-poster-ad"),this.subviews.booksThreeUpAd.playAd()},submitBooklistSearchForm:function(e){e.preventDefault();var t=this.$(":checked",this.$searchTypes).val(),i=this.$searchField.val(),s=""!==i?this.searchBase+t+"/"+encodeURIComponent(i)+"/":this.booklistBaseUrl;n.goTo(s)}});return r}),define("modules/twitter",["jquery","underscore","state","baseview","modules/scroller/sidebar-scroll"],function(e,t,i,s,n){"use strict";var o=s.extend({initialize:function(t){t=e.extend({layoutType:null},t),this.$twitterEl=this.$(".twm-wrapper"),this.isFixed=this.$el.closest(".sidebar-fixed-content").length,s.prototype.initialize.call(this,t)},renderCardInfo:function(e){"sidebar"===this.options.layoutType&&e.sidebarOpen&&this.addScrollbar()},openSideBar:function(){this.renderCardInfo({sidebarOpen:!0})},destroy:function(e){e&&this.$twitterEl.empty(),s.prototype.destroy.call(this,!1)},onSidebarScrollableHeightChange:function(i,s){if("sidebar"===this.options.layoutType){var n=t.reduce(this.$el.siblings(".card-sidebar"),function(t,i){return t+e(i).outerHeight()},0);this.$el.css("height",(this.isFixed?i:s)-n),this.refreshScrollbar()}},refreshScrollbar:function(){this.subviews&&this.subviews.scrollbar&&this.subviews.scrollbar.refresh(),"sidebar"!==this.options.layoutType||this.isFixed||i.getActiveApp().triggerEvent("refreshSidebarScroll")},addScrollbar:function(){this.subviews.scrollbar=new n({el:this.$(".twitter-sidebar-content"),color:"light",lockPageScroll:!0,fadeout:!0})}});return o}),define("modules/car-search",["jquery","underscore","baseview","state","form/base-form","ui/button-toggle"],function(e,t,i,s,n,o){"use strict";var a=i.extend({events:{"submit .cars-form-wrap":"onFormSubmit","click .cars-form-radio":"onNewUsedToggleSelect"},initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"onNewUsedToggleSelect","onMakeDropdownSelect","onModelDropdownSelect"),this.form=this.$(".cars-form-wrap"),this.baseFormUrl=this.form.attr("action"),this.form.attr("action",this._buildFormUrl(this.baseFormUrl)),this.subviews.carSearchForm=new n({el:this.form,formOptions:[{el:this.$(".cars-make-dropdown"),onSelect:this.onMakeDropdownSelect},{el:this.$(".cars-model-dropdown"),onSelect:this.onModelDropdownSelect}]})},onNewUsedToggleSelect:function(i){var n=e(i.currentTarget).data("value"),o="/services/cars/dropdown/"+n+"/all";s.fetchData(o).done(t.bind(function(t){this.parseDropdown("formItem2",e.parseHTML(t));var i=this.getDropdownResetHtml("Model");this.parseDropdown("formItem3",i)},this)),this.setNewUsedHiddenValues(n),this.form.attr("action",this._buildFormUrl(this.baseFormUrl))},_buildFormUrl:function(e){return e+"for-sale/searchresults.action"},setNewUsedHiddenValues:function(e){"used"===e?(this.$("input:hidden[name='stkTypId']").val("28881"),this.$("input:hidden[name='tracktype']").val("usedcc")):(this.$("input:hidden[name='stkTypId']").val("28880"),this.$("input:hidden[name='tracktype']").val("newcc"))},getDropdownResetHtml:function(e){return'<option class="uotrack" value="All" selected="selected">'+e+"</option>"},onMakeDropdownSelect:function(e,i){var n,o,a=this.$(".ui-radio-selected").data("value");n="All"===e?"All":i,this.currentMakeSelectValue=n,o="/services/cars/dropdown/"+a+"/"+t.escape(n.toLowerCase()),s.fetchData(o).done(t.bind(function(t){if("All"===e){var i=this.getDropdownResetHtml("Model");this.parseDropdown("formItem3",i)}else this.parseDropdown("formItem3",t)},this)),this.setMakeHiddenValues(e,i)},onModelDropdownSelect:function(e,t){this.setModelHiddenValues(e,t)},setMakeHiddenValues:function(e,t){this.$("input:hidden[name='AmbMkId']").val(e),this.$("input:hidden[name='AmbMkNm']").val(t),this.$("input:hidden[name='mkId']").val(e)},setModelHiddenValues:function(e,t){this.$("input:hidden[name='AmbMdId']").val(e),this.$("input:hidden[name='AmbMdNm']").val(t),this.$("input:hidden[name='mdId']").val(e)},parseDropdown:function(e,t){this.subviews.carSearchForm.subviews[e].refresh(t)},onFormSubmit:function(e){var t=this.$(".cars-form-input-zip"),i=/^\d{5}(?:[-\s]\d{4})?$/,s=this.$("#cars-form-make-select option:selected").val(),n=this.$("#cars-form-model-select option:selected").val();i.test(t.val())?t.removeClass("ui-form-field-error"):(e.preventDefault(),t.addClass("ui-form-field-error")),"All"===s&&(this.$("#cars-form-make-select option:selected").removeAttr("value"),this.setMakeHiddenValues("","")),"All"===n&&(this.$("#cars-form-model-select option:selected").removeAttr("value"),this.setModelHiddenValues("",""))},destroy:function(e){this.form.attr("action",this.baseFormUrl),i.prototype.destroy.call(this,e)}});return a}),define("modules/money/market-symbol-search",["jquery","underscore","baseview","state","utils","pubsub","form/autocomplete","directAdPosition"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({events:{submit:"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"onStockSelect"),this._initAd(),this.$lookupInput=this.$(".money-markets-stock-lookup-input"),this.subviews.autocomplete=new a({el:this.$lookupInput,resultDisplayTemplate:"<%= Symbol %> - <%= Name %>",resultValueTemplate:"<%= Symbol %>",onSelect:this.onStockSelect})},_initAd:function(){var e=this.$(".mss-quote-ad");e.length&&(this.subviews.ad=new r({el:e,adSizes:[88,31],adPlacement:"sponsor_logo",adType:"sponsor_logo",pageInfo:s.getActivePageInfo()}))},onStockSelect:function(e,t){var i=this.parseStockPath(t.SymbolType);this.setStockPath(i),this.$el.is("form")?this.$el.submit():this.$("form").submit()},setStockPath:function(e){this.$$(".money-markets-stock-lookup-path-input").val(e),this.triggerABTestingEvent()},getStockPath:function(){return this.$$(".money-markets-stock-lookup-path-input").val()},parseStockPath:function(e){var t="stocks";if(e)switch(e){case"C":t="stocks";break;case"F":t="mutual-funds";break;case"G":t="etfs"}return t},onFormSubmit:function(e){if(!this.getStockPath()&&(e.preventDefault(),this.$lookupInput.val())){var i=this.$lookupInput.val().toUpperCase();s.fetchData(this.$lookupInput.data("autocomplete-url")+i).done(t.bind(function(e){e&&e.length&&(t.each(e,function(e){e.Symbol===i&&(this.setStockPath(this.parseStockPath(e.SymbolType)),this.$lookupInput.val(i))},this),this.$el.submit())},this))}},triggerABTestingEvent:function(){var e=s.getActivePageInfo();if(e.ab_test_id){var t=e.ab_test_id+"|"+e.ab_test_variant||"control";o.trigger("abtesttrack",t)}},destroy:function(e){this.$$(".money-markets-stock-lookup-path-input").val(""),this.$lookupInput.blur(),i.prototype.destroy.call(this,e)}});return l}),define("modules/interactives/interactive-base",["jquery","underscore","baseview","utils","modules/interactives/interactive-ads","libs/flot/jquery.flot"],function(e,t,i,s,n){"use strict";var o=i.extend({events:{"plothover .chart-area":"lazyHover"},initialize:function(e){var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),i.prototype.initialize.call(this,e),this.initializeDom(),this.flotData=this.getFlotData(this.datasetItems),this.graph.length&&null!==this.flotData&&void 0!==this.flotData&&(t&&(this.subviews.interactiveAds=new n({el:this.$(".interactive-sponsor")})),this.redraw(),this.$chartHover.css("color",this.mainColor))},redraw:function(){e.plot(this.graph,this.flotData,this.getFlotOptions()),this.calculateBoundVal()},initializeDom:function(){this.chartData=JSON.parse(this.$(".chartData").html()||"{}"),this.datasetItems=s.getNested(this.chartData,"datasets","item")||[],this.chartColors=this.getChartColors(),this.$chartHover=this.$(".chart-hover"),this.$chartArea=this.$(".chart-area"),this.graph=this.$(".graph"),this.colorsArray=(this.$el.data("colors")||"").split("|"),this.colorsArray.length>=6?this.mainColor=this.colorsArray[2]:1==this.colorsArray.length&&(this.mainColor=this.colorsArray[0])},getChartColors:function(){return(this.$el.data("colors")||"rgb(100,100,100)").split("|")},numberWithCommas:function(e){return e.toString().replace(/\B(?=(?:\d{3})+(?!\d))/g,",")},_createTicks:function(e){return t.map(e.split("|"),function(e,t){return[t,e]})},calculateBoundVal:function(){this.hoverLeftBoundVal=this.hoverLeftBound(),this.hoverRightBoundVal=this.hoverRightBound(),this.hoverTopBoundVal=this.hoverTopBound(),this.hoverBottomBoundVal=this.hoverBottomBound()},hoverLeftBound:function(){return this.$el.width()/2},hoverRightBound:function(){return this.$el.width()/2},hoverTopBound:function(){return this.$el.height()/5},hoverBottomBound:function(){return this.$el.height()/5},getHoverPrefix:function(){return this.chartData.beforelabel||""},getHoverSuffix:function(){return this.chartData.afterlabel||""},_getHoverClass:function(e){return e.pageX>this.hoverRightBoundVal/2&&e.pageX<this.hoverLeftBoundVal/2?e.pageY<this.hoverTopBoundVal?"top":e.pageY>this.hoverBottomBoundVal?"bottom":void 0:e.pageX<this.hoverLeftBoundVal?"middleleft":e.pageX>this.hoverRightBoundVal?"middleright":""},_getHoverPosition:function(e,t){return t.pageX>this.hoverRightBoundVal/2&&t.pageX<this.hoverLeftBoundVal/2?t.pageY<this.hoverTopBoundVal?{top:e.pageY,left:e.pageX-this.$chartHover.outerWidth(!0)/2}:t.pageY>this.hoverBottomBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0),left:e.pageX-this.$chartHover.outerWidth(!0)/2}:void 0:t.pageX<this.hoverLeftBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0)/2,left:e.pageX}:t.pageX>this.hoverRightBoundVal?{top:e.pageY-this.$chartHover.outerHeight(!0)/2,left:e.pageX-this.$chartHover.outerWidth(!0)}:null},lazyHover:function(){this.lazyDebounce||(this.lazyDebounce=t.throttle(this._hover,20)),this.lazyDebounce.apply(this,arguments)},_hover:function(e,t,i){if(i&&t&&e&&i.series){var s={pageY:t.pageY-this.$el.offset().top,pageX:t.pageX-this.$el.offset().left},n={pageY:t.pageY-this.$chartArea.offset().top,pageX:t.pageX-this.$chartArea.offset().left},o=this._getHoverClass(s),a="pointer-"+o.replace("middle",""),r=""!==this._getHoverLabel(i)?"<h3>"+this._getHoverLabel(i)+"</h3>":"",l='<div class="'+a+'"></div>'+r+"<h4>"+this._getHoverBody(i)+"</h4>",h=this._getHoverPosition(n,s);this.$chartHover.show(),this.$chartHover.html(l),h&&o?this.$chartHover.css(h).attr("class",o+"-hover chart-hover"):this.$chartHover.hide()}else this.$chartHover.hide()},_getHoverBody:function(e){var t=s.addCommas(""+parseFloat(s.getNested(e,"series","percent")||0).toFixed(0));return t+"%"},_getHoverLabel:function(e){return e.series.label},getFlotOptions:function(){return{series:{},grid:{hoverable:!0,clickable:!0},legend:{show:!1}}},getFlotData:function(e){return t.map(e,function(e,t,i){var n=this.mainColor;return i.length>1&&(n=this.chartColors[t%this.chartColors.length]),{label:s.getNested(e,"label")||"",data:parseFloat(e.value),color:n}},this)},destroy:function(e,t){var s=(this.graph.data()||{}).plot;s&&s.shutdown&&s.shutdown(),i.prototype.destroy.call(this,e,t)}});return o}),function(e){function t(t){function n(e,t){t.series.pie.show&&(t.grid.show=!1,"auto"==t.series.pie.label.show&&(t.legend.show?t.series.pie.label.show=!1:t.series.pie.label.show=!0),"auto"==t.series.pie.radius&&(t.series.pie.label.show?t.series.pie.radius=.75:t.series.pie.radius=1),t.series.pie.tilt>1&&(t.series.pie.tilt=1),t.series.pie.tilt<0&&(t.series.pie.tilt=0),e.hooks.processDatapoints.push(r),e.hooks.drawOverlay.push(C),e.hooks.draw.push(c))}function o(e,t){var i=e.getOptions();i.series.pie.show&&i.grid.hoverable&&t.unbind("mousemove").mousemove(g),i.series.pie.show&&i.grid.clickable&&t.unbind("click").click(m)}function a(e){for(var t=0;t<e.length;++t){var i=parseFloat(e[t].data[0][1]);i&&(P+=i)}}function r(t,i,n,o){L||(L=!0,S=t.getCanvas(),k=e(S).parent(),s=t.getOptions(),t.setData(d(t.getData())))}function l(){E=k.children().filter(".legend").children().width(),T=Math.min(S.width,S.height/s.series.pie.tilt)/2,A=S.height/2+s.series.pie.offset.top,$=S.width/2,"auto"==s.series.pie.offset.left?s.legend.position.match("w")?$+=E/2:$-=E/2:$+=s.series.pie.offset.left,T>$?$=T:$>S.width-T&&($=S.width-T)}function h(e){for(var t=0;t<e.length;++t)"number"==typeof e[t].data?e[t].data=[[1,e[t].data]]:("undefined"==typeof e[t].data||"undefined"==typeof e[t].data[0])&&("undefined"!=typeof e[t].data&&"undefined"!=typeof e[t].data.label&&(e[t].label=e[t].data.label),e[t].data=[[1,0]]);return e}function d(e){e=h(e),a(e);for(var t=0,i=0,n=s.series.pie.combine.color,o=[],r=0;r<e.length;++r)e[r].data[0][1]=parseFloat(e[r].data[0][1]),e[r].data[0][1]||(e[r].data[0][1]=0),e[r].data[0][1]/P<=s.series.pie.combine.threshold?(t+=e[r].data[0][1],i++,n||(n=e[r].color)):o.push({data:[[1,e[r].data[0][1]]],color:e[r].color,label:e[r].label,angle:2*e[r].data[0][1]*Math.PI/P,percent:e[r].data[0][1]/P*100});return i>0&&o.push({data:[[1,t]],color:n,label:s.series.pie.combine.label,angle:2*t*Math.PI/P,percent:t/P*100}),o}function c(t,i){function n(e){ctx.save(),ctx.translate($,A),ctx.beginPath(),ctx.arc(0,0,e+4,90,2*Math.PI,!0),ctx.lineWidth=1,ctx.strokeStyle=N,ctx.stroke(),ctx.restore()}function o(){ctx.clearRect(0,0,S.width,S.height),k.children().filter(".pieLabel, .pieLabelBackground").remove()}function a(){var e=5,t=15,i=10,n=.02;if(s.series.pie.radius>1)var o=s.series.pie.radius;else var o=T*s.series.pie.radius;if(!(o>=S.width/2-e||o*s.series.pie.tilt>=S.height/2-t||i>=o)){ctx.save(),ctx.translate(e,t),ctx.globalAlpha=n,ctx.fillStyle="#000",ctx.translate($,A),ctx.scale(1,s.series.pie.tilt);for(var a=1;i>=a;a++)ctx.beginPath(),ctx.arc(0,0,o,0,2*Math.PI,!1),ctx.fill(),o-=a;ctx.restore()}}function r(){function t(e,t,i){0>=e||(i?ctx.fillStyle=t:(ctx.strokeStyle=t,ctx.lineJoin="miter"),ctx.beginPath(),Math.abs(e-2*Math.PI)>1e-9&&ctx.moveTo(0,0),ctx.arc(0,0,o,a,a+e,!1),ctx.closePath(),a+=e,i?ctx.fill():ctx.stroke())}function i(){function t(t,i,o){if(0!=t.data[0][1]){var a,r=s.legend.labelFormatter,l=s.series.pie.label.formatter;a=r?r(t.label,t):t.label,l&&(a=l(a,t));var h=(i+t.angle+i)/2,d=$+Math.round(Math.cos(h)*n),c=A+Math.round(Math.sin(h)*n)*s.series.pie.tilt,u='<span class="pieLabel" id="pieLabel'+o+'" style="position:absolute;top:'+c+"px;left:"+d+'px;">'+a+"</span>";k.append(u);var p=k.children("#pieLabel"+o),f=c-p.height()/2,g=d-p.width()/2;if(p.css("top",f),p.css("left",g),(0-f>0||0-g>0||S.height-(f+p.height())<0||S.width-(g+p.width())<0)&&(D=!0),0!=s.series.pie.label.background.opacity){var m=s.series.pie.label.background.color;null==m&&(m=t.color);var v="top:"+f+"px;left:"+g+"px;";e('<div class="pieLabelBackground" style="position:absolute;width:'+p.width()+"px;height:"+p.height()+"px;"+v+"background-color:"+m+';"> </div>').insertBefore(p).css("opacity",s.series.pie.label.background.opacity)}}}var i=startAngle;if(s.series.pie.label.radius>1)var n=s.series.pie.label.radius;else var n=T*s.series.pie.label.radius;for(var o=0;o<h.length;++o)h[o].percent>=100*s.series.pie.label.threshold&&t(h[o],i,o),i+=h[o].angle}if(startAngle=Math.PI*s.series.pie.startAngle,s.series.pie.radius>1)var o=s.series.pie.radius;else var o=T*s.series.pie.radius;ctx.save(),ctx.translate($,A),ctx.scale(1,s.series.pie.tilt),ctx.save();for(var a=startAngle,r=0;r<h.length;++r)h[r].startAngle=a,t(h[r].angle,h[r].color,!0);ctx.restore(),ctx.save(),ctx.lineWidth=s.series.pie.stroke.width,a=startAngle;for(var r=0;r<h.length;++r)t(h[r].angle,s.series.pie.stroke.color,!1);ctx.restore(),u(ctx),s.series.pie.label.show&&i(),ctx.restore(),n(o)}if(k){ctx=i,l();for(var h=t.getData(),d=0;D&&I>d;)D=!1,d>0&&(T*=M),d+=1,o(),s.series.pie.tilt<=.8&&a(),r();d>=I&&(o(),k.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>')),t.setSeries&&t.insertLegend&&(t.setSeries(h),t.insertLegend())}}function u(e){s.series.pie.innerRadius>0&&(e.save(),innerRadius=s.series.pie.innerRadius>1?s.series.pie.innerRadius:T*s.series.pie.innerRadius,e.globalCompositeOperation="destination-out",e.beginPath(),e.fillStyle=s.series.pie.stroke.color,e.arc(0,0,innerRadius,0,2*Math.PI,!1),e.fill(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.strokeStyle=s.series.pie.stroke.color,e.arc(0,0,innerRadius,0,2*Math.PI,!1),e.stroke(),e.closePath(),e.restore(),e.save(),e.beginPath(),e.arc(0,0,innerRadius/1.2,90,2*Math.PI,!1),e.lineWidth=1,e.strokeStyle=N,e.stroke(),e.restore())}function p(e,t){for(var i=!1,s=-1,n=e.length,o=n-1;++s<n;o=s)(e[s][1]<=t[1]&&t[1]<e[o][1]||e[o][1]<=t[1]&&t[1]<e[s][1])&&t[0]<(e[o][0]-e[s][0])*(t[1]-e[s][1])/(e[o][1]-e[s][1])+e[s][0]&&(i=!i);return i}function f(e,i){for(var s=t.getData(),n=t.getOptions(),o=n.series.pie.radius>1?n.series.pie.radius:T*n.series.pie.radius,a=0;a<s.length;++a){var r=s[a];if(r.pie.show){if(ctx.save(),ctx.beginPath(),ctx.moveTo(0,0),ctx.arc(0,0,o,r.startAngle,r.startAngle+r.angle,!1),ctx.closePath(),x=e-$,y=i-A,ctx.isPointInPath){if(ctx.isPointInPath(e-$,i-A))return ctx.restore(),{datapoint:[r.percent,r.data],dataIndex:0,series:r,seriesIndex:a}}else if(p1X=o*Math.cos(r.startAngle),p1Y=o*Math.sin(r.startAngle),p2X=o*Math.cos(r.startAngle+r.angle/4),p2Y=o*Math.sin(r.startAngle+r.angle/4),p3X=o*Math.cos(r.startAngle+r.angle/2),p3Y=o*Math.sin(r.startAngle+r.angle/2),p4X=o*Math.cos(r.startAngle+r.angle/1.5),p4Y=o*Math.sin(r.startAngle+r.angle/1.5),p5X=o*Math.cos(r.startAngle+r.angle),p5Y=o*Math.sin(r.startAngle+r.angle),arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]],arrPoint=[x,y],p(arrPoly,arrPoint))return ctx.restore(),{datapoint:[r.percent,r.data],dataIndex:0,series:r,seriesIndex:a};ctx.restore()}}return null}function g(e){v("plothover",e)}function m(e){v("plotclick",e)}function v(e,i){var n=t.offset(),o=parseInt(i.pageX-n.left),a=parseInt(i.pageY-n.top),r=f(o,a);if(s.grid.autoHighlight)for(var l=0;l<F.length;++l){var h=F[l];h.auto!=e||r&&h.series==r.series||w(h.series)}r&&b(r.series,e);var d={pageX:i.pageX,pageY:i.pageY};k.trigger(e,[d,r])}function b(e,i){"number"==typeof e&&(e=series[e]);var s=_(e);-1==s?(F.push({series:e,auto:i}),t.triggerRedrawOverlay()):i||(F[s].auto=!1)}function w(e){null==e&&(F=[],t.triggerRedrawOverlay()),"number"==typeof e&&(e=series[e]);var i=_(e);-1!=i&&(F.splice(i,1),t.triggerRedrawOverlay())}function _(e){for(var t=0;t<F.length;++t){var i=F[t];if(i.series==e)return t}return-1}function C(e,t){function s(e){e.angle<0||(t.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")",t.beginPath(),Math.abs(e.angle-2*Math.PI)>1e-9&&t.moveTo(0,0),t.arc(0,0,o,e.startAngle,e.startAngle+e.angle,!1),t.closePath(),t.fill())}var n=e.getOptions(),o=n.series.pie.radius>1?n.series.pie.radius:T*n.series.pie.radius;for(t.save(),t.translate($,A),t.scale(1,n.series.pie.tilt),i=0;i<F.length;++i)s(F[i].series);u(t),t.restore()}var S=null,k=null,T=null,$=null,A=null,P=0,D=!0,I=10,M=.95,E=0,L=!1,N="#ebebeb",F=[];t.hooks.processOptions.push(n),t.hooks.bindEvents.push(o)}var s={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(e,t){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+t.color+';">'+e+"<br/>"+Math.round(t.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}},pattern:null}};e.plot.plugins.push({init:t,options:s,name:"pie",version:"1.0"})}(jQuery),define("libs/flot/jquery.flot.usat.pie",function(){}),define("modules/interactives/pie-chart",["jquery","underscore","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.usat.pie"],function(e,t,i,s){"use strict";var n=s.extend({isDonut:function(){return"true"===this.chartData.donutPresent},_getHoverBody:function(e){return this.isDonut()?[this.getHoverPrefix(),i.addCommas(i.getNested(e,"datapoint",1,0,1)),this.getHoverSuffix()].join(" "):s.prototype._getHoverBody.apply(this,arguments)},getFlotOptions:function(){var e=s.prototype.getFlotOptions.apply(this,arguments);return e.series.pie={show:!0,stroke:{color:"#fff",width:2},innerRadius:0,radius:1},this.isDonut()&&(e.series.pie.innerRadius=.48),e},hoverLeftBound:function(){return this.isDonut()?this.graph.width()/3:this.graph.width()/2},hoverRightBound:function(){return this.isDonut()?this.graph.width()/3*2:this.graph.width()/2}});return n}),define("modules/sports/sports-nav",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({el:".sp-nav-wrap",events:{"mouseenter .sp-nav-item":"onHoverNavBarItem","mouseleave .sp-nav-item":"onHoverNavBarItem","mouseenter .sp-nav-item.more":"onHoverNavBarMore","mouseleave .sp-nav-item.more":"onHoverNavBarMore","mouseenter .sp-head-item.more":"onHoverHeadMore","mouseleave .sp-head-item.more":"onHoverHeadMore","mouseenter .sp-head, .sp-hover-team-front-picker":"onHeaderEnter","mouseleave .sp-head, .sp-hover-team-front-picker":"onHeaderLeave"},initialize:function(){this.$spHeads=this.$(".sp-heads"),this.$popupBox=e(".sp-details-box"),this.stayOpen=this.$spHeads.hasClass("stay-open"),this.slideSpeed=200,t.bindAll(this,"toggleNavBarMoreFlyout","toggleHeadMoreFlyout","toggleHead","switchHead"),i.prototype.initialize.apply(this,arguments)},onHoverNavBarItem:function(i){clearTimeout(this.navBarItemTimer),clearTimeout(this.navBarSwitchHeadTimer),this.navBarItem=e(i.currentTarget);var s=this.navBarItem.hasClass("more");s||(this.navBarSwitchHeadTimer=t.delay(this.switchHead,80,i));var n=s?!1:"mouseenter"===i.type;this.navBarItem.hasClass("external")&&(n=!1),this.navBarItemTimer=t.delay(this.toggleHead,100,void 0,n)},switchHead:function(e){"mouseout"!==e.type&&this.setActiveHead(this.navBarItem.data("ss"))},setActiveHead:function(e){this.$(".sp-head.active").removeClass("active"),this.$(".sp-head."+e).addClass("active")},onHoverNavBarMore:function(i){clearTimeout(this.navBarMoreTimer);var s=e(i.currentTarget);this.navBarMoreBtn=s.find(".more"),this.navBarMoreFlyout=s.find(".sp-nav-more-fly"),this.rightNow=e(".sidebar-button"),this.sidebar=e(".sidebar-sports"),this.navBarMoreTimer=t.delay(this.toggleNavBarMoreFlyout,100,void 0,"mouseenter"===i.type)},toggleNavBarMoreFlyout:function(t,i){return e.datepicker.dpDiv.css({display:"none"}),this.rightNow.toggleClass("disabled",i),this.sidebar.toggleClass("disabled",i),this.navBarMoreBtn.toggleClass("active",i),this.navBarMoreFlyout.toggleClass("active",i),!1},onHoverHeadMore:function(i){clearTimeout(this.headMoreTimer);var s=e(i.currentTarget);this.headMoreBtn=s.find(".more"),this.headMoreFlyout=s.find(".sp-head-more-fly"),this.allHeadMoreFlys=s.parent().find(".sp-head-more-fly"),this.headMoreTimer=t.delay(this.toggleHeadMoreFlyout,100,void 0,"mouseenter"===i.type)},toggleHeadMoreFlyout:function(t,i){e.datepicker.dpDiv.css({display:"none"}),this.allHeadMoreFlys.removeClass("active"),this.headMoreBtn.toggleClass("active",i),this.headMoreFlyout.toggleClass("active",i),i?this.sidebarHidden?e(".open-sidebar").hide():e(".sidebar-sports").css("z-index",15):this.sidebarHidden?e(".open-sidebar").show():e(".sidebar-sports").css("z-index","")},onCardWidthChange:function(e){this.sidebarHidden=!e.sidebarOpen},renderCardInfo:function(e){this.sidebarHidden=!e.sidebarOpen},openSideBar:function(){this.sidebarHidden="block"==e(".close-sidebar").css("display")},closeSideBar:function(){this.sidebarHidden="block"==e(".close-sidebar").css("display")},onHeaderEnter:function(t){0!==e(t.relatedTarget).parents().length&&clearTimeout(this.navBarItemTimer)},onHeaderLeave:function(e){var i=this.$popupBox.offset().top,s=this.$popupBox.offset().left,n=this.$popupBox.outerWidth(),o=this.$popupBox.outerHeight();(e.pageX<s||e.pageX>s+n||e.pageY<i||e.pageY>i+o)&&(this.navBarItemTimer=t.delay(this.toggleHead,100,void 0,!1))},toggleHead:function(t,i){this.stayOpen?i||this.setActiveHead(this.$(".sp-head.current").data("ss")):i?this.$spHeads.stop(!0).animate({height:90},this.slideSpeed,function(){e(this).addClass("temp-open")}):this.$spHeads.removeClass("temp-open").stop(!0).animate({height:0},this.slideSpeed)}});return s}),define("modules/videos/video-init",["jquery","baseview","modules/videos/brightcove-video","modules/videos/pluto/pluto-wrapper","modules/videos/uw/uw-wrapper"],function(e,t,i,s,n){var o=t.extend({initialize:function(e){t.prototype.initialize.call(this,e),this.$el.hasClass("js-uw-iframe-video")?this.subviews.videoview=new n({
el:this.$el}):this.$el.hasClass("js-ui-pluto-video")?this.subviews.videoview=new s({el:this.$el}):this.$el.hasClass("ui-video")&&(this.subviews.videoview=new i({el:this.$el}))}});return o}),define("modules/feed-stories/feed-stories",["jquery","underscore","baseview","utils","pubsub","state","managers/requestmanager","template-utils","fwinfo","libs/moment/moment.min","third_party_integrations/taboola/taboola-utils","modules/global/taboola"],function(e,t,i,s,n,o,a,r,l,h,d,c){"use strict";var u=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),t.bindAll(this,"loadDefaultModule","updateDom","renderClientTemplate","renderServerTemplate","getImageReqs","formatTaboolaAsset","formatSolrAsset","logAbTestImpression"),this.layoutType=e.layoutType||"STORYRIGHTRAIL",this._setOptions(e),l.setsessionvalue("feedStories",this.$el.attr("data-options-id")||"default"),this.loadModule()},_getDefaultOptions:function(){var e=o.getActivePageInfo(),t=s.getNested(e,"ssts")||"",i=t.split("/");return{displayName:"POPULAR STORIES",layout:"fullWidthLead",count:5,rawSsts:t,sstsArray:i,sstsDepth:1,ssts:i[0],exclude:s.getNested(e,"assetid"),placement:"feedStories",source:s.getNested(window.site_vars,"base_url"),useShortHeadlines:!0,showSource:!0}},_setOptions:function(t){return t=t||{},this.options=e.extend(!0,this._getDefaultOptions(),t),this.options.sstsArray.length=this.options.sstsDepth,this.options.ssts=this.options.sstsArray.join("/"),this.options},loadModule:function(){var i=this.options,s={};switch(i.provider){case"dynamic-video-playlist":s=t.pick(i,["count","ssts","layout","source","linkColor","timestamp","showRank","showSource","showShares","boldHeadlines","hideTextOnHover"]),a.fetchHtml("/videos/modules/dynamic-video-playlist/?"+e.param(s)).done(t.bind(function(e){this.renderServerTemplate(e,i)},this)).fail(this.loadDefaultModule);break;case"taboola":var n=new c({isWidgetPresent:!1});n.getRelated(void 0,void 0,i.assetType||"text",i.count,void 0,void 0,i.placement,!0).done(t.bind(function(e){var s=t.map(e.list,this.formatTaboolaAsset),n=t.filter(s,this.filterTaboolaAsset);this.renderClientTemplate(n,i)},this)).fail(this.loadDefaultModule);break;case"solr":s=t.pick(i,["metric","count","ssts","tags","days","assetType"]),s.count+=1,a.fetchData("/modules/feed-stories/json?"+e.param(s)).done(t.bind(function(e){var s=t.filter(e.assets,function(e){return e.id!==i.exclude}).slice(0,i.count),n=t.map(s,this.formatSolrAsset);this.renderClientTemplate(n,i)},this)).fail(this.loadDefaultModule);break;default:this.loadDefaultModule()}},renderClientTemplate:function(e,i){var s={assets:e,linkColor:i.linkColor,timestamp:i.timestamp,showRank:i.showRank,showSource:i.showSource,showShares:i.showShares,useShortHeadlines:i.useShortHeadlines,boldHeadlines:i.boldHeadlines,hideTextOnHover:i.hideTextOnHover},n=this.$(".tmpl-feed-stories-"+this.layoutType.toLowerCase()).html(),o=t.template(n,s),a=this.processHtmlString(o,e);this.updateDom(a,i.displayName)},renderServerTemplate:function(e,t){var i=this.processHtmlString(e);this.updateDom(i,t.displayName)},processHtmlString:function(i,s){var n,o=t.isString(i)?e.parseHTML(i):i;return e(o).find(".fsm-link").each(t.bind(function(i,o){s&&(n=t.first(s,"url",e(o).attr("href")),"taboola"===this.options.provider&&d.addLinkData(o,n.notifyClickUrl))},this)),o},updateDom:function(e,t,i){this.$el.append(e),t&&this.setModuleLabel(t),this.options.abTest&&this.logAbTestImpression(this.options.abTest,i)},setModuleLabel:function(e){this.$(".module-title").text(e)},logAbTestImpression:function(e,t){var i={};t&&(i.abTestFail=!0),i.abTestId=this.options.abTest.id+"",i.abTestVariant=this.options.abTest.userVariant.id,i.eventType="abTestImpression",i.inViewport=s.isElementInViewport(this.$el),n.trigger("analytics:event","pong",i)},getImageReqs:function(e,t,i){var s={};return"STORYRIGHTRAIL"===this.layoutType&&("fullWidth"===i||"fullWidthLead"===i&&0===t?(s.width="299",s.height="168",s.aspect="16_9",s.prefix="fw"):"clean"===i?(s.width="330",s.height="186",s.aspect="16_9",s.prefix="cln"):(s.width="84",s.height="84",s.aspect="1_1",s.prefix="thumb")),s},formatTaboolaAsset:function(e,t){var i=this.getImageReqs(e,t,this.options.layout),n=s.getNested(e,"thumbnail",0,"url");return n&&(n=decodeURIComponent(n.substring(n.indexOf("/http")+1))),{headline:e.name,url:e.id,image:r.getCroppedImage(n,i.width,i.height),layoutPrefix:i.prefix,pubTimeAgo:h(new Date(e.created)).fromNow(),pubDate:e.created,notifyClickUrl:e.url,source:this.getSourceFromUrl(e.id)}},filterTaboolaAsset:function(e){var t=e.image.toString()||"",i=e.url.toString()||"",s=new Date(e.pubDate)>Date.now();return i.match(/story|videos|picture-gallery/)&&!t.match(/applogos|images\/logos/)&&!s},formatSolrAsset:function(e,t){var i=this.getImageReqs(e,t,this.options.layout),n=s.getNested(e,"photo")||{},o=r.getCroppedImage(n.absoluteUrl,i.width,i.height,n.crops,i.aspect),a=s.getNested(e,"urls","longUrl");return{headline:e.headline,shortHeadline:e.shortHeadline,url:r.relativizeUrl(a),image:o,layoutPrefix:i.prefix,pubTimeAgo:h(new Date(e.datePublished)).fromNow(),pubDate:e.datePublished,source:this.getSourceFromUrl(a)}},loadDefaultModule:function(){var i=this._setOptions(),s={count:i.count+1,ssts:i.ssts};a.fetchData("/modules/feed-stories/json?"+e.param(s)).done(t.bind(function(e){var s=t.filter(e.assets,function(e){return e.id!==i.exclude}).slice(0,i.count),n=t.map(s,this.formatSolrAsset);this.renderClientTemplate(n,i)},this)).fail(this.onDefaultModuleFetchFail)},onDefaultModuleFetchFail:function(e){console.warn("Feed stories module error: default module failed",e)},getSourceFromUrl:function(e){if("/"===e.charAt(0))return this.options.source;var t=document.createElement("a");return t.setAttribute("href",e),t.hostname.replace(/^(localhost|www)\./i,"")}});return u}),define("modules/sports/sports-news",["jquery","underscore","utils","state","pubsub","baseview"],function(e,t,i,s,n,o){var a=o.extend({initialize:function(e){o.prototype.initialize.call(this,e),this.$newsBlock=this.$(".sp-news-wrap"),this.loadTaxonomyNews(this.$newsBlock.data("url"))},loadTaxonomyNews:function(e){var i=this;s.fetchHtml(e,{timeout:1e5}).done(t.bind(function(e){e&&e.length&&(i.$(".card-suspender-title").removeClass("hide"),i.$newsBlock.html(e))},this))},destroy:function(e){o.prototype.destroy.call(this,e)}});return a}),define("modules/sports/sports-video",["jquery","underscore","baseview","modules/global/brightcove-video"],function(e,t,i,s){"use strict";var n=s.extend({events:function(){var e=s.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .videoStillPlay":"swapImageForVideo","click .hero-3up-image-1":"swapImageForVideo","click .stagfront-hero-3up-text-1":"swapImageForVideo"})},initialize:function(e){this.$(".util-bar-primary-modules").addClass("util-bar-primary-modules-topic"),this.$(".util-bar-primary-modules-topic").removeClass("util-bar-primary-modules"),s.prototype.initialize.call(this,e)},swapImageForVideo:function(t){e(this.$(".parent-label.sports")[0]).css("display","none"),s.prototype.swapImageForVideo.call(this,t)},destroy:function(e){s.prototype.destroy.call(this,!1)}});return n}),define("modules/rentals-local-rentals",["jquery","baseview","state","directAdPosition"],function(e,t,i,s){var n=t.extend({layoutType:"",renderedAd:!1,renderAd:function(){if(!this.renderedAd){this.renderedAd=!0;var e=this.$(".js-rlr-google-ad")[0];e&&(this.subviews.adPositionOne=this.createAdPosition(e))}},destroyAd:function(){this.renderedAd&&(this.subviews.adPositionOne.destroy(),this.renderedAd=!1)},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},createAdPosition:function(t){return new s({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},initialize:function(e){t.prototype.initialize.call(this),this.layoutType=e.layoutType},handleCardSizeChange:function(e){this.isSidebarModule()?e.sidebarAds===!0?(this.$(".js-rentals-sidebar-ad").removeClass("rlr-hide-ad"),this.renderAd()):(this.$(".js-rentals-sidebar-ad").addClass("rlr-hide-ad"),this.destroyAd()):this.isPrimaryWellModule()&&(e.sidebarOpen===!0?this.destroyAd():this.renderAd()),e.sidebarOpen===!0?("primary"===this.layoutType&&this.$(".js-rlr-wrap").addClass("rlr-dynamic-height"),this.$(".js-rlr-locals-wrap").removeClass("rlr-dynamic-margin").addClass("rlr-dynamic-border"),this.$(".js-rlr-wrap-primary").removeClass("rlr-top-border")):("primary"===this.layoutType&&this.$(".js-rlr-wrap").removeClass("rlr-dynamic-height"),this.$(".js-rlr-locals-wrap").addClass("rlr-dynamic-margin").removeClass("rlr-dynamic-border"),this.$(".js-rlr-wrap-primary").addClass("rlr-top-border"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return n}),define("modules/rentalslite-ads",["jquery","baseview","state","directAdPosition","managers/routemanager"],function(e,t,i,s,n){var o=t.extend({layoutType:"",adRendered:!1,renderAd:function(){var e=this.$(".js-rlad-google-ad")[0];!this.adRendered&&e&&(this.adRendered=!0,this.subviews.adPositionOne=this.createAdPosition(e))},destroyAd:function(){this.adRendered&&(this.subviews.adPositionOne.destroy(),this.adRendered=!1)},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},createAdPosition:function(t){return new s({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},initialize:function(e){t.prototype.initialize.call(this),this.layoutType=e.layoutType},handleCardSizeChange:function(e){this.isSidebarModule()?e.sidebarAds===!0?(this.$(".js-rlad-sidebar-ad").removeClass("rlad-hide-ad"),this.renderAd()):(this.$(".js-rlad-sidebar-ad").addClass("rlad-hide-ad"),this.destroyAd()):this.isPrimaryWellModule()&&(e.sidebarOpen===!0?this.destroyAd():this.renderAd()),e.sidebarOpen===!0?(this.$(".js-rlad-wrap").addClass("rlad-wrap-margin").removeClass("rlad-dynamic-margin"),this.$(".js-rlad-google-ad").removeClass("rlad-dynamic-margin"),this.isPrimaryWellModule()&&(this.$(".js-rlad-wrap").addClass("rlad-dynamic-height"),this.$(".js-rlad-local").addClass("rlad-sidebar-local"))):(this.$(".js-rlad-wrap").removeClass("rlad-wrap-margin"),this.isPrimaryWellModule()&&(this.$(".js-rlad-wrap").removeClass("rlad-dynamic-height"),this.$(".js-rlad-local").addClass("rlad-primary-local").removeClass("rlad-sidebar-local")),this.$(".js-rlad-wrap").addClass("rlad-dynamic-margin"),this.$(".js-rlad-google-ad").addClass("rlad-dynamic-margin"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return o}),define("apps/overlay/pages/olympics-schedule-results",["jquery","underscore","baseview","state"],function(e,t,i,s){var n=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.$events=this.$(".schedule-results"),this.fetchResults()},fetchResults:function(){var e=this,i=this.$(".day-schedule").data("url");s.fetchHtml(i).done(t.bind(function(t){e.displayResults(t)},this))},displayResults:function(t){var i=this;t.each(function(){if(e(this).find(".flag").length>0){var t=e(this).data("id");i.$("#"+t).html(this)}})},destroy:function(){i.prototype.destroy.call(this)}});return n}),define("modules/longform/longform-series-bottom",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({el:".longform-bottom-series",events:{"click .series-bucket-prev":"doPrevTransition","click .series-bucket-next":"doNextTransition"},initialize:function(e){this.$seriesBucketSet=this.$(".series-bucket-item-set"),this.$seriesBucketItem=this.$("div.series-bucket-item"),this.$seriesBucketNext=this.$(".series-bucket-next"),this.$seriesBucketPrev=this.$(".series-bucket-prev"),this.$seriesBucketPrev.addClass("inactive-item"),this.$bucketItemPadding=10*this.$seriesBucketItem.length,this.$widthOfBucket=this.$seriesBucketItem.width()*this.$seriesBucketItem.length+this.$bucketItemPadding},doNextTransition:function(e){this.$seriesBucketNext.addClass("inactive-item"),this.$seriesBucketPrev.addClass("inactive-item");var t=this,i=parseInt(this.$seriesBucketSet.css("left"),10)-200;this.$widthOfBucket-(600-this.$bucketItemPadding)===Math.abs(i)?this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketPrev.removeClass("inactive-item")}):this.$widthOfBucket-400>Math.abs(i)&&this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketNext.removeClass("inactive-item"),t.$seriesBucketPrev.removeClass("inactive-item")})},doPrevTransition:function(e){this.$seriesBucketNext.addClass("inactive-item"),this.$seriesBucketPrev.addClass("inactive-item");var t=this,i=parseInt(this.$seriesBucketSet.css("left"),10)+200;0===i?this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketNext.removeClass("inactive-item")}):200!==i&&this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketPrev.removeClass("inactive-item"),t.$seriesBucketNext.removeClass("inactive-item")})}});return s}),define("modules/featured-events/featured-events",["jquery","underscore","state","baseview","utils","ui/generic-paginator"],function(e,t,i,s,n,o){var a=s.extend({events:{"click .js-pfem-carousel-prev":"onPrevPage","click .js-pfem-carousel-next":"onNextPage","click .js-pfem-ui-dropdown":"toggleDropdown","click .js-pfem-cat-ddl .ui-dropdown-item":"onCategoryDropdownItemSelect","click .js-pfem-when-ddl .ui-dropdown-item":"onWhenDropdownItemSelect"},initialize:function(e){s.prototype.initialize.call(this,e),this.moveMe=this.$(".pfem-items"),this.viewport=this.moveMe.parent(),this.pageIndex=0,this.maxIndex=Math.ceil(this.moveMe.children().length/3),this.prevCarousel=this.$(".pfem-carousel-prev"),this.nextCarousel=this.$(".pfem-carousel-next"),t.bindAll(this,"goTo"),this.subviews.paginator=new o({el:this.$(".paginator"),onGoTo:this.goTo}),this.pageLastIndex=this.subviews.paginator.$pageElements.length-1,1===this.maxIndex&&this.nextCarousel.removeClass("pfem-hidden")},onPrevPage:function(){var e=this.pageIndex-1;e>=0&&this.subviews.paginator.goToPage(e)},onNextPage:function(){var e=this.pageIndex+1;e<=this.pageLastIndex&&this.subviews.paginator.goToPage(e)},toggleDropdown:function(e){this.$(e.currentTarget).toggleClass("expanded")},onCategoryDropdownItemSelect:function(e){var t=this.$(e.currentTarget);this.$("#pfem-cat-display").html(t.html()),this.$("#pfem-cat").val(t.data().value)},onWhenDropdownItemSelect:function(e){var t=this.$(e.currentTarget).html();this.$("#pfem-when-display").html(t),this.$("#pfem-when").val(t)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e*-1;this.animate(this.moveMe,"left",i+"px",450,"ease-in-out"),e>0?this.prevCarousel.removeClass("pfem-hidden"):this.prevCarousel.addClass("pfem-hidden"),e<this.pageLastIndex?this.nextCarousel.removeClass("pfem-hidden"):this.nextCarousel.addClass("pfem-hidden"),this.pageIndex=e}});return a}),define("modules/stories/utility-bar-module-share",["jquery","underscore","backbone","utils","state","pubsub","managers/resourcemanager","modules/stories/utility-bar-flyout"],function(e,t,i,s,n,o,a,r){"use strict";var l=r.extend({events:{"click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn"},initialize:function(e){t.bindAll(this,"onClickFlyoutNavBtn");var i=this.$(".util-bar-share-summary-image");s.lazyLoadImage(i,"data-src",!0),this.events=t.extend({},r.prototype.events,this.events),r.prototype.initialize.call(this,e),this._loadUtilityBarModules()},_loadUtilityBarModules:function(){var e=s.getNested(window.site_vars,"utility_bar_modules");if(e){var i=t.find(e,function(e){return"utility-bar-module-share"===e.name});i&&i.options&&i.options.submodules&&a.fetchPageModules(i.options.submodules).done(t.bind(function(e){this.destroyed||t.each(e,function(e){this.subviews[e.name]=new e.ModuleClass(t.extend({el:e.selector},e.options))},this)},this))}},onClickFlyoutNavBtn:function(t){var i=e(t.currentTarget),s=e(t.currentTarget).data("share-method"),a="utilitybarshare"+s;o.trigger("uotrack",a),"A"!==i.prop("tagName")&&(t.preventDefault(),s&&n.getActiveApp().$(".util-bar-btn-"+s).trigger("click"))},showSection:function(t){this.activeSection=t,this.$(".util-bar-flyout-section, .util-bar-flyout-pane").hide(),this.$(".util-bar-flyout-pane-share, .util-bar-flyout-section-"+t).show(),this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-nav-btn-"+t).addClass("active"),e(".js-share-email-form-success-pane").hide(),"email"===this.activeSection?e(".js-share-email-form-container").show():e(".js-share-email-form-container").hide()}});return l}),define("modules/stories/share-facebook",["jquery","underscore","backbone","baseview","pubsub","utils","third-party-apis/facebook/facebook"],function(e,t,i,s,n,o,a){var r=s.extend({events:{"click .util-bar-share-submit-btn-facebook":"onClickPostBtn","click .util-bar-success-link-facebook":"onClickPostLink"},initialize:function(e){t.bindAll(this,"fbShareCallback"),s.prototype.initialize.call(this,e)},onClickPostBtn:function(e){e.preventDefault(),this.$loading=this.$$(".util-bar-share-loading-facebook"),this.$status=this.$$(".util-bar-share-status-text-facebook"),this.$message=this.$$(".util-bar-share-message-facebook"),this.$successPane=this.$$(".util-bar-flyout-pane-success-facebook"),this.$successLink=this.$$(".util-bar-success-link-facebook"),this.$successDescription=this.$$(".util-bar-success-description-facebook"),this.$flyoutSection=this.$$(".util-bar-flyout-section-facebook"),this.fbShare()},fbShare:function(){this.$loading.show();var e={method:"feed"},i=t.filter(this.$message,function(e){return e.getAttribute("data-link").length>0})[0];e.link=i.getAttribute("data-link"),e.picture=i.getAttribute("data-image"),e.name=i.getAttribute("data-title"),a.loadScript().done(t.bind(function(){FB.ui(e,this.fbShareCallback)},this))},fbShareCallback:function(t){if(t)if(t.error)this.$loading.hide(),this.$status.text("An error occurred, try again.");else{if(this.$successLink.remove(),t.post_id){var i=t.post_id.split("_");if(i.length>=2){var s="https://www.facebook.com/"+i[0]+"/posts/"+i[1],o=e('<a class="util-bar-success-link-facebook" href="'+s+'">View the post.</a>');this.$successDescription.append(o)}}this.$loading.hide(),this.$flyoutSection.hide(),this.$successPane.show(),n.trigger("uotrack","UtilityBarShareFacebook")}else this.$loading.hide()},onClickPostLink:function(t){t.preventDefault();var i=e(t.target).attr("href");o.openPopup(i,1e3,600)}});return r}),define("modules/sports/sports-carousel-gallery",["jquery","underscore","backbone","baseview","pubsub","utils","modules/global/taboola","modules/carousel/gallery","directAdPosition","adLogger"],function(e,t,i,s,n,o,a,r,l,h){var d=r.extend({initialize:function(i){t.bindAll(this,"_initializeAds","startVisible"),i=e.extend({galleryClass:".front-galleries-primary"},i),r.prototype.initialize.call(this,i)},_initializeAds:function(){if(this.options.ads){this.galleryData=this.$el.data()||{};this.getAdTargeting()}},startVisible:function(){return this.options.isSideBarOpen()&&this.options.sidebarAds()?!0:!1},refreshSponsorshipAd:function(e){}});return d}),define("modules/sports/sports-front-carousel",["jquery","underscore","utils","pubsub","modules/carousel/carousel","modules/sports/sports-carousel-gallery"],function(e,t,i,s,n,o){"use strict";var a=n.extend({events:function(){var e=n.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{mouseenter:"mouseEnter",click:"mouseClick"})},initialize:function(o){this.$primary=e(".front-galleries-primary"),this.$module=e(".front-galleries-module"),this.$closer=e(".gallery-sidebar-close"),this.$sidebar=e(".gallery-sidebar-ad"),this.$counter=e(".gallery-count"),this.$cardfilm=e(".front-card-film"),this.$cardcolor=e(".card-suspender-color"),this.$suspender=e(".front-galleries-suspender"),this.$caption=e(".gallery-sidebar-ad .caption").html(),this.$module.length<1&&(this.$module=e(".sports-front-galleries-module")),t.bindAll(this,"mouseScroll","mouseClick","mouseEnter","isSideBarOpen","sidebarCaption"),n.prototype.initialize.call(this,o),this.sidebarCaption(),s.on("carousel:switchSlide",t.bind(function(){this.captionPoll=setInterval(this.sidebarCaption,200)},this)),s.on("gallery:clickSidebar",t.bind(function(){this.showSidebar()},this)),this.$win=i.get("win"),this.$win.on("scroll."+this.cid,this.mouseScroll),this.$win.on("click."+this.cid,this.mouseClick)},_initializeGallery:function(e,t,i,s){this.subviews.gallery=new o({ads:i,el:s?this.$(s):this.$el,index:this.index,imageLazySrcAttr:e,slideTransition:t,carousel:this,isSideBarOpen:this.isSideBarOpen,sidebarAds:this.options.sidebarAds})},sidebarCaption:function(){var t=e(".gallery-sidebar-ad .caption"),i=e(".selected .active .gallery-viewport-caption").html();i!=this.$caption&&(this.$caption=i,clearInterval(this.captionPoll)),i?t.html(i):t.empty()},openSidebar:function(e){e&&(e.preventDefault(),e.stopPropagation());var i=parseInt(this.$sidebar.outerWidth()+1,10),n=null;this.$sidebar.hasClass("active")||(this.$sidebar.addClass("active"),n=this.animate(this.$sidebar,"right",-i+"px",250,"ease-in-out").promise().done(t.bind(function(){this.options&&this.options.onSidebarAfterReveal&&this.options.onSidebarAfterReveal(),s.trigger("carousel:sidebarOpened"),window.utag.link({clickName:"gallery caption flyout",clickPage:location.href,linkTrackVars:"prop41,prop64"})},this)))},showSidebar:function(){var e=parseInt(this.$sidebar.outerWidth(),10);this.$sidebar.hasClass("active")||(this.$sidebar.addClass("active"),this.$primary.addClass("active"),this.$sidebar.css({right:-e+"px",transition:""}),this.options&&this.options.onSidebarAfterReveal&&this.options.onSidebarAfterReveal(),this.$closer.addClass("active"))},isSideBarOpen:function(){return!this.$cardfilm.hasClass("inactive")},mouseEnter:function(){},mouseScroll:function(t){if(this.$sidebar.hasClass("active")){var i=this.$sidebar.outerHeight(),s=this.$module.position().top,n=e(window).scrollTop(),o=e(window).outerHeight();(n>s+i+90||s>n+o-130)&&this.$closer.click()}},mouseClick:function(e){if(this.$sidebar.hasClass("active")){s.trigger("carousel:cardfilmActive");var t=this.$module.offset().top,i=this.$module.offset().left,n=this.$module.outerWidth()+this.$sidebar.outerWidth(),o=this.$sidebar.outerHeight();e.pageX<i||e.pageX>i+n||e.pageY<t||e.pageY>t+o?this.$closer.click():this.$closer.hasClass("active")||(this.$closer.addClass("active"),this.$cardfilm.removeClass("inactive"),this.$module.css("z-index",501),this.$suspender.css("background-color",this.$cardcolor.css("background-color")))}},destroy:function(e){clearInterval(this.captionPoll),this.$win.off("."+this.cid),e&&this.$el.parent().remove(),s.off("carousel:switchSlide"),s.off("gallery:clickSidebar"),n.prototype.destroy.call(this,!1)}});return a}),define("modules/fronts/front-galleries",["jquery","underscore","backbone","pubsub","baseview","utils","modules/carousel/carousel","ui/loader","state","modules/stories/share-facebook","modules/sports/sports-front-carousel","directAdPosition"],function(e,t,i,s,n,o,a,r,l,h,d,c){"use strict";var u=n.extend({empty:!0,throttled:!1,events:{"click .js-fg-link":"select","click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn","click .gallery-sidebar-close":"closeSidebar","click .fullscreen":"launchFullscreen","click .sidebar-gallery-btn, .thumb-link":"clickPhoto"},counter:10,initialize:function(i){this.$primary=e(".front-galleries-primary"),this.$module=e(".front-galleries-module"),this.$closer=this.$(".gallery-sidebar-close"),this.$sidebar=this.$(".gallery-sidebar-ad"),this.$counter=e(".gallery-count"),this.$toolbox=this.$(".gallery-sidebar-toolbox"),this.$cardfilm=e(".front-card-film"),this.$cardcolor=e(".card-suspender-color"),this.$suspender=e(".front-galleries-suspender"),this.$galleries=this.$(".front-gallery"),this.$navItems=this.$(".js-fgs-item"),this.overrideTaboola=this.$(".js-fg-nav-list").data("taboolaOverride")?!0:!1,this.currentGallery=this.$(".fgpfm-gallery.front-gallery.selected").attr("id"),this.$titles=this.$(".gallery-sidebar-title"),this.$partnerSlot=e(".companion-galleries-partner-slot"),this.$sidebarBtn=this.$(".sidebar-gallery-btn"),t.bindAll(this,"switchGallery","setupAd","refreshAd","sidebarAds","resetGallery","clickPhoto","loading"),n.prototype.initialize.call(this,{});var a;if(o.getNested(window.site_vars,"flags","progressive_gallery_fronts")){if(s.on("carousel:switchSlide",t.bind(function(e){this.refreshAd(e.context.className)},this)),s.on("gallery:hideSidebar",t.bind(function(){this.hideSidebar()},this)),this.$galleries.find(".slide.active").length){var l=this.$(".front-gallery.selected"),c=this.$(".front-gallery");this.subviews["gallery"+c.index(l)]=new d({ads:!0,linkPath:this.$navItems.filter(".selected").find("a").attr("href"),el:l.find(".galleries"),fullScreen:!0,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds}),this.empty=!1}else a=this.$navItems.first().find("a").attr("href"),"undefined"!=typeof a&&a.length>1&&this.fetchData(a,0,this.switchGallery);this.$(".util-bar-flyout-section").hide(),this.subviews.facebook=new h({el:this.$(".util-bar-flyout-share")})}else{var u=[],p=this.currentGallery;if(this.$(".fgpfm-nav-link").each(function(){var t=e(this).data("id");t&&p!=t&&u.push(t)}),this.endslateGalleries=u,this.$galleries.find(".slide.active").length){var f=this.$(".front-gallery.selected");this._initializeCarousel(f,f.index(),this.$navItems.filter(".selected").find("a").attr("href")),this.empty=!1}else a=this.$navItems.first().find("a").attr("href"),"undefined"!=typeof a&&a.length>1&&this.fetchData(a,0,this.switchGallery)}this.subviews.loader=new r({el:this.$galleries.parent()})},_initializeCarousel:function(e,t,i){var s=new a({ads:!0,linkPath:i,el:e.find(".galleries"),fullScreen:!0,endslateOptions:{overrideTaboola:this.overrideTaboola,endslateGalleries:this.endslateGalleries,currentGallery:this.currentGallery}});return this.subviews["gallery"+t]=s,s},fetchData:function(e,t,i){var s=this,n=!0,o=this.$el.data("layout-type"),a=this.$(".front-gallery.selected");a.length&&(a.css({opacity:1}),this.animate(a,"opacity",0,200).done(function(){n&&s.loading(!0)})),o&&(e="/"+o+e),l.fetchHtml("/front-gallery"+e,{headers:{"x-no-nav":"true"}}).done(function(s){i(s,t,e)}).always(function(){n=!1,s.loading(!1)})},loading:function(e){this.subviews.loader&&(e?this.subviews.loader.show():this.subviews.loader.hide())},select:function(t){var i=e(t.currentTarget),s=i.attr("href"),n=i.parent(),o=n.index(),a=this.$galleries.eq(o);-1===s.indexOf("://")&&(a.find(".galleries").length>0?this.switchGallery(null,o,s):this.fetchData(s,o,this.switchGallery),t&&t.preventDefault());var r=this.$navItems.filter(".selected"),l=r.attr("data-theme")||"",h=n.attr("data-theme")||"";r.removeClass(l+" selected"),n.addClass(h+" selected")},trackGalleryChange:function(e){e._trackSlideChange()},_initializeAds:function(){this.$sponsorshipAd||(this.$sponsorshipAd=e('<div class="partner-placement poster" data-monetization-id="sp-gallery" data-monetization-sizes="mediumrectangle"></div>'),this.$partnerSlot.append(this.$sponsorshipAd))},renderCardInfo:function(e){this.currentCardInfo=e},onCardWidthChange:function(e){this.currentCardInfo&&this.currentCardInfo.primaryFlexWidth===e.primaryFlexWidth||this.triggerEvent("viewportResize"),this.currentCardInfo=e,this.sidebarAds()?(this.setupAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:cardfilmActive")):(this.teardownAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:sidebarClosed"))},sidebarAds:function(){return this.currentCardInfo?this.currentCardInfo.sidebarAds:!1},switchGallery:function(t,i,s){var n,a=this.$galleries.eq(i),r=l.getActivePageInfo().layout_type;if(o.getNested(window.site_vars,"flags","progressive_gallery_fronts")&&"primary-flex-sidebar-page"!==r){this.$galleries.removeClass("selected"),a.addClass("selected");var h=this.$toolbox.eq(i);this.$toolbox.length>1&&this.$toolbox.removeClass("selected"),h.addClass("selected"),this.$(".util-bar-flyout-nav-btn").removeClass("active");var c=this.$titles.eq(i);this.$titles.length>1&&this.$titles.removeClass("selected"),c.addClass("selected");var u=this.$(".gallery-sidebar-ad .caption"),p=a.find(".active .gallery-viewport-caption").html(),f=c.html();if(this.resetSections(),u.html(p),t){a.html(t);var g='<div class="front-gallery-hover"><div class="gallery-hover-title">'+f+'</div>&nbsp;<span class="gallery-count">'+a.find(".thumb-item").length+"&nbsp;Photos</span></div>";a.append(g),this.$counter=e(".gallery-count"),this._setCounterWidth(a)}this.subviews["gallery"+i]?(this.trackGalleryChange(this.subviews["gallery"+i]),this.subviews["gallery"+i].subviews.gallery&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd(),this.teardownAd(),this.setupAd()):(n=this.subviews["gallery"+i]=new d({ads:!0,el:a.find(".galleries"),fullScreen:!0,linkPath:s,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds}),this.empty||(this.trackGalleryChange(n),this.empty=!1)),a.css({opacity:0}),this.animate(a,"opacity",1,200)}else this.$galleries.removeClass("selected"),a.addClass("selected"),t&&a.html(t),this.subviews["gallery"+i]?this.trackGalleryChange(this.subviews["gallery"+i]):(n=this._initializeCarousel(a,i,s),this.empty||this.trackGalleryChange(n)),a.css({opacity:0}),this.animate(a,"opacity",1,200)},launchFullscreen:function(){e(".front-gallery.selected .fullscreen").click()},setupAd:function(){var e=this.$(".front-gallery").index(this.$(".front-gallery.selected"));if(this.sidebarAds()){this.adSetup=!0,this._initializeAds();var t={};this.subviews["gallery"+e].subviews.gallery&&this.subviews["gallery"+e].subviews.gallery.getAdTargeting&&(t=this.subviews["gallery"+e].subviews.gallery.getAdTargeting());var i=this.$(".front-gallery.selected .galleries").data();this.subviews.sponsorshipAd=new c({el:this.$sponsorshipAd,adPlacement:"poster_gallery_companion",adSizes:["mediumrectangle"],targeting:t,subSection:i.cst})}},onClickFlyoutNavBtn:function(t){var i=e(t.currentTarget),n=e(t.currentTarget).data("share-method"),o=e(t.currentTarget).data("share-title"),a=e(t.currentTarget).data("share-link"),r="Gallery"+n;s.trigger("uotrack",r),n&&this.showSection(i.parent().parent(),n),this.$closer.hasClass("active")||(this.$closer.addClass("active"),this.$cardfilm.removeClass("inactive"),this.$module.css("z-index",501),this.$suspender.css("background-color",this.$cardcolor.css("background-color"))),"facebook"==n&&(this.$(".util-bar-share-message-facebook").data("link",a),this.$(".util-bar-share-message-facebook").data("title",o),this.resetSections(),this.$(".gallery-sidebar-ad .caption").empty(),this.subviews.facebook.onClickPostBtn(t),t.preventDefault())},showSection:function(e,t){this.resetSections(),this.activeSection=t,this.$(".util-bar-flyout-nav-btn-"+t).addClass("active")},resetSections:function(){this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-pane-success").hide()},resetGallery:function(){this.resetSections(),this.$primary.removeClass("active"),this.$closer.removeClass("active"),this.$cardfilm.addClass("inactive"),this.$sidebar.removeClass("active"),this.$module.css("z-index","auto"),this._setCounterWidth(this.$module.find(".front-gallery.selected"))},closeSidebar:function(e){e&&(e.preventDefault(),e.stopPropagation());var i=(parseInt(this.$sidebar.outerWidth()+1,10),null);this.$sidebar.hasClass("active")&&(s.trigger("carousel:sidebarClosed"),this.$(".util-bar-flyout-nav-btn").removeClass("active"),i=this.animate(this.$sidebar,"right",0,250,"ease-in-out"),i.done(t.bind(function(){this.resetGallery()},this)),this.teardownAd()),this.$sidebarBtn.addClass("active")},hideSidebar:function(){parseInt(this.$sidebar.outerWidth()+1,10);this.$sidebar.hasClass("active")&&(this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$sidebar.css({right:0,transition:""}),this.resetGallery(),
this.teardownAd())},refreshAd:function(e){e&&e.indexOf("front-galleries-module")>-1&&this.subviews.sponsorshipAd&&this.subviews.sponsorshipAd.refreshPosition&&!this.throttled&&(this.subviews.sponsorshipAd.refreshPosition(),this.throttled=!0,setTimeout(t.bind(function(){this.throttled=!1},this),2e3))},teardownAd:function(){this.subviews.sponsorshipAd&&this.adSetup&&(delete this.adSetup,this.$sponsorshipAd.empty(),this.subviews.sponsorshipAd.destroy(),delete this.subviews.sponsorshipAd)},clickPhoto:function(e){if(this.$sidebarBtn.hasClass("active")){e&&(e.preventDefault(),e.stopPropagation());var t=this.$(".front-gallery.selected"),i=this.$(".front-gallery");this.subviews["gallery"+i.index(t)].openSidebar(),this.$closer.addClass("active"),this.$sidebarBtn.removeClass("active"),this.$primary.hasClass("active")||this.$primary.addClass("active"),this.$cardfilm.removeClass("inactive"),s.trigger("track",{label:"gallery caption flyout",url:location.href,event:e})}},_setCounterWidth:function(e){var i=e.find(".slide.active .gallery-photo").width(),s=40;i?(i-=40,i>470&&(i=470),470>i&&(s=(720-i)/2),e.find(".front-gallery-hover").css({width:i,left:s})):(this.counter--,this.counter?setTimeout(t.bind(function(){this._setCounterWidth(e)},this),100):e.find(".front-gallery-hover").css({width:"90%",left:s}))}});return u}),define("modules/travel/hotelme",["jquery","underscore","backbone","state","pubsub","baseview"],function(e,t,i,s,n,o){var a=o.extend({initialize:function(e){s.fetchHtml("/travel/hotelme/").done(t.bind(function(e){this.$el.html(e)},this)),o.prototype.initialize.call(this,e)}});return a}),define("modules/header/site-nav-social-module",["jquery","underscore","modules/header/site-nav-dropdown","utils"],function(e,t,i,s){"use strict";var n=i.extend({initialize:function(){this.initSocialShareButtons(),i.prototype.initialize.apply(this)},initSocialShareButtons:function(){this._loadGooglePlus()},_loadGooglePlus:function(){s.loadScript("https://apis.google.com/js/plusone.js","gapi")}});return n}),define("modules/global/iframe-auto-height",["jquery","underscore","utils","baseview"],function(e,t,i,s){"use strict";var n=s.extend({initialize:function(n){n=e.extend({frameOrigin:"http://usatoday30.usatoday.com"},n),this.win=i.get("win"),this.$scrollEl=i.get("scrollEl"),this.iframeHeight=this.$el.height(),t.bindAll(this,"onReceiveMessage"),s.prototype.initialize.call(this,n),this.win.on("message."+this.cid,this.onReceiveMessage)},onReceiveMessage:function(e){if(e.originalEvent.origin===this.options.frameOrigin){var t=e.originalEvent.data+"",i=t.match("_pageLoad");i&&(t=t.replace(/(\d*)_pageLoad/gi,"$1"),this.$scrollEl.scrollTop(0)),t!==this.iframeHeight&&(this.$el.css("height",t),this.iframeHeight=t)}},destroy:function(){this.win.off("."+this.cid),s.prototype.destroy.apply(this,arguments)}});return n}),define("modules/sports/sports-team-leaders",["jquery","underscore","backbone","baseview","easing"],function(e,t,i,s){var n=s.extend({events:{"click .js-fg-link":"onSuspenderItemClick"},initialize:function(){s.prototype.initialize.call(this,this.options),this.links=this.$(".js-fg-link"),this.viewport=this.$(".sp-team-leaders-viewport"),this.slider=this.$(".sp-team-leaders-slider"),this.views=this.$(".sp-team-leaders-wrap"),this.charts=this.$(".sports-team-statistics-charts"),this.animateGraphs(this.charts.eq(0))},onSuspenderItemClick:function(t){var i=e(t.currentTarget),s=i.data("id"),n=i.data("module-name"),o="selected";t.preventDefault(),this.links.parent().removeClass(o),this.links.filter(i).parent().addClass(o),"team-leaders"===n?(this.views.removeClass("selected"),this.views.filter(".sp-team-leaders-wrap-"+s).addClass(o)):"team-statistics"===n&&(this.$target_stats=this.$(".sports-team-statistics-charts-"+s),this.animateGraphs(this.$target_stats),this.charts.hide(),this.$target_stats.show())},animateGraphs:function(t){var i=100,s=t.find(".sports-team-statistics-chart-group .category"),n=t.find(".sports-team-statistics-chart-group .bar"),o=t.find(".sports-team-statistics-chart-group .value");n.css("height","0%"),s.hide(),o.hide(),s.fadeIn(1e3),n.each(function(t,s){e(s).delay(i).animate({height:e(s).data("percentage")},500,"easeOutElastic"),i+=100}),o.delay(i).fadeIn(1e3)}});return n}),define("modules/home-finder/home-ads",["jquery","underscore","baseview","state","directAdPosition"],function(e,t,i,s,n){var o=i.extend({initialize:function(e){i.prototype.initialize.call(this),this.layoutType=e.layoutType},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},renderedAd:!1,renderAd:function(){this.renderedAd||(this.renderedAd=!0,this.subviews.ads=[],this.$(".mpa-hf-ads").each(t.bind(function(e,t){this.subviews.ads[e]=this.createAdPosition(t)},this)))},destroyAd:function(){t.forEach(this.subviews.ads,function(e){e.destroy()}),this.subviews.ads=[]},createAdPosition:function(t){var i=e(t),s=i.data("adtag"),o=s.search("poster_front")?[300,135]:[[300,250],[300,600]];return new n({el:i,adSizes:o,adPlacement:s})},handleCardSizeChange:function(e){if(this.isSidebarModule())e.sidebarAds===!0?this.renderAd():this.destroyAd();else if(this.isPrimaryWellModule()){var t=this.$(".mpa-hf-wrap");e.sidebarOpen===!0?(t.addClass("mpa-closed"),this.destroyAd()):(t.removeClass("mpa-closed"),this.renderAd())}},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)}});return o}),define("modules/fronts/primary-poster-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){var s=this.$el;t=e.extend({adType:s.attr("data-ad-type")||"poster",adPlacement:s.attr("data-ad-placement")||"poster_front",adSizes:s.attr("data-ad-sizes")||"mediumrectangle"},t),i.prototype.initialize.call(this,t),this._initAds()}});return s}),define("uiFlip",["jquery","transformSupport"],function(e){"use strict";var t="uiPageFlip",i={useTransforms:!!e.support.css.transform,transitionTiming:"linear",flipDuration:300,flipFrontSelector:".ui-flip-panel",flipBackSelector:".ui-flip-panel",activePanelClass:"active",perspective:"900px",fadeDuration:200,onFlip:function(e){}},s={init:function(s){return this.each(function(){var n=e(this),o=e.extend({},i,s);n.data(t,{busy:!1,settings:o})})},option:function(e,i){var s=this.data(t);if(s&&e){if(!i)return s[e];("function"==typeof i||"onFlip"!==e)&&(s[e]=i)}},flipForward:function(e){var i=this.data(t),s=i.settings,o=this.find(s.flipFrontSelector);return n.transition(this,o.filter(".active"),o.filter(":not(.active)"),!0,s,i,e)},flipBackward:function(e){var i=this.data(t),s=i.settings,o=this.find(s.flipFrontSelector);return n.transition(this,o.filter(".active"),o.filter(":not(.active)"),!1,s,i,e)}},n={transition:function(t,i,s,o,a,r,l){var h;return r.busy?e.Deferred().reject():l?(a.onFlip(s),s.addClass("active"),i.removeClass("active"),e.Deferred().resolve()):(r.busy=!0,s.addClass("active"),h=a.useTransforms?n.flipTransform(t[0],i[0],s[0],o,a):n.fadeTransition(i,s,a),h.done(function(){a.onFlip(s),r.busy=!1,i.removeClass("active")}),h)},flipTransform:function(t,i,s,o,a){n.setupTransition(t,i,s,o,a);var r=e.Deferred();return e.support.css.transition.registerTransitionEndListener(i,r).done(function(){i.style[e.support.css.transform.backfaceVisibilityCssName]="",i.style[e.support.css.transform.styleCssName]="",i.style[e.support.css.transition.cssName]="",i.style[e.support.css.transform.cssName]="",s.style[e.support.css.transform.backfaceVisibilityCssName]="",s.style[e.support.css.transform.styleCssName]="",s.style[e.support.css.transition.cssName]="",s.style[e.support.css.transform.cssName]="",t.style[e.support.css.transform.perspectiveCssName]="",t.style[e.support.css.transform.styleCssName]=""}),setTimeout(function(){var t="rotateX("+(o?"":"-")+"180deg)";i.style[e.support.css.transform.cssName]=t,s.style[e.support.css.transition.cssName]=n.getTransitionStyle(e.support.css.transform.cssHyphenName,a.flipDuration,a.transitionTiming),s.style[e.support.css.transform.cssName]="rotateX(0deg)"},20),r.promise()},fadeTransition:function(e,t,i){e.css({opacity:1,"z-index":11}).show(),t.css({opacity:1,"z-index":10}).show();var s=e.fadeOut(i.fadeDuration).promise();return s.done(function(){e.css({"z-index":""}),t.css({"z-index":""})}),s},getTransitionStyle:function(e,t,i,s){var n=e+" "+t+"ms "+i;return s&&(n+=" "+s+"ms"),n},setupTransition:function(t,i,s,o,a){var r="rotateX("+(o?"-":"")+"180deg)";t.style[e.support.css.transform.perspectiveCssName]=a.perspective,t.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",i.style[e.support.css.transform.styleCssName]="preserve-3d",i.style[e.support.css.transition.cssName]=n.getTransitionStyle(e.support.css.transform.cssHyphenName,a.flipDuration,a.transitionTiming),i.style[e.support.css.transform.cssName]="rotateX(0deg)",s.style[e.support.css.transform.backfaceVisibilityCssName]="hidden",s.style[e.support.css.transform.styleCssName]="preserve-3d",s.style[e.support.css.transform.cssName]=r}};e.fn.uiFlip=function(t){return s[t]?s[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.uiPageTurn"):s.init.apply(this,arguments)}}),define("modules/fronts/hero",["jquery","underscore","backbone","baseview","pubsub","utils","state","admanager","modules/videos/brightcove-video","modules/videos/pluto/pluto-video","modules/carousel/carousel","sharedAdPosition","directAdPosition","partner/leavebehind","modules/fronts/primary-poster-ad","modules/fronts/front-list-video","uiPageTurn","uiFlip"],function(e,t,i,s,n,o,a,r,l,h,d,c,u,p,f,g){"use strict";var m=s.extend({events:{"click .slide, .hero-asset-open":"open","click .carousel-thumbs > li":"openTile","click .hero-turn-trigger, .hero-popular .hero-page-trigger":"toggleFrontBack","click .partner-close":"closeAdClick","click .hero-headline-video-close":"toggleFrontVideo","click .js-vid-play-link":"onClickPlay","click .js-video-wrap":"_onFrontListVideoClick"},destroy:function(e){var t=a.getActiveApp().$(".partner-billboard-ad");t&&t.removeClass("show-slot"),this.adShowing&&this.closeAd(!0),s.prototype.destroy.call(this,e)},initialize:function(i){if(i=e.extend(!0,{animate:{duration:200},popularCount:this.$el.data("popular-count")||6,shadow:{opacity:".4",duration:200,delay:0}},i),this.$el.hasClass("front-list-hero"))this.$activeVideos=e([]),this.pubSub={"exited:view:flhmvideo":this.onInlineVideoExitView},s.prototype.initialize.call(this,i);else{s.prototype.initialize.call(this,i),t.bindAll(this,"onVideoShow","onVideoHide","onAdReady","showHeroAd","beforeAdRender","belowHeroAdReady","onVideoStatusChange","onClickPlay","onPlutoVideoReset","onPlutoVideoPlay","_onFrontListVideoClick"),this.visibleFace="front",this.$openSidebar=e(".open-sidebar"),this.mostPopularLoaded=!1,this.isPageTurn=this.$el.hasClass("hero-page-turn"),this.isPageTurn?(this.pageTurn={frontIndex:this.$(".hero-page-front").index(),backIndex:this.$(".hero-page-back").index(),adIndex:this.$(".hero-page-ad").index(),videoIndex:this.$(".hero-page-video").index()},this.$el.uiPageTurn({perspective:"1400px"})):this.$el.uiFlip({perspective:"1400px"}),this.adShowing=!1,this.intervalSpeed=this.$el.data("interval"),this.$el.hasClass("carousel")&&(this.subviews.heroCarousel=new d({el:this.$el,ads:!1,hoverTransition:200,thumbsSelector:".carousel-thumbs",rotate:!0,rotateInterval:this.intervalSpeed,autostart:!0})),this.subviews.video=[],this.$(".ui-pluto-video").each(t.bind(function(){var e=new h({el:this.$(".ui-pluto-video")[0],pageInfo:a.getActivePageInfo(),adUnit:r.buildAdUnit("preroll_video"),siteDisplayName:o.getNested(window.site_vars,"display_name"),twitterAccount:o.getNested(window.site_vars,"twitter","default_account"),onVideoPlay:this.onPlutoVideoPlay,onEnded:this.onPlutoVideoReset});this.$el.closest(".hero-page-video").length?this.subviews.heroVideo=e:(this.subviews.video.push(e),this.PlutoVideo=e),this.onPlutoVideoReset()},this)),this.$(".ui-video").each(t.bind(function(t,i){var s=e(i),n=new l({el:s.parent(),onVideoShow:this.onVideoShow,onVideoHide:this.onVideoHide,onStatusChange:this.onVideoStatusChange,onClickPlay:this.onClickPlay});s.closest(".hero-page-video").length?this.subviews.heroVideo=n:this.subviews.video.push(n)},this));var n=this.$(".poster-ad-primary");if(n.length>0&&(this.subviews.posterAdPrimary=new f({el:n})),this.$(".partner-heroflip-ad").each(t.bind(function(e,t){if(e>0)return void console.error("why are there multiple ad placements for this hero?");var i=a.getActiveApp();i._hasBigHeadline&&!i._hasBigHeadline()&&(this.subviews.ad=new c({el:t,adSizes:["heroflip"],adPlacement:"high_impact",adType:"heroflip",beforeAdRender:this.beforeAdRender,onAdReady:this.onAdReady}))},this)),this.$(".popular").length){var u="/services/most-popular/hero/"+o.getSectionPath(window.location.pathname)+"/"+this.options.popularCount+"/";a.fetchHtml(u).done(t.bind(function(e){this.$(".popular .ui-placer").html(e),this.$(".hero-turn-trigger").fadeIn(500).addClass("ready"),this.mostPopularLoaded=!0},this))}}},renderCardInfo:function(e){if(this.updateTrackingLabels(e),this.belowHeroModule=this.$el.next(".below-hero-ad-module"),this.belowHeroModule.length)if(e.belowHeroAd){var t={el:this.belowHeroModule.find(".below-hero-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"below_hero",onAdReady:this.belowHeroAdReady};this.subviews.belowHeroAd=new u(t)}else this.belowHeroModule.hide()},belowHeroAdReady:function(){var e="/services/most-popular/headline-ad/"+o.getSectionPath(window.location.pathname)+"/2/";a.fetchHtml(e).done(t.bind(function(e){this.belowHeroModule.find(".below-hero-popular").html(e),this.belowHeroModule.show(),this.subviews.belowHeroAd.playAd()},this))},beforeAdRender:function(){var e=this.subviews.ad.$el,t=e.height(),i=e.width();this.subviews.ad.setInitialDimensions(i,t)},onAdReady:function(e){var t=a.getActiveApp().$(".partner-billboard-ad");t&&t.addClass("show-slot"),(e.leaveBehindImage||(e.frameBackground||e.frameColor)&&e.frameSliver)&&e.leaveBehindText?this.createAdLeaveBehind(this.subviews.ad,e):this.showHeroAd()},createAdLeaveBehind:function(e,t){var i=a.getActiveApp();this.subviews.adLeaveBehind=new p({el:a.getActiveApp().$(".partner-leavebehind"),onShowAd:this.showHeroAd,cards:this.$el.closest(".card-wrap"),isCompact:i.isCurrentCardBumped&&i.isCurrentCardBumped(),maxDisplayed:parseInt(t.maxDisplayed,10),behavior:{clearBgColor:!1,hideframe:!1,hidebrand:!0,initShow:!0}}),this.subviews.adLeaveBehind.render(e,t)},showHeroAd:function(){if(this.adShowing=!0,a.getActiveApp().triggerEvent("onHeroAdOpen"),this.subviews.ad.show(),this.PlutoVideo){var e=this.PlutoVideo.vjsPlayer;e.paused()||e.pause()}return this.triggerAnimation(t.bind(function(){var e;return e=this.isPageTurn?this.$el.uiPageTurn("goToPage",this.pageTurn.adIndex,!1,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipForward"),e.done(t.bind(function(){this.subviews.ad.playAd()},this)),e},this))},closeAdClick:function(e){e.preventDefault(),this.closeAd()},closeAd:function(e){return this.adShowing=!1,this.subviews.ad.stopAd(),this.triggerAnimation(t.bind(function(){var t;return t=this.isPageTurn?"back"===this.visibleFace?this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex,e,this.$(".partner-placement iframe").length):this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex,e,this.$(".partner-placement iframe").length):this.$el.uiFlip("flipBackward",e)},this)).done(t.bind(function(){a.getActiveApp().triggerEvent("onHeroAdClose"),this.subviews.adLeaveBehind&&this.subviews.adLeaveBehind.show()},this)),!1},triggerAnimation:function(e){return a.registerAnimation(e())},onVideoShow:function(){this.$openSidebar.addClass("hidden"),this.$(".hero-turn-trigger").hide()},onVideoHide:function(){this.$openSidebar.removeClass("hidden"),this.mostPopularLoaded&&this.$(".hero-turn-trigger").show()},onVideoStatusChange:function(e){"mediaComplete"===e.type?this.resetVideo():"mediaPlay"===e.type&&this.hideLiveVideoLabel()},hideLiveVideoLabel:function(){var e=this.$(".js-live-video-label");e&&e.show()},onPlutoVideoReset:function(){e(this.el).find(".js-hide-during-vid-play").show()},onPlutoVideoPlay:function(){this.hideLiveVideoLabel()},onClickPlay:function(e){var t=this.$(".js-live-video-label");t&&t.hide(),this.$(".js-hide-during-vid-play").hide(),this.subviews.video[0].playVideo()},resetVideo:function(){var e=this.subviews.video[0];e.showStill(),this.$(".js-hide-during-vid-play").show()},open:function(t){var i=e(t.target),s=e(t.currentTarget),n=s.data("content-type")||"";this.subviews.heroVideo&&(i.hasClass("videoStillPlay")||"video"===n)?(this.toggleFrontVideo(t),t.preventDefault()):i.closest("a").length||(s.find(".hero-story > h1 > a").get(0).click(),t.preventDefault())},openTile:function(t){var i=e(t.currentTarget).index();this.$(".slide:eq("+i+") .hero-story > h1 > a").click()},toggleFrontBack:function(e){return this.mostPopularLoaded?(this.triggerAnimation(t.bind(function(){return"back"!==this.visibleFace?(n.trigger("uotrack","mostpopularopen"),this.goToBack()):(n.trigger("uotrack","mostpopularclose"),this.goToFront())},this)),!1):!1},goToFront:function(){return this.visibleFace="front",this.$el.uiPageTurn("goToPage",this.pageTurn.frontIndex)},goToBack:function(){return this.visibleFace="back",this.$el.uiPageTurn("goToPage",this.pageTurn.backIndex)},goToVideo:function(){return this.visibleFace="video",this.$el.uiPageTurn("goToPage",this.pageTurn.videoIndex).done(t.bind(function(){this.subviews.heroVideo.playVideo()},this))},onCardWidthChange:function(e){this.updateTrackingLabels(e)},updateTrackingLabels:function(i){this.$moduleWrap||(this.$moduleWrap=this.$el.closest(".hero-module")),!this.variant&&this.$moduleWrap.data("variant")&&(this.variant=this.$moduleWrap.data("variant")),"4uphp"===this.variant&&(this.trackPrefix||(this.trackPrefix=this.$moduleWrap.find(".hfwmm-list").data("track-prefix")),this.$flexListItems||(this.$flexListItems=this.$moduleWrap.find(".hfwmm-secondary-link,.hfwmm-tertiary-link")),1320===i.cardWidth?t.each(this.$flexListItems,function(t,i){var s=e(t),n=i>2?i-3+1:i+1;s.data("ht",this.trackPrefix+s.data("track-display-type")+n)},this):t.each(this.$flexListItems,function(t,i){var s=e(t);s.data("ht",this.trackPrefix+"stack"+(i+1))},this))},toggleFrontVideo:function(e){return this.subviews.heroVideo?(this.triggerAnimation(t.bind(function(){return"video"!==this.visibleFace?(n.trigger("uotrack","headlinevideoopen"),this.$(".hero-headline-video-close").show(),this.subviews.heroVideo.show(),this.goToVideo()):(this.subviews.heroVideo.onVideoStatusChange(e),this.subviews.heroVideo.hide(),n.trigger("uotrack","headlinevideoclose"),this.$(".hero-headline-video-close").hide(),this.goToFront())},this)),!1):!1},_onFrontListVideoClick:function(t){t.preventDefault();var i=e(t.currentTarget),s=i.find(".js-uw-iframe-video").attr("data-video-id"),o="flhm-video-"+s;s&&!this.subviews[o]&&(n.trigger("track",{label:i.attr("data-track-label")}),this.$activeVideos=this.$activeVideos.add(i),this.subviews[o]=new g({el:i}),a.observer&&(i.addClass("js-llc js-llp").attr("data-name","flhmvideo"),a.observer.observe(t.currentTarget)))},onInlineVideoExitView:function(e){this._destroyInlineVideoIframe(e)},_destroyInlineVideoIframe:function(t){var i=e(t),s=i.find(".js-uw-iframe-video").attr("data-video-id"),n="flhm-video-"+s;this.subviews[n]&&!this.subviews[n].fullScreenEnabled&&(this.$activeVideos=this.$activeVideos.not(i),this.subviews[n].destroy(),delete this.subviews[n],a.observer&&(i.removeClass("js-llc js-llp"),a.observer.unobserve(t)))}});return m}),define("modules/sports/sports-brackets",["jquery","underscore","backbone","pubsub","state","baseview"],function(e,t,i,s,n,o){var a=o.extend({events:{"click .sp-region-hat .view-nav a":"scrollTo","mouseenter .sports-bracket-grid .match.activated":"hoverOn","mouseleave .sports-bracket-grid .match.activated":"hoverOff"},initialize:function(i){o.prototype.initialize.call(this,i),t.bindAll(this,"scrollTo"),e(".cards").addClass("sports-brackets"),this.share_this_api="http://w.sharethis.com/button/buttons.js",this.$share_bar=e(".sp-brackets-sharebar"),this.$share_count_element=e(".sp-brackets-sharebar .count"),this.shared_url=this.$share_count_element.data("url"),this.share_counts_url="/sports/services/brackets-share-count/?shared_url="+this.shared_url,this.$news_headlines=e("#sp-brackets-headlines"),this.$news_data_container=e("#sp-brackets-headlines-data"),this.news_count=e("#sp-brackets-headlines-data").data("count"),this.news_totalcount=0,this.news_offset=0,this.$news_data_loader=e("#sp-brackets-headlines-loader"),this.news_max_reached=!1,this.news_url="/sports/services/brackets-news/"+this.news_count+"/"+this.news_offset+"/",this.news_counter=this.news_count,this.pause_infinite_scroll=!1,this.$bracket_header_element=e(".sp-brackets-header"),this.auto_refresh=this.$bracket_header_element.data("autorefresh"),this.$bracket_grid_element=e(".sports-bracket-grid"),this.$bracket_data_element=e("#sp-bracket-data"),this.bracket_league=this.$bracket_data_element.data("league"),this.bracket_season=this.$bracket_data_element.data("season"),this.bracket_data_url="/sports/services/brackets-realtime/"+this.bracket_league+"/"+this.bracket_season+"/",this.$bracket_boxscore_data_element=e("#sp-bracket-boxscore-data"),this.bracket_boxscore_league=this.$bracket_boxscore_data_element.data("league"),this.bracket_boxscore_season=this.$bracket_boxscore_data_element.data("season"),this.bracket_boxscore_eventid=this.$bracket_boxscore_data_element.data("eventid"),this.bracket_boxscore_data_url="/sports/services/brackets-boxscore-realtime/"+this.bracket_boxscore_league+"/"+this.bracket_boxscore_season+"/"+this.bracket_boxscore_eventid+"/",this.refreshBracketInterval=!1,this.refreshBoxscoreInterval=!1,this.$news_data_container.length>0&&this.getNews(this.news_url),n.stopRefreshTimer(),this.$bracket_header_element.length>0&&"yes"===this.auto_refresh&&(this.$bracket_boxscore_data_element.length>0&&this.refreshBoxscoreData(),this.$bracket_data_element.length>0&&this.refreshBracketData()),this.$share_count_element.length>0&&(this.getShareCount(),this.loadShareScripts()),this.$skinLink=this.$el.parent().data("skin-link"),this.$skinLink&&this.$(".sp-brackets-sponsor-logo").attr("href",this.$skinLink)},refreshBracketData:function(){this.refreshBracketInterval=setInterval(t.bind(function(){var t=this.bracket_data_url;n.fetchHtml(t).done(function(t){e("#sp-bracket-data").empty(),e("#sp-bracket-data").html(t)}).fail(function(){console.log("bracket data failed")})},this),9e4)},refreshBoxscoreData:function(){this.refreshBoxscoreInterval=setInterval(t.bind(function(){var t=this.bracket_boxscore_data_url;n.fetchHtml(t).done(function(t){e("#sp-bracket-boxscore-data").empty(),e("#sp-bracket-boxscore-data").html(t)}).fail(function(){console.log("boxscore data failed")})},this),9e4)},getShareCount:function(){var e=this.share_counts_url;n.fetchHtml(e).done(t.bind(function(e){this.$share_count_element.empty(),this.$share_count_element.html(e)},this)).fail(t.bind(function(){console.log("sharethis count failed")},this))},loadShareScripts:function(){require([this.share_this_api],t.bind(function(){"undefined"!=typeof window.stLight?(window.stLight.options({publisher:"df703b24-a0ff-41d1-93f3-b4ce80edef4b",doNotHash:!1,doNotCopy:!0,hashAddressBar:!1,newOrZero:"zero",onhover:!1,shorten:!0,servicePopup:!0,tracking:!0}),window.stButtons.locateElements()):console.log("Error loading ShareThis!")},this))},setRefreshRate:function(){n.stopRefreshTimer(),n.REFRESH_FREQUENCY=9e4,n.startRefreshTimer()},scrollTo:function(t){t.preventDefault();var i=e(t.currentTarget),s="#"+i.data("id");e("html,body").animate({scrollTop:e(s).offset().top},1e3)},hoverOn:function(t){var i=e(t.currentTarget);i.fadeIn("slow").animate({backgroundColor:"#E2E2E2"},300)},hoverOff:function(t){var i=e(t.currentTarget);i.hasClass("islive")?i.fadeIn("slow").animate({backgroundColor:"#fef9d3"},300):i.fadeIn("slow").animate({backgroundColor:"#FBFBFB"},300)},getNews:function(i){n.fetchHtml(i).done(t.bind(function(t){this.$news_data_loader.hide(),this.$news_data_container.append(t),e(t).length>0&&(this.news_totalcount=parseInt(e(t).data("totalcount"),10),this.news_count<this.news_totalcount&&(this.updateNewsUrl(),this.initInfiniteScroll()))},this)).fail(t.bind(function(){this.$news_data_container.append("<p>We're sorry. An error has occurred please try again later.</p>")},this))},getMoreNews:function(){this.$news_data_loader.show();var i=this.newsUrl;n.fetchHtml(i).done(t.bind(function(t){this.$news_data_loader.hide(),e(t).length>0?(this.$news_data_container.append(t),this.updateNewsUrl(),this.pause_infinite_scroll=!1,this.news_counter=this.news_counter+this.news_count,this.news_counter>=this.news_totalcount&&(this.news_max_reached=!0)):this.news_max_reached=!0},this)).fail(t.bind(function(){this.$news_data_container.append("<p>We're sorry. An error has occurred please try again later.</p>")},this))},updateNewsUrl:function(){this.news_offset=parseInt(this.news_offset+this.news_count,10),this.newsUrl="/sports/services/brackets-news/"+this.news_count+"/"+this.news_offset+"/"},initInfiniteScroll:function(){e(window).scroll(t.bind(function(){e(window).scrollTop()>=e(document).height()-700-e(window).height()&&this.news_max_reached===!1&&this.pause_infinite_scroll===!1&&(this.pause_infinite_scroll=!0,this.getMoreNews())},this))},destroy:function(){this.refreshBracketInterval!==!1&&(clearInterval(this.refreshBracketInterval),this.refreshBracketInterval=!1),this.refreshBoxscoreInterval!==!1&&(clearInterval(this.refreshBoxscoreInterval),this.refreshBoxscoreInterval=!1),clearInterval(this.refreshBoxscoreInterval),e(".cards").removeClass("sports-brackets"),o.prototype.destroy.call(this)}});return a}),define("modules/sports/sports-twitter",["jquery","underscore","state","baseview","modules/scroller/sidebar-scroll"],function(e,t,i,s,n){"use strict";var o=s.extend({events:{"click .sports-twittertab-option":"twitterTabClicked"},initialize:function(i){return i=e.extend({num_tweets:null,twitter_id:null,layoutType:null,refreshInterval:3e4,failureRefreshInterval:6e4,twitter_cache:12e3},i),"sidebar"===this.options.layoutType&&this.onHideSidebarAd(),this.$twitterTabs=e(".sports-twitter-module .front-gallery-item, .sports-twitter-data"),t.bindAll(this,"createTweetsHTML","loadTweets","twitterTabClicked"),this.twitter_el=this.$(".tweet-list"),this.update=!1,this.continueRefresh=!0,this.handles=e(this.$twitterTabs[0]).attr("tab-target-handles"),this.hashtags=e(this.$twitterTabs[0]).attr("tab-target-hashtags"),this.refreshInterval=e(this.$twitterTabs[0]).attr("tab-target-refresh-rate")||i.refreshInterval,this.failureRefreshInterval=this.twitter_el.attr("data-twitter-failure-refresh-rate")||i.failureRefreshInterval,this.twitter_cache=this.twitter_el.attr("data-twitter-cache-ttl")||i.twitter_cache,this.selectedTab=1,this.$primary=e(".sports-twitter-module .sports-twitter-primary"),this.$suspender=e(".sports-twitter-module .sports-twitter-suspender"),this.$viewport=e(".sports-twitter-module .twitter-scroll-content"),this.row_size=this.options.row_size||this.twitter_el.attr("data-row-size"),this.num_tweets=this.options.num_tweets||this.twitter_el.attr("data-num-tweets"),this.twitterID=i.twitter_id||this.twitter_el.attr("data-twitter-id"),this.twitterID?(this.addscrollBar(),this.loadTweets(),void s.prototype.initialize.call(this,i)):void this.$el.hide()},twitterTabClicked:function(t){this.refreshID&&clearTimeout(this.refreshID);var i=e(t.currentTarget);t.preventDefault(),this.$twitterTabs.removeClass("selected"),i.addClass("selected"),this.refreshInterval=i.attr("tab-target-refresh-rate"),this.handles=i.attr("tab-target-handles"),this.hashtags=i.attr("tab-target-hashtags"),this.twitter_el.html(""),e(".sports-twitter-module .scrollable-content").outerHeight(e(".tweet-list")[0].scrollHeight),this.update=!1,this.refreshScrollbar(),this.$viewport.addClass("loading"),this.loadTweets()},refreshScrollbar:function(){this.scrollbar&&(this.scrollbar.refresh(),this.update===!1&&this.scrollbar.moveDraggerToPosition(0,0))},loadTweets:function(){this.tweetsLoaded=!0;var e=this.twitterID,s=this.num_tweets,n=this.row_size,o=this.createTweetsHTML,a=this.handles,r=this.hashtags,l=(this.refreshInterval,this.update,this.twitter_cache),h=a+"~~"+r,d="/sports/services/sportstwitter/json/"+e+"/"+s+"/"+n+"/"+l+"/"+h+"/";i.fetchHtml(d).done(o).fail(t.bind(function(){this.twitter_el.html("<div id='sports-no-tweets'>No tweets available.</div>"),o("TWITTER SERVER FAILURE")},this)).always(t.bind(function(){this.$viewport.removeClass("loading")},this))},stopRefresh:function(){this.continueRefresh=!1,this.refreshID&&clearTimeout(this.refreshID)},createTweetsHTML:function(t){if("TWITTER SERVER FAILURE"===t)this.continueRefresh&&"0"!=this.failureRefreshInterval&&(this.update=!0,this.refreshID=setTimeout(this.loadTweets,this.failureRefreshInterval));else{if(t&&String(t.html()).length>10){for(var i=e(this.twitter_el.html()),s=!1,n=e(t).find(".tweet"),o=e(i).find(".tweet"),a=0;a<e(n).length;a++)if(e(n[a]).html()!=e(o[a]).html()){s=!0;break}s&&(e(".sports-twitter-module .scrollable-content").outerHeight(0),this.refreshScrollbar(),this.twitter_el.html(t),e(".sports-twitter-module .scrollable-content").outerHeight(e(".tweet-list")[0].scrollHeight-150),this.refreshScrollbar());var r=this.timeAgo;t.find(".tweet_time_ago").each(function(t,i){e(i).html(r(e(i).html()))})}else e(".sports-twitter-module .scrollable-content").outerHeight(0),this.refreshScrollbar(),this.twitter_el.html("<div id='sports-no-tweets'>No tweets available.</div>");this.continueRefresh&&"0"!=this.refreshInterval&&(this.update=!0,this.refreshID=setTimeout(this.loadTweets,this.refreshInterval))}},addscrollBar:function(){this.scrollbar=new n({el:e(".sports-twitter-module .twitter-scroll-content"),color:"dark",padding:2,lockPageScroll:!0,delayScroll:!1,fadeout:!0})},timeAgo:function(e){var t=new Date,i=new Date(e);i.getTime()||(i=Date.parse(e.replace(/( \+)/," UTC$1")));var s=t-i,n=1e3,o=60*n,a=60*o,r=24*a;return isNaN(s)||0>s?"":2*n>s?"right now":o>s?Math.floor(s/n)+" seconds ago":2*o>s?"about 1 minute ago":a>s?Math.floor(s/o)+" minutes ago":2*a>s?"about 1 hour ago":r>s?Math.floor(s/a)+" hours ago":s>r&&2*r>s?"yesterday":365*r>s?Math.floor(s/r)+" days ago":"over a year ago"},destroy:function(e){e&&this.twitter_el.empty(),this.stopRefresh(),s.prototype.destroy.call(this)}});return o}),define("modules/sports/sports-front-galleries",["jquery","underscore","baseview","pubsub","modules/stories/share-facebook","modules/fronts/front-galleries","modules/sports/sports-front-carousel","ui/loader","directAdPosition"],function(e,t,i,s,n,o,a,r,l){"use strict";var h=o.extend({sponsorshipAdThrottled:!1,events:function(){var e=o.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .util-bar-flyout-nav-btn":"onClickFlyoutNavBtn","click .gallery-sidebar-close":"closeSidebar","click .fullscreen":"launchFullscreen","click .sidebar-gallery-btn, .thumb-link":"clickPhoto"})},initialize:function(o){if(this.$primary=e(".sports-front-galleries-primary"),this.$module=e(".sports-front-galleries-module"),this.$closer=this.$(".gallery-sidebar-close"),this.$sidebar=this.$(".gallery-sidebar-ad"),this.$counter=e(".gallery-count"),this.$toolbox=this.$(".gallery-sidebar-toolbox"),this.$cardfilm=e(".front-card-film"),this.$cardcolor=e(".card-suspender-color"),this.$suspender=e(".sports-front-galleries-suspender"),this.$(".front-gallery.snapshot-placeholder").remove(),this.$galleries=this.$(".front-gallery"),this.$navItems=this.$(".js-fgs-item"),this.overrideTaboola=this.$(".js-fg-nav-list").data("taboolaOverride")?!0:!1,this.currentGallery=this.$(".fgpfm-gallery.front-gallery.selected").attr("id"),this.$titles=this.$(".gallery-sidebar-title"),this.$partnerSlot=e(".companion-galleries-partner-slot"),
this.$sidebarBtn=this.$(".sidebar-gallery-btn"),t.bindAll(this,"switchGallery","setupAd","refreshAd","sidebarAds","resetGallery","clickPhoto"),i.prototype.initialize.call(this,{}),s.on("carousel:switchSlide",t.bind(function(){this.refreshAd()},this)),s.on("gallery:hideSidebar",t.bind(function(){this.hideSidebar()},this)),this.subviews.loader=new r({el:this.$galleries.parent()}),this.$galleries.find(".slide.active").length){var l=this.$(".front-gallery.selected"),h=this.$(".front-gallery");this.subviews["gallery"+h.index(l)]=new a({ads:!0,linkPath:this.$navItems.filter(".selected").find("a").attr("href"),el:l.find(".galleries"),fullScreen:!0,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds}),this.empty=!1}else{var d=this.$navItems.first().find("a").attr("href");"undefined"!=typeof d&&d.length>1&&this.fetchData(d,0,this.switchGallery)}this.$(".util-bar-flyout-section").hide(),this.subviews.facebook=new n({el:this.$(".util-bar-flyout-share")})},_initializeAds:function(){this.$sponsorshipAd||(this.$sponsorshipAd=e('<div class="partner-placement poster" data-monetization-id="sp-gallery" data-monetization-sizes="mediumrectangle"></div>'),this.$partnerSlot.append(this.$sponsorshipAd))},renderCardInfo:function(e){this.currentCardInfo=e},onCardWidthChange:function(e){this.currentCardInfo=e,this.sidebarAds()?(this.setupAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:cardfilmActive")):(this.teardownAd(),this.$sidebar.hasClass("active")&&s.trigger("carousel:sidebarClosed"))},sidebarAds:function(){return this.currentCardInfo?this.currentCardInfo.sidebarAds:!1},switchGallery:function(t,i,s){var n=this.$galleries.eq(i);this.$galleries.removeClass("selected"),n.addClass("selected");var o=this.$toolbox.eq(i);this.$toolbox.length>1&&this.$toolbox.removeClass("selected"),o.addClass("selected"),this.$(".util-bar-flyout-nav-btn").removeClass("active");var r=this.$titles.eq(i);this.$titles.length>1&&this.$titles.removeClass("selected"),r.addClass("selected");var l=this.$(".gallery-sidebar-ad .caption"),h=n.find(".active .gallery-viewport-caption").html();if(this.resetSections(),l.html(h),t){n.html(t);var d='<div class="gallery-count"><div>'+n.find(".thumb-item").length+'</div><div class="line">Photos</div></div>';n.append(d),this.$counter=e(".gallery-count")}if(this.subviews["gallery"+i])this.trackGalleryChange(this.subviews["gallery"+i]),this.subviews["gallery"+i].subviews.gallery&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd&&this.subviews["gallery"+i].subviews.gallery.refreshSportsSponsorshipAd(),this.teardownAd(),this.setupAd();else{var c=this.subviews["gallery"+i]=new a({ads:!0,el:n.find(".galleries"),fullScreen:!0,linkPath:s,onSidebarAfterReveal:this.setupAd,sidebarAds:this.sidebarAds});this.empty||(this.trackGalleryChange(c),this.empty=!1)}n.css({opacity:0}),this.animate(n,"opacity",1,200)},launchFullscreen:function(){e(".front-gallery.selected .fullscreen").click()},setupAd:function(){var e=this.$(".front-gallery").index(this.$(".front-gallery.selected"));if(this.sidebarAds()){this.adSetup=!0,this._initializeAds();var t={};this.subviews["gallery"+e].subviews.gallery&&this.subviews["gallery"+e].subviews.gallery.getAdTargeting&&(t=this.subviews["gallery"+e].subviews.gallery.getAdTargeting());var i=this.$(".front-gallery.selected .galleries").data();this.subviews.sponsorshipAd=new l({el:this.$sponsorshipAd,adPlacement:"poster_gallery_companion",adSizes:["mediumrectangle"],targeting:t,subSection:i.cst})}},onClickFlyoutNavBtn:function(t){var i=e(t.currentTarget),n=e(t.currentTarget).data("share-method"),o=e(t.currentTarget).data("share-title"),a=e(t.currentTarget).data("share-link"),r="SportsGallery"+n;s.trigger("uotrack",r),n&&this.showSection(i.parent().parent(),n),this.$closer.hasClass("active")||(this.$closer.addClass("active"),this.$cardfilm.removeClass("inactive"),this.$module.css("z-index",501),this.$suspender.css("background-color",this.$cardcolor.css("background-color"))),"facebook"==n&&(this.$(".util-bar-share-message-facebook").data("link",a),this.$(".util-bar-share-message-facebook").data("title",o),this.resetSections(),this.$(".gallery-sidebar-ad .caption").empty(),this.subviews.facebook.onClickPostBtn(t),t.preventDefault())},showSection:function(e,t){this.resetSections(),this.activeSection=t,this.$(".util-bar-flyout-nav-btn-"+t).addClass("active")},resetSections:function(){this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$(".util-bar-flyout-pane-success").hide()},resetGallery:function(){this.resetSections(),this.$primary.removeClass("active"),this.$closer.removeClass("active"),this.$cardfilm.addClass("inactive"),this.$sidebar.removeClass("active"),this.$module.css("z-index","auto")},closeSidebar:function(e){e&&(e.preventDefault(),e.stopPropagation());var i=(parseInt(this.$sidebar.outerWidth()+1,10),null);this.$sidebar.hasClass("active")&&(s.trigger("carousel:sidebarClosed"),this.$(".util-bar-flyout-nav-btn").removeClass("active"),i=this.animate(this.$sidebar,"right",0,250,"ease-in-out"),i.done(t.bind(function(){this.resetGallery()},this)),this.teardownAd()),this.$sidebarBtn.addClass("active")},hideSidebar:function(){parseInt(this.$sidebar.outerWidth()+1,10);this.$sidebar.hasClass("active")&&(this.$(".util-bar-flyout-nav-btn").removeClass("active"),this.$sidebar.css({right:0,transition:""}),this.resetGallery(),this.teardownAd())},refreshAd:function(){this.subviews.sponsorshipAd&&this.subviews.sponsorshipAd.refreshPosition&&!this.sponsorshipAdThrottled&&(this.subviews.sponsorshipAd.refreshPosition(),this.sponsorshipAdThrottled=!0,setTimeout(t.bind(function(){this.sponsorshipAdThrottled=!1},this),2e3))},teardownAd:function(){this.subviews.sponsorshipAd&&this.adSetup&&(delete this.adSetup,this.$sponsorshipAd.empty(),this.subviews.sponsorshipAd.destroy(),delete this.subviews.sponsorshipAd)},clickPhoto:function(e){if(this.$sidebarBtn.hasClass("active")){e&&(e.preventDefault(),e.stopPropagation());var t=this.$(".front-gallery.selected"),i=this.$(".front-gallery");this.subviews["gallery"+i.index(t)].openSidebar(),this.$closer.addClass("active"),this.$sidebarBtn.removeClass("active"),this.$primary.hasClass("active")||this.$primary.addClass("active"),this.$cardfilm.removeClass("inactive")}},destroy:function(e){s.off("carousel:switchSlide"),s.off("gallery:hideSidebar"),o.prototype.destroy.call(this,e)}});return h}),define("blog/blog-list",["jquery","underscore","backbone","state","modules/global/brightcove-video","baseview"],function(e,t,i,s,n,o){"use strict";var a=o.extend({el:".blog-list-module",events:{"click .button-add-content":"showMore"},initialize:function(e){this.subviews=this.subviews||{},this.readMoreBlogsNumber=this.$(".button-add-content").data("next")},getMoreBlogs:function(e){s.fetchHtml(window.location.pathname+e+"/new").done(t.bind(function(e){this.applyBlogPosts(e)},this)).fail(t.bind(function(){this.$button.removeClass("loading").addClass("inactive").text("No more posts")},this))},showMore:function(t){return e(t.target).hasClass("inactive")?!1:(this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading")),this.getMoreBlogs(this.readMoreBlogsNumber),void t.preventDefault())},applyBlogPosts:function(e){e.find(".blpm-post").removeClass("active").addClass("inactive"),e.find(".button-add-content");this.$(".blpm-all-articles").append(e),this.readMoreBlogsNumber++,this.$button.removeClass("loading").text(this.$button.attr("data-default"))}});return a}),define("modules/topics/topics-photo-gallery",["jquery","underscore","baseview","utils","pubsub","modules/scroller/horizontal-scroll","modules/scroller/vertical-scroll","site-manager","state","meteredAdPosition"],function(e,t,i,s,n,o,a,r,l,h){var d=i.extend({events:{"click .tpapgm-gallery-nav-next":"_onClickNext","click .tpapgm-gallery-nav-previous":"_onClickPrev","click .tpapgm-collage-link":"_onClickMosaic","click .tpapgm-gallery-slide-link":"_onClickSlide","click .tpapgm-gallery-nav-close":"_onClickClose","click .tpapgm-gallery-nav-fullscreen":"_onClickFullScreen","click .tpapgm-gallery-thumbs-item-link":"_onClickThumb"},selectors:{slides:".tpapgm-gallery-slide:not(.tpapgm-gallery-slide-partner-ad)",slideImage:".tpapgm-gallery-slide-image",thumb:".tpapgm-gallery-thumbs-item"},initialize:function(n){t.bindAll(this,"_handleKeyPress","_onClickThumb","refreshScrollbar"),n=e.extend({enableGalleryAds:!0,debounceSpeed:0,captionsEnabled:!0,thumbsLocation:"top",thumbWidth:80,thumbHeight:45},n),this.$doc=s.get("document"),this.$body=s.get("body"),this.$win=s.get("win"),this.$moduleWrap=this.$(".tpapgm-module-wrap"),this.$gallery=this.$(".tpapgm-gallery-wrap"),this.$collageWrap=this.$(".tpapgm-collage-wrap"),this.$slidesWrap=this.$(".tpapgm-gallery-slides-wrap"),this.$slidesItemsWrap=this.$(".tpapgm-gallery-slides-items-wrap"),this.$arrowNext=this.$(".tpapgm-gallery-nav-next"),this.$arrowPrev=this.$(".tpapgm-gallery-nav-previous"),this.$closeBtn=this.$(".tpapgm-gallery-nav-close"),this.$caption=this.$(".tpapgm-gallery-caption"),this.totalPhotos=this.$gallery.data("total-photos"),this.activeClass="tpapgm-gallery-slide-active",this.loadingClass="tpapgm-gallery-slide-loading",this.fullscreenClass="tpapgm-gallery-wrap-fullscreen",this.fetchingImages=!1,this.$thumbsWrap=this.$(".tpapgm-gallery-thumbs-wrap"),this.$thumbsList=this.$(".tpapgm-gallery-thumbs-list"),this.thumbTemplate=this.$(".tpapgm-thumb-template").html(),this.thumbActiveClass="tpapgm-gallery-thumbs-item-active",this.slidesCount=this.$(this.selectors.slides).length,this.activeIndex=1,this.adActiveClass="slide-partner-active",this.arrowDebounce=t.debounce(function(e){this.goToSlide(e)},n.debounceSpeed,!0),i.prototype.initialize.call(this,n),this._bindKeys(),n.enableGalleryAds&&this._initializeAds()},_initializeAds:function(){var e=l.getActivePageInfo();this.$adSlide=this.$(".tpapgm-gallery-slide-partner-ad"),this.$adContents=this.$(".tpapgm-gallery-slide-partner-ad .partner-placement"),this.showingAd=!1,this.subviews.ad=new h({el:this.$adContents,adPlacement:"transition_gallery",adSizes:["elastic"],meterThreshold:"transition_gallery",rateMeterId:"topic_"+e.topic})},shouldShowAd:function(){return!this.showingAd&&this.subviews.ad&&this.subviews.ad.shouldShowAd()},setAdDimensions:function(){this.subviews.ad.resizeAd(this.$adSlide.width(),this.$adSlide.height())},_updateSlidesCount:function(){return this.slidesCount=this.$(this.selectors.slides).length,this.slidesCount},_getActiveSlide:function(){return this.$(this.selectors.slides).eq(this.activeIndex)},_setActiveSlide:function(e){this.activeIndex=e;var t=this._getActiveSlide();return t.addClass(this.activeClass),t},openGallery:function(e){this._setActiveSlide(e),this._updateSlide(),this.lazyLoadPhotos(),this.$collageWrap.hide(),this.$gallery.show(),this._bindKeys(),this.loadThumbs(),this._trackSlideChange(),this.subviews.ad&&this.subviews.ad.setInitialDimensions(this.$adSlide.width(),this.$adSlide.height())},openFullScreen:function(){n.trigger("topicgallery:open"),this.$gallery.addClass(this.fullscreenClass),this.$body.css("overflow","hidden"),this.lazyLoadPhotos(),r.getHeader().setClosedFixed(!0),this.refreshScrollbar(),this.fetchImages(),this.$win.on("resize."+this.cid,t.throttle(this.refreshScrollbar,2e3,{leading:!1,trailing:!1})),this.subviews.ad&&this.setAdDimensions()},refreshScrollbar:function(){this.subviews.scrollbar.refresh()},lazyLoadPhotos:function(){var t=this._getActiveSlide(),i=t.find("img"),n=t.prevAll("*:lt(2)").find("img"),o=t.nextAll("*:lt(2)").find("img"),a=this._isFullScreen()?"data-src-large":"data-src",r=this.loadingClass;this.$(this.selectors.slides+"."+r).removeClass(r),i=i.add(n).add(o);var l=function(t){e(t).closest(".tpapgm-gallery-slide").removeClass(r)};s.lazyLoadImage(i,a,!0,null,l)&&i.each(function(t,i){e(i).closest(".tpapgm-gallery-slide").addClass(r)})},loadThumbs:function(){for(var e=this.$(this.selectors.slides),i=t.template(this.thumbTemplate),s=this.$thumbsWrap.data("pos"),n=this.$thumbsList.find(this.selectors.thumb).length,r=n;r<this.slidesCount;r++){var l=e.eq(r).find(this.selectors.slideImage),h=i({active:r==this.activeIndex?this.thumbActiveClass:"",thumbSrc:l.data("thumb-src"),alt:l.data("caption"),current:r+1,total:this.totalPhotos});this.$thumbsList.append(h)}this.subviews.scrollbar?this.refreshScrollbar():"top"==s||"bottom"==s?this.subviews.scrollbar=new o({el:this.$thumbsWrap,color:"light",draggerPaddingLeft:4,draggerPaddingRight:4}):this.subviews.scrollbar=new a({el:this.$thumbsWrap,color:"light",draggerPaddingTop:10,draggerPaddingBottom:0}),this.subviews.scrollbar.scrollToElement(this.$("."+this.thumbActiveClass),!0,0,"linear")},closeGallery:function(){n.trigger("topicgallery:close"),this._isFullScreen()&&(this.$body.css("overflow","auto"),this.$gallery.removeClass(this.fullscreenClass),this.lazyLoadPhotos(),r.getHeader().restoreLastState(),this.refreshScrollbar(),this.$win.off("."+this.cid),this.subviews.ad&&this.setAdDimensions())},nextSlide:function(){this.activeIndex+1<this.slidesCount&&this.arrowDebounce(this.activeIndex+1)},previousSlide:function(){0!==this.activeIndex&&this.arrowDebounce(this.activeIndex-1)},goToSlide:function(e){var t=this.$(this.selectors.slides),i=this._getActiveSlide(),s=t.eq(e),n=this.shouldShowAd();this.showingAd?(this.subviews.ad.stopAd(),this.subviews.ad.refreshPosition(),this.showingAd=!1,this.$adSlide.hide(),this.$gallery.removeClass(this.adActiveClass)):(i.removeClass(this.activeClass),i.hide()),n?(this.showingAd=!0,this.subviews.ad.show(),this.subviews.ad.playAd(),this.$gallery.addClass(this.adActiveClass),this.$adSlide.show()):(s.show(),this._setActiveSlide(e),this._updateSlide(),this._selectThumb(this.activeIndex),this.lazyLoadPhotos(),this._trackSlideChange()),e>=t.length-10&&!this.fetchingImages&&this.fetchImages()},_selectThumb:function(e){var t=this.$thumbsList.find(this.selectors.thumb).eq(e);t.addClass(this.thumbActiveClass).siblings().removeClass(this.thumbActiveClass),this.subviews.scrollbar.scrollToElement(t,!0,400,"ease-out")},_updateArrows:function(){0===this.activeIndex?this.$arrowPrev.hide():this.$arrowPrev.show(),this.activeIndex<this.slidesCount-1?this.$arrowNext.show():this.$arrowNext.hide()},_updateCaption:function(){var e=this._getActiveSlide().find(this.selectors.slideImage),t=e.data("caption")+' <span class="tpapgm-gallery-captions-credit">'+e.data("credit")+"</span>";this.$caption.html(t)},_updateSlide:function(){this._updateArrows(),this.options.captionsEnabled&&this._updateCaption()},_trackSlideChange:function(){var e={gallery_id:l.getActivePageInfo().topic,gallery_title:this.$gallery.attr("data-title"),gallery_index:this.activeIndex,slide_id:this._getActiveSlide().find("img").attr("data-id"),ssts:this.$gallery.attr("data-ssts"),cst:this.$gallery.attr("data-cst"),contenttype:l.getActivePageInfo().contenttype+"-gallery",pathName:this.$gallery.attr("data-gallery-path")};n.trigger("slide:change",e),l.fetchData("/comscorepvcandidate.xml",{cache:!1},!1,!0,!1)},fetchImages:function(){this.fetchingImages=!0;var e=this.$(this.selectors.slides).last();if(e.attr("data-more-photos-path")){var i="/topic/ajax/photos/?path="+encodeURIComponent(e.data("more-photos-path"));l.fetchHtml(i).done(t.bind(function(t){t.appendTo(this.$slidesWrap),this._updateSlidesCount(),this._updateSlide(),this.loadThumbs(),e.removeAttr("data-more-photos-path"),this.fetchingImages=!1},this))}},_isFullScreen:function(){return this.$gallery.hasClass(this.fullscreenClass)},_onClickNext:function(e){this.nextSlide()},_onClickPrev:function(e){this.previousSlide()},_onClickSlide:function(t){return e(t.currentTarget).closest(".tpapgm-gallery-slide-partner-ad").length?!1:void this.nextSlide()},_onClickMosaic:function(t){this.openGallery(e(t.currentTarget).index())},_onClickClose:function(e){this.closeGallery()},_onClickFullScreen:function(e){this.openFullScreen()},_onClickThumb:function(t){this.arrowDebounce(e(t.currentTarget).closest(this.selectors.thumb).index())},_bindKeys:function(){this.$gallery.is(":visible")&&this.$doc.on("keydown."+this.cid,this._handleKeyPress)},_handleKeyPress:function(e){return 37===e.keyCode&&this.$arrowPrev.is(":visible")?(this.$arrowPrev.trigger("click"),!1):39===e.keyCode&&this.$arrowNext.is(":visible")?(this.$arrowNext.trigger("click"),!1):27===e.keyCode&&this._isFullScreen()?(this.$closeBtn.trigger("click"),!1):!0},destroy:function(e){this.$doc.off("."+this.cid),this.$win.off("."+this.cid),i.prototype.destroy.apply(this,arguments)}});return d}),define("modules/longform/longform-sponsorship",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({logoTemplate:'<div class="sponsored-by-text"><%= sponsoredByText %></div><div class="top-series-bucket-header-sponsor"><img src="<%= imageLogo %>" alt="<%= imageLogoAlt %>"></div>',initialize:function(t){t=e.extend({imageSkinLeft:null,imageSkinRight:null,clickThru:null,imageLogo:null,imageLogoAlt:null,sponsoredByText:"sponsored by:"},t),i.prototype.initialize.call(this,t),this.$adWrapper=this.$(".top-series-bucket-header-sponsor-wrapper"),this.$header=this.$(".top-series-bucket-header"),this.render()},destroy:function(e){this.$logo&&(this.$logo.remove(),this.$logo=null),i.prototype.destroy.call(this,e)},render:function(){this.setupLogo(),this.showBar()},setupLogo:function(){this.$header.height()>30&&this.$adWrapper.css("margin-top",this.$header.height()/2-this.$adWrapper.height()/2),this.$logo=e(t.template(this.logoTemplate,this.options)),this.$adWrapper.html(this.$logo)},showBar:function(){this.$adWrapper.removeClass("hidden"),this.$header.removeClass("hidden")}});return s}),define("modules/longform/longform-featured-series",["jquery","underscore","baseview","utils","sharedAdPosition","state","modules/longform/longform-sponsorship"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({el:".longform-top-series-bucket",events:{"click .top-series-bucket-prev":"doPrevTransition","click .top-series-bucket-next":"doNextTransition"},initialize:function(n){t.bindAll(this,"onAdReady"),this.$win=s.get("win"),n=e.extend({adPlacement:"poster",adSizes:["mediumrectangle"],adType:"sponsorship",defaultPosition:!0},n),this.$sponsorshipAd=this.$(".poster-ad"),this.$seriesBucketSet=this.$(".top-series-bucket-item-set"),this.$seriesBucketItem=this.$("div.top-series-bucket-item"),this.$seriesBucketNext=this.$(".top-series-bucket-next"),this.$seriesBucketPrev=this.$(".top-series-bucket-prev"),this.$currentSeriesArticleArrow=this.$(".arrow-down"),this.$seriesBucketPrev.addClass("inactive-item-prev"),this.$seriesBucketWrapper=this.$(".top-series-bucket-wrapper"),this.$seriesBucketArrow=this.$(".arrow-wrapper"),this.$seriesBucketItemTitle=this.$(".top-series-bucket-item-title"),this.$seriesBucketItemWrap=this.$(".top-series-bucket-item-wrapper"),this.$bucketItemPadding=40*this.$seriesBucketItem.length,this.$widthOfBucket=this._setSeriesSetWidth(),this._setSeriesHeight(),this._findCurrent(),i.prototype.initialize.call(this,n),this.$seriesBucketItem.length>3&&this._calcNavArrowSpacing(),this._buildAd()},doNextTransition:function(e){this.$seriesBucketNext.addClass("inactive-item-next"),this.$seriesBucketPrev.addClass("inactive-item-prev");var t=this,i=parseInt(this.$seriesBucketSet.css("left"),10)-300;this.$widthOfBucket-900===Math.abs(i)?this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketPrev.removeClass("inactive-item-prev")}):this.$widthOfBucket-600>Math.abs(i)&&this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketNext.removeClass("inactive-item-next"),t.$seriesBucketPrev.removeClass("inactive-item-prev")})},doPrevTransition:function(e){this.$seriesBucketPrev.addClass("inactive-item-prev"),this.$seriesBucketNext.addClass("inactive-item-next");var t=this,i=parseInt(this.$seriesBucketSet.css("left"),10)+300;0===i?this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketNext.removeClass("inactive-item-next")}):300!==i&&this.animate(this.$seriesBucketSet,"left",i,300,"ease-out").done(function(){t.$seriesBucketPrev.removeClass("inactive-item-prev"),t.$seriesBucketNext.removeClass("inactive-item-next")})},_calcNavArrowSpacing:function(e){this.$seriesBucketPrev.css("margin-left",(this.$win.width()-850)/2-100),this.$seriesBucketNext.css("margin-right",(this.$win.width()-850)/2-100),this.$seriesBucketPrev.removeClass("hidden"),this.$seriesBucketNext.removeClass("hidden")},_setSeriesSetWidth:function(){var e=this.$seriesBucketItem.width()*this.$seriesBucketItem.length+this.$bucketItemPadding,t=e;return this.$seriesBucketSet.css("width",t),this.$seriesBucketSet.removeClass("hidden"),e},_setSeriesHeight:function(){var t=this.$seriesBucketWrapper.height(),i=parseInt(this.$seriesBucketArrow.css("top")),s=this.$seriesBucketItem.length,n=0;this.$seriesBucketItemTitle.each(function(){var t=e(this).height();return t>195?!1:void(n+=1)}),n==s&&(t-=24,i-=24,this.$seriesBucketWrapper.css("height",t),this.$seriesBucketArrow.css("top",i))},_findCurrent:function(){var t=0,i=this.$seriesBucketItem.length,s=this;i>3&&this.$seriesBucketItemWrap.each(function(){return e(this).data("currentarticle")&&i-3>t?(s.$seriesBucketSet.css("left",-300*t),t>=1&&s.$seriesBucketPrev.removeClass("inactive-item-prev"),!1):e(this).data("currentarticle")&&3>=i-t?(s.$seriesBucketSet.css("left",-300*(i-3)),s.$seriesBucketNext.addClass("inactive-item-next"),s.$seriesBucketPrev.removeClass("inactive-item-prev"),!1):void(t+=1)})},_buildAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorAd&&(this.subviews.sponsorAd=new n({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType,defaultPosition:this.options.defaultPosition,onAdReady:this.onAdReady}))},onAdReady:function(t,i){this.subviews.sponsorshipAd&&this.subviews.sponsorshipAd.destroy(),this.subviews.sponsorshipAd=new a(e.extend({el:o.getActiveApp().$(".longform-top-series-bucket")},t))}});return r}),define("modules/longform/longform-nav-rail-bucket",["jquery","underscore","baseview","pubsub","state","modules/scroller/vertical-scroll","third-party-apis/facebook/facebook","site-manager","utils"],function(e,t,i,s,n,o,a,r,l){var h=i.extend({el:".longform-series-flyout-bucket-wrapper",events:{"click .longform-series-flyout-bucket-icon, .longform-series-flyout-bucket-text":"openSeriesFlyout","click .longform-series-up":"onClickSeriesUp","click .longform-series-down":"onClickSeriesDown"},initialize:function(t){this.$win=l.get("win"),this.pubSub={closeSeriesFlyout:this.closeSeriesFlyout},this.$flyoutWindow=this.$(".longform-series-flyout"),this.$upBtn=e(".longform-series-up"),this.$downBtn=e(".longform-series-down"),this.$topGrad=e(".longform-series-grad-top"),this.$botGrad=e(".longform-series-grad-bot"),this.$seriesNavItem=this.$(".longform-series-item"),this.$seriesItemWrap=this.$(".longform-series-item-wrap"),this.$seriesOverflow=this.$(".longform-series-overflow-wrap"),this.seriesCount=0,this.seriesOverflowPos=0,this.seriesHeights=[],this.calcHeightBool=!1,this.availableVertSpace=this.getAvailableVerticalSpace(),this.flyoutOptions={flyout:this.$flyoutWindow,icon:"longform-series-flyout-bucket",iconSpace:"105px",closeMethod:"closeSeriesFlyout"},i.prototype.initialize.call(this,t)},openSeriesFlyout:function(e){this.calcHeightBool||this._setSeriesWrapHeight(),s.trigger("openFlyout",this.flyoutOptions)},closeSeriesFlyout:function(){this.animate(this.$flyoutWindow,"right","-300px",200)},_setSeriesWrapHeight:function(){this.calcHeightBool=!0;var e=this.getSeriesHeights(),t=this.availableVertSpace;e>t?this.$seriesItemWrap.height(t):(this.$seriesItemWrap.height(e),this.$seriesOverflow.css({position:"inherit"}),this.$upBtn.hide(),this.$downBtn.hide(),this.$topGrad.hide(),this.$botGrad.hide())},getAvailableVerticalSpace:function(){var e=r.getHeader(),t=0;return e&&(t=e.getCollapsedHeight()),this.$win.height()-320},getSeriesHeights:function(){var t=0,i=this;return this.$seriesNavItem.each(function(s){i.seriesHeights.push(e(this).height()),t+=e(this).height()}),t},onClickSeriesDown:function(e){this.seriesOverflowPos+this.$seriesOverflow.height()-this.availableVertSpace>0&&(this.$upBtn.css("opacity","1"),this.animate(this.$seriesOverflow,"top",(this.seriesOverflowPos-=this.seriesHeights[this.seriesCount])+"px",100,"linear"),this.seriesCount++,this.seriesOverflowPos+this.$seriesOverflow.height()-this.availableVertSpace<0&&this.$downBtn.css("opacity",".5"))},onClickSeriesUp:function(e){this.seriesCount>0&&(this.$downBtn.css("opacity","1"),this.animate(this.$seriesOverflow,"top",(this.seriesOverflowPos+=this.seriesHeights[this.seriesCount])+"px",100,"linear"),this.seriesCount--,0===this.seriesCount&&this.$upBtn.css("opacity",".5"))}});return h}),define("modules/fronts/countdown-clock",["jquery","underscore","baseview","state","directAdPosition"],function(e,t,i,s,n){"use strict";var o=i.extend({timer:0,seconds:0,classes:{sponsor:"countdown-clock-ad"},initialize:function(t){t=e.extend({adPlacement:"sponsor_logo_countdown",adSizes:[100,50],countdownContainer:".countdown-clock-container",digitBoxes:".countdown-timer-digit-container .digit",digitContainer:".countdown-timer-digit-container"},t),this.options=t,this.$sponsorshipAd=this.$("."+this.classes.sponsor),this.layoutType=this._getLayoutType();var s=e(t.countdownContainer).attr("data-type-event_date");i.prototype.initialize.call(this,t),this.seconds=Math.round(new Date(s).getTime()/1e3)-Math.round((new Date).getTime()/1e3),this.$digitBoxes=this.$(t.digitBoxes),this.$digitContainer=this.$(t.digitContainer),this.$primaryTimer=e(".card-primary-suspender.countdown-clock-module"),this.$sidebarTimer=e(".card-sidebar.countdown-clock-module"),this.counterStart(),this.positionTimer()},_getLayoutType:function(){var e=null;return this.options.layoutType&&(-1!==this.options.layoutType.indexOf("primary")?e="primary":"sidebar"===this.options.layoutType&&(e="sidebar")),e},positionTimer:function(){this.$sidebarTimer.length||this.$primaryTimer.css("display","block")},renderCardInfo:function(e){e.sidebarOpen||"primary"!==this.layoutType?e.sidebarOpen&&"sidebar"===this.layoutType&&this._buildSponsorshipAd():(this.$primaryTimer.show(),this._buildSponsorshipAd()),this.currentCardInfo=e},_buildSponsorshipAd:function(){this.$sponsorshipAd.length&&!this.subviews.sponsorshipAd&&(this.subviews.sponsorshipAd=new n({el:this.$sponsorshipAd,adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:"sponsor_logo",pageInfo:s.getActivePageInfo()}))},openSideBar:function(){this.currentCardInfo&&this._buildSponsorshipAd()},onCardWidthChange:function(e){e.sidebarOpen!==this.currentCardInfo.sidebarOpen&&(this.currentCardInfo=e,e.sidebarOpen&&this.$sidebarTimer.length?"primary"===this.layoutType?this.$primaryTimer.hide():"sidebar"===this.layoutType&&this._buildSponsorshipAd():"primary"===this.layoutType&&(this.$primaryTimer.show(),this._buildSponsorshipAd()))},pad:function(e){for(var t=[],i=e.length;i>0;i--){var s=e[e.length-i]>9?e[e.length-i]:"0"+e[e.length-i];t.push(s.toString())}return t},updateTime:function(t){var i=Math.floor(t/86400),s=Math.floor(t/3600),n=Math.floor(t/60),o=Math.floor(t),a=i,r=s-24*i,l=n-60*s,h=o-60*n,d=0,c="",u=this.$digitContainer,p=this.pad([a,r,l,h]);this.$digitBoxes.each(function(t,i){if(void 0!==p[d]){var s=p[d].split("");t%2===0?e(i).text(s[0]):e(i).text(s[1]),t++,t%2===0&&d++}}),c=u.clone().first(),t--,u.slice(1).html(c.html())},decrementCounter:function(){this.updateTime(this.seconds),(0===this.seconds||isNaN(this.seconds))&&this.counterStop(),this.seconds--},counterStart:function(){clearInterval(this.timer),this.timer=setInterval(this.decrementCounter.bind(this),1e3)},counterStop:function(){clearInterval(this.timer)},destroy:function(e){this.counterStop(),i.prototype.destroy.call(this,e)}});return o}),define("modules/sports/sports-follow-usat",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({events:{},initialize:function(){i.prototype.initialize.apply(this,arguments),e(document).ready(this.followUSATOverlay)},followUSATOverlay:function(){var t=e(".sp-follow-usat-overlay-wrap");if(t.length>0){for(var i="",s="usatfollowus=",n=document.cookie.split(";"),o=0;o<n.length;o++){var a=n[o].trim();if(0===a.indexOf(s)){i=a.substring(s.length,a.length);break}}var r=new Date;r.setTime(r.getTime()+24*t.data("exp")*60*60*1e3);var l="expires="+r.toGMTString();switch(i){case"":document.cookie="usatfollowus=ready; "+l+"; path=/";break;case"ready":if(e(".follow-button-wrap.fb-wrap").length>0&&e(".follow-button-wrap.fb-wrap").append('<iframe src="//www.facebook.com/plugins/like.php?href=https%3A%2F%2Fwww.facebook.com%2Fusatodaysports&amp;width&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;share=false&amp;height=21&amp;appId=2530096808" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:21px; width:84px;" allowTransparency="true"></iframe>'),e(".follow-button-wrap.tw-wrap").length>0){if(e("#twitter-wjs").length>0)return;var h=/^http:/.test(document.location)?"http":"https",d=e("<script src='"+h+"://platform.twitter.com/widgets.js' id='twitter-wjs'>");e("head").append(d)}e("#follow-usat-box-details").css("top",e("#follow-usat-box-details").offset().top-100+"px"),e("#follow-usat-box-details").css("position","absolute"),e("#follow-usat-film").fadeIn(1e3,function(){e("#follow-usat-box-details").fadeIn(1e3)}),document.cookie="usatfollowus=shown; "+l+"; path=/",e(".sp-details-close").click(function(t){e(".sp-follow-usat-overlay-wrap").parent().remove()});break;case"shown":e(".sp-follow-usat-overlay-wrap").parent().remove();break;default:e(".sp-follow-usat-overlay-wrap").parent().remove()}}}});return s}),define("modules/topics/topics-share-tools",["jquery","underscore","baseview","third-party-apis/facebook/facebook"],function(e,t,i,s){var n=i.extend({events:{"click .tpa-social-icon-facebook":"onClickFB"},initialize:function(e){t.bindAll(this,"fbShareCallback"),i.prototype.initialize.call(this,e)},onClickFB:function(i){var n={method:"feed",caption:e(i.currentTarget).data("link"),link:e(i.currentTarget).data("link"),picture:e(i.currentTarget).data("image"),name:e(i.currentTarget).data("title"),description:e(i.currentTarget).data("description"),actions:[{name:e(i.currentTarget).data("link"),link:e(i.currentTarget).data("link")}]};s.loadScript().done(t.bind(function(){FB.ui(n,this.fbShareCallback)},this))},fbShareCallback:function(e){}});return n}),define("modules/newsletter-signup-condensed/newsletter-signup-condensed",["jquery","underscore","baseview","state","user-manager","pubsub","managers/cachemanager"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({validEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},events:{submit:"onFormSubmit","input .nscm-email":"validateEmail"},initialize:function(i){this.$nlTitle=this.$(".nscm-title"),this.$nlForm=this.$(".nscm-form"),this.$nlFormAction=this.$nlForm.attr("action"),this.$emailField=this.$(".nscm-email"),this.$businessUnitCode=this.$nlForm.data("business-unit"),this.$nlSubmit=this.$(".nscm-submit"),this.$ssts=this.$nlSubmit.data("ssts"),this.$nlMsgCard=this.$(".nscm-message-card"),this.$nlCardSuccess=this.$(".nscm-message-card .success"),this.$nlCardFailure=this.$(".nscm-message-card .fail"),this.userAccount=n.getAccount("firefly"),this.userAccount&&(this.userAccount.getUserInfo().done(t.bind(function(t){if(t.email)if(this.$currentUserEmail=t.email,this.$emailField.val(this.$currentUserEmail),this.$emailField.removeClass("invalid").addClass("valid"),this.newsletterLocal=a.getValue(this.$currentUserEmail+"_newsletter",null,1),this.newsletterLocal){var i=!1;e.each(this.newsletterLocal.subscriptions,function(t,s){e(".newsletter-"+s)||(i=!0)}),i||e(".nscm-container").show()}else a.clearValue(this.$currentUserEmail+"_newsletter"),s.fetchData(null,{
url:"/services/gemsapi/getuser/"+t.email+"/"+this.$businessUnitCode}).done(function(t){var i=!1;t.success===!0&&t.subscriptions&&(e.each(t.subscriptions,function(t,s){e(".newsletter-"+s)||(i=!0)}),i||e(".nscm-container").show())})},this)),this.userAccount.getUserInfo().fail(function(){e(".nscm-container").show()},this))},setSubscriptionsLocal:function(e,t){var i={subscriptions:t};a.setValue(e+"_newsletter",i,10)},onFormSubmit:function(e){if(e.preventDefault(),this.validateEmail(),this.validEmail(this.$emailField.val())){var i=[];i.push({id:this.$nlForm.data("newsletter-id"),signup:!0});var n=JSON.stringify(i);this.$emailField.removeClass("invalid").removeClass("valid").addClass("updating"),this.$emailField.prop("disabled",!0);var a=!1;this.userAccount&&this.userAccount.getUserInfo().always(t.bind(function(e){e&&"Not logged in."!==e&&(a=!0)},this)),s.fetchData(null,{type:"POST",url:this.$nlFormAction+this.$emailField.val()+"/"+this.$businessUnitCode+"/",data:{logged_in:a,newsletter_choices:n}}).done(t.bind(function(e){if(this.$emailField.removeClass("updating"),this.$nlForm.hide(),this.$nlMsgCard.show(),e.success===!0){this.$nlMsgCard.removeClass("fail").addClass("success"),this.$nlCardFailure.hide(),this.$nlCardSuccess.show(),this.$ssts=this.$ssts.replace(/,/g,":"),this.trackLabel="newsletterSignUp|";var t=[this.$nlForm.data("newsletter-id")];this.setSubscriptionsLocal(this.$currentUserEmail,t),o.trigger("track",{label:this.trackLabel})}else this.$nlMsgCard.removeClass("success").addClass("fail"),this.$nlCardFailure.show(),this.$nlCardSuccess.hide()},this))}},validateEmail:function(){this.$emailField.val()&&this.validEmail(this.$emailField.val())?this.$emailField.removeClass("invalid").addClass("valid"):this.$emailField.removeClass("valid").addClass("invalid")}});return r}),define("modules/weather/weather-dropdown",["jquery","underscore","backbone","baseview","pubsub","utils","state","form/autocomplete","easing","animatecolors","cookie"],function(e,t,i,s,n,o,a,r){"use strict";var l=s.extend({events:{mouseenter:"onMouseEnter",mouseleave:"onMouseLeave","click .weather-nav-dropdown-settings-open-btn":"showSettingsPanel","click .weather-nav-dropdown-settings-close-btn":"hideSettingsPanel","click .weather-nav-location-cancel-btn":"hideSettingsPanel","click .weather-nav-location-set-btn":"onSetButtonClick","submit .weather-nav-location-form":"onSubmitLocationForm","keydown .weather-nav-location-input":"onKeyDown","focus .weather-nav-location-input":"onFocusLocationField","blur .weather-nav-location-input":"onBlurLocationField","click .weather-nav-full-forecast-btn":"onClickFullForecast"},initialize:function(i){t.bindAll(this,"refreshData","onAutoCompleteResultClick"),this.panels=this.$(".weather-nav-dropdown-panel-wrap"),this.frontPanel=this.panels.find(".weather-nav-conditions-panel"),this.frontWeatherLocation=this.frontPanel.find(".weather-nav-location-name"),this.frontWeatherIcon=this.frontPanel.find(".weather-nav-dropdown-wicon"),this.frontWeatherTemp=this.frontPanel.find(".weather-nav-dropdown-temp"),this.settingsPanel=this.panels.find(".weather-nav-settings-panel"),this.locationField=this.settingsPanel.find(".weather-nav-location-input"),this.dropdownWiconClassName=this.frontWeatherIcon.attr("class"),this.transitionDelay=80,this.body=o.get("body"),this.navBtn=this.$el.parent(".weather"),this.$navLink=this.$el.siblings("a").eq(0),this.$navTempSpan=this.$navLink.find(".site-nav-alt-span"),this.navBtnTemp=this.navBtn.find(".btn-temp"),this.navBtnClassName=this.navBtnTemp.attr("class"),this.pubSub={"weather:newLocation":this._parseData},s.prototype.initialize.call(this,i),this.locationErrorEl=this.$(".weather-nav-location-error"),e.cookie("weatherLocation")?this.refreshData():this.updateWeatherLocation(window.defaultWeatherLocation),this.weatherDataRefresh=setInterval(this.refreshData,3e5)},onSetButtonClick:function(e){e.preventDefault(),this.updateWeatherLocation(this.locationField.val())},onAutoCompleteResultClick:function(){this.updateWeatherLocation(this.locationField.val())},onKeyDown:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&this.updateWeatherLocation(this.locationField.val()),this.clearLocationInputError()},onSubmitLocationForm:function(e){e.preventDefault()},onClickFullForecast:function(e){this.isMouseOnDropdown=!1,this.closeDropdown()},onMouseEnter:function(){this.isMouseOnDropdown=!0},onMouseLeave:function(){this.locationField.is(":focus")||(this.isMouseOnDropdown=!1,this.closeDropdown())},closeDropdown:function(){this.isMouseOnDropdown||(this.isSettingsPanelActive&&this.hideSettingsPanel(),this.$el.hide(),this.$el.removeClass("dropdown-active"),this.navBtn.find(".nav-span").removeClass("dropdown-active"),this.body.off("."+this.cid))},openDropdown:function(){this.$el.show(),this.$el.addClass("dropdown-active"),this.navBtn.find(".nav-span").addClass("dropdown-active")},showSettingsPanel:function(){this.$el.hasClass("settings-active")||(this.$el.addClass("settings-active"),this.isSettingsPanelActive=!0),this.subviews.autocomplete||(this.subviews.autocomplete=new r({el:this.locationField,resultDisplayTemplate:"<%= City %>, <%= State %>",resultValueTemplate:"<%= City %>, <%= State %>",onSelect:this.onAutoCompleteResultClick,maxResults:50}))},hideSettingsPanel:function(){this.subviews.autocomplete&&this.subviews.autocomplete.resetInput(),this.clearLocationInputError(),this.locationField.blur(),this.$el.hasClass("settings-active")&&(this.$el.removeClass("settings-active"),this.isSettingsPanelActive=!1)},onFocusLocationField:function(i){this.locationField.val(""),this.body.on("click."+this.cid,t.bind(function(t){0===e(t.target).closest(this.el).length&&(this.isMouseOnDropdown=!1,this.closeDropdown())},this))},onBlurLocationField:function(e){""===this.locationField.val()&&this.locationField.val(this.locationField.data("value"))},setWeatherCookie:function(t){e.cookie("weatherLocation",t,{path:"/",expires:1825})},updateWeatherLocation:function(i){return i&&i!==e.cookie("weatherLocation")?this._fetchData(i).done(t.bind(function(e){this.hideSettingsPanel(),n.trigger("weather:newLocation",e)},this)).fail(t.bind(function(e){this.showLocationInputError(e)},this)):void 0},refreshData:function(){return this._fetchData(e.cookie("weatherLocation"))},_fetchData:function(i){return this.isBusyGettingData||!i?e.Deferred().reject():(i=i.replace(",",""),this.isBusyGettingData=!0,e.Deferred(t.bind(function(e){a.persistentFetchData("/weather/forecast/json/"+i+"/").done(t.bind(function(t){t.length&&t[0]?(this._parseData(t),e.resolveWith(this,[t])):e.rejectWith(this,["No data is available for this location."]),this.isBusyGettingData=!1},this)).fail(t.bind(function(){e.rejectWith(this,["There was an error finding this location. Please try again later."]),this.isBusyGettingData=!1},this))},this)))},showLocationInputError:function(e){this.locationErrorEl.html()!==e&&(this.locationErrorEl.addClass("ui-input-field-error-active"),this.locationErrorEl.text(e),this.locationErrorEl.stop().slideDown(50,"easeInOutQuad"))},clearLocationInputError:function(){this.locationErrorEl.hasClass("ui-input-field-error-active")&&this.locationErrorEl.stop().slideUp(50,"easeInOutQuad").promise().done(t.bind(function(){this.locationErrorEl.removeClass("ui-input-field-error-active"),this.locationErrorEl.empty()},this))},_parseData:function(i){if(i[0].currentConditions){var s=i[0],n=s.currentConditions,o=s.local.city+", "+s.local.adminArea.Text,a="wicon-"+n.weatherIcon,r=parseInt(n.temperature,10),l=this.$navTempSpan.add(this.$("[data-weather]"));l.each(t.bind(function(t,i){var s=e(i);s.html((n[s.data("weather")]||"")+(s.data("weather-suffix")||""))},this)),o.length>20&&this.frontWeatherLocation.addClass("longname"),this.frontWeatherLocation.html(o),r>99&&this.frontWeatherTemp.addClass("three-digit"),this.frontWeatherIcon.attr("class",this.dropdownWiconClassName+" "+a),this.navBtnTemp.attr("class",this.navBtnClassName+" "+a),this.$navTempSpan.addClass("site-nav-visible-alt-span "+a),e.cookie("weatherLocation")!==o&&this.setWeatherCookie(o),this.locationField.data("value",o).val(o)}},destroy:function(e){this.body.off("."+this.cid),clearInterval(this.weatherDataRefresh),s.prototype.destroy.call(this,e)}});return l}),define("modules/weather/site-nav-weather-module",["jquery","underscore","baseview","pubsub","utils","state","modules/weather/weather-dropdown"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({events:{mouseenter:"onHoverWeatherNav",mouseleave:"onHoverWeatherNav","click .site-nav-weather-link":"onClickWeatherNav"},initialize:function(){i.prototype.initialize.apply(this);var e=this.$(".weather-nav-dropdown");this.subviews.weatherDropdown=new a({el:e})},onHoverWeatherNav:function(e){var i=this.$(".site-nav-alt-span");clearTimeout(this.navBtnHoverDelay),i.hasClass("site-nav-visible-alt-span")&&("mouseenter"===e.type?(i.addClass("site-nav-active-alt-span"),this.navBtnHoverDelay=t.delay(t.bind(this.subviews.weatherDropdown.openDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)):(i.removeClass("site-nav-active-alt-span"),this.navBtnHoverDelay=t.delay(t.bind(this.subviews.weatherDropdown.closeDropdown,this.subviews.weatherDropdown),this.hoverDropdownDelay)))},onClickWeatherNav:function(e){this.subviews.weatherDropdown.closeDropdown()}});return r}),define("modules/rentals-apartments-ad",["jquery","baseview","state","directAdPosition","managers/routemanager"],function(e,t,i,s,n){var o=t.extend({events:{"click .js-rad-search-btn":"aptAffWidget"},layoutType:"",renderedAd:!1,createAdPosition:function(t){return new s({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},renderAd:function(){if(!this.renderedAd){this.renderedAd=!0;var e=this.$(".js-rad-google-ad")[0];e&&(this.subviews.adPositionOne=this.createAdPosition(e))}},destroyAd:function(){this.renderedAd&&(this.subviews.adPositionOne.destroy(),this.renderedAd=!1)},initialize:function(e){t.prototype.initialize.call(this),this.layoutType=e.layoutType},isSidebarModule:function(){return"sidebar"===this.layoutType},isPrimaryWellModule:function(){return"primary"===this.layoutType},handleCardSizeChange:function(e){this.isSidebarModule()?e.sidebarAds===!0?(this.$(".js-rad-sidebar-ad").removeClass("rad-hide-ad"),this.renderAd()):(this.$(".js-rad-sidebar-ad").addClass("rad-hide-ad"),this.destroyAd()):this.isPrimaryWellModule()&&(e.sidebarOpen===!0?this.destroyAd():this.renderAd());var t=this.$(".js-rad-wrap");e.sidebarOpen===!0?(t.removeClass("rad-wrap-margin"),"primary"===this.layoutType&&t.addClass("rad-dynamic-height"),this.$(".js-rad-wrap-primary").removeClass("rad-top-border"),this.$(".js-rad-google-ad").removeClass("rad-dynamic-margin")):(t.addClass("rad-wrap-margin"),"primary"===this.layoutType&&t.removeClass("rad-dynamic-height"),this.$(".js-rad-wrap-primary").addClass("rad-top-border"),this.$(".js-rad-google-ad").addClass("rad-dynamic-margin"))},onCardWidthChange:function(e){this.handleCardSizeChange(e)},renderCardInfo:function(e){this.handleCardSizeChange(e)},aptAffWidget:function(t){var i,s,o,a,r;return i=this.$(".js-rad-form-city").val(),s=this.$(".js-rad-form-bedrooms").val(),o=this.$(".js-rad-form-bathrooms").val(),a=this.$(".js-rad-form-rent").val(),r="https://www.apartments.com/search/?query="+i,i?(s&&(r+="&bedchkvalue="+s),o&&(r+="&bathchkvalue="+o),a&&(r+="&rentmax="+a),r+="&stype=CityStateOrZip",n.goTo(r)):e(".js-rad-form-city").focus(),!1}});return o}),define("modules/sports/sports-video-ooyala",["jquery","underscore","state","backbone","baseview"],function(e,t,i,s,n){var o=n.extend({events:{"click #ooyalaplaylist li.item":"selectVideo"},initialize:function(){n.prototype.initialize.call(this,this.options),this.settings={disableAds:e("#ooyalaplayer").data("disableads"),wmode:"transparent",enableChannels:!0,autoplay:!1,debug:!0,nextIndex:2,containerId:"ooyalaplayer",playlistContainer:"ooyalaplaylist",videoTitleId:"ooyala-title",playlistId:"ooyalaplaylist",videoPlayer:{},hasPlayed:!1,width:e("#ooyalaplayer").data("width"),height:e("#ooyalaplayer").data("height"),adsetcode:e("#ooyalaplayer").data("adsetcode"),adtagurl:e("#ooyalaplayer").data("adtagurl"),cuedvideoid:"",viewdestroyed:!1},this.firstVideoId=e("#"+this.settings.containerId).data("videoid"),this.playerApiUrl=e("#"+this.settings.containerId).data("playerapiurl"),t.bindAll(this,"createPlayer","loadScripts","selectVideo","playerReceiver","loadVideoById","setNextplaylistItem","clearActiveElement","setActiveElement","getAdOptions"),window.googletag&&this.settings.disableAds!==!0&&window.googletag.cmd.push(function(){window.googletag.pubads().enableSingleRequest(),window.googletag.companionAds().setRefreshUnfilledSlots(!0),window.googletag.enableServices()}),this.loadScripts()},loadScripts:function(){require([this.playerApiUrl],t.bind(function(){"undefined"!=typeof window.OO?this.createPlayer(this.firstVideoId):console.log("Error loading ooyala")},this))},createPlayer:function(e){var i={wmode:this.settings.wmode,enableChannels:!0,autoplay:this.settings.autoplay,width:this.settings.width+"px",height:this.settings.height+"px",debug:this.settings.debug,adSetCode:this.settings.adsetcode,onCreate:t.bind(function(e){window.mb=e.mb,window.mb.subscribe("*","PGATourOoyala",t.bind(function(e){this.playerReceiver(e)},this))},this)};this.settings.disableAds!==!0&&(i["google-ima-ads-manager"]=this.getAdOptions(e)),this.settings.videoPlayer=window.OO.Player.create(this.settings.containerId,e,i)},destroyVideo:function(e){this.settings.videoPlayer.destroy()},selectVideo:function(t){this.loadVideoById(e(t.currentTarget).data("videoid")),this.clearActiveElement(),this.setActiveElement(e(t.currentTarget)),this.setNextplaylistItem(e(t.currentTarget))},playerReceiver:function(t){switch(t){case"played":var s=e("#"+this.settings.playlistId+" li:nth-child("+this.settings.nextIndex+")");s.data("videoid");e(s).trigger("click");break;case"playbackReady":this.settings.autoplay=!0;break;case"playing":i.stopRefreshTimer();break;case"destroy":this.settings.viewdestroyed===!1&&this.loadVideoById()}},getAdOptions:function(e,t){var i=this.settings.adtagurl.replace("%s",e),s=(new Date).getTime(),n={adTagUrl:i,additionalAdTagParameters:{correlator:s},showInAdControlBar:!0};return n},loadVideoById:function(e){e?(this.settings.cuedvideoid=e,this.destroyVideo()):this.createPlayer(this.settings.cuedvideoid)},setNextplaylistItem:function(e){e.next().attr("data-index")?this.settings.nextIndex=e.next().data("index"):this.settings.nextIndex=1},setVideoTitle:function(){var t=this.settings.videoPlayer.getTitle();e("#"+this.settings.videoTitleId).html(t)},clearActiveElement:function(){e("#"+this.settings.playlistId+" li").siblings().removeClass("active")},setActiveElement:function(e){e.addClass("active")},destroy:function(){this.settings.viewdestroyed=!0,this.clearActiveElement(),this.setActiveElement(e("#"+this.settings.playlistId+" li").first()),"function"==typeof this.settings.videoPlayer.destroy&&this.settings.videoPlayer.destroy(),n.prototype.destroy.apply(this,arguments)}});return o}),define("modules/live-newscasts/live-newscasts",["jquery","underscore","baseview","modules/global/livevideo"],function(e,t,i,s){var n=i.extend({events:{"click .newscast-item a":"onLiveNewscastsClick"},onLiveNewscastsClick:function(t){var i=e(t.currentTarget).attr("data-livevideoassetid");if(i){var n=new s({service:"/services/livenewscasts/"});return n.loadLiveVideo(i),!1}}});return n}),define("modules/interactives/overview",["jquery","underscore","backbone","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(e,t,i,s,n,o,a){var r=n.extend({initialize:function(e){n.prototype.initialize.call(this,e);var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),this.$el.length&&(this.subviews.template=new o({ads:t,el:this.$el,interactiveType:"chronology",isFramed:e.isFramed,standAlone:e.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex))}});return r}),define("modules/trending-map/trending-map",["jquery","underscore","baseview","utils"],function(e,t,i,s){"use strict";var n=i.extend({el:".tmfwm-wrapper",initialize:function(e){t.bindAll(this,"processScroll"),this.$win=s.get("win"),this.$marketBubbles=this.$(".tmfwm-plot.tmfwm-market-bubble"),this.$trendingBubbles=this.$(".tmfwm-plot.tmfwm-trending-bubble"),this.isMapVisible()?this.showMarketBubbles():this.$win.on("scroll."+this.cid,t.throttle(this.processScroll,32))},showMarketBubbles:function(){var e=this;this.animate(this.$marketBubbles,"opacity",1,400,"ease-out").done(function(){e.showTrendingBubbles()}),this.animate(this.$marketBubbles,"transform","scale(1)",800,"ease-out")},showTrendingBubbles:function(){this.animate(this.$trendingBubbles,"opacity",1,600,"ease-out"),this.animate(this.$trendingBubbles,"transform","scale(1)",800,"ease-out")},isMapVisible:function(){return s.getScrollPosition()>=this.$el.offset().top-200},processScroll:function(){this.isMapVisible()&&(this.showMarketBubbles(),this.$win.off("."+this.cid))},destroy:function(){this.$win.off("."+this.cid),i.prototype.destroy.call(this,!0)}});return n}),define("modules/stories/oembed",["jquery","baseview","utils"],function(e,t,i){var s=t.extend({initialize:function(e){"rich"===this.$el.attr("data-oembed-type")&&"twitter"===this.$el.attr("data-oembed-provider")&&i.loadScript("https://platform.twitter.com/widgets.js","twttr",function(e){e.widgets.load()}),t.prototype.initialize.call(this,e)}});return s}),define("modules/travel/travel-poll",["jquery","underscore","baseview","pubsub","utils","state","cookie"],function(e,t,i,s,n,o){var a=i.extend({events:{"submit .travel-poll-form":"registerVote","click .poll-vote-results .story-poll-vote-btn":"revealChoices"},initialize:function(){this.user_id="unauthenticated",this.template=this.$(".travel-poll-wrapper"),this.form=this.$(".travel-poll-form"),this.choices=this.$(".travel-poll-choices"),this.results=this.$(".travel-poll-results"),this.poll_id=this.template.attr("data-pollid"),e.cookie(this.poll_id)&&this.revealResults(),i.prototype.initialize.apply(this,arguments)},revealResults:function(i){var s="/polls/get/"+this.poll_id+"/";o.fetchData(s).done(t.bind(function(s){var n=t.pluck(s[0].answer,"count"),o=t.reduce(n,function(e,t){return e+parseFloat(t)},0),a=0===o?!0:!1,r=0;isNaN(i)||e.cookie(this.poll_id,!0),t.each(s[0].answer,function(e,t){var s,n=parseFloat(e.count);a?s=i==t?100:0:(i==t-1&&(e.count+=1),s=Math.round(n/o*100)),e.count_output=n,r+=s,e.percent=s,e.percent_width=.8*s,n>999&&(e.count_output=(Math.round(n/100*10)/10).toString()+"k")});var l=t.template(e(".quickpoll-results").html(),{data:s[0],total:o});this.form.hide(),this.results.html(l),e.cookie(this.poll_id)&&this.$(".poll-vote-results .story-poll-vote-wrapper").hide(),this.results.css("height","auto")},this))},registerVote:function(i){var n=e("input[name=travel-poll-choice]:checked").val(),a="/polls/save/"+this.poll_id+"/"+this.user_id+"/"+n+"/";return i.preventDefault(),o.fetchData(a,{method:"post"}).done(t.bind(function(e){e&&(s.trigger("uotrack","pollvote"),this.revealResults(n))},this)),!1},revealChoices:function(){this.choices=this.$(".story-poll-choices"),this.results=this.$(".story-poll-chart"),this.results.hide(),this.choices.fadeIn()}});return a}),define("modules/fronts/live-feed",["jquery","underscore","baseview","state","utils"],function(e,t,i,s,n){"use strict";var o=i.extend({initialize:function(s){t.bindAll(this,"initMarkup","updateMarkup","fetchUpdate","hideImage");var o=this.$el.attr("data-livefeed")||n.getSectionPath(window.location.pathname),a=this.$el.attr("data-livefeed-site-id"),r=this.$el.attr("data-livefeed-site-prefix"),l=this.$el.attr("data-livefeed-itemfetchlimit")||40;s=e.extend({maxItems:60,itemFetchLimit:l,removeNewHighlight:20,updateDelay:180,dataSrcAttr:"data-src",autoUpdate:!0,site_id:a,site_prefix:r,section:o,afterFetchResults:null,ajaxOptions:null},s);var h={count:s.itemFetchLimit};"undefined"!=typeof a&&""!==a&&(h.site_id=s.site_id),"undefined"!=typeof r&&""!==r&&(h.site_prefix=s.site_prefix);var d={url:"/feeds/live/"+o+"/",data:h,headers:{"x-no-nav":"true"}};this.requestOptions=e.extend(!0,d,s.ajaxOptions),i.prototype.initialize.call(this,s)},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.setLiveFeedWidth(e)},setLiveFeedWidth:function(e){e.sidebarWidth<340?this.$el.removeClass("live-feed-wide"):this.$el.addClass("live-feed-wide"),this.options.dataSrcAttr="data-src-"+e.sidebarWidth,this.loadLazyImages()},openSideBar:function(){this.setupLiveFeed()},closeSideBar:function(){this.stopUpdateCheck()},renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.setupLiveFeed()},setupLiveFeed:function(){this.stopUpdateCheck(),this.setLiveFeedWidth(this.currentCardInfo),this.$el.children("li").length?(this.$el.children(".newcontent").removeClass("newcontent"),this.fetchUpdate()):s.fetchHtml(null,this.requestOptions).done(t.bind(function(e){this.initMarkup(e),this.afterFetchResultsSuccess(e)},this))},afterFetchResultsSuccess:function(e){this.options.afterFetchResults&&this.options.afterFetchResults(e)},initMarkup:function(e){this.$el.removeClass("livefeed-loading"),this.$el.append(e),this.loadLazyImages(e.find("img")),this.refreshSidebar(),this.options.autoUpdate&&this.startUpdateCheck()},loadLazyImages:function(e){e=e||this.$("img"),n.lazyLoadImage(e,this.options.dataSrcAttr,!0,this.hideImage,this.refreshSidebar)},refreshSidebar:function(){s.getActiveApp().triggerEvent("refreshSidebarScroll")},hideImage:function(e){e.closest(".has-image").removeClass("has-image"),this.refreshSidebar()},fetchUpdate:function(){this.requestOptions.data.date=this.$("li:first").attr("data-timestamp"),s.fetchHtml(null,this.requestOptions).done(t.bind(function(e){this.updateMarkup(e),this.afterFetchResultsSuccess(e)},this))},updateMarkup:function(i){if(i&&0!==i.length){var s,n=this.$("li"),o={};n.removeClass("top"),i.each(function(){o[e(this).attr("data-content-id")]=!0}),n.each(function(){s=e(this),o[s.attr("data-content-id")]&&s.remove()}),i.eq(0).addClass("top").append('<div class="shadow"></div>'),this.$el.prepend(i),i.addClass("newcontent"),this.loadLazyImages(i.find("img")),n=this.$el.children("li"),n.length>60&&n.slice(60).remove(),this.afterNewContent=setTimeout(t.bind(function(){i.removeClass("newcontent")},this),1e3*this.options.removeNewHighlight),this.refreshSidebar()}},startUpdateCheck:function(){clearInterval(this.interval),this.interval=setInterval(this.fetchUpdate,1e3*this.options.updateDelay)},stopUpdateCheck:function(){clearInterval(this.interval)},destroy:function(e){e&&this.$el.empty(),this.stopUpdateCheck(),clearTimeout(this.afterNewContent),i.prototype.destroy.apply(this,arguments)}});return o}),define("modules/ggm-va-loan/ggm-va-loan",["jquery","underscore","baseview","form/dropdown","state","managers/routemanager"],function(e,t,i,s){"use strict";var n=i.extend({events:{"submit .ggmval-form":"onFormSubmit"},initialize:function(e){i.prototype.initialize.call(this,e),this._setupForm()},_setupForm:function(){this.subviews.dropdownProduct=new s({el:this.$(".ggmval-select")})},onFormSubmit:function(e){var t=this.$(".ggmval-input");return/^\d{5}$/.test(t.val())?void t.removeClass("ggmval-input-error"):(t.addClass("ggmval-input-error"),void e.preventDefault())}});return n}),function(e){function t(e){function t(e,t,n){var a=null;if(i(t)&&(h(t),s(e),o(e),l(t),m>=2)){var r=d(t),v=0;v=u(r)?-1*p(g,r-1,Math.floor(m/2)-1):p(g,Math.floor(m/2),r-2),m%2===0&&(v+=c()),a=f(n,t,v),n.points=a}return a}function i(e){return null!=e.bars&&e.bars.show&&null!=e.bars.order}function s(e){var t=w?e.getPlaceholder().innerHeight():e.getPlaceholder().innerWidth(),i=w?n(e.getData(),1):n(e.getData(),0),s=i[1]-i[0];y=s/t}function n(e,t){for(var i=new Array,s=0;s<e.length;s++)i[0]=e[s].data[0][t],i[1]=e[s].data[e[s].data.length-1][t];return i}function o(e){g=a(e.getData()),m=g.length}function a(e){for(var t=new Array,i=0;i<e.length;i++)null!=e[i].bars.order&&e[i].bars.show&&t.push(e[i]);return t.sort(r)}function r(e,t){var i=e.bars.order,s=t.bars.order;return s>i?-1:i>s?1:0}function l(e){v=3,b=v*y}function h(e){e.bars.horizontal&&(w=!0)}function d(e){for(var t=0,i=0;i<g.length;++i)if(e==g[i]){t=i;break}return t+1}function c(){return g[Math.ceil(m/2)].bars.barWidth/2}function u(e){return e<=Math.ceil(m/2)}function p(e,t,i){for(var s=0,n=t;i>=n;n++)s+=e[n].bars.barWidth+2*b;return s}function f(e,t,i){for(var s=e.pointsize,n=e.points,o=0,a=w?1:0;a<n.length;a+=s)n[a]+=i,t.data[o][3]=n[a],o++;return n}var g,m,v,b,y=1,w=!1;e.hooks.processDatapoints.push(t)}var i={series:{bars:{order:null}}};e.plot.plugins.push({init:t,options:i,name:"orderBars",version:"0.2"})}(jQuery),define("libs/flot/jquery.flot.orderBars",function(){}),function(e){function t(e){function t(e){var t=document.createElement("canvas");if(t.getContext&&t.getContext("2d")){e.getCanvas().getContext("2d"),e.width()+100,e.height()+50}}e.hooks.draw.push(t)}var i={};e.plot.plugins.push({init:t,options:i,name:"style ",version:"0.05"})}(jQuery),define("libs/flot/jquery.flot.usat.style",function(){}),define("modules/interactives/bar-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base","libs/flot/jquery.flot.orderBars","libs/flot/jquery.flot.usat.style"],function(e,t,i,s,n){"use strict";var o=n.extend({initialize:function(e){this.orientation=this.$el.data("orientation"),n.prototype.initialize.call(this,e)},_isMultiBar:function(){return this.datasetItems.length>1},getChartColors:function(){return"horizontal"===this.orientation&&this._isMultiBar()?(this.$el.data("colors")||"").split("|").slice(0,this.datasetItems.length).reverse():(this.$el.data("colors")||"").split("|")},getFlotData:function(e){return t.map(e,function(e,i,s){var n=this.mainColor;return s.length>1&&(n=this.chartColors[i%this.chartColors.length]),{label:e.label||"",color:n,bars:{borderWidth:30,fillColor:n},data:t.map(e.value,function(e){return e.split(",")})}},this)},_getHoverBody:function(e){return[this.getHoverPrefix(),s.addCommas(s.addCommas(e.datapoint["horizontal"===this.orientation?0:1])),this.getHoverSuffix()].join(" ")},getFlotOptions:function(){var e=this.datasetItems.length+(this.datasetItems.length>1&&s.getNested(this.datasetItems,"0","value","length")>6?4:this.datasetItems.length>1?2:1),t=n.prototype.getFlotOptions.apply(this,arguments),i=1/e;return t.colors=this.chartColors,t.series={bars:{show:!0,barWidth:i,order:"integer"},stack:!1},t.series.bars.align="center",t.grid.borderWidth=1,t.grid.labelMargin=5,t.grid.axisMargin=0,t.grid.autoHighlight=!0,t.grid.borderColor="rgb(237,236,236)","horizontal"===this.orientation?(t.xaxis={position:"bottom",autoscaleMargin:.02,tickFormatter:this.numberWithCommas},t.yaxis={ticks:this._createTicks(this.chartData.datasetLabels||""),position:"left",tickLength:0,autoscaleMargin:.02},t.bars={horizontal:!0}):(t.xaxis={autoscaleMargin:.02,ticks:this._createTicks(this.chartData.datasetLabels||""),position:"bottom",tickLength:0},t.yaxis={position:"left",labelWidth:40,tickFormatter:this.numberWithCommas}),t},_getHoverLabel:function(e){return this._isMultiBar()?e.series.label:""}});return o}),define("modules/stories/google-survey",["jquery","underscore","utils","state","baseview","user-manager","managers/cachemanager","pubsub","admanager","managers/autoplay","cookie"],function(e,t,i,s,n,o,a,r,l,h){var d=n.extend({initialize:function(a){var d=i.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY")||{},c=o.getAccount("firefly"),u=this._getLocation(),p=e.Deferred(),f=s.getActivePageInfo(),g=e.cookie(d.ad_block_cookie);return d.ENABLED&&this.surveyChecksPass(d)&&!f.sponsored_series&&0===e(".p402_premium").find(".companion-story-gallery").length?(window.gcsOnSurveyComplete=function(){var e={date:new Date,reliefPeriod:i.getNested(window.site_vars,"THIRDPARTYAPI","GOOGLECONSUMERSURVEY","relief_period")||864e5,isSet:function(){return localStorage.getItem("google-survey-complete-datetime")?!0:!1},isExpired:function(e){return this.getSavedExpireTime()<this.date.getTime()?!0:!1},createNewExpireTime:function(){return parseInt(this.reliefPeriod,10)+this.date.getTime()},setExpirationTime:function(e){localStorage.setItem("google-survey-complete-datetime",e)},getSavedExpireTime:function(){return parseInt(localStorage.getItem("google-survey-complete-datetime"),10)}};if(e.isSet()&&!e.isExpired())r.trigger("fireflyout:open");else{var t=e.createNewExpireTime();e.setExpirationTime(t)}p.resolve(),window.scrollTo(0,1)},window.gcsNoSurveyDelivered=function(){r.trigger("fireflyout:open"),p.resolve()},n.prototype.initialize.call(this,a),this.setAlternativeActionResult(u),void l.getActiveSlotStatistics().done(t.bind(function(e){h.register("google-survey",t.bind(function(){return d.gravity_override&&t.findWhere(e.high_impact_info,{adType:"gravity"})?(p.resolve(),p):("true"!==g?c?c.getUserInfo().always(t.bind(function(e){!e||"Not logged in."===e||d.need_market_access&&!e.hasMarketAccess?this.loadGoogleConsumerSurvey(d,u,p):p.resolve()},this)):this.loadGoogleConsumerSurvey(d,u,p):p.resolve(),p)},this))},this))):(r.trigger("fireflyout:open"),!1)},surveyChecksPass:function(e){var t=parseInt(this.getAlternativeActionResult(),10),i=this.getEligibleArticleCount(),s=new Date;if(!e.show_on_article_number||i>=e.show_on_article_number){if(!t)return!0;if(s.getTime()>t+e.relief_period)return!0}else i++,a.setValue("gcs-eligible-page-count",i);return!1},loadGoogleConsumerSurvey:function(t,i){if(t.publisher_id&&i){var n="everything",o="//survey.g.doubleclick.net/survey";return s.fetchData(o,{dataType:"script",data:{site:"_"+t.publisher_id,url:i,cid:n,after:"1"}})}return e.Deferred().reject()},setAlternativeActionResult:function(e){if(e&&e.indexOf("#gcs-aau-success")>-1){var t=new Date;localStorage["gcs-aau-fulfilled"]=t.getTime(),window.location.hash=""}},getAlternativeActionResult:function(){return localStorage.getItem("gcs-aau-fulfilled")},getEligibleArticleCount:function(){return a.getValue("gcs-eligible-page-count",1)},_getLocation:function(){return window.location.href},destroy:function(){e(".t402-prompt-iframe-container").remove(),window.scrollTo(0,1),delete window.gcsOnSurveyComplete,delete window.gcsNoSurveyDelivered,n.prototype.destroy.call(this)}});return d}),define("modules/fronts/suspender-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){t=e.extend({adPlacement:"sponsor_logo_front",adSizes:"sponsor_logo_medium"},t),this.visibleWithSidebarOpen="false"!==this.$el.attr("data-visible-with-sidebar-open"),i.prototype.initialize.call(this,t)},openSideBar:function(){this.visibleWithSidebarOpen||this._onHideSidebarAd()},closeSideBar:function(){this.visibleWithSidebarOpen||this._initAds()},_onHideSidebarAd:function(){this.subviews.simpleAd&&(this.subviews.simpleAd.destroy(),this.hide(),this.subviews.simpleAd=!1)},renderCardInfo:function(e){this.visibleWithSidebarOpen?this._initAds():e.sidebarOpen||this._initAds()}});return s}),define("modules/stories/share-email",["jquery","underscore","backbone","pubsub","baseview","state","utils","form/input-field"],function(e,t,i,s,n,o,a,r){var l=n.extend({events:{"click .recaptcha_option":"onRecaptcha","click .js-share-email-cancel-btn":"onClickCancelBtn","click .js-share-email-send-btn":"onSubmitEmailForm"},initialize:function(i){i=e.extend({uotrackName:"UtilityBarShareEmail",message:"",theme:"light"},i),t.bindAll(this,"initInputs","sendEmail"),this.subviews={},this.$recaptchaV2=this.$("#recaptcha-share"),this.v2_captcha_available=!0,this.$emailForm=this.$(".js-share-email-form"),this.$emailFormContainer=this.$(".js-share-email-form-container"),this.$successPane=this.$(".js-share-email-form-success-pane"),this.$shareTextarea=this.$(".js-share-email-form-textarea"),this.$shareTextareaOldVal=this.$shareTextarea.val(),this.$emailForm.length&&(this.$recaptchaV2.length?(this.initInputs(),this.initCaptcha()):(this.setRecaptcha(),
a.requireSingleUseScript("https://www.google.com/recaptcha/api/challenge?k=6Lf7fuESAAAAAJ3_KMIDbkQySsEE0vMkLXUkq4eY").done(t.delay(this.initInputs,300)))),n.prototype.initialize.call(this,i)},initInputs:function(){this.$inputs=this.$(".ui-text-input"),t.each(this.$inputs,function(e,t){this.subviews["input"+t]&&this.subviews["input"+t].destroy(),this.subviews["input"+t]=new r({el:e})},this)},initCaptcha:function(){this.$recaptchaV2.is(":empty")&&(this.$recaptchaV2.data("key")?grecaptcha.render("recaptcha-share",{sitekey:this.$recaptchaV2.data("key"),callback:this.sendEmail,theme:this.options.theme,size:"invisible",badge:"inline"}):this.v2_captcha_available=!1)},setRecaptcha:function(){e(".recaptcha_widget").remove();var t=e("#recaptcha_widget").html();this.$(".js-email-form-recaptcha-widget").html(t),"modalEmailForm"===this.$el.attr("id")&&e("#recaptcha_response_field").addClass("ui-light")},onSubmitEmailForm:function(e){e.preventDefault(),this.isValid(this.$emailForm)&&(this.$recaptchaV2.length?this.v2_captcha_available?grecaptcha.execute():this.sendEmail("v2_captcha_unavailable"):this.sendEmail("v1"))},sendEmail:function(i){this.$emailForm.children("input,textarea").removeClass("error"),e.ajax({type:"POST",url:this.$emailForm.attr("action"),data:this.$emailForm.serialize()}).done(t.bind(function(e){this.onSuccessfulSubmission()},this)).fail(t.bind(function(e){this.onFailedSubmission()},this))},onSuccessfulSubmission:function(){this.showSuccessPane(),this.triggerEvent("clearInputValue"),s.trigger("uotrack",this.options.uotrackName),this.$recaptchaV2.length?this.v2_captcha_available&&grecaptcha.reset():this.reloadRecaptcha()},onFailedSubmission:function(){this.$recaptchaV2.length?(this.$emailForm.children("input,textarea").addClass("error"),this.v2_captcha_available&&grecaptcha.reset()):(this.$("#recaptcha_response_field").addClass("error"),window.Recaptcha.reload())},showSuccessPane:function(){this.hideEmailForm(),this.$successPane.show()},showEmailForm:function(){this.hideConfirmationPane(),this.setupShareText(),this.$el.show(),this.$emailFormContainer.show()},setupShareText:function(){this.$shareTextarea.val(this.options.message+"\n"+this.options.postLink+"\n\n"+this.$shareTextareaOldVal),this.$shareTextarea.height(40)},hideEmailForm:function(){this.$emailFormContainer.hide()},hideConfirmationPane:function(){this.$successPane.hide()},isValid:function(t){var i=!0;return t.children("input,textarea").removeClass("error").each(function(t,s){var n=e(s);n.hasClass("required")&&""===n.val()&&(n.addClass("error"),i=!1)}),i},onClickCancelBtn:function(e){"modalEmailForm"===this.$el.attr("id")?o.getActiveApp().$(".social-share-modal-close-btn").trigger("click"):o.getActiveApp().$(".js-share-email-btn").trigger("click")},onRecaptcha:function(t){var i=e(t.currentTarget).data("option");"audio"===i||"image"===i?this.switchRecaptchaType(i):"help"===i?this.showRecaptchaHelp():this.reloadRecaptcha()},switchRecaptchaType:function(e){window.Recaptcha.switch_type(e)},showRecaptchaHelp:function(){window.Recaptcha.showhelp()},reloadRecaptcha:function(){window.Recaptcha.reload()}});return l}),define("modules/longform/longform-share",["jquery","underscore","baseview","pubsub","state","modules/scroller/vertical-scroll","third-party-apis/facebook/facebook","site-manager","utils","modules/stories/share-email"],function(e,t,i,s,n,o,a,r,l,h){var d=i.extend({el:".longform-share-wrapper",events:{"click .longform-share-flyout-icon-wrap":"onClickFlyoutIcon","click .longform-share-icon":"onClickShare","click .sub-flyout-close, .js-share-email-cancel-btn":"closeSubFlyout"},initialize:function(t){this.pubSub={closeShareFlyout:this.closeShareFlyout,onClickShare:this.onClickShare,onClickCommentsIcon:this.onClickCommentsIcon,onClickEmailIcon:this.onClickEmailIcon};this.$shareComments=e(".share-comments"),this.$flyoutWindow=this.$(".longform-share-flyout"),this.$subFlyoutWrapper=this.$(".sub-flyout-wrapper"),this.$subFlyoutFirefly=this.$(".sub-flyout-firefly"),this.$subFlyoutComments=this.$(".sub-flyout-comments"),this.$subFlyoutEmail=this.$(".sub-flyout-email"),this.$fireflyShareFlyoutIcon=this.$(".longform-share-flyout-icon-wrap-firefly"),this.$commentFlyoutIcon=this.$(".longform-share-flyout-icon-wrap-comments"),this.$emailFlyoutIcon=this.$(".longform-share-flyout-icon-wrap-email"),this.$socialBarScrollWrap=this.$(".social-bar-scroll-wrap"),this.$emailScrollWrap=this.$(".sub-flyout-email-scroll"),this.$win=l.get("win"),this.flyoutOptions={flyout:this.$flyoutWindow,icon:"longform-share",iconSpace:"5px",closeMethod:"closeShareFlyout"},this.subFlyoutIsOpen=!1,this.subFlyoutType="",i.prototype.initialize.call(this,t)},closeShareFlyout:function(){this.animate(this.$flyoutWindow,"right","-300px",200),this.closeSubFlyout()},onClickShare:function(e){this.subFlyoutIsOpen?e===this.subFlyoutType?(s.trigger("openFlyout",this.flyoutOptions),this.closeSubFlyout()):this.openSubFlyout(e):(s.trigger("openFlyout",this.flyoutOptions),("firefly"===e||"email"===e||"comments"==e)&&this.openSubFlyout(e))},onClickFlyoutIcon:function(t){e(t.target).hasClass("longform-share-flyout-icon-wrap-firefly")?this.openSubFlyout("firefly"):e(t.target).hasClass("longform-share-flyout-icon-wrap-comments")?this.openSubFlyout("comments"):e(t.target).hasClass("longform-share-flyout-icon-wrap-email")&&this.openSubFlyout("email")},getAvailableVerticalSpace:function(){var e=r.getHeader(),t=0;return e&&(t=e.getCollapsedHeight()),this.$win.height()-t},updateFlyoutHeight:function(e){this.$socialBarScrollWrap.css("height",e-130),this.$emailScrollWrap.css("height",e)},animateSubFlyout:function(e,t){this.animate(e,"right",t||"70px",200,"ease-in-out")},openSubFlyout:function(e){if(this.subFlyoutIsOpen&&e===this.subFlyoutType)return this.closeSubFlyout(),!1;"firefly"===e?(this.subFlyoutIsOpen&&this.closeSubFlyout(),this.$fireflyShareFlyoutIcon.addClass("longform-share-flyout-clicked-firefly"),this.animateSubFlyout(this.$subFlyoutFirefly)):"comments"===e?(this.subFlyoutIsOpen&&this.closeSubFlyout(),this.$commentFlyoutIcon.addClass("longform-share-flyout-clicked-comments"),this.animateSubFlyout(this.$subFlyoutComments),this.loadComments()):"email"===e&&(this.subFlyoutIsOpen&&this.closeSubFlyout(),this.$emailFlyoutIcon.addClass("longform-share-flyout-clicked-email"),this.animateSubFlyout(this.$subFlyoutEmail),this.loadEmail()),this.subFlyoutIsOpen=!0,this.subFlyoutType=e;var t=this.getAvailableVerticalSpace();t-=140,this.updateFlyoutHeight(t)},closeSubFlyout:function(){this.$fireflyShareFlyoutIcon.removeClass("longform-share-flyout-clicked-firefly"),this.animateSubFlyout(this.$subFlyoutFirefly,"-300px"),this.$commentFlyoutIcon.removeClass("longform-share-flyout-clicked-comments"),this.animateSubFlyout(this.$subFlyoutComments,"-370px"),this.$emailFlyoutIcon.removeClass("longform-share-flyout-clicked-email"),this.animateSubFlyout(this.$subFlyoutEmail,"-370px"),this.subFlyoutIsOpen=!1,this.subFlyoutType=""},loadComments:function(){this.$scrollWrap=this.$(".wide-bar-scroll-wrap"),this.$scrollable=this.$subFlyoutWrapper;var e=this;a.loadScript().done(function(t){t.XFBML.parse(e.$scrollable[0])})},loadEmail:function(){this.subviews.shareEmailView||(this.subviews.shareEmailView=new h({el:".share-email-container",uotrackName:"longformemail",theme:"dark"})),this.subviews.shareEmailView.showEmailForm()},destroy:function(){this.$shareComments.off("."+this.cid),i.prototype.destroy.apply(this,arguments)}});return d}),define("modules/longform/longform-navigation",["jquery","underscore","baseview","pubsub","state","site-manager","utils"],function(e,t,i,s,n,o,a){var r=i.extend({el:".longform-navigation-wrapper",events:{"click .longform-navigation-icon, .longform-navigation-text":"onClickNavigation","click .longform-navigation-chapter-up":"onClickChapterUp","click .longform-navigation-chapter-down":"onClickChapterDown","click .longform-navigation-chapter":"onChapterClick"},initialize:function(t){this.$win=a.get("win"),this.pubSub={closeChaptersFlyout:this.closeChaptersFlyout},this.$flyoutWindow=this.$(".longform-navigation-flyout"),this.$upBtn=e(".longform-navigation-chapter-up"),this.$downBtn=e(".longform-navigation-chapter-down"),this.$topGrad=e(".longform-navigation-chapter-grad-top"),this.$botGrad=e(".longform-navigation-chapter-grad-bot"),this.$chapterNav=this.$(".longform-navigation-chapter"),this.$chapterItemWrap=this.$(".longform-navigation-chapter-item-wrap"),this.$chapterOverflow=this.$(".longform-navigation-chapter-overflow-wrap"),this.chapterCount=0,this.chapterOverflowPos=0,this.chapterHeights=[],this.calcHeightBool=!1,this.availableVertSpace=this.getAvailableVerticalSpace(),this.flyoutOptions={flyout:this.$flyoutWindow,icon:"longform-navigation",iconSpace:"105px",closeMethod:"closeChaptersFlyout"},i.prototype.initialize.call(this,t)},closeChaptersFlyout:function(e){this.animate(this.$flyoutWindow,"right","-300px",200)},onClickNavigation:function(){this.calcHeightBool||this._setChapterWrapHeight(),s.trigger("openFlyout",this.flyoutOptions)},onChapterClick:function(t){e("html, body").animate({scrollTop:e(".chapter-marker:eq( "+e(t.currentTarget).index()+" )").offset().top-60},1e3)},_setChapterWrapHeight:function(){var e=this.getChapterHeights(),t=this.availableVertSpace;e>t?this.$chapterItemWrap.height(t):(this.$chapterItemWrap.height(e),this.$chapterOverflow.css({position:"inherit"}),this.$upBtn.hide(),this.$downBtn.hide(),this.$topGrad.hide(),this.$botGrad.hide())},getAvailableVerticalSpace:function(){var e=o.getHeader(),t=0;return e&&(t=e.getCollapsedHeight()),this.$win.height()-320-t},getChapterHeights:function(){var t=this,i=0;return this.$chapterNav.each(function(s){t.chapterHeights.push(e(this).height()),i+=e(this).height()}),i},onClickChapterDown:function(e){this.chapterOverflowPos+this.$chapterOverflow.height()-this.availableVertSpace>0&&(this.$upBtn.css("opacity","1"),this.animate(this.$chapterOverflow,"top",(this.chapterOverflowPos-=this.chapterHeights[this.chapterCount])+"px",100,"linear"),this.chapterCount++,this.chapterOverflowPos+this.$chapterOverflow.height()-this.availableVertSpace<0&&this.$downBtn.css("opacity",".5"))},onClickChapterUp:function(e){this.chapterCount>0&&(this.$downBtn.css("opacity","1"),this.animate(this.$chapterOverflow,"top",(this.chapterOverflowPos+=this.chapterHeights[this.chapterCount])+"px",100,"linear"),this.chapterCount--,0===this.chapterCount&&this.$upBtn.css("opacity",".5"))}});return r}),define("modules/newsletter-story/newsletter-story",["jquery","underscore","baseview","state","user-manager","pubsub","managers/cachemanager"],function(e,t,i,s,n,o,a){var r=i.extend({validEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},events:{submit:"onFormSubmit","input .newsletter-story-email":"validateEmail"},initialize:function(i){this.$nlTitle=this.$(".newsletter-story-title"),this.$nlForm=this.$(".newsletter-story-form"),this.$nlFormAction=this.$nlForm.attr("action"),this.$emailField=this.$(".newsletter-story-email"),this.$businessUnitCode=this.$nlForm.data("business-unit"),this.$recaptchaEnabled=this.$nlForm.data("recaptcha-enabled"),this.$nlSubmit=this.$(".newsletter-story-submit"),this.$ssts=this.$nlSubmit.data("ssts"),this.$nlMsgCard=this.$(".newsletter-story-message-card"),this.$nlCardSuccess=this.$(".newsletter-story-message-card .success"),this.$nlCardFailure=this.$(".newsletter-story-message-card .fail"),this.userAccount=n.getAccount("firefly"),this.userAccount&&(this.userAccount.getUserInfo().done(t.bind(function(t){t.email&&(this.$currentUserEmail=t.email,this.$emailField.val(this.$currentUserEmail),this.$emailField.removeClass("invalid").addClass("valid"),this.newsletterLocal=a.getValue(this.$currentUserEmail+"_newsletter",null,1),this.newsletterLocal?this.newsletterLocal.subscriptions.length||e(".newsletter-embed").slideDown("slow"):(a.clearValue(this.$currentUserEmail+"_newsletter"),s.fetchData(null,{url:"/services/gemsapi/getuser/"+t.email+"/"+this.$businessUnitCode}).done(function(t){t.success===!0&&t.subscriptions&&(t.subscriptions.length||e(".newsletter-embed").slideDown("slow"))})))},this)),this.userAccount.getUserInfo().fail(function(){e(".newsletter-embed").slideDown("slow")},this))},setSubscriptionsLocal:function(e,t){var i={subscriptions:t};a.setValue(e+"_newsletter",i,10)},onFormSubmit:function(e){if(e.preventDefault(),this.validateEmail(),this.validEmail(this.$emailField.val())){var i=[];i.push({id:this.$nlForm.data("newsletter-id"),signup:!0});var n=JSON.stringify(i);this.$emailField.removeClass("invalid").removeClass("valid").addClass("updating"),this.$emailField.prop("disabled",!0);var a=!1;this.userAccount&&this.userAccount.getUserInfo().always(t.bind(function(e){e&&"Not logged in."!=e&&(a=!0)},this)),this.recaptchaResponse="","True"==this.$recaptchaEnabled&&(this.recaptchaResponse=grecaptcha.getResponse()),"True"!=this.$recaptchaEnabled||this.recaptchaResponse.length?s.fetchData(null,{type:"POST",url:this.$nlFormAction+this.$emailField.val()+"/"+this.$businessUnitCode+"/",data:{logged_in:a,newsletter_choices:n}}).done(t.bind(function(e){if(this.$emailField.removeClass("updating"),this.$nlForm.hide(),this.$nlMsgCard.show(),e.success===!0){this.$nlMsgCard.removeClass("fail").addClass("success"),this.$nlCardFailure.hide(),this.$nlCardSuccess.show(),this.$ssts=this.$ssts.replace(/,/g,":");var t=this.$nlSubmit.data("contenttype")+"|"+this.$ssts+"|rightrail|newsletterdesign",i=[this.$nlForm.data("newsletter-id")];this.setSubscriptionsLocal(this.$currentUserEmail,i),o.trigger("uotrack",t)}else this.$nlMsgCard.removeClass("success").addClass("fail"),this.$nlCardFailure.show(),this.$nlCardSuccess.hide()},this)):(this.$emailField.removeClass("updating"),this.$nlForm.hide(),this.$nlMsgCard.show(),this.$nlMsgCard.removeClass("success").addClass("fail"),this.$nlCardFailure.show(),this.$nlCardSuccess.hide())}},validateEmail:function(){this.$emailField.val()&&this.validEmail(this.$emailField.val())?this.$emailField.removeClass("invalid").addClass("valid"):this.$emailField.removeClass("valid").addClass("invalid")}});return r}),define("modules/fronts/most-popular-sidebar",["jquery","underscore","baseview","utils","state"],function(e,t,i,s,n){"use strict";var o=i.extend({renderCardInfo:function(e){this.currentCardInfo=e,e.sidebarOpen&&this.loadLazyImages()},onCardWidthChange:function(e){var t=e.sidebarWidth!==this.currentCardInfo.sidebarWidth;this.currentCardInfo=e,t&&this.loadLazyImages()},onOpenSidebar:function(){this.loadLazyImages()},loadLazyImages:function(){s.lazyLoadImage(this.$("img"),"data-src-"+this.currentCardInfo.sidebarWidth,!0,this.hideImage,this.showImage)},hideImage:function(e){e.parent().css("height",e.next().outerHeight()),n.getActiveApp().triggerEvent("refreshSidebarScroll")},showImage:function(e){e.css("visibility","visible"),n.getActiveApp().triggerEvent("refreshSidebarScroll")}});return o}),define("modules/fronts/most-popular",["jquery","underscore","baseview","modules/fronts/most-popular-primary","modules/fronts/most-popular-sidebar"],function(e,t,i,s,n){"use strict";var o=i.extend({initialize:function(e){this.subviews={},"sidebar"===e.layoutType?this.subviews.sidebar=new n(e):this.subviews.primary=new s(e),i.prototype.initialize.call(this,e)},renderCardInfo:function(e){this.triggerEvent("renderCardInfo",e)}});return o}),define("modules/rentalslite-classified",["jquery","baseview","state","directAdPosition","managers/routemanager"],function(e,t,i,s,n){var o=t.extend({adRendered:!1,events:{"click .js-rlc-search-btn":"aptsClassifieds"},renderAd:function(){var e=this.$(".js-rlc-google-ad")[0];!this.adRendered&&e&&(this.adRendered=!0,this.subviews.adPositionOne=this.createAdPosition(e))},createAdPosition:function(t){return new s({el:e(t),adSizes:[300,250],adPlacement:e(t).data("adtag")})},initialize:function(e){t.prototype.initialize.call(this),this.renderAd()},aptsClassifieds:function(e){n.goTo(this.$("input:hidden.js-rlc-search-url").val())}});return o}),define("modules/travel/travel-tools",["jquery","baseview"],function(e,t){"use strict";var i=t.extend({events:{"click .ttp-tab":"switchTabs","click .ttp-close":"closeTabs"},switchTabs:function(t){var i=e(t.currentTarget),s=i.attr("data-tabtarget"),n=this.$(s),o=this.$(".ttp-tab-content");this.$el.addClass("tt-dashboard-open"),this.$(".ttp-tab").removeClass("ttp-tab-active"),i.addClass("ttp-tab-active"),o.removeClass("ttp-submodule-active").addClass("ttp-submodule"),n.addClass("ttp-submodule-active").removeClass("ttp-submodule")},closeTabs:function(e){this.$el.removeClass("tt-dashboard-open"),this.$(".ttp-tab-active").removeClass("ttp-tab-active"),this.$(".ttp-submodule-active").removeClass("ttp-submodule-active").addClass("ttp-submodule")}});return i}),define("modules/sports/sports-headline-grid",["jquery","underscore","backbone","state","pubsub","utils","baseview","ui/button-toggle","modules/fronts/headline-grid","modules/scroller/vertical-scroll"],function(e,t,i,s,n,o,a,r,l,h){"use strict";var d=l.extend({el:".sp-filter-bar-wrap",events:function(){return e.extend(l.prototype.events,{"click .sp-filter-link":"getFilteredContent","mouseenter .sp-filter-dropdown":"onHoverFilterDropdown","mouseleave .sp-filter-dropdown":"onHoverFilterDropdown"})},initialize:function(e){l.prototype.initialize.call(this,e)},getFilteredContent:function(i){this.$contentFilterId=e(i.currentTarget);var o=this.$contentFilterId.text(),a=this.$contentFilterId.data("url");this.$(".headline-collection-container").addClass("sp-loading-details"),this.$(".headline-collection-container").html(""),this.$(".sp-filter-btn").html(o),s.fetchHtml(a).done(t.bind(function(e){this.$(".headline-collection-container").html(e),this.$(".headline-collection-container").removeClass("sp-loading-details")},this));var r=this.$contentFilterId.data("ht")+o;r&&n.trigger("uotrack",r)},showMore:function(t){if(t.preventDefault(),e(t.target).hasClass("inactive"))return!1;this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading"));var i,s=this.$(".headline-page.active:last").next(),a=s.attr("data-itemnum"),r=s.attr("data-items-per-page"),l=Math.round(a/r),h=e(".headline-collection");return i=h.hasClass("listview")?"data-list-src":"data-grid-src",o.lazyLoadImage(s.find("img"),i,!0),n.trigger("uotrack",o.getSectionPath(window.location.pathname)+"morestories"+l),this.transitionMore(s),!0},onHoverFilterDropdown:function(t){if("mouseenter"===t.type){var i=e(t.currentTarget),s=i.find(".sp-filter-scroll-wrap");this.subviews.vscroll=new h({el:s,padding:6})}else this.subviews.vscroll&&this.subviews.vscroll.destroy()}});return d}),define("modules/polldaddy-poll",["jquery","underscore","baseview","state"],function(e,t,i,s){"use strict";var n=i.extend({el:".polls-primary-wrapper",events:{"click .pmp-view-results":"toggleLink","click .pmp-answer-option":"submitVote"},initialize:function(e){i.prototype.initialize.call(this,e),this.$q_wrapper=this.$(".poll-question-wrapper"),this.$a_wrapper=this.$(".poll-answer-wrapper"),this.$question=this.$(".pmp-answer-option"),this.$toggle=this.$(".pmp-view-results"),this.$bars=this.$(".pmp-bar"),this.poll_id=this.$question.data("poll"),this.viewResults()},viewResults:function(e){this.getVoteValue()===String(this.poll_id)&&(this.$a_wrapper.addClass("pmp-active"),this.$q_wrapper.remove(),this.$toggle.remove())},toggleLink:function(e){this.$a_wrapper.hasClass("pmp-active")?(this.$a_wrapper.removeClass("pmp-active"),this.$q_wrapper.addClass("pmp-active")):(this.$q_wrapper.removeClass("pmp-active"),this.$a_wrapper.addClass("pmp-active"))},incBarWidths:function(i){var s=[],n=0;t.each(i.answers.answer,function(e){s.push(e.percent)}),e.each(this.$bars,function(){e(this).width(s[n]+"%"),n++})},submitVote:function(i){i.preventDefault();var n=e(i.target),o=n.data("vote"),a=n.data("poll"),r=this;this.getVoteValue()!==String(a)&&s.fetchData("/polls/post/"+a+"/"+o+"/").done(t.bind(function(e){this.setVoteValue(a),this.incBarWidths(e),r.viewResults()},this))},setVoteValue:function(e){localStorage.setItem("polldaddy_pollvote",e)},getVoteValue:function(){return localStorage.getItem("polldaddy_pollvote")}});return n}),define("modules/sports/sports-team-matchup",["jquery","underscore","backbone","baseview","easing"],function(e,t,i,s){var n=s.extend({initialize:function(){s.prototype.initialize.call(this,this.options);var i=0,n=this.$(".sp-matchup-away-stat-chart-fill"),o=this.$(".sp-matchup-home-stat-chart-fill");n.each(t.bind(function(t,s){this.animBar(e(s),i),this.animBar(o.eq(t),i),i+=100},this))},animBar:function(e,t){e.delay(t).animate({width:e.data("percentage")},175,"easeInQuad")}});return n}),define("modules/interactives/line-chart",["jquery","underscore","baseview","utils","modules/interactives/interactive-base"],function(e,t,i,s,n){"use strict";var o=n.extend({getFlotData:function(e){return void 0===e?null:(t.isArray(e)||(e=[e]),t.map(e,function(e,i,s){var n=this.mainColor;return s.length>1&&(n=this.chartColors[i%this.chartColors.length]),{label:e.label||"",color:n,data:t.map(e.value,function(e,t){return[t,e]}),points:{fillColor:n}}},this))},_getMinValue:function(e){var i=Number.MAX_VALUE,s=Number.MIN_VALUE;if(t.each(e,function(e){t.each(e.data,function(e){e=parseFloat(e[1]),i>e&&(i=e),e>s&&(s=e)})}),i===Number.MAX_VALUE)i=s=0;else{i>0&&(i=0);var n=.1*(s-i);s+=n,0>i&&(i-=n)}return[i,s]},getFlotOptions:function(){var e=s.getNested(this.flotData,0,"data","length")||0,t=this._getMinValue(this.flotData),i=n.prototype.getFlotOptions.apply(this,arguments);return i.legend={show:!1,noColumns:1},i.xaxis={ticks:this._createTicks(this.chartData.xaxisvalues||""),autoscaleMargin:.03,position:"bottom",borderColor:"rgb(237,236,236)"},i.yaxis={position:"left",labelHeight:25,borderColor:"rgb(237,236,236)",min:t[0],max:t[1],tickFormatter:this.numberWithCommas},i.series={lines:{show:!0}},i.grid={borderWidth:1,borderColor:"rgb(237,236,236)",labelMargin:5,axisMargin:0,clickable:!0,hoverable:!0,autoHighlight:!0},i.colors=this.colors,13>e?i.series.points={show:!0,radius:5,fill:!0}:e>13&&(i.series.points={show:!1}),i},_getHoverBody:function(e){return[this.getHoverPrefix(),s.addCommas(s.getNested(e,"datapoint","1"))||"",this.getHoverSuffix()].join(" ")}});return o}),define("modules/sports/sports-ballots",["jquery","underscore","backbone","pubsub","state","utils","baseview","modules/interactives/line-chart","modules/sports/popup-details","modules/scroller/horizontal-scroll","modules/scroller/sidebar-scroll"],function(e,t,i,s,n,o,a,r,l,h,d){var c=l.extend({el:".card-container",events:{"click .ballot-key":"onBallotKeyClick","mouseenter .ballot-matrix-row":"onMatrixRowEnter","mouseenter .ballot-matrix-column":"onMatrixColumnHover","mouseleave .ballot-matrix-column":"onMatrixColumnHover","click .sp-details-film":"onDetailsClose","click .sp-graph-btn, .sp-table-btn":"showGraph","mouseleave .ballot-matrix-scrollable":"onBallotMatrixHover","mouseenter .ballot-matrix-scrollable":"onBallotMatrixHover"},initialize:function(){l.prototype.initialize.call(this,this.options),this.$activeBallotLink=this.$(".coaches-ballot .active"),this.$pickerValuesBox=this.$(".ballot-picker-values"),t.bindAll(this,"ballotScrollers"),this.ballotScrollers(),this.$activeMatrixRow=this.$(".coaches-ballot .active-row"),this.$activeMatrixColumn=this.$(".coaches-ballot .active-columnn"),this.$activeRanks=[],this.$activeVotes=[],window.onresize=function(e){this.$(".sp-ballot-matrix-table").removeAttr("style")},this.$activeBallotLink.click()},ballotScrollers:function(){var e=this;this.$(".sp-scrollable-details").each(function(t){e.subviews["ballots"+t]&&e.subviews["ballots"+t].destroy(),e.subviews["ballots"+t]=new d({el:this})})},onBallotKeyClick:function(i){i.preventDefault();var o=e(i.currentTarget).data("ht"),a=e(i.currentTarget).data("id");this.$pickerValuesBox.addClass("loading-panel"),this.$activeBallotLink.removeClass("active"),this.$activeBallotLink=e(i.currentTarget);var r=this.$activeBallotLink.data("url");n.fetchHtml(r).done(t.bind(function(e){this.$(".ballot-picker-values").html(e),this.$pickerValuesBox.removeClass("loading-panel"),this.ballotScrollers()},this)),this.$activeBallotLink.addClass("active"),o+=a,o&&s.trigger("uotrack",o)},onBallotMatrixHover:function(t){if("mouseenter"===t.type){var i=e(t.currentTarget);this.subviews.scroll=new h({el:i,delayScroll:!1}),this.$(".horizontal-scroll")&&"none"!=this.$(".horizontal-scroll").css("display")&&this.$(".sp-ballot-matrix-table").css("margin-bottom","7px")}else this.subviews.scroll&&this.$(".sp-ballot-matrix-table").css("margin-bottom","0px"),this.subviews.scroll.destroy()},onMatrixRowEnter:function(t){t.preventDefault(),this.$activeMatrixRow.removeClass("active-row"),e(this.$activeRanks).each(function(){e(this).removeClass("active-rank")}),this.$activeRanks=[],this.$activeMatrixRow=e(t.currentTarget).parent(),this.$activeMatrixRow.addClass("active-row");var i=this.$activeMatrixRow.data("votes");for(var s in i)i[s]&&(e(i[s]).addClass("active-rank"),this.$activeRanks.push(e(i[s])))},onMatrixColumnHover:function(t){if(t.preventDefault(),this.$activeMatrixColumn=e(t.currentTarget),this.$activeMatrixColumn.toggleClass("active-column"),e("."+this.$activeMatrixColumn.data("id")).each(function(){e(this).toggleClass("active-column")}),"mouseenter"===t.type){var i=this.$activeMatrixColumn.data("votes");for(var s in i)i[s]&&(e(i[s]).addClass("active-ballot"),e(i[s]).html(parseInt(s,10)+1),this.$activeVotes.push(e(i[s])))}else e(this.$activeVotes).each(function(){e(this).removeClass("active-ballot"),e(this).html("")}),this.$activeVotes=[]},showGraph:function(t){var i=e(t.currentTarget).data("ht"),n=e(t.currentTarget).data("icon-value"),o=n+"-"+this.$(".sp-filter-btn").text().toLowerCase(),a=this.$(".sp-subhead-name").text();this.$ballotWeeklyTable=this.$(".ballotWeeklyTable"),this.$ballotWeeklyGraph=this.$(".ballotWeeklyGraph"),this.$ballotWeeklyPopupDiv=this.$(".sp-ballot-weekly-popup"),this.$ballotWeeklyPopupDiv.removeClass("active").addClass("inactive");var l=this.$('div[data-icon="'+o+'"]');l.removeClass("inactive").addClass("active"),"sp-profile-table"==n?(this.$(".sp-table-btn.sp-ballot-weekly-icon").removeClass("table-off").addClass("table-on"),this.$(".sp-graph-btn.sp-ballot-weekly-icon").removeClass("graph-on").addClass("graph-off"),this.$ballotWeeklyTable.removeClass("inactive").addClass("active"),this.$ballotWeeklyGraph.removeClass("active").addClass("inactive")):"sp-profile-graph"==n&&(this.$(".sp-graph-btn").removeClass("graph-off").addClass("graph-on"),this.$(".sp-table-btn").removeClass("table-on").addClass("table-off"),this.$ballotSportsCharts=this.$(".interactive.weekly-line-graph"),this.subviews.lgraph=new r({el:this.$ballotSportsCharts}),this.$(".coordExpenses").removeClass("coordExpenses").addClass("coord"),this.$ballotWeeklyTable.removeClass("active").addClass("inactive"),this.$ballotWeeklyGraph.removeClass("inactive").addClass("active")),i+=a,i&&s.trigger("uotrack",i)}});return c}),define("modules/travel/travel-email",["jquery","underscore","baseview","state","utils","pubsub"],function(e,t,i,s,n,o){var a=i.extend({updateMessage:function(i){var s;try{i=e.parseJSON(i)}catch(n){i={}}if(i.travelEmailMessage&&(s=i.travelEmailMessage,s.errorControl&&this.travelEmailForm.find('input[name="'+s.errorControl+'"]').addClass("travel-email-form-input-error").attr("placeholder","Required: "+s.errorControl),"travel-email-success"==s.status)){o.trigger("uotrack","travelfrontemail");var a=t.template('<div class="travel-email-confirmation"><div class="travel-email-thank-you"><%= message %></div><div>We\'ll be in touch with you soon.</div></div>'),r=a({message:s.message});this.travelEmailForm.find(".travel-email-wrapper").html(r).addClass("travel-email-submitted"),this.travelEmailForm.find("input").removeClass("travel-email-form-input-error")}},initialize:function(s){this.travelEmailForm=e(this.$el),this.win=n.get("win"),this.win.on("message."+this.cid,t.bind(function(e){var t=window.location.protocol+"//"+window.location.host;e.originalEvent.origin.replace(/\/$/,"")==t&&"undefined"!=e.originalEvent.data.travelEmailMessage&&this.updateMessage(e.originalEvent.data)},this)),i.prototype.initialize.call(this,s)},destroy:function(e){this.win.off("."+this.cid),i.prototype.destroy.call(this,e)}});return a}),define("apps/overlay/pages/book-reviews-overlay",["jquery","underscore","backbone","baseview","ui/dropdown"],function(e,t,i,s,n){"use strict";var o=s.extend({initialize:function(e){this.subviews={},this.subviews.dropdown=new n({el:this.$(".books-buy-button")}),s.prototype.initialize.call(this,{})}});return o}),define("modules/users/site-nav-user-module",["jquery","underscore","pubsub","utils","modules/header/site-nav-dropdown","user-manager"],function(e,t,i,s,n,o){"use strict";var a=n.extend({ALT_ACTIVE_CLASS:"site-nav-visible-alt-span",WRAP_ACTIVE_CLASS:"site-nav-user-dropdown-wrap-active",events:{"click .site-nav-user-login-btn":"onClickLogin","click .site-nav-user-logout-btn":"onClickLogout"},initialize:function(e){this.pubSub={"user:login":this.showLoggedInUser,"user:logout":this.showLoggedOutUser},t.bindAll(this,"_handleDropdownPanels","showLoggedInUser","showLoggedOutUser"),this.events=t.extend({},n.prototype.events,this.events),this.$loginWrap=this.$(".site-nav-user-logged-in-wrap"),this.$logoutWrap=this.$(".site-nav-user-logged-out-wrap"),this.$siteNavAltSpan=this.$(".site-nav-alt-span"),this.$avatarContainer=this.$(".site-nav-user-avatar-span"),this.$userDisplayName=this.$(".site-nav-user-display-name"),this.$avatar=this.$(".site-nav-user-avatar-image"),n.prototype.initialize.call(this,e),this._handleDropdownPanels()},_handleDropdownPanels:function(){this.isUserLoggedIn?(this.$loginWrap.addClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.removeClass(this.WRAP_ACTIVE_CLASS)):(this.$loginWrap.removeClass(this.WRAP_ACTIVE_CLASS),this.$logoutWrap.addClass(this.WRAP_ACTIVE_CLASS))},showLoggedOutUser:function(){this.isUserLoggedIn=!1,this._teardownLoggedInMarkup(),this._handleDropdownPanels()},showLoggedInUser:function(){this._setupLoggedInMarkup(o.getAccount()),this.isUserLoggedIn=!0,this._handleDropdownPanels()},_setupLoggedInMarkup:function(e){var t=e.getUserFirstName()+" "+e.getUserLastName();this.$avatar.attr("src",e.getUserAvatar()),this.$avatar.attr("alt",t),this.$siteNavAltSpan.addClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html(t)},_teardownLoggedInMarkup:function(){this.$avatar.attr("src",""),this.$avatar.attr("alt",""),this.$siteNavAltSpan.removeClass(this.ALT_ACTIVE_CLASS),this.$userDisplayName.html("")},onClickLogout:function(){this.showLoggedOutUser(),o.logoutUser().done(function(){i.trigger("uotrack","headerprofilelogout")})},onClickLogin:function(t){var s=e(t.target).data("user-account");o.loginUser(s).done(function(){i.trigger("uotrack","headerprofilelogin")})},destroy:function(e){this._teardownLoggedInMarkup(),n.prototype.destroy.call(this,e)}});return a}),define("modules/fronts/snapshots",["jquery","underscore","baseview","state","cookie"],function(e,t,i,s){var n=i.extend({el:".front-galleries-module",events:{"click a.vote":"revealQuickQuestion","click .snap-vote a.cancel":"revealSnapshotTeaser","click a.snap-vote-btn":"registerVote"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.render()},render:function(){if(e("#snapshots").length<=0){var t=this.$(".js-fg-nav-list"),i=t.find("li:first-child"),s=t.data("item-class")||"",n=t.data("link-class")||"";i.after('<li data-id="gallery" id="snapshots" class="front-gallery-item news-theme-border-hover '+s+'" data-href="/services/snapshots/gallery/" data-theme="news-theme-border"><a class="front-gallery-link '+n+'" href="/services/snapshots/gallery/" data-href="/services/snapshots/gallery/">Snapshots</a></li>')}},revealQuickQuestion:function(t){var i=e(t.currentTarget).closest(".snapshot-card");e(".snapshot",i).hide(),e(".snap-vote",i).not(".results").fadeIn();
},revealSnapshotTeaser:function(t){var i=e(t.currentTarget).closest(".snapshot-card");e(".snap-vote",i).hide(),e(".snapshot",i).fadeIn()},revealResults:function(t,i){var s=e(t.currentTarget).closest(".snapshot-card");s.find(".snap-vote.results").length?s.find(".snap-vote.results").replaceWith(i):s.append(i),e(".snap-vote",s).hide(),e(".snap-vote.results",s).fadeIn()},registerVote:function(i){var n,o=(e(i.currentTarget).closest(".snapshot-card"),e(i.currentTarget).attr("data-answer-id"));e(i.currentTarget).addClass("loading");var a=this.$(".slide.active[data-qqid]").attr("data-qqid");n=e.cookie(a)?"/services/snapshots/get/"+a+"/":"/services/snapshots/vote/"+o+"/"+a+"/",this.ajax=s.fetchData(n).done(t.bind(function(s){var n=t.pluck(s.quick_question.answers,"votes"),o=t.reduce(n,function(e,t){return e+parseFloat(t)},0),r=s.quick_question.answers.length-1,l=0;t.each(s.quick_question.answers,function(e,t){var i=Math.round(parseFloat(e.votes)/o*100);t===r?i=100-l:l+=i,e.answerPercent=i});var h=e("#snapshot-results"),d=t.template(h.html(),{data:s.quick_question});this.revealResults(i,d),e(i.currentTarget).removeClass("loading"),e.cookie(a,!0)},this))}});return n}),define("modules/money/job-search",["jquery","underscore","baseview","state","form/base-form"],function(e,t,i,s,n){"use strict";var o=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),s.fetchData("/money/jobs/categories/",{timeout:1e4}).done(t.bind(function(e){this.$(".jobs-form-dropdown").html(e)},this)).always(t.bind(function(){this.subviews.jobSearchForm=new n({el:this.$(".jobs-form-wrap")})},this))}});return o}),define("modules/sports/sports-story-video",["jquery","underscore","state","pubsub","backbone","baseview","directAdPosition","modules/global/brightcove-video","modules/stories/share-facebook","bxslider"],function(e,t,i,s,n,o,a,r,l){"use strict";var h=r.extend({events:function(){var e=r.prototype.events;return t.isFunction(e)&&(e=e()),t.extend({},e,{"click .sports-video-promo-link":"createPlayer"})},initialize:function(i){r.prototype.initialize.call(this,i),this.$spVideoObj=e(".sp-video-player-modal"),this.isPlaying=!1,this.$globalHeaderEl=e("body header:first"),this.$overlayCloseEl=e(".close-wrap"),this.activeVideoId="",this.modalHtml='<div id="sp-videomodal-overlay" class="sp-videomodal-overlay"></div>',this.modalHtml+='<div id="sp-videomodal-container" class="sp-videomodal-container">',this.modalHtml+='<a id="sp-videomodal-close" class="sp-videomodal-close" title="Close"></a>',this.modalHtml+='<div id="sp-videomodal-wrapper" class="sp-videomodal-wrapper loading">',this.modalHtml+="</div></div>",this.$promoEl="",this.videoType="",this.cuedVideoId="",this.autoRotate=!0,this.subviews={},t.bindAll(this,"createPlayer","onBrightCoveLoad","onTemplateReady","onVideoComplete","onVideoStart","isPlayingHandler","determineCompletion"),this._initAd()},_buildBrightCoveLoadCallback:function(){e(".sp-video-player-modal").length>0&&(this.$brightcove=e(".sp-video-player-modal .BrightcoveExperience"),this.brightcoveId=e(".sp-video-player-modal .BrightcoveExperience").attr("id")),window.BCCallbacks||(window.BCCallbacks={}),window.BCCallbacks[this.brightcoveId]=this.onBrightCoveLoad,window.brightcove.createExperiences(),window.BCLoad?console.log("BCLoad is already here"):window.BCLoad=function(e){window.BCCallbacks[e]?window.BCCallbacks[e](e):console.log("received brightcove callback for video that does not exist: "+e)}},_initAd:function(){var e=this.$(".sp-player-sponsor");e.length&&(this.subviews.ad=new a({el:e,adSizes:["sponsor_logo"],adPlacement:"video_sponsor_logo",pageInfo:i.getActivePageInfo()}))},updateTrackingDataObj:function(e){this.$videoObj=e},createPlayer:function(i){""===this.$promoEl&&(i.preventDefault(),this.$promoEl=e(i.currentTarget)),"undefined"!=typeof window.brightcove?this.fetchPlaylist(this.$promoEl):this.loadScripts(t.bind(this.createPlayer,this))},loadVideoById:function(t,i){this.updateTrackingDataObj(i),this.closeShare(),this.updateActiveItem(i),this.modVP.loadVideoByID(t),this.populateUtilityShare(e(i).find("a"))},fetchPlaylist:function(s){this.showModal();var n=e(s).data("playlistid"),o=e(s).data("playerid"),a=e(s).data("playerkey"),r=e(s).data("awspath");this.modifyGlobalElements();var l="/sports/services/sports-video/playlist/"+o+"/"+n+"/"+a+"/?awspath="+r,h=this.launchVideoPromo;i.fetchHtml(l).done(t.bind(h,this))},launchVideoPromo:function(t){e("#sp-videomodal-wrapper").html(t),e("#sp-videomodal-wrapper").removeClass("loading"),this.$videoObj=e(".sp-video-player-modal .player"),this._buildBrightCoveLoadCallback(),this.initPlaylistCarousel(),this.initShareEvents()},initPlaylistCarousel:function(){this.$sliderEl=e(".sp-video-player-modal .bxslider"),this.$sliderEl.bxSlider({slideWidth:128,minSlides:1,maxSlides:6,pager:!1,slideMargin:10,onSliderLoad:t.bind(function(){this.initPlaylistItems()},this),onSlideAfter:t.bind(function(e,t,i){this.$sliderEl.find("a[data-id='"+this.activeVideoId+"']").parent().addClass("active")},this)})},initPlaylistItems:function(){this.$spVideoObj=e(".sp-video-player-modal"),this.activeEl=e(".sp-video-player-modal .bxslider .active"),this.activeVideoId=this.activeEl.find("a").data("id"),this.$nextEl=e(".sp-video-player-modal .bxslider .active").next(),this.nextAsset=e(".sp-video-player-modal .bxslider .active").next().find("a").data("id"),e(".sp-video-player-modal .bxslider .item a").click(t.bind(function(t){t.preventDefault();var i=e(t.currentTarget).data("id"),s=e(t.currentTarget).data("title");e(t.currentTarget).parent().siblings().removeClass("active"),e(t.currentTarget).parent().addClass("active"),e(".sp-video-player-modal .asset-title").html(s),this.loadVideoById(i,e(t.currentTarget).parent())},this))},modifyGlobalElements:function(){this.$globalHeaderEl.css("position","relative").css("z-index","1000"),this.$overlayCloseEl.hide()},resetGlobalElements:function(){this.$globalHeaderEl.css("position","interit").css("z-index","auto"),this.$overlayCloseEl.show()},initShareEvents:function(){this.subviews.shareTools=new l({el:".sp-video-player-modal"}),e(".util-bar-btn-facebook").click(t.bind(function(){this.pausePlayer()},this)),e(".util-bar-flyout-close-ribbon").click(t.bind(function(){this.unpausePlayer()},this))},populateUtilityShare:function(t){var i=e(t).data("title"),s=e(t).data("desc"),n=e(t).data("shorturl"),o=e(t).data("pageurl"),a="https://twitter.com/intent/tweet?url="+n+"&via=USATODAY&text="+i,r="//plus.google.com/share?url="+n,l="http://www.linkedin.com/shareArticle?url="+n+"&mini=true",h="";h=e(t).find("figure").length>0?e(t).find("figure").find("img").attr("src"):e(t).data("imageurl"),this.$spVideoObj.find(".util-bar-flyout-nav-btn-twitter").attr("href",a),this.$spVideoObj.find(".util-bar-flyout-nav-btn-googleplus").attr("href",r),this.$spVideoObj.find(".util-bar-flyout-nav-btn-linkedin").attr("href",l),this.$spVideoObj.find(".util-bar-share-message-facebook").data("link",o),this.$spVideoObj.find(".util-bar-share-message-facebook").data("title",i),this.$spVideoObj.find(".util-bar-share-message-facebook").data("image",h),this.$spVideoObj.find(".util-bar-share-form-email textarea").html(i+"on USAToday.com: "+n),this.$spVideoObj.find(".util-bar-share-summary-title").html(i),this.$spVideoObj.find(".util-bar-share-summary-description").html(s),this.$spVideoObj.find(".util-bar-share-summary-image").data("src",h),this.$spVideoObj.find(".util-bar-share-summary-image").attr("src",h),this.$spVideoObj.find(".util-bar-share-loading-facebook").data("image",h)},pausePlayer:function(){i.startRefreshTimer();this.modVP.getIsPlaying(t.bind(function(e){e===!1?this.isPlaying=!1:this.isPlaying=!0},this));this.modVP.pause(!0)},unpausePlayer:function(){i.stopRefreshTimer(),this.isPlaying===!0&&this.modVP.pause(!1)},showModal:function(){var i=e(document).scrollTop()+30;e("body").append(this.modalHtml),e("#sp-videomodal-container").css("top",i+"px"),e("#sp-videomodal-overlay").fadeIn("slow",function(){e("#sp-videomodal-container").fadeIn("slow")}),e("#sp-videomodal-overlay").click(t.bind(function(e){this.closeModal(e)},this)),e("#sp-videomodal-close").click(t.bind(function(e){this.closeModal(e)},this))},setNextAsset:function(t){e(t).next(".item").length>0?(this.nextAsset=e(t).next().find("a").data("id"),this.$nextEl=e(t).next()):(this.nextAsset=e(t).siblings().filter(":first").find("a").data("id"),this.$nextEl=e(t).siblings().filter(":first"))},updateActiveItem:function(t){this.activeEl=t,this.activeVideoId=e(t).find("a").data("id"),e(t).siblings().removeClass("active"),e(t).addClass("active"),this.setNextAsset(e(t))},closeShare:function(){e(".util-bar-flyout-share-video").hasClass("open")&&e(".util-bar-flyout-close-ribbon").trigger("click")},closeModal:function(t){this.modExp.removeEventListener(window.brightcove.api.events.ExperienceEvent.TEMPLATE_READY,this.onTemplateReady),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.BEGIN,this.onVideoStart),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.COMPLETE,this.onVideoComplete),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PLAY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.STOP,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.SEEK_NOTIFY,this.onMediaEventFired),this.modVP.removeEventListener(window.brightcove.api.events.MediaEvent.PROGRESS,this.throttledDetermine),this.resetGlobalElements(),e("#sp-videomodal-overlay").fadeOut("fast",function(){e(this).remove()}),e("#sp-videomodal-container").fadeOut("fast",function(){e(this).remove()})},onVideoComplete:function(){if(this.$activeEl=this.$nextEl,this.autoRotate!==!1&&(this.loadVideoById(this.nextAsset,this.$nextEl),e(".sp-video-player-modal").length>0)){var t=e(".sp-video-player-modal .bx-viewport").innerWidth(),i=e(".sp-video-player-modal .bx-viewport").offset().left,s=i+t,n=e(this.$activeEl).offset().left;n>s&&e(".sp-video-player-modal .bx-next").trigger("click"),e(".sp-video-player-modal .asset-title").text(e(this.$nextEl).find("a").data("title"))}},onBrightCoveLoad:function(e){r.prototype.onBrightCoveLoad.apply(this,arguments),this.videoType=this.player.type},onTemplateReady:function(e){r.prototype.onTemplateReady.apply(this,arguments),"html"===this.videoType&&this.modVP.canPlayWithoutInteraction()?this.modVP.cueVideoByID(this.cuedVideoId):this.modVP.loadVideoByID(this.cuedVideoId)},destroy:function(e,t){o.prototype.destroy.apply(this,arguments)}});return h}),define("modules/sports/sports-multipurpose-promo",["jquery","underscore","baseview","pubsub"],function(e,t,i,s){var n=i.extend({initialize:function(){this.$promo=e("#sports-multipurpose-promo"),this.active_mod=this.$promo.attr("activemod"),"countdown"==this.active_mod&&(this.$countdown=e(".sports-countdown"),this.countdown_transition_target=this.$countdown.data("transitionlink"),this.countdown_preview_target=this.$countdown.data("previewink"),this.secondsInMinute=60,this.secondsInHour=60*this.secondsInMinute,this.secondsInDay=24*this.secondsInHour,this.startDate=this.$countdown.data("startdate")?new Date(this.$countdown.data("startdate")):new Date,this.endDate=this.$countdown.data("enddate")?new Date(this.$countdown.data("enddate")):this.startDate,this.endDate<this.startDate&&(this.endDate=this.startDate),this.dateDiffInSeconds=Math.ceil(.001*(this.endDate-new Date)),this.dateDiffInSeconds>0?this.startCountdown():this.countdownTransition(this.countdown_transition_target))},startCountdown:function(){this.timer=setInterval(e.proxy(function(){this.dateDiffInSeconds=this.dateDiffInSeconds-1;var e=Math.floor(this.dateDiffInSeconds/this.secondsInDay),t=this.dateDiffInSeconds%this.secondsInDay,i=Math.floor(t/this.secondsInHour),s=t%this.secondsInHour,n=Math.floor(s/this.secondsInMinute),o=Math.ceil(s%this.secondsInMinute);this.$countdown.find("#days").text(10>e?"0"+e:e),this.$countdown.find("#hours").text(10>i?"0"+i:i),this.$countdown.find("#minutes").text(10>n?"0"+n:n),this.$countdown.find("#seconds").text(10>o?"0"+o:o),this.dateDiffInSeconds<=0&&this.countdownTransition(this.countdown_transition_target)},this),1e3)},countdownTransition:function(t){clearInterval(this.timer),e("#sports-multipurpose-promo .sports-countdown-img img").attr("src",t),e("#sports-multipurpose-promo #clock_display").hide()},destroy:function(e){clearInterval(this.timer),i.prototype.destroy.call(this,e)}});return n}),define("modules/travel/kayak-module",["jquery","underscore","baseview","state","pubsub","form/base-form"],function(e,t,i,s,n,o){"use strict";var a=i.extend({el:".kayak-wrapper",events:{"click .kayak-btn":"kayakWidgetBtnClick","click .flight-select-radio-btn":"onFlightRadioButtonClick","clock .kayak-submit":"onKayakSubmitClick"},initialize:function(e){t.bindAll(this,"kayakWidgetBtnClick","tabTransition","onHotelAutoCompleteSelect","datePickerBeforeShow","datePickerBeforeShowDay"),i.prototype.initialize.call(this,e),this.$kayakHotelId=this.$("#kayak-hotel-id"),this._setupDropdownDates(),this._setupForms(),this.tabAnimHeights=this._getTabHeights(this.$(".kayak-tab")),this.$activeTab=this.$(".kayak-btn.active"),this.tabTransition(this.$(".kayak-btn.active").data("type"),!0),this.$("form").submit(function(){n.trigger("uotrack","kayaksearch")})},onHotelAutoCompleteSelect:function(e,t){t.hid?this.$kayakHotelId.val(t.hid):this.$kayakHotelId.val("")},getTabHeight:function(e){return this.tabAnimHeights[e]},setTabHeight:function(e,t){this.tabAnimHeights[e]=t},kayakWidgetBtnClick:function(t){var i=e(t.currentTarget),s=i.data("type"),o="kayak"+s;n.trigger("heattrack",o),this.tabTransition(s,!1)},tabTransition:function(e,i){var s=this.$(".kayak-tab-"+e),n=this.$activeTab,o="kayak-tab-active",a=this.getTabHeight(e);n&&s[0]===n[0]||(n&&n.removeClass(o),this.animTabWrapperHeight(a).done(t.bind(function(){this.makeButtonActive(e),s.fadeIn(250,t.bind(function(){s.addClass(o),this.$activeTab=s},this))},this)))},animTabWrapperHeight:function(e){return this.animate(this.$(".kayak-search-widget").stop(),"height",e+"px",150,"linear",0)},makeButtonActive:function(e){var t="active",i=this.$(".kayak-"+e+"-btn");i&&(this.$activeBtn&&this.$activeBtn.removeClass(t),i.addClass(t),this.$activeBtn=i)},onFlightRadioButtonClick:function(t){this.switchView(e(t.currentTarget).val())},switchView:function(e){var i=this.$(".flights-"+e+"-container"),s="kayak-flight-view-active",n=i[0].scrollHeight;this.$(".kayak-flight-view").removeClass(s),this.animTabWrapperHeight(n).done(t.bind(function(){i.fadeIn(250).addClass(s),this.setTabHeight("flights",n)},this))},_setupForms:function(){var i=[];this.$(".kayak-tab-hotels .kayak-auto, .kayak-tab-deals .kayak-auto").each(t.bind(function(t,s){i.push({el:e(s),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= displayname %>",maxResults:5,onSelect:this.onHotelAutoCompleteSelect,ajaxOptions:{dataType:"jsonp"}})},this)),this.$(".kayak-tab-flights .kayak-auto").each(function(){i.push({el:e(this),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= ap %>",maxResults:5,ajaxOptions:{dataType:"jsonp"}})}),this.$(".kayak-tab-vacations .kayak-auto").each(function(){i.push({el:e(this),resultDisplayTemplate:"<%= displayname %>",resultValueTemplate:"<%= displayname %>",maxResults:5,ajaxOptions:{dataType:"jsonp"}})}),this.$(".ui-date-picker").each(t.bind(function(t,s){var n=e(s),o=n.parent().find(".ui-date-picker-btn");i.push({el:n,buttonSelector:o,calendarPanelClass:"ui-light",changeMonth:!0,changeYear:!0,minDate:null,maxDate:null,showOtherMonths:!0,selectOtherMonths:!0,showMonthAfterYear:!0,dateFormat:"m/d/yy",dayNamesMin:["S","M","T","W","T","F","S"],beforeShow:this.datePickerBeforeShow(e(s)),beforeShowDay:null})},this)),this.$(".kayak-form").each(t.bind(function(t,s){this.subviews["form"+t]=new o({el:e(s),formOptions:i})},this));var s=new Date,n=s.getMonth()+1+"/"+s.getDate()+"/"+s.getFullYear();this.$(".kayak-date-picker-field").val(n)},datePickerBeforeShow:function(t){t.find(e(".ui-date-picker-btn")).addClass("kayak-date-picker-flyout"),t.find(e(".ui-date-picker-btn")).addClass("ui-light")},datePickerBeforeShowDay:function(e){var t=e.getDay();return[0!==t,""]},_setupDropdownDates:function(){var e=10,t=["January","February","March","April","May","June","July","August","September","October","November","December"],i=(new Date).getMonth(),s=(new Date).getFullYear(),n=t.length,o=i,a=e+o,r=a-n,l=function(e,t){for(var i=0,s=e.length;s--;)e[i]+=" "+t,i++},h=function(e){var t=e.substr(e.indexOf(" ")+1);return t},d=[].concat(t.slice(o,a));if(l(d,s),r>0){var c=t.slice(0,r);l(c,s+1),d.push.apply(d,c)}for(var u=0;e>u;u++){var p=h(d[u]),f=i+u+1;f>12&&(f-=12),this.$("#kayakCruiseDateDropdown").append('<option value="'+f+"/1/"+p+'">'+d[u]+"</option>"),f=i+u+1}},_getTabHeights:function(i){var s={};return t.each(i,function(t){var i=e(t),n=i.data("tab-id");if(s[n]=i[0].scrollHeight,"flights"===n){var o=this.$(".flight-select-radio-btn:checked").val(),a=this.$(".flights-"+o+"-container");s.flights=a[0].scrollHeight}},this),s}});return a}),define("modules/header/site-nav-search-trending-module",["jquery","underscore","baseview","pubsub","modules/header/site-nav-dropdown"],function(e,t,i,s,n){"use strict";var o=n.extend({events:function(){return t.extend({},n.prototype.events,{"click .search-tr-module-trending-item":"updateSearch","submit .search-tr-module-form":"formSubmit"})},initialize:function(e){this.searchForm=this.$(".search-tr-module-form"),this.searchInput=this.$(".search-tr-module-input"),this.searchTrending=this.$(".search-tr-module-trending"),this.trackLabel="",n.prototype.initialize.call(this,e)},updateSearch:function(t){this.searchInput.val(e(t.currentTarget).find(".search-tr-module-trending-item-tag-js").text()),this.trackLabel="search|"+e(t.currentTarget).find(".search-tr-module-trending-item-tag-js").data("track-headline-var"),this.searchForm.submit()},formSubmit:function(e){""===this.trackLabel&&(this.trackLabel="search|"+this.searchInput.val()),s.trigger("track",{label:this.trackLabel})}});return o}),define("modules/travel/travel-experience",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(e,t,i,s,n,o){var a=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer"},initialize:function(s){t.bindAll(this,"automate","goTo"),s=e.extend({transition:{interval:15e3}},s),this.subviews={},this.moveMe=this.$(".exp-travel-wrapper"),this.viewport=this.moveMe.parent(),this.subviews.paginator=new o({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.viewport.outerWidth(),i=t*e;this.animate(this.moveMe,"left","-"+i+"px",450,"ease-in-out")},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)}});return a}),define("modules/longform/longform-poster-ad-bottom",["jquery","underscore","baseview","utils","state","directAdPosition"],function(e,t,i,s,n,o){"use strict";var a=i.extend({el:".longform-poster-ad-bottom",initialize:function(t){t=e.extend({adPlacement:"poster",adSizes:["mediumrectangle"],adType:"generic"},t),i.prototype.initialize.call(this,t),this._buildAd()},_buildAd:function(){this.subviews.posterAd||(this.subviews.posterAd=new o({el:this.$(".poster-ad"),adSizes:this.options.adSizes,adPlacement:this.options.adPlacement,adType:this.options.adType}))}});return a}),define("modules/stories/inline-share-tools",["jquery","baseview","pubsub","state"],function(e,t,i,s){var n=t.extend({events:{"click .inline-share-btn":"onClickInlineShareBtn"},onClickInlineShareBtn:function(t){var i=e(t.currentTarget);if("A"!==i.prop("tagName")){t.preventDefault();var n=e(t.currentTarget).data("share-method");s.getActiveApp().$(".util-bar-btn-"+n).trigger("click")}}});return n}),define("modules/sports/sports-event-tool",["jquery","underscore","backbone","pubsub","state","utils","baseview","form/datepicker"],function(e,t,i,s,n,o,a,r){var l=a.extend({events:{"click .event-tool-icon, .fixture-tool-icon":"onEventToolLaunch","click .event-tool-reset, .event-tool-insert":"onEventToolAction"},initialize:function(){this.checkFFDQ=null,this.$datepicker_filter=e(".sp-filter-date-picker-wrap"),a.prototype.initialize.apply(this,arguments),t.bindAll(this,"checkFileQueue","onEventToolAction"),this.subviews.datepicker=new r({el:this.$(".sp-filter-date-picker-input"),buttonSelector:".sp-filter-date-picker-btn",flyoutClass:"sp-filter-date-picker-flyout",calendarPanelClass:"ui-dark",dateFormat:"yy-mm-dd",changeMonth:!0,changeYear:!0,yearRange:"-4:+1"})},checkFileQueue:function(){var e=this.check;n.fetchHtml(e).done(t.bind(function(e){e.find(".event-tool-result").length?(this.btn.html(e.find(".event-tool-result")),clearInterval(this.checkFFDQ),window.opener.location.reload()):console.log("Failed to load: "+this.url)},this))},onEventToolAction:function(i){this.btn=e(i.currentTarget);var s=this.btn.data("url");this.check=this.btn.data("check"),n.fetchHtml(s).done(t.bind(function(e){e.find(".event-tool-result").length?(this.btn.html(e.find(".event-tool-result")),this.check?(clearInterval(this.checkFFDQ),this.checkFFDQ=setInterval(this.checkFileQueue,1e4)):window.opener.location.reload()):console.log("Failed to load: "+this.url)},this))},onEventToolLaunch:function(t){console.log("launch tool");var i=e(t.currentTarget),s=i.data("url");window.open(s,"sports-event-tool","toolbar=0,location=0,status=0,menubar=0,resizeable=1,scrollbars=1,left=10,top=10,width=600,height=900")},destroy:function(){clearInterval(this.checkFFDQ),a.prototype.destroy.apply(this,arguments)}});return l}),define("modules/partner/taboola-exchange",["baseview"],function(e){"use strict";return e}),define("modules/stories/utility-bar-module-comments",["jquery","underscore","backbone","pubsub","utils","modules/stories/utility-bar-flyout","modules/scroller/vertical-scroll","third-party-apis/facebook/facebook"],function(e,t,i,s,n,o,a,r){var l=o.extend({initialize:function(i){this.pubSub={"breakingbar:after:open":this.scalePanel},i=e.extend({noFlyoutScroll:!0},i),this.events=t.extend({},o.prototype.events,this.events),o.prototype.initialize.call(this,i)},attachCommentListener:function(){r.loadScript().done(function(){FB.getLoginStatus(function(e){"connected"===e.status&&(FB.Event.subscribe("comment.create",function(){s.trigger("comment:created")}),FB.Event.subscribe("comment.remove",function(){s.trigger("comment:removed")}))})})},unattachCommentListener:function(){r.loadScript().done(function(){FB.getLoginStatus(function(e){"connected"===e.status&&(FB.Event.unsubscribe("comment.create"),FB.Event.unsubscribe("comment.remove"))})})},loadComments:function(){return r.loadScript().done(t.bind(function(){FB.XFBML.parse(this.$scrollable[0]),this.scrollableHeight=this.$scrollable.height(),this.heightPoll=setInterval(t.bind(function(){this.scrollableHeight!==this.$scrollable.height()&&(this.scrollableHeight=this.$scrollable.height(),this.scalePanel())},this),200),this.$scrollWrap.css("overflow","auto")},this))},onWindowResize:function(){this.scalePanel(),o.prototype.onWindowResize.call(this)},scalePanel:function(){this.$scrollWrap.css("height",this.$win.height()-n.get("headerHeight")-115),this.subviews.vscroll&&this.subviews.vscroll.refresh()},open:function(){this.$scrollWrap=this.$(".util-bar-scroll-wrap"),this.$scrollable=this.$(".scrollable-content"),this.$fbPluginWrap=this.$(".facebook-comments-plugin-wrap"),this.$win=n.get("win"),this.loadComments().done(t.bind(function(){this.attachCommentListener(),s.trigger("uotrack","UtilityBarCommentsOpen"),o.prototype.open.call(this)},this))},close:function(){s.trigger("uotrack","UtilityBarCommentsClose"),this.destroy()},destroy:function(e){clearInterval(this.heightPoll),this.unattachCommentListener(),o.prototype.destroy.call(this,e)}});return l}),define("modules/sports/sports-popup-media-view",["jquery","underscore","backbone","pubsub","baseview","modules/sports/sports-front-galleries","modules/global/brightcove-video","state","ui/loader"],function(e,t,i,s,n,o,a,r,l){var h=n.extend({el:"body",events:{"click .video-popup-close":"hideVideo","click .popup-media-video":"showVideo","click .popup-media-gallery":"showGallery","click .gallery-sidebar-close.active":"hideGallery"},initialize:function(i){n.prototype.initialize.call(this,i),this.$cardfilm=this.$(".sports-popup-media-module .popup-film"),this.$title=this.$(".sports-popup-media-module .gallery-sidebar-title"),this.$video=this.$(".sports-popup-media-module .video-wrapper"),this.$gallery=this.$(".sports-popup-media-module .gallery-wrapper"),this.$galleryLinks=this.$(".sports-popup-media-module .gallery-link-wrapper"),this.$galleryCount=0,t.bindAll(this,"prepareMedia","updateShareTools","lightsOn","lightsOut","hideGallery","showGallery","hideVideo","showVideo"),s.on("carousel:sidebarClosed",t.bind(function(){this.hideGallery()},this)),this.pattern="/popup-media-link",this.prepareMedia(),s.on("showmore:headlines",this.prepareMedia),this.subviews.gallery=new o({el:e(".stagfront-content")}),this.subviews.loader=new l({el:this.$video})},prepareMedia:function(){var t=this;this.$(".hero-asset-open").addClass("hero-asset-popup"),this.$(".anchor, .hero-asset-popup a").each(function(){var t=e(this).attr("href");void 0===t&&(t=e(this).data("href")),void 0!==t&&(0===t.indexOf("/picture-gallery/")?e(this).addClass("popup-media-gallery"):0===t.indexOf("/videos/")&&e(this).addClass("popup-media-video"))}),this.$(".popup-media-gallery").each(function(i){if(i>=t.$galleryCount){var s=e(this).attr("href"),n=s.split("/").slice(-2,-1)[0];e(this).data("id",n);var o='<div class="front-gallery-item"><a id="link'+n+'" class="front-gallery-link" href="'+s+'"></a></div>';t.$galleryLinks.append(o);var a='<div id="'+n+'" class="front-gallery"></div>';t.$(".front-gallery").last().after(a)}}),this.$galleryCount=this.$(".front-gallery-item").length,this.$(".gallery-sidebar-close").addClass("active"),this.hideGallery(),this.hideVideo()},lightsOn:function(){this.$cardfilm.hasClass("inactive")||this.$cardfilm.addClass("inactive")},lightsOut:function(t){e(t.currentTarget);t.preventDefault(),this.$cardfilm.removeClass("inactive")},hideGallery:function(){this.lightsOn(),this.$gallery.hide(),s.trigger("gallery:hideSidebar")},showGallery:function(t){this.lightsOut(t);var i=e(t.currentTarget);this.$galleryLinks.find("#link"+i.data("id")).click();var n=i.find("h1, h3 span").html();this.$title.html(n);var o=e(window).outerWidth();o>1080?this.$gallery.css("left",(o-1080)/2):this.$gallery.css("left",(o-720)/2),this.updateShareTools(i.attr("href")),s.trigger("gallery:clickSidebar"),this.$gallery.show()},hideVideo:function(e){this.lightsOn(),this.subviews.video&&this.subviews.video.pauseVideo(),this.$video.hide()},showVideo:function(t){var i=this,s=e(t.currentTarget),n=s.attr("href"),o=e(window).outerWidth();this.$video.css("left",(o-this.$video.width())/2);this.$(".popup-media-video").index(s);this.lightsOut(t),this.$video.show(),this.subviews.loader.show(),r.fetchHtml(n).done(function(e){var t=e.find(".asset .video"),s=i.$(".video-wrapper .video-slot");s.html(t),s.html(s.html().replace("usat_shareFunction","default_shareFunction")),i.subviews.video=new a({el:t,autostart:!0}),i.subviews.loader.hide()})},updateShareTools:function(e){var t=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-facebook");t.data("share-link",t.data("share-link").replace(this.pattern,e));var i=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-twitter");i.attr("href",i.attr("href").replace(this.pattern,e));var s=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-googleplus");s.attr("href",s.attr("href").replace(this.pattern,e));var n=this.$(".gallery-sidebar-ad .util-bar-flyout-nav-btn-linkedin");n.attr("href",n.attr("href").replace(this.pattern,e)),this.pattern=e},destroy:function(){s.off("showmore:headlines"),s.off("carousel:sidebarClosed"),n.prototype.destroy.apply(this,arguments)}});return h}),define("modules/fronts/blogs",["jquery","underscore","backbone","baseview","pubsub"],function(e,t,i,s,n){var o=s.extend({events:{"click .scroller":"scroll"},initialize:function(t){this.$moveMe=this.$(".stage ul"),this.totalItems=e("li",this.$moveMe).length,this.$scrollerLeft=this.$(".scroller.left"),this.$scrollerRight=this.$(".scroller.right"),s.prototype.initialize.call(this,t)},scroll:function(t){t&&t.preventDefault();var i=e(t.target);if(i.hasClass("disabled"))return!1;var s=i.hasClass("right"),n=this.$moveMe.data("item-offset"),o=4;Modernizr.mq("screen and (min-width: 1250px)")?o=6:Modernizr.mq("screen and (min-width: 1150px)")&&(o=5),s&&(o=-1*o);var a=o+n;a>0&&(a=0);var r=183*n-1,l=183*o,h=l+r;h=183*a-1,0===a?this.$scrollerLeft.addClass("disabled"):this.$scrollerLeft.removeClass("disabled");var d=Math.abs(a)+Math.abs(o);d>=this.totalItems?(this.$scrollerRight.addClass("disabled"),o+=d-this.totalItems,a=o+n,l=183*o,h=l+r,h=183*a-1):this.$scrollerRight.removeClass("disabled"),this.$moveMe.data("item-offset",a),this.animate(this.$moveMe,"left",h+"px",200,"ease-in")}});return o}),define("modules/sports/sports-module-update",["jquery","underscore","baseview","state","utils","pubsub"],function(e,t,i,s,n,o){"use strict";var a=i.extend({initialize:function(s){t.bindAll(this,"initMarkup","updateMarkup","fetchUpdate"),s=e.extend({getItems:25,maxItems:50,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",dataSection:"data-livefeed",dataLoading:"livefeed-loading",dataTimeStamp:"data-timestamp",dataContentId:"data-content-id",moreLink:null,moreLinkText:null,newContentClass:"newcontent"},s),s.section=this.$el.attr(this.options.dataSection)||n.getSectionPath(window.location.pathname),i.prototype.initialize.call(this,s),this.setupLiveFeed()},setupLiveFeed:function(){var e="/feeds/live/"+this.options.section+"/?count="+this.options.getItems;this.$el.children("li").length?(this.$el.children("."+this.options.newContentClass).removeClass(this.options.newContentClass),this.fetchUpdate()):s.fetchHtml(e).done(this.initMarkup)},initMarkup:function(e){this.$el.removeClass(this.options.dataLoading),this.$el.append(e),this.loadLazyImages(e.find("img")),this.renderMoreLink(),o.trigger("sports:module:update"),this.startUpdateCheck()},loadLazyImages:function(e){e=e||this.$("img"),n.lazyLoadImage(e,this.options.dataSrcAttr,!0,this.hideBrokenHasImage)},renderMoreLink:function(){this.options.moreLink&&this.$el.append('<li class="live-feed-news-item"><a href="'+this.options.moreLink+'" class="livefeed-news-item-link has-more">'+this.options.moreLinkText+"</a></li>")},hideBrokenHasImage:function(){e(this).closest(".has-image").removeClass("has-image"),o.trigger("sports:module:update")},fetchUpdate:function(){var e=this.$("li:first").attr(this.options.dataTimeStamp),t="/feeds/live/"+this.options.section+"/?date="+e;s.fetchHtml(t).done(this.updateMarkup)},updateMarkup:function(i){if(i&&0!==i.length){var s,n=this.$("li"),a={};n.removeClass("top"),i.each(function(){a[e(this).attr(this.options.dataContentId)]=!0}),n.each(function(){s=e(this),a[s.attr(this.options.dataContentId)]&&s.remove()}),i.eq(0).addClass("top").append('<div class="shadow"></div>'),this.$el.prepend(i),i.addClass(this.options.newContentClass),this.loadLazyImages(i.find("img")),n=this.$el.children("li"),n.length>this.options.maxItems&&n.slice(this.options.maxItems).remove(),this.renderMoreLink(),this.afterNewContent=setTimeout(t.bind(function(){i.removeClass(this.options.newContentClass)},this),1e3*this.options.removeNewHighlight),o.trigger("sports:module:update")}},startUpdateCheck:function(){clearInterval(this.interval),this.interval=setInterval(this.fetchUpdate,1e3*this.options.updateDelay)},stopUpdateCheck:function(){clearInterval(this.interval);
},destroy:function(e){e&&this.$el.empty(),this.stopUpdateCheck(),clearTimeout(this.afterNewContent),i.prototype.destroy.apply(this,arguments)}});return a}),define("modules/sports/sports-latest-player-news",["jquery","underscore","backbone","base-app","modules/sports/sports-module-update"],function(e,t,i,s,n){var o=s.extend({initialize:function(t){s.prototype.initialize.call(this,t);var i=e(this.el).find(".sports-latest-player-news"),o=i.data("livefeed-more-link")||null,a=i.data("livefeed-more-link-text")||"More...";this.subviews.updatemodule=new n({el:".livefeed-news-list",maxItems:5,getItems:5,removeNewHighlight:20,updateDelay:30,dataSrcAttr:"data-src",dataSection:"data-livefeed",dataLoading:"livefeed-loading",dataTimeStamp:"data-timestamp",dataContentId:"data-content-id",moreLink:o,moreLinkText:a,newContentClass:"newcontent"})}});return o}),define("modules/sports/sports-jumptotop",["jquery","underscore","backbone","pubsub","utils"],function(e,t,i,s,n){var o=i.View.extend({el:"#section_sports",events:{"click .backtotop":"backToTop"},initialize:function(){this.scrollEl=n.get("scrollEl")},backToTop:function(t){this.scrollEl.animate({scrollTop:0},700),s.trigger("uotrack",e(t.target).attr("data-ht"))},destroy:function(){this.undelegateEvents()}});return o}),define("modules/topics/topics-timeline",["jquery","underscore","state","baseview","utils","pubsub"],function(e,t,i,s,n,o){var a=s.extend({initialize:function(i){t.bindAll(this,"onScroll"),i=e.extend({enableInfiniteScroll:!0},i),i.enableInfiniteScroll&&(this.$win=n.get("win"),this.$win.on("scroll."+this.cid,t.throttle(this.onScroll,200)),this.$storyWrapper=this.$(".tpatm-wrap"),this.fetchingStories=!1,this.loaderClass="tpatm-loading-icon",this.loader='<div class="'+this.loaderClass+'">Loading...</div>'),s.prototype.initialize.call(this,i)},getMoreStories:function(){var e=this.$(".tpatm-item:last"),s=e.attr("data-more-stories-path");if(s){this.fetchingStories=!0,this.$storyWrapper.append(this.loader),o.trigger("topicarticles:fetching");var n=this.$storyWrapper.find("."+this.loaderClass),a="/topic/ajax/stories/?counter="+this.getStoriesCount()+"&path="+encodeURIComponent(s);e.removeAttr("data-more-stories-path"),i.fetchHtml(a).done(t.bind(function(e){n.remove(),e.hide().appendTo(this.$storyWrapper).fadeIn(1e3),this.fetchingStories=!1,o.trigger("topicarticles:fetched")},this)).fail(t.bind(function(){n.remove()},this))}},getStoriesCount:function(){return this.$(".tpatm-item").length},onScroll:function(){if(!this.fetchingStories){var e=this.$(".tpatm-item").last().position().top,t=this.$storyWrapper.offset().top;n.getScrollPosition()>=e-t&&this.getMoreStories()}return!1},destroy:function(e){this.$win.off("."+this.cid),s.prototype.destroy.call(this,e)}});return a}),define("modules/newsletter-signup/newsletter-signup",["jquery","underscore","baseview","state","user-manager","pubsub","managers/cachemanager"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({validEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},el:".newsletter-signup-container",events:{submit:"onFormSubmit"},initialize:function(i){this.$nlTitle=this.$(".newsletter-signup-title"),this.$nlForm=this.$(".newsletter-signup-form"),this.$nlFormAction=this.$nlForm.attr("action"),this.$emailField=this.$(".newsletter-signup-email"),this.$emailFormMsg=this.$(".newsletter-signup-msg"),this.$emailFormMsgTxt=this.$(".newsletter-signup-message-text"),this.$customSuccessMessage=this.$emailFormMsg.data("success-message"),this.$nlCheckboxes=this.$(".newsletter-signup-form .newsletters input"),this.$businessUnitCode=this.$nlForm.data("business-unit"),this.$nlSubmit=this.$(".newsletter-signup-submit-update"),this.$nlTagline=this.$(".newsletter-signup-tagline"),this.$newsletterNeedLgn=this.$(".newsletter-signup-need-login"),this.$newsletterOptLgn=this.$(".newsletter-signup-option-login"),this.$newsletterLogIn=this.$(".newsletter-signup-logged-in"),this.$moreNewsletter=this.$(".more-newsletters"),this.userAccount=n.getAccount("firefly"),this.userAccount&&this.userAccount.getUserInfo().done(t.bind(function(t){t.email?(this.isLoggedIn=!0,this.$currentUserEmail=t.email,this.$emailField.val(this.$currentUserEmail),this.$nlTagline.html("Hello, <strong>"+t.welcomeName+"</strong>. Please select any new newsletters you would like to receive."),this.$newsletterLogIn.removeClass("hidden"),this.$moreNewsletter.removeClass("hidden"),this.newsletterLocal=a.getValue(this.$currentUserEmail+"_newsletter",null,1),this.newsletterLocal?e.each(this.newsletterLocal.subscriptions,function(t,i){e("#newsletter-"+i)&&e("#newsletter-"+i).prop("checked",!0)}):(a.clearValue(this.$currentUserEmail+"_newsletter"),s.fetchData(null,{url:"/services/gemsapi/getuser/"+t.email+"/"+this.$businessUnitCode}).done(function(t){t.success===!0&&t.subscriptions&&e.each(t.subscriptions,function(t,i){e("#newsletter-"+i)&&e("#newsletter-"+i).prop("checked",!0)})}))):this.showNewsletterOptionAbTest()},this)).fail(t.bind(function(){this.isLoggedIn||this.showNewsletterOptionAbTest()},this))},showNewsletterOptionAbTest:function(){this.options.registrationEnabled?this.$newsletterNeedLgn.removeClass("hidden"):this.$newsletterOptLgn.removeClass("hidden"),this.$moreNewsletter.removeClass("hidden")},setSubscriptionsLocal:function(e,t){var i={subscriptions:t};a.setValue(e+"_newsletter",i,10)},onFormSubmit:function(i){if(i.preventDefault(),this.$emailField.val()==this.$emailField.val()&&this.validEmail(this.$emailField.val())){this.$emailFormMsg.hide();var n=[];this.$nlCheckboxes.each(function(t,i){n.push({id:e(i).data("newsletter-id"),signup:e(i).is(":checked")})});var a=JSON.stringify(n);this.$emailFormMsg.removeClass("fail").removeClass("success").addClass("updating"),this.$emailFormMsgTxt.html("Updating subscriptions."),this.$emailFormMsg.show();var r=0;this.userAccount&&this.userAccount.getUserInfo().always(t.bind(function(e){e.email&&(r=1)},this)),s.fetchData(null,{type:"POST",url:this.$nlFormAction+this.$emailField.val()+"/"+this.$businessUnitCode+"/",data:{logged_in:r,newsletter_choices:a}}).done(t.bind(function(t){if(this.$emailFormMsg.removeClass("updating"),t.success===!0){this.$emailFormMsg.removeClass("fail").addClass("success");var i=this.$el.hasClass("newsletter-signup-sidebar");i&&(this.$nlForm.addClass("hidden"),this.$nlTitle.addClass("hidden"));var s="newsletter-signup|front|"+this.$nlSubmit.data("frontname")+"|choices|",n=[];this.$nlCheckboxes.each(function(t,i){e(i).is(":checked")&&n.push(e(i).data("newsletter-id"))}),this.setSubscriptionsLocal(this.$currentUserEmail,n);var a=n.join("|");s+=a,o.trigger("uotrack",s)}else this.$emailFormMsg.removeClass("success").addClass("fail");t.success&&this.$customSuccessMessage&&(this.$customSuccessMessage=this.$customSuccessMessage.split("||").map(function(e){return'<span class="newsletter-signup-custom-success">'+e+"</span>"}).join(""),t.message=this.$customSuccessMessage),this.$emailFormMsgTxt.html(t.message)},this))}else this.$emailFormMsg.removeClass("updating").removeClass("success").addClass("fail"),this.$emailField.val()&&this.validEmail(this.$emailField.val())||this.$emailFormMsgTxt.html("Please enter a valid email address."),this.$emailFormMsg.show()}});return r}),define("modules/search-module",["jquery","underscore","baseview","pubsub"],function(e,t,i,s){"use strict";var n=i.extend({events:{"focus .search-module-input":"startSearch","focusout .search-module-input":"hideSearch","mousedown .search-module-trending-item":"updateSearch","mousedown .search-module-cancel":"cancelSearch","submit .search-module-form":"formSubmit"},initialize:function(e){this.searchForm=this.$(".search-module-form"),this.searchInput=this.$(".search-module-input"),this.searchCancel=this.$(".search-module-cancel"),this.searchTrending=this.$(".search-module-trending"),this.trackLabel="",i.prototype.initialize.call(this,e)},startSearch:function(){this.searchTrending.css("display","block"),this.searchCancel.css("display","inline-block")},updateSearch:function(t){this.searchInput.val(e(t.currentTarget).find(".search-module-trending-item-tag-js").text()),this.trackLabel="search|"+e(t.currentTarget).find(".search-module-trending-item-tag-js").data("track-headline-var"),this.searchForm.submit()},hideSearch:function(){this.searchTrending.css("display","none"),this.searchCancel.css("display","none")},cancelSearch:function(){this.searchInput.val(""),this.searchTrending.css("display","none"),this.searchCancel.css("display","none")},formSubmit:function(e){""===this.trackLabel&&(this.trackLabel="search|"+this.searchInput.val()),s.trigger("track",{label:this.trackLabel})}});return n}),define("modules/longform/cover-photo-arrow",["jquery","underscore","baseview","utils"],function(e,t,i,s){"use strict";var n=i.extend({events:{"click .longform-intro-arrow-wrap":"scrollToFirstChapter"},initialize:function(e){this.$bottomArrowWrap=this.$(".longform-intro-arrow-wrap"),this._startArrowPulse(),i.prototype.initialize.call(this,e)},_startArrowPulse:function(){var e=this;this.animate(this.$bottomArrowWrap,"opacity",.25,1500,"ease-out").done(function(){e.destroyed||e.animate(e.$bottomArrowWrap,"opacity",1,1500,"ease-out").done(function(){e.destroyed||e._startArrowPulse()})})},scrollToFirstChapter:function(t){t.preventDefault();var i,n=e(".chapter-marker:eq(0)");i=n.length?n.offset().top-60:e(".longform-content-wrapper").offset().top-60,s.get("scrollEl").animate({scrollTop:i},{step:function(t,i){0===t&&(i.start=i.now=e(window).scrollTop())},duration:1e3})}});return n}),define("modules/money/market-summary",["jquery","underscore","baseview","state","pubsub"],function(e,t,i,s,n){"use strict";var o=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),"suspender"===e.layoutType?this.interval=s.recurringFetchHtml("/services/markets/home-widget/",null,6e4,t.bind(function(e){this.$(".market-ss").html(e)},this)):this.interval=s.recurringFetchHtml("/services/markets/default-quotes/",null,6e4,t.bind(function(e){this.$(".mmtdq").html(e)},this))},triggerABTestingEvent:function(){var e=s.getActivePageInfo();if(e.ab_test_id){var t=e.ab_test_id+"|"+e.ab_test_variant||"control";n.trigger("abtesttrack",t)}},destroy:function(){clearInterval(this.interval),i.prototype.destroy.apply(this,arguments)}});return o}),define("modules/money/market-summary-search",["jquery","underscore","baseview","state","pubsub","modules/money/market-summary","modules/money/market-symbol-search"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({initialize:function(e){i.prototype.initialize.call(this,e),this.subviews.stocks=new o({el:this.$(".mmtsi-wrap")}),this.subviews.marketsearch=new a({el:this.$(".markets-stock-search-wrap")})},triggerABTestingEvent:function(){var e=s.getActivePageInfo();if(e.ab_test_id){var t=e.ab_test_id+"|"+e.ab_test_variant||"control";n.trigger("abtesttrack",t)}}});return r}),define("modules/partner/slider-ad",["jquery","underscore","modules/partner/simple-ad"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){t=e.extend({adType:"slider",adPlacement:"slider",adSizes:[160,600]},t),i.prototype.initialize.call(this,t),this._initAds()}});return s}),define("modules/header/site-nav-search-module",["modules/header/site-nav-dropdown"],function(e){"use strict";var t=e.extend({initialize:function(t){e.prototype.initialize.call(this,t)}});return t}),define("modules/sports/sports-player-news",["jquery","underscore","utils","state","pubsub","baseview","form/autocomplete"],function(e,t,i,s,n,o,a){var r=o.extend({el:".player-news-search-form",events:{"click .button-add-content.player-news":"showMoreNews"},initialize:function(s){if(this.itemsPerPage=this.$el.data("itemsPerPage"),this.$button=this.$(".button-add-content"),this.section=i.getSectionPath(window.location.pathname)+"playernews",location.href.indexOf("#")){var n=e(".news"+location.href.split("#")[1]);if(n.parent().hasClass("inactive")&&n.parent().removeClass("inactive").addClass("active"),n.length){var r=n.offset().top;this.scrollEl=i.get("scrollEl"),this.scrollEl.animate({scrollTop:r-100},700)}}o.prototype.initialize.call(this,s),t.bindAll(this,"onSearchSelect"),this.$lookupInput=this.$(".player-news-search-form-input"),this.subviews.autocomplete=new a({el:this.$lookupInput,resultDisplayTemplate:"<%= full_name %>",resultValueTemplate:"<%= full_name %>",onSelect:this.onSearchSelect})},onSearchSelect:function(e,t){var i=t.safe_name;this.setPlayerName(i),this.$el.submit()},setPlayerName:function(e){this.$$(".player-news-search-player-input").val(e)},getPlayerName:function(){return this.$$(".player-news-search-player-input").val()},showMoreNews:function(t){if(e(t.target).hasClass("inactive"))return!1;this.$button=this.$(".button-add-content"),this.$button.addClass("loading").text(this.$button.attr("data-loading"));var i=this.$(".page.active:last").next(),s=i.attr("data-itemnum"),o=i.attr("data-items-per-page"),a=parseInt(i.attr("data-max-items"),10),r=parseInt(i.attr("data-items-loaded"),10),l=parseInt(s,10)+parseInt(o,10),h=i.attr("data-timestamp"),d=i.parent();l%r===0&&a>l&&this.loadMoreNews(d,h,l);var c=Math.round(s/o);i.find("img").each(function(){var t=e(this);t.attr("src",t.attr("data-src"))}),n.trigger("uotrack",this.section+"morestories"+c),this.transitionMoreNews(i),t.preventDefault()},transitionMoreNews:function(t){Modernizr.csstransitions?t.removeClass("inactive").addClass("active"):t.animate({"max-height":"5000px"},200,function(){e(this).removeClass("inactive").addClass("active").css("max-height","")}),this.$(".page.inactive").length<=0&&this.$button.addClass("inactive"),this.$button.removeClass("loading").text(this.$button.attr("data-default")),n.trigger("showmore:headlines")},loadMoreNews:function(e,i,n){var o=e.attr("data-url")+"?before="+i+"&lastcount="+n;s.fetchHtml(o).done(t.bind(function(t){t&&t.length&&(e.append(t),this.$button.removeClass("inactive"))},this))},onFormSubmit:function(e){if(!this.getPlayerName()&&this.$lookupInput.val()){var i=this.$lookupInput.val(),n=this.$lookupInput.data("autocomplete-url")+i;s.fetchData(n).done(t.bind(function(e){e&&e.length&&this.$el.submit()},this))}},destroy:function(e){this.$$(".player-news-search-player-input").val(""),this.$lookupInput.blur(),o.prototype.destroy.call(this,e)}});return r}),define("modules/interactives/sequencer",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","modules/global/brightcove-video"],function(e,t,i,s,n,o,a){var r=n.extend({events:function(){var e=Modernizr.touch?"touchstart":"click",t={"click .navigation li":"navInteraction"};return t[e+" .nav-hide"]="showHidePanel",t},initialize:function(e){n.prototype.initialize.call(this,e);var t=!0;(e.isFramed||this.$el.data("suppressad")===!0)&&(t=!1),this.subviews.template=new o({ads:t,el:this.$el,ignoreFirstNav:!0,interactiveType:"sequencer",isFramed:e.isFramed,standAlone:e.standAlone}),this.subviews.template.goTo(this.subviews.template.currentSlideIndex),this.subviews.video=[],this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$nav=this.subviews.template.$navigation,this.$navButton=this.$nav.find(".nav-hide-button"),this.$viewport=this.subviews.template.$viewport,this.setupSlides()},setupSlides:function(){if(this.$viewport.hasClass("slide-transition")){var e=this.$slides.eq(0).width()*this.$slides.length;this.$slideContainer.width(e)}else if(this.$viewport.hasClass("vslide-transition")){var t=this.$slides.eq(0).height()*this.$slides.length;this.$slideContainer.height(t)}},showHidePanel:function(e){if(this.$navButton.length<1)return!1;var t=this.$nav.hasClass("show"),i=t?"showpanel":"hidepanel";this.animatePanel(t),this.options.isFramed!==!0&&this.subviews.template.trackClick("sequencer"+document.location.pathname+i)},navInteraction:function(){this.$(arguments[0].currentTarget).hasClass("nav-hide")||this.options.isFramed!==!0&&this.subviews.template.trackPageView()},animatePanel:function(e){e?(this.$nav.animate({width:"180px"},350),this.$nav.find(".sq-navigation-text-wrap").fadeIn()):(this.$nav.find(".sq-navigation-text-wrap").fadeOut(),this.$nav.animate({width:"48px"},350)),this.$nav.toggleClass("show")}});return r}),define("modules/live-video-sidebar/live-video-sidebar",["jquery","underscore","baseview","state","modules/global/livevideo"],function(e,t,i,s,n){"use strict";var o=i.extend({events:{"click .lvsm-link":"onClickLiveVideoLink"},initialize:function(e){this.liveVideosRailPoll=s.recurringFetchHtml("/videos/services/live-video-sidebar/",null,91e3,t.bind(function(e){this.$el.html(e)},this)),i.prototype.initialize.call(this,e)},destroy:function(){clearInterval(this.liveVideosRailPoll),i.prototype.destroy.apply(this,arguments)},onClickLiveVideoLink:function(t){var i=e(t.currentTarget).data("video-id");i&&(this.subviews.live&&this.subviews.live.destroy(!0),this.subviews.live=new n,this.subviews.live.loadLiveVideo(i),t.preventDefault())}});return o}),define("modules/fronts/pr-front",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({initialize:function(t){this.prTag=e(".pr-outer-wrap"),this.prodCdn=this.prTag.attr("data-prod-cdn"),this.smallLogo=e(".site-nav-logo-img"),this.largeLogo=e(".logo-link").find("img"),window.location.href.indexOf("/pr/")>-1&&this.changeLogoToPR(),i.prototype.initialize.call(this,t)},changeLogoToPR:function(){var e=this.prodCdn+"appservices/site-masthead-logo@2x.png",t=this.largeLogo.attr("src");this.largeLogo.attr("data-new-src",t);var i=this.prodCdn+"appservices/site-nav-logo@2x.png",s=this.smallLogo.attr("src");this.smallLogo.attr("data-new-src",s),this.largeLogo.attr("src",""),this.largeLogo.attr("src",e).css({positon:"absolute",display:"block",height:"80px"}),this.smallLogo.attr("src",i)}});return s}),define("modules/sports-stn-promo/sports-stn-promo",["jquery","underscore","baseview"],function(e,t,i){var s=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),e(document).ready(function(){e('a[href*="story/sports"]').click(function(){"undefined"!=typeof s2nStopPlayer&&e.isFunction(s2nStopPlayer)&&(console.log("s2nStopPlayer exists"),s2nStopPlayer())})})}});return s}),define("modules/sports/sports-tickets",["jquery","underscore","pubsub","baseview"],function(e,t,i,s){"use strict";var n=s.extend({events:{"click .sports-tickets-submit":"triggerOmniture"},triggerOmniture:function(e){i.trigger("uotrack","TicketCityModuleExit")},initialize:function(e){s.prototype.initialize.call(this,e),this.$el.width()>=240?this.$(".sports-tickets-sidebar-content").removeClass("sports-tickets-sidebar-content-override"):this.$(".sports-tickets-sidebar-content").addClass("sports-tickets-sidebar-content-override"),window.onresize=function(e){this.$(".sports-tickets-sidebar-content").parent().width()>=240?this.$(".sports-tickets-sidebar-content").removeClass("sports-tickets-sidebar-content-override"):this.$(".sports-tickets-sidebar-content").addClass("sports-tickets-sidebar-content-override")}}});return n}),define("modules/travel/travel-experience-promo",["jquery","baseview","ui/dropdown"],function(e,t,i){"use strict";var s=t.extend({initialize:function(e){t.prototype.initialize.call(this,e),this.subviews.dropdown=new i({el:this.$(".tep-list")})}});return s}),define("modules/interactives/timeline",["jquery","underscore","pubsub","utils","baseview","modules/interactives/interactive-templates","libs/jqueryui/draggable","modules/global/brightcove-video","touchswipe"],function(e,t,i,s,n,o,a){var r=n.extend({events:{"click .interactive-timeline-marker":"goToMarker","click .slide-nav.prev, .slide-nav.next":"renderArrowClick"},initialize:function(e){n.prototype.initialize.call(this,e),t.bindAll(this,"snapToMarker"),this.subviews.template=new o({el:this.$el,interactiveType:"timeline",isFramed:e.isFramed,standAlone:e.standAlone}),this.$leftArrow=this.subviews.template.$leftArrow,this.$rightArrow=this.subviews.template.$rightArrow,this.$slideContainer=this.subviews.template.$slideContainer,this.$slides=this.subviews.template.$slides,this.$viewport=this.subviews.template.$viewport,this.$timeslider=this.$(".interactive-timeline-timeslider"),this.$timesliderBelt=this.$timeslider.find(".interactive-timeline-belt"),this.$timesliderBuckle=this.$timeslider.find(".interactive-timeline-buckle"),this.$timesliderLabelContainer=this.$timeslider.find(".interactive-timeline-labels"),this.$timesliderLabels=this.$timesliderLabelContainer.find(".interactive-timeline-label"),this.$contentBox=this.$slideContainer.find(".timeline-slide-content"),this.$gridLines=this.$viewport.find(".grid-line"),this.arrEventPositions=[],this.maxSlides=this.subviews.template.maxSlides,this.arrayPanelMax=850,this.numPanelMinLefts=6,this.numMarkerWidth=9,this.strDateBegin="",this.strDateEnd="",this.currentSlideIndex=this.subviews.template.currentSlideIndex;var i={containment:".buckle-box",cursor:"move",axis:"x",stop:this.snapToMarker};if(Modernizr.touch){i.delay=200,this.$(".stage").swipe({self:this,swipe:function(e,t,i,s,n,o){"right"===t||"down"===t?o.self.previousSlide():o.self.nextSlide()}});var s=this;require(["touchpunch"],function(){s.destroyed||s.setup(i)})}else this.setup(i)},destroy:function(){this.$timesliderBuckle.draggable("destroy"),n.prototype.destroy.apply(this,arguments)},setup:function(t){var i="",s=this.$viewport.data()||{},n=this;this.strDateBegin=s.graphstart,this.strDateEnd=s.graphend,this.$slides.each(function(t){var s=e(this).find(".timeline-slide-content").data().tlpercent,o=parseInt(n.arrayPanelMax,10),a=Math.round(s*o+27);n.arrEventPositions[t]=a,i+='<div class="interactive-timeline-marker" style="left:'+a+'px;"></div>'}),this.$timesliderBelt.append(i),this.maxEvents=this.arrEventPositions.length,this.setUpLabels(),this.goTo(0),this.$timesliderBuckle.draggable(t)},setUpLabels:function(){var t=this.strDateBegin,i=this.strDateEnd,s=i-t,n=this,o=n.arrayPanelMax;this.$timesliderLabels.each(function(){var i=e(this).data().labelms,n=Math.round((i-t)/s*o);e(this).css("left",n)}),this.$gridLines.each(function(t){var i=n.$timesliderLabels.eq(t).position().left+33+"px";e(this).css("left",i)}),this.$timesliderLabels.find(".interactive-timeline-time").fadeIn("slow")},goToMarker:function(e){var t=this.$timesliderBelt.children(".interactive-timeline-marker").index(e.currentTarget);this.goTo(t),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},renderArrowClick:function(t){e(t.currentTarget).is(this.$leftArrow)?this.previousSlide():this.nextSlide(),this.options.isFramed!==!0&&this.subviews.template.trackPageView()},goTo:function(e){var t;this.currentSlideIndex=e;var i=parseInt(this.$contentBox.eq(e).width(),10),s=this.arrayPanelMax-i;this.$timesliderBuckle.css("left",(this.arrEventPositions[e]-19).toString()+"px"),t=Math.round(this.arrEventPositions[e]+this.numMarkerWidth/2-i/2),t>s?t=s:t<this.numPanelMinLefts&&(t=this.numPanelMinLefts),this.$slides.eq(e).find(".indicator").css("left",this.arrEventPositions[e]-8-t.toString()+"px"),this.$slides.removeClass("active").eq(e).css("left",t.toString()+"px").addClass("active"),this.$contentBox.find(".text a").attr("target","_blank"),this.subviews.template.goTo(e),this.currentSlideIndex=e},previousSlide:function(){this.goTo(Math.max(this.currentSlideIndex-1,0))},nextSlide:function(){this.goTo(Math.min(this.currentSlideIndex+1,this.maxSlides-1))},snapToMarker:function(t){var i,s,n=850,o=e(t.target),a=parseInt(o.css("left"),10);for(s=0;s<this.arrEventPositions.length;s++)Math.abs(a+19-this.arrEventPositions[s])<n&&(i=s,n=Math.abs(a+19-this.arrEventPositions[s]));this.options.isFramed!==!0&&this.subviews.template.trackPageView(),this.goTo(i)}});return r}),define("partner/asset-sponsorship",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({backgroundTemplate:"<%= sponsorshipHtml %>",logoTemplate:'<div class="sponsor" style="display:table-cell;"><div class="sponsor-logo-box"><img src="<%= imageLogo %>" alt="<%= imageLogoAlt %>" class="sponsor-logo-img"><span class="sponsor-logo-byline">Sponsored by <br/><%= imageLogoAlt %></span></div></div>',initialize:function(t){t=e.extend({imageSkinLeft:null,imageSkinRight:null,clickThru:null,imageLogo:null,imageLogoAlt:null},t),i.prototype.initialize.call(this,t)},destroy:function(e){this.$background&&(this.$background.remove(),this.$background=null),this.$logo&&(this.$logo.remove(),this.$logo=null),i.prototype.destroy.call(this,e)},render:function(){this.setupBackground(),this.setupLogo()},setupBackground:function(){"Yes"!==this.options.hasSkin&&this.options.sponsorshipHtml||(this.$background=e(t.template(this.backgroundTemplate,this.options)),this.$el.parent().append(this.$background))},setupLogo:function(){var i=this.$(".content-bar-top .title").eq(0);i.length&&(this.$logo=e(t.template(this.logoTemplate,this.options)),i.after(this.$logo))}});return s}),define("modules/partner/poster-ad-asset",["jquery","underscore","baseview","state","sharedAdPosition","partner/asset-sponsorship","utils"],function(e,t,i,s,n,o,a){"use strict";var r=i.extend({initialize:function(e){var s=this.$el.data("sizes");t.bindAll(this,"onAdReady"),i.prototype.initialize.call(this,e),s&&(s=s.split(",")),this.subviews.posterad=new n({el:this.$el,adSizes:s||["mediumrectangle","halfpage","portrait",[300,725]],adPlacement:"poster",adType:"sponsorship",defaultPosition:!0,onAdReady:this.onAdReady})},refreshAdPosition:function(){window.googletag&&window.googletag.pubads().clearTargeting("amznslots"),this.subviews.posterad.refreshPosition()},onAdReady:function(t,i){this.subviews.posterad.show(),this.subviews.posterad.$("iframe").css("position","relative"),"sponsorship"===i&&(this.subviews.sponsorshipad&&this.subviews.sponsorshipad.destroy(),this.subviews.sponsorshipad=new o(e.extend({el:s.getActiveApp().$(".asset")},t)),this.subviews.sponsorshipad.render())}});return r}),define("modules/renvy-lite-search",["jquery","baseview","managers/routemanager"],function(e,t,i){var s=t.extend({events:{"submit .renvy-lite-search-form":"_searchRenvyEvent"},initialize:function(i){t.prototype.initialize.call(this,i),this.form=e("form.renvy-lite-search-form"),this.options={$city:e(".renvy-lite-input.city input"),$beds:e(".renvy-lite-input.beds select"),$minPrice:e(".renvy-lite-input.min-price select"),$maxPrice:e(".renvy-lite-input.max-price select")},this.errors={$city:e("renvy-lite-input.city .errors")},this.rootUrl="http://renvy.com/search/"},addOptionsToUrl:function(e){var t={beds:this.options.$beds.val(),"min-price":this.options.$minPrice.val(),"max-price":this.options.$maxPrice.val()};"/"!==e[e.length-1]&&(e+="/");for(var i in t)if(t.hasOwnProperty(i)){var s=parseInt(t[i]);isNaN(s)||0>s||(e+=s+"-"+i+"/")}return e},_searchRenvyEvent:function(e){e.preventDefault(),e.stopPropagation(),this.searchRenvy()},searchRenvy:function(){var e=this.rootUrl,t=this.options.$city.val().toLowerCase();if(!t)return this.options.$city.addClass("error"),this.errors.$city.html("<p>Please enter a city</p>"),"";var s=e+encodeURIComponent(t)+"/";return s=this.addOptionsToUrl(s),i.goTo(s),s}});return s}),define("modules/series-ribbon/series-ribbon",["jquery","underscore","baseview","utils","pubsub","state","managers/requestmanager","site-manager","directAdPosition"],function(e,t,i,s,n,o,a,r,l){var h=i.extend({events:{"click .srb-stb-prev-img":"onPrevClick","click .srb-stb-next-img":"onNextClick"},initialize:function(s){i.prototype.initialize.call(this,s),t.bindAll(this,"updateDom","renderServerTemplate"),this.pubSub=e.extend({"breakingbar:after:open":this.onBreakingNewsOpen,"breakingbar:after:close":this.onBreakingNewsClose,"header:fixed":this.onHeaderFixed,"header:unfixed":this.onHeaderUnfixed},this.pubSub),n.attach(this.pubSub,this),this.bnm_bar_height=0,this.fixed_header=!1,this.article_count=1,this.item_width=0,this.current_position=0,this.prev_button_width=0,this.next_button_width=0,this.options=e.extend(!0,{count:12},s),this.loadModule()},onBreakingNewsOpen:function(){this.bnm_bar_height=e(".bnm-bar").outerHeight(),this.srb_stb&&this.fixed_header&&this.adjustNewsreelPosition()},onBreakingNewsClose:function(){this.bnm_bar_height=0,this.adjustNewsreelPosition()},onHeaderFixed:function(){this.fixed_header=!0,this.srb_stb&&this.setFixedNewsreel(),n.trigger("newsreel:fixed")},onHeaderUnfixed:function(){this.fixed_header=!1,this.srb_stb.removeClass("srb-stb-fixed"),n.trigger("newsreel:unfixed")},setFixedNewsreel:function(){this.srb_stb.addClass("srb-stb-fixed"),this.adjustNewsreelPosition()},onPrevClick:function(){var e=this.getItemsPerPage();if(this.current_position>0){var t=0;this.current_position-=e,this.current_position>0?t=this.srb_stb_asset[this.current_position].offsetLeft+20-this.prev_button_width:this.current_position<0&&(this.current_position=0),this.$(".srb-stb-assets-wrapper").animate({scrollLeft:t},500,"swing")}else this.current_position=this.article_count-this.getItemsPerPage(),this.$(".srb-stb-assets-wrapper").animate({scrollLeft:this.srb_stb_asset[this.current_position].offsetLeft+20-this.prev_button_width},500,"swing")},onNextClick:function(){var e=this.getItemsPerPage(),t=this.article_count-(this.current_position+e);t>0?(this.current_position+=t>e?e:t,this.$(".srb-stb-assets-wrapper").animate({scrollLeft:this.srb_stb_asset[this.current_position].offsetLeft+20-this.prev_button_width},500,"swing")):(this.$(".srb-stb-assets-wrapper").animate({scrollLeft:0},500,"swing"),this.current_position=0)},getItemsPerPage:function(){var e=this.srb_stb_assets_nav.outerWidth()-this.prev_button_width-this.next_button_width;return Math.floor(e/this.item_width)},adjustNewsreelPosition:function(){this.srb_stb.css({top:40+this.bnm_bar_height+"px"})},loadModule:function(){var i=this.options,n=s.getNested(o.getActivePageInfo(),"assetid"),h=t.pick(i,["exclude","metric","count","ssts","days","assetType"]);a.fetchHtml("/modules/series-ribbon/"+n+"?"+e.param(h)).done(t.bind(function(t){this.renderServerTemplate(t),this.srb_stb_asset=this.$(".srb-stb-asset"),this.article_count=this.srb_stb_asset.length,this.article_count>0&&(this.srb_stb=this.$(".srb-stb"),this.srb_stb_assets_nav=this.srb_stb.find(".srb-stb-assets-nav"),this.srb_stb_prev_img=this.srb_stb_assets_nav.find(".srb-stb-prev-img"),this.srb_stb_next_img=this.srb_stb_assets_nav.find(".srb-stb-next-img"),this.prev_button_width=this.srb_stb_assets_nav.find(".srb-stb-fade-left").outerWidth(),this.next_button_width=this.srb_stb_assets_nav.find(".srb-stb-fade-right").outerWidth(),this.item_width=this.srb_stb_asset.first().outerWidth(),this.$el.css({height:this.srb_stb.outerHeight()}),this.header=r.getHeader(),this.header.state.fixed&&this.onHeaderFixed(),this.subviews.ad=new l({el:e(".js-srb-ad"),adSizes:[220,90],adPlacement:"native-ribbon_tile"}),this.article_count<6&&(this.srb_stb_prev_img.css({display:"none"}),this.srb_stb_next_img.css({display:"none"})))},this))},renderServerTemplate:function(e){var t=this.processHtmlString(e);this.updateDom(t)},processHtmlString:function(i){var s=t.isString(i)?e.parseHTML(i):i;return s},updateDom:function(e){this.$el.append(e)}});return h}),define("modules/jobs-search/jobs-search",["jquery","underscore","state","baseview","pubsub"],function(e,t,i,s,n){"use strict";var o=s.extend({events:{"click .jobs-search-submit":"searchJobs","submit .jobs-search-form":"searchJobs","click .jsm-close-icon":"closeSuggestions","click .jsm-suggestions-list-item":"selectSuggestion","input .jobs-search-text-input":"onInputChange"},initialize:function(){s.prototype.initialize.call(this),this.form=document.getElementById("jobs-search-form"),this.populateSuggestions=t.debounce(this.getSuggestions,200)},searchJobs:function(e){var t=this.form.getAttribute("data-url"),i=document.getElementById("jobs-search-keyword")?document.getElementById("jobs-search-keyword").value:"",s=document.getElementById("jobs-search-location")?document.getElementById("jobs-search-location").value:"";this.encoded_keyword=this.encodeSearchTerm(i),
this.encoded_location=this.encodeSearchTerm(s),t+="q-"+this.encoded_keyword+"-l-"+this.encoded_location;var o=this.form.getAttribute("data-affiliateId");o&&(t+="?affiliateid="+o),t+="source=1&countryId=3";var a=this.form.getAttribute("data-radius");a&&(t+="&radius="+a),i||(i="n/a"),s||(s="n/a"),this.trackLabel="thejobnetwork|findjobs|"+i+"|"+s,n.trigger("track",{label:this.trackLabel}),window.open(t,"_blank")},encodeSearchTerm:function(e){for(var t={"/":"-or-","\\":"-or-",".":"-dot-","&":"-and-","+":"-plus-","%":"-perc-","?":"-ques-","#":"-hash-",$:"-dlr-","*":"-star-","!":"-mrk-",'"':"-quat-","'":"-apos-","<":"-lt-",">":"-gt-","|":"-pipe-",":":"-cln-"},i="",s=0;s<e.length;s++)i="undefined"!=typeof t[e[s]]?i+t[e[s]]:i+encodeURIComponent(e[s]);return i},onInputChange:function(t){var i=t.target.value;i?("jobs-search-text-input jobs-search-keyword"===t.target.className&&(this.populateSuggestions(i,"Title","jsm-keywords"),e(".jsm-keyword-suggestions").removeClass("hide-suggestions")),"jobs-search-text-input jobs-search-location"===t.target.className&&(this.populateSuggestions(i,"Location","jsm-locations"),e(".jsm-location-suggestions").removeClass("hide-suggestions"))):("jobs-search-text-input jobs-search-keyword"===t.target.className&&e(".jsm-keyword-suggestions").addClass("hide-suggestions"),"jobs-search-text-input jobs-search-location"===t.target.className&&e(".jsm-location-suggestions").addClass("hide-suggestions"))},closeSuggestions:function(){this.$(".jsm-search-suggestions").addClass("hidden")},selectSuggestion:function(t){var i=document.getElementById("jobs-search-keyword"),s=document.getElementById("jobs-search-location");"jsm-suggestions-list jsm-keywords"===t.target.parentNode.className&&(i.value=t.target.textContent,e(".jsm-keyword-suggestions").addClass("hidden")),"jsm-suggestions-list jsm-locations"===t.target.parentNode.className&&(s.value=t.target.textContent,e(".jsm-location-suggestions").addClass("hidden"))},getSuggestions:function(t,s,n){i.fetchData(null,{url:"/services/jobs/suggestions/"+s+"/"+t}).done(function(t){for(var i=document.getElementById(n);i.firstChild;)i.removeChild(i.firstChild);var o=t.Data;o&&(o.forEach(function(e){var t=document.createElement("li");t.innerText=e[s],t.className="jsm-suggestions-list-item",document.getElementById(n).appendChild(t)}),"jsm-keywords"===n?e(".jsm-keyword-suggestions").removeClass("hidden"):"jsm-locations"===n&&e(".jsm-location-suggestions").removeClass("hidden")),i.firstChild||e(".jsm-search-suggestions").addClass("hidden")},this)}});return o}),define("modules/stories/utility-bar-module-print",["jquery","underscore","backbone","pubsub","baseview"],function(e,t,i,s,n){var o=n.extend({open:function(){s.trigger("uotrack","UtilityBarPrint"),window.print(),this.destroy()},close:function(){this.destroy()},destroy:function(e){n.prototype.destroy.call(this,e),this.options.onDestroy&&this.options.onDestroy(this)}});return o}),define("apps/overlay/pages/olympics-profile-overlay",["jquery","underscore","baseview","modules/sports/popup-details"],function(e,t,i,s){var n=i.extend({initialize:function(t){i.prototype.initialize.call(this,t),this.subviews.popup=new s({el:e(".olympics-profile")});var n=this.$(".sp-details-open");n.data("active")&&n.click()},destroy:function(){i.prototype.destroy.call(this)}});return n}),define("modules/section-highlights/section-highlights",["jquery","underscore","backbone","utils","baseview"],function(e,t,i,s,n){"use strict";var o=n.extend({initialize:function(e){n.prototype.initialize.call(this,e),this._refreshSports()},_refreshSports:function(){t.each(this.$(".shpm-score-box"),function(t){if("True"==e(t).data("live")){var i="/services/live_sports_scores/"+e(t).data("league")+"/"+e(t).data("team")+"/"+Math.floor(Date.now()/6e4);e.get(i,function(i){e(t).replaceWith(i)})}})}});return o}),define("modules/sports/sports-filters",["jquery","underscore","baseview","state","utils","modules/scroller/vertical-scroll","form/datepicker"],function(e,t,i,s,n,o,a){var r=i.extend({el:".sp-filter-bar-wrap",events:{"mouseenter .sp-filter-dropdown":"onHoverFilterDropdown","mouseleave .sp-filter-dropdown":"onHoverFilterDropdown","click .sp-filter-item":"confSelect"},initialize:function(){i.prototype.initialize.apply(this,arguments),this.$datepicker_filter=e(".sp-filter-date-picker-wrap"),this.$daysAvailable=this.$datepicker_filter.data("gamedates"),t.bindAll(this,"getDays","checkAvailableDates"),this.subviews.datepicker=new a({el:this.$(".sp-filter-date-picker-input"),buttonSelector:".sp-filter-date-picker-btn",flyoutClass:"sp-filter-date-picker-flyout",calendarPanelClass:"ui-dark",dateFormat:"yy / mm / dd",changeMonth:!0,changeYear:!0,onChangeMonthYear:this.getDays,beforeShowDay:this.checkAvailableDates,yearRange:"-4:+1"})},checkAvailableDates:function(t){var i=!1;if("undefined"==typeof this.$daysAvailable)return[!0,"available"];for(var s="unavailable",n=this.$daysAvailable.toString().split(","),o=e.datepicker.formatDate("d",t),a=0;a<n.length;a++)n[a].toString()==o.toString()&&(i=!0,s="available");return[i,s]},getDays:function(i,n,o){if("undefined"!=typeof this.$daysAvailable){var a=this.$datepicker_filter.data("league-name"),r=this.$datepicker_filter.data("pagetype"),l=this.$datepicker_filter.data("filter");l&&(l+="/");var h="sports/"+a+"/"+r+"/"+i+"/"+n+"/1/date-picker/"+l;s.fetchHtml(h).done(t.bind(function(t){this.$daysAvailable=e(t).data("gamedates"),e(".ui-date-picker").datepicker("refresh")},this))}},confSelect:function(t){var i=e(t.currentTarget),s=i.closest(".sp-filter-dropdown"),n=s.find(".sp-filter-btn"),o=i.text();n.text(o)},onHoverFilterDropdown:function(t){if("mouseenter"===t.type){var i=e(t.currentTarget),s=i.find(".sp-filter-scroll-wrap");this.subviews.vscroll=new o({el:s,padding:6})}else this.subviews.vscroll&&this.subviews.vscroll.destroy()}});return r}),define("modules/fronts/super-hero",["jquery","underscore","baseview","state","managers/routemanager"],function(e,t,i,s,n){var o=i.extend({el:".super-hero-module-wrapper",events:{"click .super-hero":"open"},open:function(t){if("a"!=e(t.target).prop("tagName").toLowerCase()){var i=e(t.currentTarget);n.goTo(i.find(".hero-story > h1 > a").attr("href"))}}});return o}),define("modules/travel/travel-experience-featured",["jquery","underscore","baseview","state","utils","ui/generic-paginator"],function(e,t,i,s,n,o){var a=i.extend({events:{mouseenter:"stoptimer",mouseleave:"starttimer","click .travel-experience-featured-carousel-nav":"step"},initialize:function(s){s=e.extend({transition:{interval:15e3}},s),t.bindAll(this,"automate","goTo","step","toggleArrows"),this.subviews={},this.$moveMe=this.$(".travel-experienced-featured-wrapper"),this.$slides=this.$(".travel-experience-featured-link"),this.$navPrev=this.$(".travel-experience-featured-carousel-prev"),this.$navNext=this.$(".travel-experience-featured-carousel-next"),this.$viewport=this.$moveMe.parent(),this.indexActive=this.$moveMe.data("active")||0,this.$moveMe.width(this.$moveMe.width()*this.$moveMe.children().length),this.subviews.paginator=new o({el:this.$(".paginator"),onGoTo:this.goTo}),s.transition&&(this.interval=s.transition.interval||!1,this.timer=null,this.interval&&this.starttimer()),this.toggleArrows(),i.prototype.initialize.call(this,s)},automate:function(){this.subviews.paginator.goToNextPage(!0)},destroy:function(e){this.stoptimer(),i.prototype.destroy.call(this,e)},goTo:function(e){var t=this.$viewport.outerWidth(),i=t*e;this.$moveMe.data("active",e),this.indexActive=e,this.animate(this.$moveMe,"left","-"+(i+1)+"px",450,"ease-in-out"),this.toggleArrows()},step:function(t){e(t.currentTarget).hasClass("prev")?this.subviews.paginator.goToPrevPage(!0):this.subviews.paginator.goToNextPage(!0)},starttimer:function(){this.interval&&!this.timer&&(this.timer=setInterval(this.automate,this.interval))},stoptimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},toggleArrows:function(){this.$navPrev.fadeIn(),this.$navNext.fadeIn(),"0"==this.indexActive&&this.$navPrev.fadeOut(),this.indexActive==this.$slides.length-1&&this.$navNext.fadeOut()}});return a}),define("modules/sports/leagues",["jquery","underscore","backbone","utils","pubsub"],function(e,t,i,s,n){var o=i.View.extend({el:"#section_sports",events:{"click #teams_toggle ul li a":"onToggle"},initialize:function(e,t){this.$teams=this.$("div.teams"),this.$ncaaf=this.$("#ncaaf_div_selector")},onToggle:function(t){var i=e(t.currentTarget).data("value"),s=e(t.currentTarget).data("toggle"),o="conf"==s?'div[data-conf="'+i+'"]':'div[data-div="'+i+'"]',a=e(t.currentTarget).data("ht"),r=e(o);"all"===i?this.$teams.show():(this.$teams.hide(),r.show()),a&&n.trigger("uotrack",a)},destroy:function(){this.undelegateEvents()}});return o}),define("modules/book-reviews/booklist",["jquery","underscore","baseview","state","managers/routemanager","form/base-form","ui/dropdown","directAdPosition"],function(e,t,i,s,n,o,a,r){"use strict";var l=i.extend({events:{"submit #ListFilter":"submitBooklistSearchForm"},initialize:function(s){i.prototype.initialize.call(this,s),t.bindAll(this,"booklistAdReady");var n=this._getMostRecentWeek();this.$searchForm=this.$("#ListFilter"),this.$searchTypes=this.$('input[name="search_type"]'),this.$searchField=this.$("#books-list-search"),this.$filterFields=this.$('select[name="sort"], select[name="genreId"], select[name="classId"]',this.$searchForm),this.$weekFilter=this.$("#booklist-datepicker"),this.searchBase=this.$searchForm.attr("action"),this.booklistBaseUrl="/life/books/best-selling/",this.subviews.baseform=new o({el:this.$("#ListFilter"),formOptions:[{el:this.$("#booklist-sortby"),onSelect:t.bind(this.filterBooklist,this)},{el:this.$("#booklist-classpicker"),onSelect:t.bind(this.filterBooklist,this)},{el:this.$("#booklist-genrepicker"),onSelect:t.bind(this.filterBooklist,this)},{el:this.$("#booklist-datepicker"),selectWeek:!0,showOtherMonths:!0,showMonthAfterYear:!0,changeMonth:!0,changeYear:!0,defaultDate:0,dateFormat:"mm/dd/yy",maxDate:n,onSelect:t.bind(this.changeWeek,this)}]}),this.$(".books-buy-button").each(t.bind(function(t,i){this.subviews["dropdown"+t]=new a({el:e(i)})},this))},renderCardInfo:function(e){if(this.booklistPosterAd=this.$(".booklist-poster-ad-module"),this.booklistPosterAd.length)if(e.belowHeroAd){var t={el:this.booklistPosterAd.find(".booklist-poster-ad"),adSizes:["mediumrectangle"],adPlacement:"poster_front",adType:"below_hero",onAdReady:this.booklistAdReady};this.subviews.booklistPosterAd=new r(t)}else this.booklistPosterAd.hide()},booklistAdReady:function(){this.$el.addClass("has-poster-ad"),this.subviews.booklistPosterAd.playAd()},submitBooklistSearchForm:function(e){e.preventDefault();var t=this.$(":checked",this.$searchTypes).val(),i=this.$searchField.val(),s=""!==i?this.searchBase+t+"/"+encodeURIComponent(i)+"/":this.booklistBaseUrl;n.goTo(s)},filterBooklist:function(){n.goTo(window.location.pathname+"?"+this.$filterFields.serialize())},changeWeek:function(e,t){var i=new Date(t.selectedYear,t.selectedMonth,t.selectedDay),s=this._getWeek(i);n.goTo(this.booklistBaseUrl+"week/"+t.selectedYear+"/"+s+"/")},_getWeek:function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},_getMostRecentWeek:function(){var e=new Date,t=e.getDay();return 4>t&&e.setDate(e.getDate()-7+(4-t)),e}});return l}),define("modules/longform/longform-fullsize-gallery",["jquery","underscore","baseview"],function(e,t,i){"use strict";var s=i.extend({events:{"click .js-lfa-tabs-thumb":"toggleThumbs","click .js-lfa-tabs-caption":"toggleCaptions"},initialize:function(e){this.$thumbTab=this.$(".js-lfa-tabs-thumb"),this.$captionTab=this.$(".js-lfa-tabs-caption"),this.$lfaGalleryThumbs=this.$(".js-lfa-gallery-thumbs"),this.$lfaGalleryThumbswrap=this.$(".js-lfa-full-gallery-thumbswrap"),this.$lfaGalleryThumblist=this.$(".js-lfa-full-gallery-thumblist"),this.$lfaGalleryCaption=this.$(".js-lfa-full-gallery-view-meta"),this.$thumbTabTxt=this.$(".js-lfa-gallery-ctrl-lbl-thumb"),this.$captionTabTxt=this.$(".js-lfa-gallery-ctrl-lbl-caption"),this.scrollCheck(),i.prototype.initialize.call(this,e)},scrollCheck:function(){this.$lfaGalleryThumblist.width()<=this.$lfaGalleryThumbs.width()&&this.$lfaGalleryThumbswrap.addClass("lfa-gallery-noscroll")},toggleThumbs:t.debounce(function(){var e=this;this.$thumbTab.hasClass("thumbs-active")?(e.$(".horizontal-scroll").css("visibility","hidden"),e.$lfaGalleryThumbs.removeClass("thumbs-with-ad"),e.$lfaGalleryThumbs.animate({height:"0px"},300,function(){e.$thumbTab.removeClass("thumbs-active"),e.$thumbTabTxt.html("Show thumbnails")}),e.$lfaGalleryCaption.animate({bottom:"36px"},300)):(e.$lfaGalleryThumbs.animate({height:"75px"},300,function(){e.$thumbTab.addClass("thumbs-active"),e.$thumbTabTxt.html("Hide thumbnails"),e.$(".horizontal-scroll").css("visibility","visible"),e.$lfaGalleryThumbs.addClass("thumbs-with-ad")}),e.$lfaGalleryCaption.animate({bottom:"111px"},300))},300,!0),toggleCaptions:t.debounce(function(){var e=this;this.$captionTab.hasClass("caption-active")?this.$lfaGalleryCaption.animate({height:"toggle"},300,function(){e.$captionTab.removeClass("caption-active"),e.$captionTabTxt.html("Show captions")}):this.$lfaGalleryCaption.animate({height:"toggle"},300,function(){e.$captionTab.addClass("caption-active"),e.$captionTabTxt.html("Hide captions")})},300,!0)});return s}),define("modules/sports/nfl-unitedway",["jquery","underscore","backbone","baseview"],function(e,t,i,s){var n=s.extend({events:{"click #nfl-unitedway-skip":"skipSubscribe","click #nfl-unitedway-submit":"validateForm"},initialize:function(){this.$email_address=e('#nfl-unitedway-subscribe form [name="Email Address"]'),s.prototype.initialize.call(this,this.options),t.bindAll(this,"setup","update"),this.setup()},setup:function(){this.setUpNewsletter()},skipSubscribe:function(){e.cookie("unitedway-subscribed","true",{expires:30,path:"/"}),e("#nfl-unitedway-subscribe").hide(),e("#fs-survey-iframe").show()},setUpNewsletter:function(){"true"==e.cookie("unitedway-subscribed")?(e("#nfl-unitedway-subscribe").hide(),e("#fs-survey-iframe").show()):(e("#nfl-unitedway-subscribe").show(),e("#nfl-unitedway-subscribe form").submit(function(t){t.preventDefault(),e.post(e(this).attr("action"),e(this).serialize()),e("#nfl-unitedway-subscribe").hide(),e("#fs-survey-iframe").show(),e.cookie("unitedway-subscribed","true",{expires:30,path:"/"})}))},emailError:function(){e(this.$email_address).css("background","yellow").focus(),window.alert("Please enter a valid email address")},signUp:function(){e("#nfl-unitedway-subscribe form").trigger("submit")},validateForm:function(){var t=e('#nfl-unitedway-subscribe form [name="Email Address"]').val(),i=/\S+@\S+\.\S+/;i.test(t)?e('#nfl-unitedway-subscribe form [name="Thirteen Older"]').prop("checked")?this.signUp():window.alert("You must be 13 years or older to participate in the online voting."):this.emailError()},update:function(){this.setup()},destroy:function(){s.prototype.destroy.apply(this,arguments)}});return n}),define("buildfiles/common",function(){}),define("framework-config",[],function(){return window.use_minified_css&&require.config({baseUrl:window.site_static_url+"jsb"}),{paths:{jquery:"libs/jquery/jquery.require",jquery_modern:"libs/jquery/jquery-2.1.4",jquery_legacy:"libs/jquery/jquery-1.11.3",underscore:"libs/underscore/underscore",backbone:"libs/backbone/backbone-dev",utils:"global/utils",baseview:"global/base-view","base-app":"apps/base-app",pubsub:"global/pubsub","site-manager":"managers/sitemanager",state:"managers/statemanager","user-manager":"managers/usermanager","abtest-manager":"managers/abtestmanager","template-manager":"managers/templatemanager","template-utils":"global/template-utils",cookie:"libs/jquery/plugins/jquery.cookie",easing:"libs/jquery/plugins/jquery.easing.1.3",animatecolors:"libs/jquery/plugins/jquery.animate-colors-min",mousewheel:"libs/jquery/plugins/jquery.mousewheel",uiPageTurn:"libs/jquery/plugins/jquery.ui-page-turn",uiFlip:"libs/jquery/plugins/jquery.ui-flip",transformSupport:"libs/jquery/plugins/jquery.transformSupport",touchpunch:"libs/jquery/plugins/jquery-ui.touch-punch.min",admanager:"managers/admanager",sharedAdPosition:"partner/shared-ad-position",meteredAdPosition:"partner/metered-ad-position",directAdPosition:"partner/direct-ad-position",leaflet:"libs/leaflet/leaflet-0.4.4",base64:"libs/base64/base64",mergedSiteConfig:"/services/config/site-config.js?fullsite=true",adLogger:"partner/ad-logger","file-upload":"libs/jquery/plugins/file-upload/jquery.fileupload",fwinfo:"global/fwinfo","intersection-observer":"libs/polyfills/intersection-observer"},shim:{jquery_modern:["console.setup"],jquery_legacy:["console.setup"],easing:["jquery"],animatecolors:["jquery"],mousewheel:["jquery"],touchpunch:["libs/jqueryui/mouse"],backbone:["underscore","jquery"],"file-upload":["libs/jquery/plugins/file-upload/jquery.iframe-transport"]}}}),require(["framework-config"],function(e){require.config(e),require(["api/analytics","abtest-manager","template-manager","site-manager","modules/global/header","user-accounts/facebook-user-account","user-accounts/googleplus-user-account"],function(e,t,i,s,n){s.start(!window.chromeless&&n,!0)})}),define("main",function(){});
//# sourceMappingURL=main.min.js.map